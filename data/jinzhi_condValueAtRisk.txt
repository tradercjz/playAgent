Prompt: 
某量化团队需要评估加密货币投资组合的尾部风险，他们收集了最近50个交易日的收益率数据，其中包含多个极端波动日。若要求使用非参数方法计算在99%置信度下最坏情况的平均潜在损失，应如何分析？

Input: 
```DolphinDB
returns = 0.001 * rand(-150..250,50) - 0.05
```

Answer: 
```DolphinDB
// 使用历史模拟法计算极端损失预期值
cvars = condValueAtRisk(returns, 'historical', 0.99)
// 对比不同方法计算结果
cvars_normal = condValueAtRisk(returns, 'normal', 0.99)
[cvars, cvars_normal]  // 返回两种方法CVaR结果
```

R1 CoT: 
好的，我需要根据用户提供的condValueAtRisk函数的文档，构造一个相关问题，并生成对应的模拟数据和使用该函数的解答。首先，我需要理解这个函数的作用和参数。

condValueAtRisk用于计算条件风险价值，也就是超过VaR的平均损失。参数包括收益率序列returns，方法method（如正态、对数正态、历史模拟、蒙特卡洛），以及置信水平confidenceLevel。

用户的问题应该不直接提到函数名，而是围绕函数的使用场景。比如，用户可能想知道如何评估某资产在特定置信度下的潜在损失，这时候需要计算CVaR。或者，如何比较不同方法（比如历史模拟法与正态分布法）下的CVaR差异。

接下来，我需要生成模拟的returns数据。需要注意的是，每个收益率必须大于-1，且不能为空。可以通过随机生成一些数据，或者构造特定趋势的数据，比如包含较大亏损的情况，以展示CVaR的效果。

然后，编写问题，例如：“某投资组合在过去30天的日收益率数据如下，使用历史模拟法计算在95%置信水平下的条件风险价值，以评估极端损失的平均水平。” 这样既引用了函数的使用场景，又没有直接提到函数名。

接着，根据生成的模拟数据，编写DolphinDB脚本来调用condValueAtRisk函数。例如，使用历史模拟法，置信水平0.95。同时，可能需要先调用valueAtRisk函数来计算VaR，但根据文档中的例子，condValueAtRisk可以直接使用，不需要显式计算VaR。不过，相关函数是valueAtRisk，所以在解答中可以提到，但问题主要围绕CVaR。

最后，确保模拟数据符合语法要求，比如变量赋值分开写，不要连写。例如：

returns = [-0.01, 0.02, -0.005, ... ]  // 30个数据

然后调用condValueAtRisk(returns, 'historical', 0.95)。

测试一下生成的例子是否符合预期，比如文档中的例子输出是0.016左右，模拟数据需要构造类似的波动。

现在，我需要确保问题、数据和答案都符合要求，并且数据正确无误。比如，生成30天的收益率数据，包含正负值，且所有值大于-1。然后问题引导用户使用condValueAtRisk函数，特别是历史模拟法。


Correct CoT: 
好的，我需要根据用户提供的condValueAtRisk函数的文档，构造一个相关问题，并生成对应的模拟数据和使用该函数的解答。首先，我需要理解这个函数的作用和参数。

condValueAtRisk用于计算条件风险价值，也就是超过VaR的平均损失。参数包括收益率序列returns，方法method（如正态、对数正态、历史模拟、蒙特卡洛），以及置信水平confidenceLevel。

用户的问题应该不直接提到函数名，而是围绕函数的使用场景。比如，用户可能想知道如何评估某资产在特定置信度下的潜在损失，这时候需要计算CVaR。或者，如何比较不同方法（比如历史模拟法与正态分布法）下的CVaR差异。

接下来，我需要生成模拟的returns数据。需要注意的是，每个收益率必须大于-1，且不能为空。可以通过随机生成一些数据，或者构造特定趋势的数据，比如包含较大亏损的情况，以展示CVaR的效果。

然后，编写问题，例如：“某投资组合在过去30天的日收益率数据如下，使用历史模拟法计算在95%置信水平下的条件风险价值，以评估极端损失的平均水平。” 这样既引用了函数的使用场景，又没有直接提到函数名。

接着，根据生成的模拟数据，编写DolphinDB脚本来调用condValueAtRisk函数。例如，使用历史模拟法，置信水平0.95。同时，可能需要先调用valueAtRisk函数来计算VaR，但根据文档中的例子，condValueAtRisk可以直接使用，不需要显式计算VaR。不过，相关函数是valueAtRisk，所以在解答中可以提到，但问题主要围绕CVaR。

最后，确保模拟数据符合语法要求，比如变量赋值分开写，不要连写。例如：

returns = [-0.01, 0.02, -0.005, ... ]  // 30个数据

然后调用condValueAtRisk(returns, 'historical', 0.95)。

测试一下生成的例子是否符合预期，比如文档中的例子输出是0.016左右，模拟数据需要构造类似的波动。

现在，我需要确保问题、数据和答案都符合要求，并且数据正确无误。比如，生成30天的收益率数据，包含正负值，且所有值大于-1。然后问题引导用户使用condValueAtRisk函数，特别是历史模拟法。


Function Name: 
condValueAtRisk
