<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="在股票交易市场，涨幅是一个基础的量价指标，可以衡量资金对个股的拉升力度，是监控主力异动的重要指标。通过关注涨幅，可以了解到资金青睐哪些个股，市场关注哪些板块。 本教程主要提供一种基于 DolphinDB 流数据处理框架，实时计算 1 分钟、5 分钟和 10 分钟涨幅榜的低延时解决方案。 本教程基于上交所 2021 年某日的快照数据进行代码调试，在 DolphinDB 中存储的表结构为： 字段名称 ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="dita"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="实时计算涨幅榜"/><title>实时计算涨幅榜</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ..?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;dita xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34;&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;实时计算涨幅榜&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;实时计算涨幅榜&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;在股票交易市场，涨幅是一个基础的量价指标，可以衡量资金对个股的拉升力度，是监控主力异动的重要指标。通过关注涨幅，可以了解到资金青睐哪些个股，市场关注哪些板块。&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Real-Time_Stock_Price_Increase_Calculation/1.png&#34; width=&#34;65%&#34; xtrc=&#34;image:1;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34; dita-ot:image-width=&#34;780&#34; dita-ot:image-height=&#34;344&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程主要提供一种基于 DolphinDB 流数据处理框架，实时计算 1 分钟、5 分钟和 10 分钟涨幅榜的低延时解决方案。&lt;/p&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:122;158:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-应用场景描述&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;1. 应用场景描述&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;11-数据源&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;1.1. 数据源&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;14:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程基于上交所 2021 年某日的快照数据进行代码调试，在 DolphinDB 中存储的表结构为：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:1;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrc=&#34;tgroup:1;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:1;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:2;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:3;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:1;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:1;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:1;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;16:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;字段名称&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:2;16:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;16:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;数据类型&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:3;16:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;16:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;数据说明&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:1;18:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:2;18:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:4;18:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;SecurityID&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:5;18:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:6;18:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;证券代码&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:3;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:7;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DateTime&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:8;19:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;TIMESTAMP&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:9;19:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;日期时间&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:4;20:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:10;20:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;PreClosePx&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:11;20:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:12;20:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;昨收价&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:5;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:13;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;OpenPx&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:14;21:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:15;21:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;开始价&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:6;22:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:16;22:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;HighPx&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:17;22:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:18;22:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;最高价&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:7;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:19;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;LowPx&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:20;23:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:21;23:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;最低价&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:8;24:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:22;24:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;LastPx&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:23;24:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:24;24:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;最新价&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:9;25:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:25;25:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;……&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:26;25:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;……&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:27;25:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;……&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;12-计算指标&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;1.2. 计算指标&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程示例代码计算了 1 分钟，5 分钟，10 分钟涨幅榜。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;涨幅计算公式： &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:1;31:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;(lastPx - prevLastPx) / prevLastPx * 100 %&lt;/i&gt;&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:2;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:2;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:4;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:5;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:2;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:10;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:28;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;33:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;指标名称&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:29;33:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;33:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;含义&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:2;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:11;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:30;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;factor_1min&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:31;35:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;1 分钟涨幅，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:2;35:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 为 1 分钟前的股票价格&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:12;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:32;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;factor_5min&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:33;36:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;5 分钟涨幅，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:3;36:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 为 5 分钟前的股票价格&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:13;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:34;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;factor_10min&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:35;37:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;10 分钟涨幅，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:4;37:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 为 10 分钟前的股票价格&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;关于涨幅的计算细节，不同的开发者会有不同的处理方法。本教程的处理方式如下：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;当前 X 分钟数据存在时，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:5;41:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 取前 X 分钟数据的价格。&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;42:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;42:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;比如 1 分钟涨幅，09:31:00 的时候，存在 09:30:00 的数据，则 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:6;42:46&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 为 09:30:00 的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:7;42:72&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;lastPx&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;当前 X 分钟数据不存在时，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:8;43:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 取 X 分钟前的一个临近时间对应数据的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:9;43:50&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;lastPx&lt;/i&gt;。&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:3;44:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;44:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;比如 5 分钟涨幅，假设 11:30:00 的数据是上午的最后一条数据，11:30:01~12:59:59 这段时间内没有数据产生。13:03:00 的时候，没有前 5 分钟的 12:58:00 的数据，则 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:10;44:109&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 为 12:58:00 的上一条数据，即 11:30:00 的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:11;44:153&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;lastPx&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;当窗口不满 X 分钟时，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:12;45:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 取窗口内第一条数据的价格。&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:4;46:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;46:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;比如 10 分钟涨幅，假设 09:30:00 时，只有 09:25:00~09:30:00 的数据，没有前 10 分钟的 09:20:00 的数据，也没有 10 分钟前的临近时间的数据，则 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:13;46:100&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;prevLastPx&lt;/i&gt; 为窗口第一条数据，即 09:25:00 的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:14;46:135&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;lastPx&lt;/i&gt;。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;09:30:00 以后开始输出计算结果&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;上游过滤数据，只计算上交所主板 A 股（股票代码 60 开头）09:25:00 以后的股票涨幅（09:25:00 以后 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:15;48:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;lastPx&lt;/i&gt; 不为 0）&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;13-实时计算方案&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;50:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;50:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;1.3. 实时计算方案&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;50:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;52:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;52:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;createReactiveStateEngine&lt;/codeph&gt; 函数创建响应式状态引擎实时计算股票涨幅，通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;52:58&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;createCrossSectionalEngine&lt;/codeph&gt; 函数创建横截面引擎对股票截面上的涨幅进行排序生成涨幅榜。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;54:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程实现的处理流程如下图所示：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;../stream/images/stk_price_inc_1.png&#34; width=&#34;45%&#34; xtrc=&#34;image:2;56:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34; dita-ot:image-width=&#34;1693&#34; dita-ot:image-height=&#34;1877&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;58:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;58:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;处理流程图说明：&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:5;60:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;60:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;实时数据：为了测试方便，本教程选择从数据库内取出某一天的快照数据，通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;60:39&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;replay&lt;/codeph&gt; 函数指定速率回放，以此模拟实时数据。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;snapshotStreamTable 是 DolphinDB 中的流数据表，用于接收实时数据源的数据并发布给流计算引擎进行实时计算。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;62:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;62:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;subscribeTable&lt;/codeph&gt; 订阅流数据表，将 snapshotStreamTable 中的增量数据根据股票代码 SecurityID 过滤出沪市主板 A 股的数据，并添加到流计算引擎中计算涨幅。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;响应式状态引擎结合内置的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;63:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;tmfirst&lt;/codeph&gt;, &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;63:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;tmove&lt;/codeph&gt; 函数实时计算涨幅。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;64:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;横截面引擎结合内置的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;64:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;rank&lt;/codeph&gt; 函数实时计算排名。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;计算结果表是 DolphinDB 中的共享键值表，用于维护涨幅榜的截面，其数据可以被外部消费者消费。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;66:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;Grafana 查询引擎输出的计算结果，以实现动态展示涨幅榜的效果。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-代码开发&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;68:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;68:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;2. 代码开发&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;68:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;70:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程代码开发工具采用 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/db_distr_comp/gui.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:1;70:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB GUI&lt;/xref&gt;，所有代码均可在 DolphinDB GUI 客户端开发工具执行。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;21-创建存储历史数据的库表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;72:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;72:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;2.1. 创建存储历史数据的库表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;72:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;74:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;def createDfsTb(dbName, tbName){ //create database if(existsDatabase(dbName)){ dropDatabase(dbName) } db1 = database(, VALUE, 2020.01.01..2021.01.01) db2 = database(, HASH, [SYMBOL, 30]) db = database(dbName, COMPO, [db1, db2], , &#34;TSDB&#34;) //create table schemaTable = table( array(SYMBOL, 0) as SecurityID, array(TIMESTAMP, 0) as DateTime, array(DOUBLE, 0) as PreClosePx, array(DOUBLE, 0) as OpenPx, array(DOUBLE, 0) as HighPx, array(DOUBLE, 0) as LowPx, array(DOUBLE, 0) as LastPx, array(INT, 0) as TotalVolumeTrade, array(DOUBLE, 0) as TotalValueTrade, array(SYMBOL, 0) as InstrumentStatus, array(DOUBLE[], 0) as BidPrice, array(INT[], 0) as BidOrderQty, array(INT[], 0) as BidNumOrders, array(INT[], 0) as BidOrders, array(DOUBLE[], 0) as OfferPrice, array(INT[], 0) as OfferOrderQty, array(INT[], 0) as OfferNumOrders, array(INT[], 0) as OfferOrders, array(INT, 0) as NumTrades, array(DOUBLE, 0) as IOPV, array(INT, 0) as TotalBidQty, array(INT, 0) as TotalOfferQty, array(DOUBLE, 0) as WeightedAvgBidPx, array(DOUBLE, 0) as WeightedAvgOfferPx, array(INT, 0) as TotalBidNumber, array(INT, 0) as TotalOfferNumber, array(INT, 0) as BidTradeMaxDuration, array(INT, 0) as OfferTradeMaxDuration, array(INT, 0) as NumBidOrders, array(INT, 0) as NumOfferOrders, array(INT, 0) as WithdrawBuyNumber, array(INT, 0) as WithdrawBuyAmount, array(DOUBLE, 0) as WithdrawBuyMoney, array(INT, 0) as WithdrawSellNumber, array(INT, 0) as WithdrawSellAmount, array(DOUBLE, 0) as WithdrawSellMoney, array(INT, 0) as ETFBuyNumber, array(INT, 0) as ETFBuyAmount, array(DOUBLE, 0) as ETFBuyMoney, array(INT, 0) as ETFSellNumber, array(INT, 0) as ETFSellAmount, array(DOUBLE, 0) as ETFSellMoney ) db.createPartitionedTable(table=schemaTable, tableName=tbName, partitionColumns=`DateTime`SecurityID, compressMethods={DateTime:&#34;delta&#34;}, sortColumns=`SecurityID`DateTime, keepDuplicates=ALL) } dbName, tbName = &#34;dfs://snapshot&#34;, &#34;snapshot&#34; createDfsTb(dbName, tbName)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:6;135:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;135:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;分区原则：建议落在 1 个最小分区的数据在内存的大小约 150MB~500MB。&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:7;136:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;136:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;比如：上交所 2021 年 12 月 01 日的股票快照数据为 7873799 行 194 列，加载到内存的大小约 7.3 GB。所以采用组合分区的方法，第一层按天分区，第二层对股票代码按 HASH 分 30 个分区，每个分区的全部数据加载到内存后约占用 249MB 内存空间。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;137:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;创建数据库时，选择 DolphinDB 的 TSDB 存储引擎进行数据的存储。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;138:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;创建数据表时，按照分区方法，指定 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;138:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DateTime&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;138:33&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;SecurityID&lt;/codeph&gt; 为分区字段。在对大数据集查询时，必须指定 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;138:67&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DateTime&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;138:80&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;SecurityID&lt;/codeph&gt; 的过滤条件，可以起到分区剪枝的作用。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;139:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DolphinDB 默认数据存储的压缩算法为 lz4，对于时间、日期类型的数据，建议指定采用 Delta（delta-of-delta encoding） 压缩算法存储，提高存储的压缩比。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;22-导入上交所历史快照数据&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;141:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;141:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;2.2. 导入上交所历史快照数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;141:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;143:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;def transform(t){ temp = select lpad(string(SecurityID), 6, &#34;0&#34;) as SecurityID, DateTime, PreClosePx, OpenPx, HighPx, LowPx, LastPx, TotalVolumeTrade, TotalValueTrade, InstrumentStatus, fixedLengthArrayVector(BidPrice0, BidPrice1, BidPrice2, BidPrice3, BidPrice4, BidPrice5, BidPrice6, BidPrice7, BidPrice8, BidPrice9) as BidPrice, fixedLengthArrayVector(BidOrderQty0, BidOrderQty1, BidOrderQty2, BidOrderQty3, BidOrderQty4, BidOrderQty5, BidOrderQty6, BidOrderQty7, BidOrderQty8, BidOrderQty9) as BidOrderQty, fixedLengthArrayVector(BidNumOrders0, BidNumOrders1, BidNumOrders2, BidNumOrders3, BidNumOrders4, BidNumOrders5, BidNumOrders6, BidNumOrders7, BidNumOrders8, BidNumOrders9) as BidNumOrders, fixedLengthArrayVector(BidOrders0, BidOrders1, BidOrders2, BidOrders3, BidOrders4, BidOrders5, BidOrders6, BidOrders7, BidOrders8, BidOrders9, BidOrders10, BidOrders11, BidOrders12, BidOrders13, BidOrders14, BidOrders15, BidOrders16, BidOrders17, BidOrders18, BidOrders19, BidOrders20, BidOrders21, BidOrders22, BidOrders23, BidOrders24, BidOrders25, BidOrders26, BidOrders27, BidOrders28, BidOrders29, BidOrders30, BidOrders31, BidOrders32, BidOrders33, BidOrders34, BidOrders35, BidOrders36, BidOrders37, BidOrders38, BidOrders39, BidOrders40, BidOrders41, BidOrders42, BidOrders43, BidOrders44, BidOrders45, BidOrders46, BidOrders47, BidOrders48, BidOrders49) as BidOrders, fixedLengthArrayVector(OfferPrice0, OfferPrice1, OfferPrice2, OfferPrice3, OfferPrice4, OfferPrice5, OfferPrice6, OfferPrice7, OfferPrice8, OfferPrice9) as OfferPrice, fixedLengthArrayVector(OfferOrderQty0, OfferOrderQty1, OfferOrderQty2, OfferOrderQty3, OfferOrderQty4, OfferOrderQty5, OfferOrderQty6, OfferOrderQty7, OfferOrderQty8, OfferOrderQty9) as OfferOrderQty, fixedLengthArrayVector(OfferNumOrders0, OfferNumOrders1, OfferNumOrders2, OfferNumOrders3, OfferNumOrders4, OfferNumOrders5, OfferNumOrders6, OfferNumOrders7, OfferNumOrders8, OfferNumOrders9) as OfferNumOrders, fixedLengthArrayVector(OfferOrders0, OfferOrders1, OfferOrders2, OfferOrders3, OfferOrders4, OfferOrders5, OfferOrders6, OfferOrders7, OfferOrders8, OfferOrders9, OfferOrders10, OfferOrders11, OfferOrders12, OfferOrders13, OfferOrders14, OfferOrders15, OfferOrders16, OfferOrders17, OfferOrders18, OfferOrders19, OfferOrders20, OfferOrders21, OfferOrders22, OfferOrders23, OfferOrders24, OfferOrders25, OfferOrders26, OfferOrders27, OfferOrders28, OfferOrders29, OfferOrders30, OfferOrders31, OfferOrders32, OfferOrders33, OfferOrders34, OfferOrders35, OfferOrders36, OfferOrders37, OfferOrders38, OfferOrders39, OfferOrders40, OfferOrders41, OfferOrders42, OfferOrders43, OfferOrders44, OfferOrders45, OfferOrders46, OfferOrders47, OfferOrders48, OfferOrders49) as OfferOrders, NumTrades, IOPV, TotalBidQty, TotalOfferQty, WeightedAvgBidPx, WeightedAvgOfferPx, TotalBidNumber, TotalOfferNumber, BidTradeMaxDuration, OfferTradeMaxDuration, NumBidOrders, NumOfferOrders, WithdrawBuyNumber, WithdrawBuyAmount, WithdrawBuyMoney,WithdrawSellNumber, WithdrawSellAmount, WithdrawSellMoney, ETFBuyNumber, ETFBuyAmount, ETFBuyMoney, ETFSellNumber, ETFSellAmount, ETFSellMoney from t return temp } csvDataPath = &#34;/home/v2/下载/data/20211201snapshot_30stocks.csv&#34; loadTextEx(dbHandle=database(dbName), tableName=tbName, partitionColumns=`DateTime`SecurityID, filename=csvDataPath, transform=transform)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:8;165:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;165:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;测试只使用了 2021 年 12 月 01 日上交所 30 只股票 10:30:00 前的数据，共 32972 条数据，内存占用约 30 M&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:22;166:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;历史数据对象为 csv 文本数据，磁盘空间占用 23 MB&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:23;167:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;167:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;loadTextEx&lt;/codeph&gt; 函数可以直接将数据文件加载到数据库中。其中系统会对数据文件中的数据执行 transform 参数指定的函数，再将得到的结果保存到数据库中，本教程中将 csv 中的十档量价数据转化为了 array vector 进行存储&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;169:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;数据导入完成后，可以执行以下查询语句确认数据是否导入成功：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;171:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;select count(*) from loadTable(dbName, tbName) group by date(DateTime) as TradeDate&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;175:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;执行完后，返回如下信息，说明数据成功导入：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:3;177:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:3;177:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:6;177:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:7;177:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:3;177:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:14;177:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:36;177:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;TradeDate&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:37;177:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;count&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:3;179:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:15;179:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:38;179:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;2021.12.01&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:39;179:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;32,972&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;23-清理环境并创建相关流数据表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;181:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;181:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;2.3. 清理环境并创建相关流数据表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;181:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;183:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;use ops // clean up environment def cleanEnvironment(){ cancelJobEx() try{ unsubscribeTable(tableName=`snapshotStreamTable, actionName=&#34;snapshotFilter&#34;) } catch(ex){ print(ex) } try{ dropStreamEngine(&#34;calChange&#34;)} catch(ex){ print(ex) } try{ dropStreamEngine(&#34;crossSectionalEngine&#34;) } catch(ex){ print(ex) } try{ undef(&#34;snapshotStreamTable&#34;, SHARED) } catch(ex){ print(ex) } try{ undef(&#34;changeCrossSectionalTable&#34;, SHARED) } catch(ex){ print(ex) } } // create stream table def createStreamTable(dbName, tbName){ schemaTB = loadTable(dbName, tbName).schema().colDefs share(streamTable(40000:0, schemaTB.name, schemaTB.typeString), `snapshotStreamTable) share(keyedTable(`SecurityID, 50:0, `DateTime`SecurityID`factor_1min`rank_1min`factor_5min`rank_5min`factor_10min`rank_10min, [TIMESTAMP, SYMBOL, DOUBLE, INT, DOUBLE, INT, DOUBLE, INT]), `changeCrossSectionalTable) } cleanEnvironment() dbName, tbName = &#34;dfs://snapshot&#34;, &#34;snapshot&#34; createStreamTable(dbName, tbName)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;208:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;根据“实时计算方案”章节的流程图，可以看出需要清理的有：正在进行的回放任务、一个订阅（subscribeTable）、两个引擎（响应式状态引擎和横截面引擎）、两张共享表（输入输出表）。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;210:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;需要创建的表有：一张共享流数据表（和数据库 dbName 中名为 tbName 的分布式表结构相同，用于接收实时数据）、一张共享键值表（用于维护股票涨幅排名的截面数据）。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;24-注册流计算引擎和订阅流数据表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;212:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;212:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;2.4. 注册流计算引擎和订阅流数据表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;212:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;214:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:7;214:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;（1）订阅流表&lt;/b&gt; snapshotStreamTable，过滤出沪市主板 A 股 09:25:00 以后的数据&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;216:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;def snapshotFilter(engineName, mutable data){ t = select * from data where left(SecurityID, 2)=&#34;60&#34; and time(DateTime)&amp;gt;=09:25:00.000 getStreamEngine(engineName).append!(t) } subscribeTable(tableName=&#34;snapshotStreamTable&#34;, actionName=&#34;snapshotFilter&#34;, offset=-1, handler=snapshotFilter{&#34;calChange&#34;}, msgAsTable=true, hash=0)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:9;225:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:24;225:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:16;225:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;batchSize&lt;/i&gt; 和 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:17;225:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;throttle&lt;/i&gt; 能指定触发 handler 的规则。&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:18;225:49&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;batchSize&lt;/i&gt; 未指定或为非正数，则每一批次的消息都会触发 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:19;225:83&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;handler&lt;/i&gt; 处理增量数据；否则未处理的数据需要积攒到 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:20;225:114&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;batchSize&lt;/i&gt; 条时，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:21;225:129&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;handler&lt;/i&gt; 才会统一处理消息。如果 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:22;225:151&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;batchSize&lt;/i&gt; 条件一直未达到，那么继上次处理消息的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:23;225:182&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;throttle&lt;/i&gt; 秒之后也会触发 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:24;225:201&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;handler&lt;/i&gt; 处理消息。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:25;226:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程代码没有指定 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:25;226:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;batchSize&lt;/i&gt; 和 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:26;226:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;throttle&lt;/i&gt; 是因为示例数据的数据量比较小，共 30 只上交股票，其中主板 A 股只有 26 只。所以每批数据触发一次 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:27;226:91&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;handler&lt;/i&gt; 处理也不会产生计算压力。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:26;227:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;当接入实时数据之后，可以用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;227:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;getStreamingStat().subWorkers&lt;/codeph&gt; 观察订阅状态，如果发现 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:28;227:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;queueDepth&lt;/i&gt; 一直增加，表示订阅队列产生堵塞。此时可以考虑配置并调整 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:29;227:102&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;batchSize&lt;/i&gt; 和 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:30;227:116&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;throttle&lt;/i&gt; 参数。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;229:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:8;229:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;（2）注册响应式状态引擎&lt;/b&gt; calChange，计算涨幅&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;231:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;@state def calculateChange(DateTime, LastPx, lag){ windowFirstPx = tmfirst(DateTime, LastPx, lag) preMinutePx = tmove(DateTime, LastPx, lag) prevLastPx = iif(preMinutePx == NULL, windowFirstPx, preMinutePx) return 100 * (LastPx - prevLastPx) \ prevLastPx } createReactiveStateEngine(name=&#34;calChange&#34;, metrics=&amp;lt;[DateTime, calculateChange(DateTime, LastPx, lag=1m), calculateChange(DateTime, LastPx, lag=5m), calculateChange(DateTime, LastPx, lag=10m)]&amp;gt;, dummyTable=objByName(&#34;snapshotStreamTable&#34;), outputTable=getStreamEngine(&#34;crossSectionalEngine&#34;), keyColumn=`SecurityID, filter=&amp;lt;time(DateTime) &amp;gt;= 09:30:00.000&amp;gt;)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:10;243:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:27;243:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;@state 用于标识状态函数，表示在响应式状态引擎中需要访问灌入引擎的历史数据。其中 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;243:47&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;tmfirst&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;243:59&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;tmove&lt;/codeph&gt; 是涉及状态的函数。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:28;244:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;采用了引擎串联，即响应式状态引擎的输出直接输入下一个横截面引擎。因为 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;244:38&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;outputTable=getStreamEngine(&#34;crossSectionalEngine&#34;)&lt;/codeph&gt;，所以需要先执行下面 (3) 的代码创建横截面引擎后，才能顺利执行上述代码创建响应式状态引擎&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:9;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;（3）注册响应式状态引擎&lt;/b&gt; crossSectionalEngine，计算排名&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;248:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;schemaTB = table(1:0, `SecurityID`DateTime`factor_1min`factor_5min`factor_10min, [SYMBOL, TIMESTAMP, DOUBLE, DOUBLE, DOUBLE]) createCrossSectionalEngine(name=&#34;crossSectionalEngine&#34;, metrics=&amp;lt;[SecurityID, factor_1min, rank(factor_1min, ascending=false), factor_5min, rank(factor_5min, ascending=false), factor_10min, rank(factor_10min, ascending=false)]&amp;gt;, dummyTable=schemaTB, outputTable=objByName(&#34;changeCrossSectionalTable&#34;), keyColumn=`SecurityID, triggeringPattern='perBatch', useSystemTime=false, timeColumn=`DateTime)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:11;253:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:29;253:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;schemaTB 是横截面引擎的输入表结构（对应响应式状态引擎的输出表结构）。参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:31;253:45&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;dummyTable&lt;/i&gt; 只是为了指定输入表结构，和表里是否有数据无关。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:30;254:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;横截面引擎支持多种触发计算的规则，包括&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:12;255:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:31;255:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;“perBatch”每插入一批数据触发一次计算&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:32;256:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;“perRow”每一行数据都会触发一次计算&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:33;257:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;“interval” （根据系统时间）每隔 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:32;257:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;triggeringInterval&lt;/i&gt; 的时间，引擎内若存在未计算数据，触发一次计算&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:34;258:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;“keyCount”当前时间戳记录数达到 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:33;258:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;triggeringInterval&lt;/i&gt;，或有更新时间戳的数据到达时，触发一次计算&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:35;259:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本例中，触发计算的规则采取的是 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:17;259:19&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;triggeringPattern='perBatch'&lt;/codeph&gt;，即每插入一次数据触发一次对截面的排名统计。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;25-grafana-实时展示涨幅榜&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;261:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;261:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;2.5. Grafana 实时展示涨幅榜&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;261:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;263:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;Grafana 配置 DolphinDB 数据源及监控 DolphinDB 数据表中数据的教程：&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;../tools/grafana.md&#34; xtrc=&#34;xref:2;263:49&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;Grafana 连接 DolphinDB 数据源&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;265:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程监控 1 分钟、5 分钟、10 分钟的涨幅榜。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;267:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;Grafana 中的 Query 代码：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:13;269:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:36;269:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;269:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;1 min 涨幅榜&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;271:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;select SecurityID, DateTime, factor_1min from changeCrossSectionalTable order by rank_1min&lt;/codeblock&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:37;275:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;275:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;5 min 涨幅榜&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;277:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;select SecurityID, DateTime, factor_5min from changeCrossSectionalTable order by rank_5min&lt;/codeblock&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:38;281:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;281:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;10 min 涨幅榜&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;283:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;select SecurityID, DateTime, factor_10min from changeCrossSectionalTable order by rank_10min&lt;/codeblock&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;26-历史数据回放&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;287:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;287:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;2.6. 历史数据回放&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;287:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;288:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;t = select * from loadTable(&#34;dfs://snapshot&#34;, &#34;snapshot&#34;) where date(DateTime)=2021.12.01 order by DateTime submitJob(&#34;replay_snapshot&#34;, &#34;snapshot&#34;, replay{t, snapshotStreamTable, `DateTime, `DateTime, 1000, true, 1}) getRecentJobs()&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;294:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;执行完后，返回如下信息：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Real-Time_Stock_Price_Increase_Calculation/2_1.png&#34; width=&#34;75%&#34; xtrc=&#34;image:3;296:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34; dita-ot:image-width=&#34;1208&#34; dita-ot:image-height=&#34;75&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;298:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;如果 endTime 和 errorMsg 为空，说明任务正在正常运行中。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-结果展示&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;300:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;300:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;3. 结果展示&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;300:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;31-节点内的计算结果表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:14;302:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:14;302:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;3.1. 节点内的计算结果表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:14;302:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;304:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;计算结果表 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:18;304:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;changeCrossSectionalTable&lt;/codeph&gt;，可以通过 DolphinDB 所有 API 查询接口实时查询。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;306:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;下图是通过 DolphinDB GUI 实时查看该表的结果：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Real-Time_Stock_Price_Increase_Calculation/3_1.png&#34; width=&#34;60%&#34; xtrc=&#34;image:4;308:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34; dita-ot:image-width=&#34;756&#34; dita-ot:image-height=&#34;544&#34;/&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;32-grafana-实时监控结果&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:15;310:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:15;310:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;3.2. Grafana 实时监控结果&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:15;310:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Real-Time_Stock_Price_Increase_Calculation/3_2.png&#34; width=&#34;80%&#34; xtrc=&#34;image:5;312:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34; dita-ot:image-width=&#34;1772&#34; dita-ot:image-height=&#34;866&#34;/&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;4-性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:16;314:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:16;314:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;4. 性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:16;314:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;316:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程测试了单次响应计算和连续响应计算两种场景。测试数据为 2021 年某天的上交所主板 A 股 1650 只股票的数据。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;41-单次响应计算性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:17;318:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:17;318:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;4.1. 单次响应计算性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:17;318:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;320:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;单次响应计算时间为从第 1 个响应式状态引擎收到输入至第 2 个横截面引擎输出结果所经历的时间。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;322:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;测试了单只股票响应一次计算（单条数据触发一次计算）和 1650 只股票响应一次计算（一批数据触发一次计算）的性能。统计了 10 次的总耗时，取平均值作为单次的耗时。测试使用的服务器 CPU 为 Intel(R) Xeon(R) Silver 4216 CPU @ 2.10GHz。单线程情况下，测试结果如下：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:4;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:4;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:8;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:9;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:4;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:16;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:40;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;股票个数&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:41;324:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;耗时 (单位:ms)&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:4;326:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:17;326:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:42;326:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;1&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:43;326:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;0.20&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:18;327:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:44;327:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;1650&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:45;327:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;3.45&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;42-连续响应计算性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:18;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:18;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;4.2. 连续响应计算性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:18;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;331:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;以 2021 年某天的上交所主板 A 股 1650 只股票的 658 万条快照数据为测试数据，将所有测试数据全量灌入第 1 个响应式状态引擎触发计算。引擎流水线的计算总耗时是 17 秒，最大处理的能力是 38 万条每秒。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;333:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;开发者可以增加计算的并行度，提高系统的处理能力。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;5-总结&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:19;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:19;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;5. 总结&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:19;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;337:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;DolphinDB 内置的流数据框架支持流数据的发布，订阅，预处理，实时内存计算，复杂指标的滚动窗口计算、滑动窗口计算、累计窗口计算等，是一个运行高效、使用便捷的流数据处理框架。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;339:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;本教程基于 DolphinDB 流数据处理框架，提供了一种实时计算涨幅榜的低延时解决方案，旨在提高开发人员在使用 DolphinDB 内置的流数据框架开发流计算业务场景时的开发效率、降低开发难度，更好地挖掘 DolphinDB 在复杂实时流计算场景中的价值。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;附件&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:20;341:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:20;341:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;附件&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:20;341:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;343:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:10;343:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;业务代码&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;345:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/Real-Time_Stock_Price_Increase_Calculation/01.创建存储快照数据的库表并导入数据.txt&#34; xtrc=&#34;xref:3;345:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;?ditaot usertext?&gt;01.创建存储快照数据的库表并导入数据.txt&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;347:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/Real-Time_Stock_Price_Increase_Calculation/02.清理环境并创建相关流数据表.txt&#34; xtrc=&#34;xref:4;347:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;?ditaot usertext?&gt;02.清理环境并创建相关流数据表.txt&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;349:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/Real-Time_Stock_Price_Increase_Calculation/03.注册流计算引擎和订阅流数据表.txt&#34; xtrc=&#34;xref:5;349:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;?ditaot usertext?&gt;03.注册流计算引擎和订阅流数据表.txt&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;351:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/Real-Time_Stock_Price_Increase_Calculation/04.历史数据回放.txt&#34; xtrc=&#34;xref:6;351:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;?ditaot usertext?&gt;04.历史数据回放.txt&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;353:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/Real-Time_Stock_Price_Increase_Calculation/05.性能测试.txt&#34; xtrc=&#34;xref:7;353:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;?ditaot usertext?&gt;05.性能测试.txt&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;355:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:11;355:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;示例数据&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;357:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;zip&#34; href=&#34;data/Real-Time_Stock_Price_Increase_Calculation/20211201snapshot_30stocks.zip&#34; xtrc=&#34;xref:8;357:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md&#34;&gt;&lt;?ditaot usertext?&gt;20211201snapshot_30stocks.zip&lt;/xref&gt;&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/dita&gt;"/><meta name="wh-source-relpath" content="tutorials/rt_stk_price_inc_calc.md file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/rt_stk_price_inc_calc.md"/><meta name="wh-out-relpath" content="tutorials/rt_stk_price_inc_calc_2.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/OHLC_2.html">金融场景案例</a></div></div></li><li class="active"><div class="topicref" data-id="实时计算涨幅榜"><div class="title"><a href="../tutorials/rt_stk_price_inc_calc_2.html">实时计算涨幅榜</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="k-线计算-d9713e102569" class="topicref" data-id="k-线计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="k-线计算-d9713e102569-link">K 线计算</a></div></div></li><li role="treeitem"><div data-tocid="使用-klinechart-展示-dolphindb-k-线-d9713e102615" class="topicref" data-id="使用-klinechart-展示-dolphindb-k-线" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/displaying_the_dolphindb_k-line_with_klinechart.html" id="使用-klinechart-展示-dolphindb-k-线-d9713e102615-link">使用 KLineChart 展示 DolphinDB K 线</a></div></div></li><li role="treeitem"><div data-tocid="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比-d9713e102661" class="topicref" data-id="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Python_HDF5_vs_DolphinDB.html" id="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比-d9713e102661-link">Python + HDF5 因子计算与 DolphinDB 一体化因子计算方案对比</a></div></div></li><li role="treeitem"><div data-tocid="python--文件存储与-dolphindb-因子计算性能比较-d9713e102707" class="topicref" data-id="python--文件存储与-dolphindb-因子计算性能比较" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/DolphinDB_VS_PythonFile_Storage.html" id="python--文件存储与-dolphindb-因子计算性能比较-d9713e102707-link">Python + 文件存储与 DolphinDB 因子计算性能比较</a></div></div></li><li role="treeitem"><div data-tocid="python-parser-在金融量化分析场景的应用入门-d9713e102753" class="topicref" data-id="python-parser-在金融量化分析场景的应用入门" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/py_parser__quant_fin.html" id="python-parser-在金融量化分析场景的应用入门-d9713e102753-link">Python Parser 在金融量化分析场景的应用入门</a></div></div></li><li role="treeitem"><div data-tocid="处理-level-2-行情数据实例-d9713e102799" class="topicref" data-id="处理-level-2-行情数据实例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/l2_stk_data_proc_2.html" id="处理-level-2-行情数据实例-d9713e102799-link">处理 Level-2 行情数据实例</a></div></div></li><li role="treeitem"><div data-tocid="存储金融数据的分区方案最佳实践-d9713e102845" class="topicref" data-id="存储金融数据的分区方案最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practices_for_partitioned_storage.html" id="存储金融数据的分区方案最佳实践-d9713e102845-link">存储金融数据的分区方案最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="公募基金历史数据基础分析教程-d9713e102891" class="topicref" data-id="公募基金历史数据基础分析教程" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/public_fund_basic_analysis.html" id="公募基金历史数据基础分析教程-d9713e102891-link">公募基金历史数据基础分析教程</a></div></div></li><li role="treeitem"><div data-tocid="股票行情回放-d9713e102937" class="topicref" data-id="股票行情回放" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stock_market_replay_2.html" id="股票行情回放-d9713e102937-link">股票行情回放</a></div></div></li><li role="treeitem"><div data-tocid="搭建行情回放服务的最佳实践-d9713e102983" class="topicref" data-id="搭建行情回放服务的最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/appendices_market_replay_bp.html" id="搭建行情回放服务的最佳实践-d9713e102983-link">搭建行情回放服务的最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="国内股票行情数据导入实例-d9713e103029" class="topicref" data-id="国内股票行情数据导入实例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stockdata_csv_import_demo.html" id="国内股票行情数据导入实例-d9713e103029-link">国内股票行情数据导入实例</a></div></div></li><li role="treeitem"><div data-tocid="基金份额参考价值-iopv-计算-d9713e103076" class="topicref" data-id="基金份额参考价值-iopv-计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_IOPV_2.html" id="基金份额参考价值-iopv-计算-d9713e103076-link">基金份额参考价值 IOPV 计算</a></div></div></li><li role="treeitem"><div data-tocid="基于快照行情的股票和基金-k-线合成-d9713e103122" class="topicref" data-id="基于快照行情的股票和基金-k-线合成" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/k.html" id="基于快照行情的股票和基金-k-线合成-d9713e103122-link">基于快照行情的股票和基金 K 线合成</a></div></div></li><li role="treeitem"><div data-tocid="计算基金日频因子-d9713e103168" class="topicref" data-id="计算基金日频因子" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/fund_factor_contrasted_by_py.html" id="计算基金日频因子-d9713e103168-link">计算基金日频因子</a></div></div></li><li role="treeitem"><div data-tocid="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎-d9713e103214" class="topicref" data-id="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/orderBookSnapshotEngine.html" id="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎-d9713e103214-link">基于逐笔数据合成高频 Orderbook：DolphinDB Orderbook 引擎</a></div></div></li><li role="treeitem"><div data-tocid="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇-d9713e103260" class="topicref" data-id="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/LoadDataForPoc.html" id="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇-d9713e103260-link">金融 PoC 用户历史数据导入指导手册之股票 Level-2 逐笔篇</a></div></div></li><li role="treeitem"><div data-tocid="金融实时实际波动率预测-d9713e103306" class="topicref" data-id="金融实时实际波动率预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ml_volatility_2.html" id="金融实时实际波动率预测-d9713e103306-link">金融实时实际波动率预测</a></div></div></li><li role="treeitem"><div data-tocid="金融因子流式实现-d9713e103352" class="topicref" data-id="金融因子流式实现" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/str_comp_fin_quant_2.html" id="金融因子流式实现-d9713e103352-link">金融因子流式实现</a></div></div></li><li role="treeitem"><div data-tocid="开发股票波动率预测模型的-676-个输入特征-d9713e103398" class="topicref" data-id="开发股票波动率预测模型的-676-个输入特征" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/metacode_derived_features_2.html" id="开发股票波动率预测模型的-676-个输入特征-d9713e103398-link">开发股票波动率预测模型的 676 个输入特征</a></div></div></li><li role="treeitem"><div data-tocid="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践-d9713e103444" class="topicref" data-id="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/l2_snapshot_factor_calc_2.html" id="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践-d9713e103444-link">快速搭建 Level-2 快照数据流批一体因子计算平台最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="量化金融范例-d9713e103490" class="topicref" data-id="量化金融范例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/quant_finance_examples.html" id="量化金融范例-d9713e103490-link">量化金融范例</a></div></div></li><li role="treeitem"><div data-tocid="流式计算中证-1000-指数主买主卖交易量-d9713e103536" class="topicref" data-id="流式计算中证-1000-指数主买主卖交易量" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/CSI_1000_2.html" id="流式计算中证-1000-指数主买主卖交易量-d9713e103536-link">流式计算中证 1000 指数主买/主卖交易量</a></div></div></li><li role="treeitem"><div data-tocid="深度不平衡买卖压力指标波动率计算-d9713e103583" class="topicref" data-id="深度不平衡买卖压力指标波动率计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/sql_performance_optimization_wap_di_rv.html" id="深度不平衡买卖压力指标波动率计算-d9713e103583-link">深度不平衡、买卖压力指标、波动率计算</a></div></div></li><li role="treeitem"><div data-tocid="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用-d9713e103629" class="topicref" data-id="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/insight_plugin_orderbook_engine_application.html" id="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用-d9713e103629-link">实时合成自定义频订单簿快照：DolphinDB INSIGHT 行情插件与订单簿引擎应用</a></div></div></li><li role="treeitem"><div data-tocid="实时计算分钟资金流-d9713e103675" class="topicref" data-id="实时计算分钟资金流" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_capital_flow_order_by_order_2.html" id="实时计算分钟资金流-d9713e103675-link">实时计算分钟资金流</a></div></div></li><li role="treeitem"><div data-tocid="实时计算高频因子-d9713e103721" class="topicref" data-id="实时计算高频因子" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/hf_factor_streaming_2.html" id="实时计算高频因子-d9713e103721-link">实时计算高频因子</a></div></div></li><li role="treeitem"><div data-tocid="实时计算日累计逐单资金流-d9713e103767" class="topicref" data-id="实时计算日累计逐单资金流" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_capital_flow_daily_2.html" id="实时计算日累计逐单资金流-d9713e103767-link">实时计算日累计逐单资金流</a></div></div></li><li role="treeitem" class="active"><div data-tocid="实时计算涨幅榜-d9713e103813" class="topicref" data-id="实时计算涨幅榜" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/rt_stk_price_inc_calc_2.html" id="实时计算涨幅榜-d9713e103813-link">实时计算涨幅榜</a></div></div></li><li role="treeitem"><div data-tocid="实时选取外汇行情多价源最优价-d9713e103859" class="topicref" data-id="实时选取外汇行情多价源最优价" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_price_selection.html" id="实时选取外汇行情多价源最优价-d9713e103859-link">实时选取外汇行情多价源最优价</a></div></div></li><li role="treeitem"><div data-tocid="外汇掉期估值计算-d9713e103905" class="topicref" data-id="外汇掉期估值计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/FxSwapValuation.html" id="外汇掉期估值计算-d9713e103905-link">外汇掉期估值计算</a></div></div></li><li role="treeitem"><div data-tocid="因子计算平台构建-d9713e103951" class="topicref" data-id="因子计算平台构建" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Python_Celery.html" id="因子计算平台构建-d9713e103951-link">因子计算平台构建</a></div></div></li><li role="treeitem"><div data-tocid="因子计算最佳实践-d9713e103997" class="topicref" data-id="因子计算最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practice_for_factor_calculation.html" id="因子计算最佳实践-d9713e103997-link">因子计算最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="mvo_tutorial-d9713e104043" class="topicref" data-id="mvo_tutorial" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/MVO.html" id="mvo_tutorial-d9713e104043-link">优化投资组合：DolphinDB 最优化求解系列函数应用指南</a></div></div></li><li role="treeitem"><div data-tocid="中高频多因子库存储最佳实践-d9713e104090" class="topicref" data-id="中高频多因子库存储最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practices_for_multi_factor.html" id="中高频多因子库存储最佳实践-d9713e104090-link">中高频多因子库存储最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="alphalens-在-dolphindb-中的应用因子分析建模实践-d9713e104136" class="topicref" data-id="alphalens-在-dolphindb-中的应用因子分析建模实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Practical_Factor_Analysis_Modeling.html" id="alphalens-在-dolphindb-中的应用因子分析建模实践-d9713e104136-link">Alphalens 在 DolphinDB 中的应用：因子分析建模实践</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-与-dolphinscheduler-的集成-d9713e104182" class="topicref" data-id="dolphindb-与-dolphinscheduler-的集成" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphinscheduler_integration.html" id="dolphindb-与-dolphinscheduler-的集成-d9713e104182-link">DolphinDB 与 DolphinScheduler 的集成</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-与-python-airflow-最佳实践-d9713e104228" class="topicref" data-id="dolphindb-与-python-airflow-最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_airflow.html" id="dolphindb-与-python-airflow-最佳实践-d9713e104228-link">DolphinDB 与 Python AirFlow 最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="gplearn-d9713e104274" class="topicref" data-id="gplearn" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/gplearn.html" id="gplearn-d9713e104274-link">Shark GPLearn 快速上手</a></div></div></li><li role="treeitem"><div data-tocid="利用jit加速计算-etf-期权隐含波动率和希腊值-d9713e104320" class="topicref" data-id="利用jit加速计算-etf-期权隐含波动率和希腊值" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/IV_Greeks_Calculation_for_ETF_Options_Using_JIT.html" id="利用jit加速计算-etf-期权隐含波动率和希腊值-d9713e104320-link">利用JIT加速计算 ETF 期权隐含波动率和希腊值</a></div></div></li><li role="treeitem"><div data-tocid="基于-dolphindb-的-brinson-绩效归因模型实践-d9713e104366" class="topicref" data-id="基于-dolphindb-的-brinson-绩效归因模型实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/brinson.html" id="基于-dolphindb-的-brinson-绩效归因模型实践-d9713e104366-link">基于 DolphinDB 的 Brinson 绩效归因模型实践</a></div></div></li><li role="treeitem"><div data-tocid="基于-dolphindb-的-campisi-绩效归因模型实践-d9713e104412" class="topicref" data-id="基于-dolphindb-的-campisi-绩效归因模型实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/campisi.html" id="基于-dolphindb-的-campisi-绩效归因模型实践-d9713e104412-link">基于 DolphinDB 的 Campisi 绩效归因模型实践</a></div></div></li><li role="treeitem"><div data-tocid="期货分钟频cta策略回测案例-d9713e104458" class="topicref" data-id="期货分钟频cta策略回测案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/futures_minute_frequency_cta_strategy_backtest_example.html" id="期货分钟频cta策略回测案例-d9713e104458-link">期货分钟频CTA策略回测案例</a></div></div></li><li role="treeitem"><div data-tocid="exchdata-交易所历史股票数据自动化导入功能模块使用教程-d9713e104504" class="topicref" data-id="exchdata-交易所历史股票数据自动化导入功能模块使用教程" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/exchdata_exchange_historical_stock_data_auto_import_module_tutorial.html" id="exchdata-交易所历史股票数据自动化导入功能模块使用教程-d9713e104504-link">ExchData 交易所历史股票数据自动化导入功能模块使用教程</a></div></div></li><li role="treeitem"><div data-tocid="ficc_func_uasge_and_performance-d9713e104550" class="topicref" data-id="ficc_func_uasge_and_performance" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ficc_func_uasge_and_performance.html" id="ficc_func_uasge_and_performance-d9713e104550-link">FICC 固收系列函数使用示例及性能</a></div></div></li><li role="treeitem"><div data-tocid="title1-d9713e104597" class="topicref" data-id="title1" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ficc_funcs_application.html" id="title1-d9713e104597-link">FICC 固收系列函数应用场景</a></div></div></li><li role="treeitem"><div data-tocid="最优化函数_socp_的使用及转化案例-d9713e104643" class="topicref" data-id="最优化函数_socp_的使用及转化案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/socp_usage_case.html" id="最优化函数_socp_的使用及转化案例-d9713e104643-link">最优化函数 socp 的使用及转化案例</a></div></div></li><li role="treeitem"><div data-tocid="k_line_calculation-d9713e104689" class="topicref" data-id="k_line_calculation" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/k_line_calculation%20.html" id="k_line_calculation-d9713e104689-link">基于期货快照行情数据计算合约 K 线以及主连行情</a></div></div></li><li role="treeitem"><div data-tocid="backtest_introduction_usage-d9713e104735" class="topicref" data-id="backtest_introduction_usage" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/backtest_introduction_usage.html" id="backtest_introduction_usage-d9713e104735-link">融资融券策略回测使用说明及回测案例</a></div></div></li><li role="treeitem"><div data-tocid="stock_backtest-d9713e104781" class="topicref" data-id="stock_backtest" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stock_backtest.html" id="stock_backtest-d9713e104781-link">股票中低频投资组合回测案例实现</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="" role="article" aria-labelledby="ariaid-title1"><article class="nested0" aria-labelledby="ariaid-title1" id="实时计算涨幅榜"><h1 class="- topic/title title topictitle1" id="ariaid-title1">实时计算涨幅榜</h1><div class="- topic/body body"><p class="- topic/p p">在股票交易市场，涨幅是一个基础的量价指标，可以衡量资金对个股的拉升力度，是监控主力异动的重要指标。通过关注涨幅，可以了解到资金青睐哪些个股，市场关注哪些板块。</p><img class="- topic/image image" src="images/Real-Time_Stock_Price_Increase_Calculation/1.png"/><br/><p class="- topic/p p">本教程主要提供一种基于 DolphinDB 流数据处理框架，实时计算 1 分钟、5 分钟和 10 分钟涨幅榜的低延时解决方案。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-应用场景描述"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. 应用场景描述</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title3" id="11-数据源"><h3 class="- topic/title title topictitle3" id="ariaid-title3">1.1. 数据源</h3><div class="- topic/body body"><p class="- topic/p p">本教程基于上交所 2021 年某日的快照数据进行代码调试，在 DolphinDB 中存储的表结构为：</p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="11-数据源__entry__1"><strong class="+ topic/ph hi-d/b ph b">字段名称</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="11-数据源__entry__2"><strong class="+ topic/ph hi-d/b ph b">数据类型</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="11-数据源__entry__3"><strong class="+ topic/ph hi-d/b ph b">数据说明</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__1">SecurityID</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__2">SYMBOL</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__3">证券代码</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__1">DateTime</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__2">TIMESTAMP</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__3">日期时间</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__1">PreClosePx</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__3">昨收价</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__1">OpenPx</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__3">开始价</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__1">HighPx</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__3">最高价</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__1">LowPx</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__3">最低价</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__1">LastPx</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__3">最新价</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__1">……</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__2">……</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="11-数据源__entry__3">……</td></tr></tbody></table></div></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="12-计算指标"><h3 class="- topic/title title topictitle3" id="ariaid-title4">1.2. 计算指标</h3><div class="- topic/body body"><p class="- topic/p p">本教程示例代码计算了 1 分钟，5 分钟，10 分钟涨幅榜。</p><p class="- topic/p p">涨幅计算公式： <em class="+ topic/ph hi-d/i ph i">(lastPx - prevLastPx) / prevLastPx * 100 %</em></p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="12-计算指标__entry__1"><strong class="+ topic/ph hi-d/b ph b">指标名称</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="12-计算指标__entry__2"><strong class="+ topic/ph hi-d/b ph b">含义</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="12-计算指标__entry__1">factor_1min</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="12-计算指标__entry__2">1 分钟涨幅，<em class="+ topic/ph hi-d/i ph i">prevLastPx</em> 为 1 分钟前的股票价格</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="12-计算指标__entry__1">factor_5min</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="12-计算指标__entry__2">5 分钟涨幅，<em class="+ topic/ph hi-d/i ph i">prevLastPx</em> 为 5 分钟前的股票价格</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="12-计算指标__entry__1">factor_10min</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="12-计算指标__entry__2">10 分钟涨幅，<em class="+ topic/ph hi-d/i ph i">prevLastPx</em> 为 10 分钟前的股票价格</td></tr></tbody></table></div><p class="- topic/p p">关于涨幅的计算细节，不同的开发者会有不同的处理方法。本教程的处理方式如下：</p><ul class="- topic/ul ul"><li class="- topic/li li">当前 X 分钟数据存在时，<em class="+ topic/ph hi-d/i ph i">prevLastPx</em>  取前 X 分钟数据的价格。<ul class="- topic/ul ul"><li class="- topic/li li">比如 1 分钟涨幅，09:31:00 的时候，存在 09:30:00 的数据，则 <em class="+ topic/ph hi-d/i ph i">prevLastPx</em> 为 09:30:00 的 <em class="+ topic/ph hi-d/i ph i">lastPx</em></li></ul></li><li class="- topic/li li">当前 X 分钟数据不存在时，<em class="+ topic/ph hi-d/i ph i">prevLastPx</em> 取 X 分钟前的一个临近时间对应数据的 <em class="+ topic/ph hi-d/i ph i">lastPx</em>。<ul class="- topic/ul ul"><li class="- topic/li li">比如 5 分钟涨幅，假设 11:30:00 的数据是上午的最后一条数据，11:30:01~12:59:59 这段时间内没有数据产生。13:03:00 的时候，没有前 5 分钟的 12:58:00 的数据，则 <em class="+ topic/ph hi-d/i ph i">prevLastPx</em> 为 12:58:00 的上一条数据，即 11:30:00 的 <em class="+ topic/ph hi-d/i ph i">lastPx</em></li></ul></li><li class="- topic/li li">当窗口不满 X 分钟时，<em class="+ topic/ph hi-d/i ph i">prevLastPx</em>  取窗口内第一条数据的价格。<ul class="- topic/ul ul"><li class="- topic/li li">比如 10 分钟涨幅，假设 09:30:00 时，只有 09:25:00~09:30:00 的数据，没有前 10 分钟的 09:20:00 的数据，也没有 10 分钟前的临近时间的数据，则 <em class="+ topic/ph hi-d/i ph i">prevLastPx</em> 为窗口第一条数据，即 09:25:00 的 <em class="+ topic/ph hi-d/i ph i">lastPx</em>。</li></ul></li><li class="- topic/li li">09:30:00 以后开始输出计算结果</li><li class="- topic/li li">上游过滤数据，只计算上交所主板 A 股（股票代码 60 开头）09:25:00 以后的股票涨幅（09:25:00 以后 <em class="+ topic/ph hi-d/i ph i">lastPx</em> 不为 0）</li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="13-实时计算方案"><h3 class="- topic/title title topictitle3" id="ariaid-title5">1.3. 实时计算方案</h3><div class="- topic/body body"><p class="- topic/p p">本教程通过 <code class="+ topic/ph pr-d/codeph ph codeph">createReactiveStateEngine</code> 函数创建响应式状态引擎实时计算股票涨幅，通过 <code class="+ topic/ph pr-d/codeph ph codeph">createCrossSectionalEngine</code> 函数创建横截面引擎对股票截面上的涨幅进行排序生成涨幅榜。</p><p class="- topic/p p">本教程实现的处理流程如下图所示：</p><img class="- topic/image image" src="../stream/images/stk_price_inc_1.png"/><br/><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">处理流程图说明：</strong></p><ul class="- topic/ul ul"><li class="- topic/li li">实时数据：为了测试方便，本教程选择从数据库内取出某一天的快照数据，通过 <code class="+ topic/ph pr-d/codeph ph codeph">replay</code>  函数指定速率回放，以此模拟实时数据。</li><li class="- topic/li li">snapshotStreamTable 是 DolphinDB 中的流数据表，用于接收实时数据源的数据并发布给流计算引擎进行实时计算。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">subscribeTable</code> 订阅流数据表，将 snapshotStreamTable 中的增量数据根据股票代码 SecurityID 过滤出沪市主板 A 股的数据，并添加到流计算引擎中计算涨幅。</li><li class="- topic/li li">响应式状态引擎结合内置的 <code class="+ topic/ph pr-d/codeph ph codeph">tmfirst</code>, <code class="+ topic/ph pr-d/codeph ph codeph">tmove</code> 函数实时计算涨幅。</li><li class="- topic/li li">横截面引擎结合内置的 <code class="+ topic/ph pr-d/codeph ph codeph">rank</code> 函数实时计算排名。</li><li class="- topic/li li">计算结果表是 DolphinDB 中的共享键值表，用于维护涨幅榜的截面，其数据可以被外部消费者消费。</li><li class="- topic/li li">Grafana 查询引擎输出的计算结果，以实现动态展示涨幅榜的效果。</li></ul></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title6" id="2-代码开发"><h2 class="- topic/title title topictitle2" id="ariaid-title6">2. 代码开发</h2><div class="- topic/body body"><p class="- topic/p p">本教程代码开发工具采用 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/db_distr_comp/gui.html" target="_blank" rel="external noopener">DolphinDB GUI</a>，所有代码均可在 DolphinDB GUI 客户端开发工具执行。</p></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title7" id="21-创建存储历史数据的库表"><h3 class="- topic/title title topictitle3" id="ariaid-title7">2.1. 创建存储历史数据的库表</h3><div class="- topic/body body"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def createDfsTb(dbName, tbName){
	//create database
	if(existsDatabase(dbName)){
		dropDatabase(dbName)
	}
	db1 = database(, VALUE, 2020.01.01..2021.01.01)
	db2 = database(, HASH, [SYMBOL, 30])
	db = database(dbName, COMPO, [db1, db2], , "TSDB")
	//create table
	schemaTable = table(
		array(SYMBOL, 0) as SecurityID,
		array(TIMESTAMP, 0) as DateTime,
		array(DOUBLE, 0) as PreClosePx,
		array(DOUBLE, 0) as OpenPx,
		array(DOUBLE, 0) as HighPx,
		array(DOUBLE, 0) as LowPx,
		array(DOUBLE, 0) as LastPx,
		array(INT, 0) as TotalVolumeTrade,
		array(DOUBLE, 0) as TotalValueTrade,
		array(SYMBOL, 0) as InstrumentStatus,
		array(DOUBLE[], 0) as BidPrice,
		array(INT[], 0) as BidOrderQty,
		array(INT[], 0) as BidNumOrders,
		array(INT[], 0) as BidOrders,
		array(DOUBLE[], 0) as OfferPrice,
		array(INT[], 0) as OfferOrderQty,
		array(INT[], 0) as OfferNumOrders,
		array(INT[], 0) as OfferOrders,
		array(INT, 0) as NumTrades,
		array(DOUBLE, 0) as IOPV,
		array(INT, 0) as TotalBidQty,
		array(INT, 0) as TotalOfferQty,
		array(DOUBLE, 0) as WeightedAvgBidPx,
		array(DOUBLE, 0) as WeightedAvgOfferPx,
		array(INT, 0) as TotalBidNumber,
		array(INT, 0) as TotalOfferNumber,
		array(INT, 0) as BidTradeMaxDuration,
		array(INT, 0) as OfferTradeMaxDuration,
		array(INT, 0) as NumBidOrders,
		array(INT, 0) as NumOfferOrders,
		array(INT, 0) as WithdrawBuyNumber,
		array(INT, 0) as WithdrawBuyAmount,
		array(DOUBLE, 0) as WithdrawBuyMoney,
		array(INT, 0) as WithdrawSellNumber,
		array(INT, 0) as WithdrawSellAmount,
		array(DOUBLE, 0) as WithdrawSellMoney,
		array(INT, 0) as ETFBuyNumber,
		array(INT, 0) as ETFBuyAmount,
		array(DOUBLE, 0) as ETFBuyMoney,
		array(INT, 0) as ETFSellNumber,
		array(INT, 0) as ETFSellAmount,
		array(DOUBLE, 0) as ETFSellMoney
	)
	db.createPartitionedTable(table=schemaTable, tableName=tbName, partitionColumns=`DateTime`SecurityID, compressMethods={DateTime:"delta"}, sortColumns=`SecurityID`DateTime, keepDuplicates=ALL)
}

dbName, tbName = "dfs://snapshot", "snapshot"
createDfsTb(dbName, tbName)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">分区原则：建议落在 1 个最小分区的数据在内存的大小约 150MB~500MB。<ul class="- topic/ul ul"><li class="- topic/li li">比如：上交所 2021 年 12 月 01 日的股票快照数据为 7873799 行 194 列，加载到内存的大小约 7.3 GB。所以采用组合分区的方法，第一层按天分区，第二层对股票代码按 HASH 分 30 个分区，每个分区的全部数据加载到内存后约占用 249MB 内存空间。</li></ul></li><li class="- topic/li li">创建数据库时，选择 DolphinDB 的  TSDB 存储引擎进行数据的存储。</li><li class="- topic/li li">创建数据表时，按照分区方法，指定 <code class="+ topic/ph pr-d/codeph ph codeph">DateTime</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">SecurityID</code> 为分区字段。在对大数据集查询时，必须指定 <code class="+ topic/ph pr-d/codeph ph codeph">DateTime</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">SecurityID</code> 的过滤条件，可以起到分区剪枝的作用。</li><li class="- topic/li li">DolphinDB 默认数据存储的压缩算法为 lz4，对于时间、日期类型的数据，建议指定采用 Delta（delta-of-delta encoding） 压缩算法存储，提高存储的压缩比。</li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title8" id="22-导入上交所历史快照数据"><h3 class="- topic/title title topictitle3" id="ariaid-title8">2.2. 导入上交所历史快照数据</h3><div class="- topic/body body"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def transform(t){
	temp = select lpad(string(SecurityID), 6, "0") as SecurityID, DateTime, PreClosePx, OpenPx, HighPx, LowPx, LastPx, TotalVolumeTrade, TotalValueTrade, InstrumentStatus,
			fixedLengthArrayVector(BidPrice0, BidPrice1, BidPrice2, BidPrice3,  BidPrice4, BidPrice5, BidPrice6, BidPrice7, BidPrice8, BidPrice9) as BidPrice,
			fixedLengthArrayVector(BidOrderQty0, BidOrderQty1, BidOrderQty2, BidOrderQty3,  BidOrderQty4, BidOrderQty5, BidOrderQty6, BidOrderQty7, BidOrderQty8, BidOrderQty9) as BidOrderQty,
			fixedLengthArrayVector(BidNumOrders0, BidNumOrders1, BidNumOrders2, BidNumOrders3,  BidNumOrders4, BidNumOrders5, BidNumOrders6, BidNumOrders7, BidNumOrders8, BidNumOrders9) as BidNumOrders,
			fixedLengthArrayVector(BidOrders0, BidOrders1, BidOrders2, BidOrders3,  BidOrders4, BidOrders5, BidOrders6, BidOrders7, BidOrders8, BidOrders9, BidOrders10, BidOrders11, BidOrders12, BidOrders13,  BidOrders14, BidOrders15, BidOrders16, BidOrders17, BidOrders18, BidOrders19, BidOrders20, BidOrders21, BidOrders22, BidOrders23,  BidOrders24, BidOrders25, BidOrders26, BidOrders27, BidOrders28, BidOrders29, BidOrders30, BidOrders31, BidOrders32, BidOrders33,  BidOrders34, BidOrders35, BidOrders36, BidOrders37, BidOrders38, BidOrders39, BidOrders40, BidOrders41, BidOrders42, BidOrders43,  BidOrders44, BidOrders45, BidOrders46, BidOrders47, BidOrders48, BidOrders49) as BidOrders,
			fixedLengthArrayVector(OfferPrice0, OfferPrice1, OfferPrice2, OfferPrice3,  OfferPrice4, OfferPrice5, OfferPrice6, OfferPrice7, OfferPrice8, OfferPrice9) as OfferPrice,
			fixedLengthArrayVector(OfferOrderQty0, OfferOrderQty1, OfferOrderQty2, OfferOrderQty3,  OfferOrderQty4, OfferOrderQty5, OfferOrderQty6, OfferOrderQty7, OfferOrderQty8, OfferOrderQty9) as OfferOrderQty,
			fixedLengthArrayVector(OfferNumOrders0, OfferNumOrders1, OfferNumOrders2, OfferNumOrders3,  OfferNumOrders4, OfferNumOrders5, OfferNumOrders6, OfferNumOrders7, OfferNumOrders8, OfferNumOrders9) as OfferNumOrders,
			fixedLengthArrayVector(OfferOrders0, OfferOrders1, OfferOrders2, OfferOrders3,  OfferOrders4, OfferOrders5, OfferOrders6, OfferOrders7, OfferOrders8, OfferOrders9, OfferOrders10, OfferOrders11, OfferOrders12, OfferOrders13,  OfferOrders14, OfferOrders15, OfferOrders16, OfferOrders17, OfferOrders18, OfferOrders19, OfferOrders20, OfferOrders21, OfferOrders22, OfferOrders23,  OfferOrders24, OfferOrders25, OfferOrders26, OfferOrders27, OfferOrders28, OfferOrders29, OfferOrders30, OfferOrders31, OfferOrders32, OfferOrders33,  OfferOrders34, OfferOrders35, OfferOrders36, OfferOrders37, OfferOrders38, OfferOrders39, OfferOrders40, OfferOrders41, OfferOrders42, OfferOrders43,  OfferOrders44, OfferOrders45, OfferOrders46, OfferOrders47, OfferOrders48, OfferOrders49) as OfferOrders,
			NumTrades, IOPV, TotalBidQty, TotalOfferQty, WeightedAvgBidPx, WeightedAvgOfferPx, TotalBidNumber, TotalOfferNumber, BidTradeMaxDuration, OfferTradeMaxDuration, 
			NumBidOrders, NumOfferOrders, WithdrawBuyNumber, WithdrawBuyAmount, WithdrawBuyMoney,WithdrawSellNumber, WithdrawSellAmount, WithdrawSellMoney, ETFBuyNumber, ETFBuyAmount, 
			ETFBuyMoney, ETFSellNumber, ETFSellAmount, ETFSellMoney
			from t
	return temp
}

csvDataPath = "/home/v2/下载/data/20211201snapshot_30stocks.csv"
loadTextEx(dbHandle=database(dbName), tableName=tbName, partitionColumns=`DateTime`SecurityID, filename=csvDataPath, transform=transform)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">测试只使用了 2021 年 12 月 01 日上交所 30 只股票 10:30:00 前的数据，共 32972 条数据，内存占用约 30 M</li><li class="- topic/li li">历史数据对象为 csv 文本数据，磁盘空间占用  23 MB</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">loadTextEx</code> 函数可以直接将数据文件加载到数据库中。其中系统会对数据文件中的数据执行 transform 参数指定的函数，再将得到的结果保存到数据库中，本教程中将 csv 中的十档量价数据转化为了 array vector 进行存储</li></ul><p class="- topic/p p">数据导入完成后，可以执行以下查询语句确认数据是否导入成功：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select count(*) from loadTable(dbName, tbName) group by date(DateTime) as TradeDate</code></pre><p class="- topic/p p">执行完后，返回如下信息，说明数据成功导入：</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="22-导入上交所历史快照数据__entry__1">TradeDate</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="22-导入上交所历史快照数据__entry__2">count</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-导入上交所历史快照数据__entry__1">2021.12.01</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-导入上交所历史快照数据__entry__2">32,972</td></tr></tbody></table></div></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title9" id="23-清理环境并创建相关流数据表"><h3 class="- topic/title title topictitle3" id="ariaid-title9">2.3. 清理环境并创建相关流数据表</h3><div class="- topic/body body"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>use ops

// clean up environment
def cleanEnvironment(){
	cancelJobEx()
	try{ unsubscribeTable(tableName=`snapshotStreamTable, actionName="snapshotFilter") } catch(ex){ print(ex) }
	try{ dropStreamEngine("calChange")} catch(ex){ print(ex) }
	try{ dropStreamEngine("crossSectionalEngine") } catch(ex){ print(ex) }
	try{ undef("snapshotStreamTable", SHARED) } catch(ex){ print(ex) }
	try{ undef("changeCrossSectionalTable", SHARED) } catch(ex){ print(ex) }
}

// create stream table
def createStreamTable(dbName, tbName){
	schemaTB = loadTable(dbName, tbName).schema().colDefs
	share(streamTable(40000:0, schemaTB.name, schemaTB.typeString), `snapshotStreamTable)
	share(keyedTable(`SecurityID, 50:0, `DateTime`SecurityID`factor_1min`rank_1min`factor_5min`rank_5min`factor_10min`rank_10min, [TIMESTAMP, SYMBOL, DOUBLE,  INT, DOUBLE, INT, DOUBLE, INT]), `changeCrossSectionalTable)
}

cleanEnvironment()
dbName, tbName = "dfs://snapshot", "snapshot"
createStreamTable(dbName, tbName)</code></pre><p class="- topic/p p">根据“实时计算方案”章节的流程图，可以看出需要清理的有：正在进行的回放任务、一个订阅（subscribeTable）、两个引擎（响应式状态引擎和横截面引擎）、两张共享表（输入输出表）。</p><p class="- topic/p p">需要创建的表有：一张共享流数据表（和数据库 dbName 中名为 tbName 的分布式表结构相同，用于接收实时数据）、一张共享键值表（用于维护股票涨幅排名的截面数据）。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title10" id="24-注册流计算引擎和订阅流数据表"><h3 class="- topic/title title topictitle3" id="ariaid-title10">2.4. 注册流计算引擎和订阅流数据表</h3><div class="- topic/body body"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">（1）订阅流表</strong> snapshotStreamTable，过滤出沪市主板 A 股 09:25:00 以后的数据</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def snapshotFilter(engineName, mutable data){
	t = select * from data where left(SecurityID, 2)="60" and time(DateTime)&gt;=09:25:00.000
	getStreamEngine(engineName).append!(t)
}

subscribeTable(tableName="snapshotStreamTable", actionName="snapshotFilter", offset=-1, handler=snapshotFilter{"calChange"}, msgAsTable=true, hash=0)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">参数 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 和 <em class="+ topic/ph hi-d/i ph i">throttle</em> 能指定触发 handler 的规则。<em class="+ topic/ph hi-d/i ph i">batchSize</em> 未指定或为非正数，则每一批次的消息都会触发 <em class="+ topic/ph hi-d/i ph i">handler</em> 处理增量数据；否则未处理的数据需要积攒到 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 条时，<em class="+ topic/ph hi-d/i ph i">handler</em> 才会统一处理消息。如果 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 条件一直未达到，那么继上次处理消息的 <em class="+ topic/ph hi-d/i ph i">throttle</em> 秒之后也会触发 <em class="+ topic/ph hi-d/i ph i">handler</em> 处理消息。</li><li class="- topic/li li">本教程代码没有指定 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 和 <em class="+ topic/ph hi-d/i ph i">throttle</em> 是因为示例数据的数据量比较小，共 30 只上交股票，其中主板 A 股只有 26 只。所以每批数据触发一次 <em class="+ topic/ph hi-d/i ph i">handler</em> 处理也不会产生计算压力。</li><li class="- topic/li li">当接入实时数据之后，可以用 <code class="+ topic/ph pr-d/codeph ph codeph">getStreamingStat().subWorkers</code> 观察订阅状态，如果发现 <em class="+ topic/ph hi-d/i ph i">queueDepth</em> 一直增加，表示订阅队列产生堵塞。此时可以考虑配置并调整 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 和 <em class="+ topic/ph hi-d/i ph i">throttle</em> 参数。</li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">（2）注册响应式状态引擎</strong> calChange，计算涨幅</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>@state
def calculateChange(DateTime, LastPx, lag){
	windowFirstPx = tmfirst(DateTime, LastPx, lag)
	preMinutePx = tmove(DateTime, LastPx, lag)
	prevLastPx = iif(preMinutePx == NULL, windowFirstPx, preMinutePx)
	return 100 * (LastPx - prevLastPx) \ prevLastPx
}

createReactiveStateEngine(name="calChange", metrics=&lt;[DateTime, calculateChange(DateTime, LastPx, lag=1m), calculateChange(DateTime, LastPx, lag=5m), calculateChange(DateTime, LastPx, lag=10m)]&gt;, dummyTable=objByName("snapshotStreamTable"), outputTable=getStreamEngine("crossSectionalEngine"), keyColumn=`SecurityID, filter=&lt;time(DateTime) &gt;= 09:30:00.000&gt;)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">@state 用于标识状态函数，表示在响应式状态引擎中需要访问灌入引擎的历史数据。其中 <code class="+ topic/ph pr-d/codeph ph codeph">tmfirst</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">tmove</code> 是涉及状态的函数。</li><li class="- topic/li li">采用了引擎串联，即响应式状态引擎的输出直接输入下一个横截面引擎。因为 <code class="+ topic/ph pr-d/codeph ph codeph">outputTable=getStreamEngine("crossSectionalEngine")</code>，所以需要先执行下面 (3) 的代码创建横截面引擎后，才能顺利执行上述代码创建响应式状态引擎</li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">（3）注册响应式状态引擎</strong> crossSectionalEngine，计算排名</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>schemaTB = table(1:0, `SecurityID`DateTime`factor_1min`factor_5min`factor_10min, [SYMBOL, TIMESTAMP, DOUBLE, DOUBLE, DOUBLE])
createCrossSectionalEngine(name="crossSectionalEngine", metrics=&lt;[SecurityID, factor_1min, rank(factor_1min, ascending=false), factor_5min, rank(factor_5min, ascending=false), factor_10min, rank(factor_10min, ascending=false)]&gt;, dummyTable=schemaTB, outputTable=objByName("changeCrossSectionalTable"), keyColumn=`SecurityID, triggeringPattern='perBatch', useSystemTime=false, timeColumn=`DateTime)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">schemaTB 是横截面引擎的输入表结构（对应响应式状态引擎的输出表结构）。参数 <em class="+ topic/ph hi-d/i ph i">dummyTable</em> 只是为了指定输入表结构，和表里是否有数据无关。</li><li class="- topic/li li">横截面引擎支持多种触发计算的规则，包括<ul class="- topic/ul ul"><li class="- topic/li li">“perBatch”每插入一批数据触发一次计算</li><li class="- topic/li li">“perRow”每一行数据都会触发一次计算</li><li class="- topic/li li">“interval” （根据系统时间）每隔 <em class="+ topic/ph hi-d/i ph i">triggeringInterval</em> 的时间，引擎内若存在未计算数据，触发一次计算</li><li class="- topic/li li">“keyCount”当前时间戳记录数达到 <em class="+ topic/ph hi-d/i ph i">triggeringInterval</em>，或有更新时间戳的数据到达时，触发一次计算</li></ul></li><li class="- topic/li li">本例中，触发计算的规则采取的是 <code class="+ topic/ph pr-d/codeph ph codeph">triggeringPattern='perBatch'</code>，即每插入一次数据触发一次对截面的排名统计。</li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title11" id="25-grafana-实时展示涨幅榜"><h3 class="- topic/title title topictitle3" id="ariaid-title11">2.5. Grafana 实时展示涨幅榜</h3><div class="- topic/body body"><p class="- topic/p p">Grafana 配置 DolphinDB 数据源及监控 DolphinDB 数据表中数据的教程：<a class="- topic/xref xref" href="../tools/grafana.html">Grafana 连接 DolphinDB 数据源</a></p><p class="- topic/p p">本教程监控 1 分钟、5 分钟、10 分钟的涨幅榜。</p><p class="- topic/p p">Grafana 中的 Query 代码：</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">1 min 涨幅榜</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select SecurityID, DateTime, factor_1min from changeCrossSectionalTable order by rank_1min</code></pre></li><li class="- topic/li li"><p class="- topic/p p">5 min 涨幅榜</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select SecurityID, DateTime, factor_5min from changeCrossSectionalTable order by rank_5min</code></pre></li><li class="- topic/li li"><p class="- topic/p p">10 min 涨幅榜</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select SecurityID, DateTime, factor_10min from changeCrossSectionalTable order by rank_10min</code></pre></li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title12" id="26-历史数据回放"><h3 class="- topic/title title topictitle3" id="ariaid-title12">2.6. 历史数据回放</h3><div class="- topic/body body"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>t = select * from loadTable("dfs://snapshot", "snapshot") where date(DateTime)=2021.12.01 order by DateTime
submitJob("replay_snapshot", "snapshot",  replay{t, snapshotStreamTable, `DateTime, `DateTime, 1000, true, 1})
getRecentJobs()</code></pre><p class="- topic/p p">执行完后，返回如下信息：</p><img class="- topic/image image" src="images/Real-Time_Stock_Price_Increase_Calculation/2_1.png"/><br/><p class="- topic/p p">如果 endTime 和 errorMsg 为空，说明任务正在正常运行中。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title13" id="3-结果展示"><h2 class="- topic/title title topictitle2" id="ariaid-title13">3. 结果展示</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title14" id="31-节点内的计算结果表"><h3 class="- topic/title title topictitle3" id="ariaid-title14">3.1. 节点内的计算结果表</h3><div class="- topic/body body"><p class="- topic/p p">计算结果表 <code class="+ topic/ph pr-d/codeph ph codeph">changeCrossSectionalTable</code>，可以通过 DolphinDB 所有 API 查询接口实时查询。</p><p class="- topic/p p">下图是通过 DolphinDB GUI 实时查看该表的结果：</p><img class="- topic/image image" src="images/Real-Time_Stock_Price_Increase_Calculation/3_1.png"/><br/></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title15" id="32-grafana-实时监控结果"><h3 class="- topic/title title topictitle3" id="ariaid-title15">3.2. Grafana 实时监控结果</h3><div class="- topic/body body"><img class="- topic/image image" src="images/Real-Time_Stock_Price_Increase_Calculation/3_2.png"/><br/></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title16" id="4-性能测试"><h2 class="- topic/title title topictitle2" id="ariaid-title16">4. 性能测试</h2><div class="- topic/body body"><p class="- topic/p p">本教程测试了单次响应计算和连续响应计算两种场景。测试数据为 2021 年某天的上交所主板 A 股 1650 只股票的数据。</p></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title17" id="41-单次响应计算性能测试"><h3 class="- topic/title title topictitle3" id="ariaid-title17">4.1. 单次响应计算性能测试</h3><div class="- topic/body body"><p class="- topic/p p">单次响应计算时间为从第 1 个响应式状态引擎收到输入至第 2 个横截面引擎输出结果所经历的时间。</p><p class="- topic/p p">测试了单只股票响应一次计算（单条数据触发一次计算）和 1650 只股票响应一次计算（一批数据触发一次计算）的性能。统计了 10 次的总耗时，取平均值作为单次的耗时。测试使用的服务器 CPU 为 Intel(R) Xeon(R) Silver 4216 CPU @ 2.10GHz。单线程情况下，测试结果如下：</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="41-单次响应计算性能测试__entry__1">股票个数</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="41-单次响应计算性能测试__entry__2">耗时 (单位:ms)</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="41-单次响应计算性能测试__entry__1">1</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="41-单次响应计算性能测试__entry__2">0.20</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="41-单次响应计算性能测试__entry__1">1650</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="41-单次响应计算性能测试__entry__2">3.45</td></tr></tbody></table></div></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title18" id="42-连续响应计算性能测试"><h3 class="- topic/title title topictitle3" id="ariaid-title18">4.2. 连续响应计算性能测试</h3><div class="- topic/body body"><p class="- topic/p p">以 2021 年某天的上交所主板 A 股 1650 只股票的 658 万条快照数据为测试数据，将所有测试数据全量灌入第 1 个响应式状态引擎触发计算。引擎流水线的计算总耗时是 17 秒，最大处理的能力是 38 万条每秒。</p><p class="- topic/p p">开发者可以增加计算的并行度，提高系统的处理能力。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title19" id="5-总结"><h2 class="- topic/title title topictitle2" id="ariaid-title19">5. 总结</h2><div class="- topic/body body"><p class="- topic/p p">DolphinDB 内置的流数据框架支持流数据的发布，订阅，预处理，实时内存计算，复杂指标的滚动窗口计算、滑动窗口计算、累计窗口计算等，是一个运行高效、使用便捷的流数据处理框架。</p><p class="- topic/p p">本教程基于 DolphinDB 流数据处理框架，提供了一种实时计算涨幅榜的低延时解决方案，旨在提高开发人员在使用 DolphinDB 内置的流数据框架开发流计算业务场景时的开发效率、降低开发难度，更好地挖掘 DolphinDB 在复杂实时流计算场景中的价值。</p></div></article></article><article class="- topic/topic topic nested0" aria-labelledby="ariaid-title20" id="附件"><h1 class="- topic/title title topictitle1" id="ariaid-title20">附件</h1><div class="- topic/body body"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">业务代码</strong></p><p class="- topic/p p"><a class="- topic/xref xref" href="script/Real-Time_Stock_Price_Increase_Calculation/01.%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E5%BF%AB%E7%85%A7%E6%95%B0%E6%8D%AE%E7%9A%84%E5%BA%93%E8%A1%A8%E5%B9%B6%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.txt">01.创建存储快照数据的库表并导入数据.txt</a></p><p class="- topic/p p"><a class="- topic/xref xref" href="script/Real-Time_Stock_Price_Increase_Calculation/02.%E6%B8%85%E7%90%86%E7%8E%AF%E5%A2%83%E5%B9%B6%E5%88%9B%E5%BB%BA%E7%9B%B8%E5%85%B3%E6%B5%81%E6%95%B0%E6%8D%AE%E8%A1%A8.txt">02.清理环境并创建相关流数据表.txt</a></p><p class="- topic/p p"><a class="- topic/xref xref" href="script/Real-Time_Stock_Price_Increase_Calculation/03.%E6%B3%A8%E5%86%8C%E6%B5%81%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8E%E5%92%8C%E8%AE%A2%E9%98%85%E6%B5%81%E6%95%B0%E6%8D%AE%E8%A1%A8.txt">03.注册流计算引擎和订阅流数据表.txt</a></p><p class="- topic/p p"><a class="- topic/xref xref" href="script/Real-Time_Stock_Price_Increase_Calculation/04.%E5%8E%86%E5%8F%B2%E6%95%B0%E6%8D%AE%E5%9B%9E%E6%94%BE.txt">04.历史数据回放.txt</a></p><p class="- topic/p p"><a class="- topic/xref xref" href="script/Real-Time_Stock_Price_Increase_Calculation/05.%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95.txt">05.性能测试.txt</a></p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">示例数据</strong></p><p class="- topic/p p"><a class="- topic/xref xref" href="data/Real-Time_Stock_Price_Increase_Calculation/20211201snapshot_30stocks.zip">20211201snapshot_30stocks.zip</a></p></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E6%8F%8F%E8%BF%B0" data-tocid="1-应用场景描述">1. 应用场景描述</a><ul><li class="topic-item"><a href="#11-%E6%95%B0%E6%8D%AE%E6%BA%90" data-tocid="11-数据源">1.1. 数据源</a></li><li class="topic-item"><a href="#12-%E8%AE%A1%E7%AE%97%E6%8C%87%E6%A0%87" data-tocid="12-计算指标">1.2. 计算指标</a></li><li class="topic-item"><a href="#13-%E5%AE%9E%E6%97%B6%E8%AE%A1%E7%AE%97%E6%96%B9%E6%A1%88" data-tocid="13-实时计算方案">1.3. 实时计算方案</a></li></ul></li><li class="topic-item"><a href="#2-%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91" data-tocid="2-代码开发">2. 代码开发</a><ul><li class="topic-item"><a href="#21-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E5%8E%86%E5%8F%B2%E6%95%B0%E6%8D%AE%E7%9A%84%E5%BA%93%E8%A1%A8" data-tocid="21-创建存储历史数据的库表">2.1. 创建存储历史数据的库表</a></li><li class="topic-item"><a href="#22-%E5%AF%BC%E5%85%A5%E4%B8%8A%E4%BA%A4%E6%89%80%E5%8E%86%E5%8F%B2%E5%BF%AB%E7%85%A7%E6%95%B0%E6%8D%AE" data-tocid="22-导入上交所历史快照数据">2.2. 导入上交所历史快照数据</a></li><li class="topic-item"><a href="#23-%E6%B8%85%E7%90%86%E7%8E%AF%E5%A2%83%E5%B9%B6%E5%88%9B%E5%BB%BA%E7%9B%B8%E5%85%B3%E6%B5%81%E6%95%B0%E6%8D%AE%E8%A1%A8" data-tocid="23-清理环境并创建相关流数据表">2.3. 清理环境并创建相关流数据表</a></li><li class="topic-item"><a href="#24-%E6%B3%A8%E5%86%8C%E6%B5%81%E8%AE%A1%E7%AE%97%E5%BC%95%E6%93%8E%E5%92%8C%E8%AE%A2%E9%98%85%E6%B5%81%E6%95%B0%E6%8D%AE%E8%A1%A8" data-tocid="24-注册流计算引擎和订阅流数据表">2.4. 注册流计算引擎和订阅流数据表</a></li><li class="topic-item"><a href="#25-grafana-%E5%AE%9E%E6%97%B6%E5%B1%95%E7%A4%BA%E6%B6%A8%E5%B9%85%E6%A6%9C" data-tocid="25-grafana-实时展示涨幅榜">2.5. Grafana 实时展示涨幅榜</a></li><li class="topic-item"><a href="#26-%E5%8E%86%E5%8F%B2%E6%95%B0%E6%8D%AE%E5%9B%9E%E6%94%BE" data-tocid="26-历史数据回放">2.6. 历史数据回放</a></li></ul></li><li class="topic-item"><a href="#3-%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA" data-tocid="3-结果展示">3. 结果展示</a><ul><li class="topic-item"><a href="#31-%E8%8A%82%E7%82%B9%E5%86%85%E7%9A%84%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C%E8%A1%A8" data-tocid="31-节点内的计算结果表">3.1. 节点内的计算结果表</a></li><li class="topic-item"><a href="#32-grafana-%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7%E7%BB%93%E6%9E%9C" data-tocid="32-grafana-实时监控结果">3.2. Grafana 实时监控结果</a></li></ul></li><li class="topic-item"><a href="#4-%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="4-性能测试">4. 性能测试</a><ul><li class="topic-item"><a href="#41-%E5%8D%95%E6%AC%A1%E5%93%8D%E5%BA%94%E8%AE%A1%E7%AE%97%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="41-单次响应计算性能测试">4.1. 单次响应计算性能测试</a></li><li class="topic-item"><a href="#42-%E8%BF%9E%E7%BB%AD%E5%93%8D%E5%BA%94%E8%AE%A1%E7%AE%97%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="42-连续响应计算性能测试">4.2. 连续响应计算性能测试</a></li></ul></li><li class="topic-item"><a href="#5-%E6%80%BB%E7%BB%93" data-tocid="5-总结">5. 总结</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>