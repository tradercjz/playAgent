<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="随着数字化转型的浪潮兴起，越来越多企业认识到工业物联网在提升工业生产安全性和效率方面的关键作用。然而，随着设备规模的扩大和工艺复杂性的提升，智能化运维监管成为工业企业急需解决的重要挑战。 ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="助力工业物联网实现智能运维"/><title>助力工业物联网实现智能运维</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;助力工业物联网实现智能运维&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;助力工业物联网实现智能运维&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;随着数字化转型的浪潮兴起，越来越多企业认识到工业物联网在提升工业生产安全性和效率方面的关键作用。然而，随着设备规模的扩大和工艺复杂性的提升，智能化运维监管成为工业企业急需解决的重要挑战。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;智能运维是一种利用先进技术和数据分析方法来提高生产设备和工艺系统可靠性、安全性与效率的方法。它结合了物联网、人工智能和大数据分析等技术，通过实时监测、故障预测、优化维护计划和自动化操作等手段，帮助企业实现设备故障的及时诊断和修复，降低生产停机时间，并提升设备利用率和生产质量。智能运维不仅可以减少人为错误和人力成本，还可以提高生产过程的可持续性和环境友好性，对提升企业竞争力和促进可持续发展具有重要意义。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 是由浙江智臾科技有限公司研发的一款高性能分布式时序数据库，能够完美解决智能运维领域面临的大数据量和实时性要求高的问题。DolphinDB 不仅支持数据的存储，还具备强大的数据处理和分析能力。它集成了功能强大的编程语言和高容量高速度的流数据分析系统，为智能运维提供了轻量级、一站式的解决方案，而无需复杂的系统架构。&lt;/p&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:159;202:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-智能运维面临的挑战&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;1 智能运维面临的挑战&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;11:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;智能运维面临着几个关键挑战：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;13:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;设备异构性&lt;/b&gt;：一个大型工业平台系统通常包含众多不同类型、不同品牌的设备，这些设备可能使用各种不同的通信协议和数据格式。不同设备数据的接入、管理是一大难题。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;14:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;14:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;数据激增与复杂性&lt;/b&gt;：随着工业设备和系统的智能化程度提高，产生的数据规模急剧增加。这些数据不仅在数量上巨大，而且包含了更多的复杂性和多样性，传统的运维手段难以满足对数据的高效处理和深度分析需求。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;15:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;实时性与准确性要求提升&lt;/b&gt;：众多行业对设备状态、生产过程等实时性要求越来越高，需要实时监测和故障诊断，以确保生产的连续性和可靠性。传统的运维模式可能无法满足对实时性和准确性的双重需求，需要更加智能、高效的运维方式。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-解决方案&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;2 解决方案&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;本文将通过&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;19:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;十二个&lt;/b&gt;典型工业生产的智能运维场景，来验证 DolphinDB 在工业物联网智能运维方面的应用能力：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:1;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:1;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:1;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:2;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:1;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:1;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:1;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;场景&lt;/b&gt;&lt;/entry&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:2;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例&lt;/b&gt;&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:2;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; morerows=&#34;2&#34; xtrc=&#34;entry:3;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;工业智能运维&lt;/entry&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;根据状态指标计算设备累计开停机时长&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:3;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:5;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;根据指定时间段内状态突变次数计算累计开停机次数&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:6;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;根据状态值计算设备最大持续运行时间&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:5;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; morerows=&#34;5&#34; xtrc=&#34;entry:7;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;生产监控&lt;/entry&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:8;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;统计生料磨每小时的汇总产量&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:6;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:9;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;根据可加指标计算变化率&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:7;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:10;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;根据电流计算一段时间内设备的累计空载时间&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:8;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:11;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;计算指定时间段范围内（窗口时间）电机轴承的平均温度&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:9;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:12;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;指标根据表达式的二次计算&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:10;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:13;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;合并汇总计算&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:11;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34; morerows=&#34;2&#34; xtrc=&#34;entry:14;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;实时流计算&lt;/entry&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:15;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;每个整点的平均值相减&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:12;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:16;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;根据状态突变抽取记录&lt;/entry&gt; &lt;/row&gt; &lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:13;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt; &lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;13&#34; xtrc=&#34;entry:17;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;实时检测异常变化率&lt;/entry&gt; &lt;/row&gt; &lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:2;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;0&#34; xtrc=&#34;tgroup:2;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;架构图如下：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Iot_intelligent_O&amp;amp;M/01.png&#34; placement=&#34;break&#34; xtrc=&#34;image:1;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; dita-ot:image-width=&#34;1441&#34; dita-ot:image-height=&#34;778&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:1;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;01&lt;/alt&gt;&lt;/image&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;下文中，我们将详细介绍 DolphinDB 的安装部署、数据准备以及功能的实现过程。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-前期准备&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;3 前期准备&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;31-安装部署&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;3.1 安装部署&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:1;77:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;77:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;下载&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://www.dolphindb.cn/product#downloads&#34; scope=&#34;external&#34; xtrc=&#34;xref:1;77:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;?ditaot usertext?&gt;官网&lt;/xref&gt;社区最新版，建议 2.00.10 或以上版本。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;78:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;解压缩下载的安装包。&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:7;78:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;注意&lt;/b&gt;：Windows 解压路径，不能有空格，避免安装到 Program Files 路径下。参考教程：&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;standalone_server.md&#34; xtrc=&#34;xref:2;78:69&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;单节点部署与升级&lt;/xref&gt;。&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;32-模拟环境&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;80:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;80:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;3.2 模拟环境&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;80:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;82:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;在此案例中，我们需要处理 100 台设备，每台设备有 1000 个测点，采集频率为每 5 分钟 1 次。为了对这些数据进行有效的建模，我们使用了宽表模型，其中包含了 6 个字段，分别为数采时间、设备编号、逻辑位置 ID、物理位置 ID、属性测点编码和测点值。&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:3;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;7&#34; xtrc=&#34;tgroup:3;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:3;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:4;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:5;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:6;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col5&#34; colnum=&#34;5&#34; xtrc=&#34;colspec:7;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col6&#34; colnum=&#34;6&#34; xtrc=&#34;colspec:8;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col7&#34; colnum=&#34;7&#34; xtrc=&#34;colspec:9;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:1;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:14;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:18;84:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:8;84:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;字段名&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:19;84:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:9;84:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;ts&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:20;84:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:10;84:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;deviceCode&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:21;84:40&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:11;84:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;logicalPositionId&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:22;84:64&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:12;84:65&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;physicalPositionId&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:23;84:89&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:13;84:90&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyCode&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:24;84:108&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:14;84:109&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:2;86:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:15;86:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:25;86:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;字段描述&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:26;86:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;数采时间&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:27;86:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;设备编号&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:28;86:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;逻辑位置ID&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:29;86:51&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;物理位置ID&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:30;86:72&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;属性测点编码&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:31;86:85&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;测点值&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:16;87:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:32;87:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;数据类型&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:33;87:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DATETIME&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:34;87:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:35;87:39&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:36;87:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:37;87:88&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:38;87:107&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;INT&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:17;88:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:39;88:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;字节占用&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:40;88:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:41;88:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:42;88:39&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:43;88:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:44;88:88&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:45;88:107&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;90:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;在此案例中，我们需要记录 100 台设备在 10 天内产生的数据，共 2.88 亿条。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 数据库支持多种分区类型，包括范围分区、哈希分区、值分区、列表分区和复合分区。用户可以根据自己的需求选择不同的分区类型。在本案例中，我们选择了值分区。对于 10 天产生的数据，会按照天进行切分，将每天产生的数据放在同一个分区中。这种分区方式能够提高查询效率，使得查询只需要访问特定的分区，而不需要扫描整个数据表。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;94:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;create database &#34;dfs://db_test&#34; partitioned by VALUE([2022.11.01]),engine='TSDB' create table &#34;dfs://db_test&#34;.&#34;collect&#34;( ts DATETIME,//数采时间 deviceCode SYMBOL,//设备编号 logicalPositionId SYMBOL,//逻辑位置ID physicalPositionId SYMBOL,//物理位置ID propertyCode SYMBOL,//属性测点编码 propertyValue INT//测点值 ) partitioned by ts sortColumns=[`deviceCode,`ts]&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;108:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;完成了建表建库后，我们将使用自定义函数模拟 100 台设备在 10 天内产生的 2.88 亿条数据，并将生成的数据写入 DolphinDB 数据库。详细的实现过程请参考文章末尾的完整示例代码。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;4-功能实现&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4 功能实现&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;41-工业智能运维&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4.1 工业智能运维&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;114:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;首先，DolphinDB 可以实现设备的全寿命周期管理。通过设备完整、实时的监测数据，全面掌握设备的异常及故障情况。根据历史数据及设定的条件，系统自动分析设备维修保养的频度，并生成相应的任务单，并定时提醒相关责任人。同时，DolphinDB 能够在线跟踪维修保养的过程，并进行记录与分析评估。通过实现计划性维修及预测性保养，并能够消除大面积盲目定期大修与保养的大量无效人工，从而保障设备的运行效果，并延长设备的寿命。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;116:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;此外，DolphinDB 具备强大的数据挖掘和分析能力，可以帮助企业深度挖掘和分析设备数据，生成丰富多样的统计报表。例如，可以对设备的总能耗、分项能耗进行统计分析，包括按日、周、月、年等任意时间段进行同比、环比和趋势预测。还可以对各区域（考核单元）的能耗总量进行统计，并按时间段的占比和排名进行分析。DolphinDB 还能对重点设备的分项能耗占比和排名进行详尽的分析。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;118:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;最后，实时监测和有效报警是提升运维安全保障能力的关键环节。DolphinDB 可以实时监测设备的运行状态，并配置异常预警报警参数。基于实时监测设备参数变化趋势，DolphinDB 植入了多参数报警算法进行诊断分析，并可对超过预警和报警阈值的设备或参数进行实时报警。报警支持按需订阅，可以通过邮件、手机短信等方式通知相关责任人，并能根据报警信息触发业务工单，及时通知相关维护人员，从而提高设备的安全保障能力。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;120:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 的这些功能，包括计算设备累计开停机时长、开停机次数、最大持续运行时间和实时监控设备状态等，能够为工业智能运维提供强有力的支持，详见以下各例。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-1根据状态指标计算设备累计开停机时长&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;122:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;122:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 1：根据状态指标计算设备累计开停机时长&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;122:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;124:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;设备累计开停机时长是设备全寿命周期管理中的一个常见指标。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;126:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;计算过程中主要涉及两个字段：&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;126:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;126:33&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;ts&lt;/codeph&gt;。其中，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;126:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt; 记录设备的状态，0 表示关机，1 表示开机；&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;126:79&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;ts&lt;/codeph&gt; 是时间戳。计算过程如下：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:2;128:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;128:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;128:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;deltas&lt;/codeph&gt; 函数来计算相邻时间戳之间的差值。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;129:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;129:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;bar(ts,1H)&lt;/codeph&gt; 将时间戳按小时进行划分，将数据分组。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;130:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;根据设备状态 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;130:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt; 对同一小时内的数据进行进一步分组。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;131:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;对同一组内的时间差值求和，从而得到设备的累计开停机时长。&lt;/li&gt;&lt;/ol&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;133:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;通过以上步骤计算得到的数据可以被推送给业务应用，为运维人员了解设备状态并制定维护计划提供帮助。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;135:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 1：根据状态指标计算设备累计开停机时长 dt=select * from pt where deviceCode=&#34;361RP88&#34; and propertyCode=&#34;361RP88002&#34; //处理累计时长 t = select *,deltas(ts) as duration from dt //输出（分钟） select sum(duration)/60 as duration from t group by bar(ts,1H) as bar_ts,deviceCode,logicalPositionId,physicalPositionId,propertyValue&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-2根据指定时间段内状态突变次数计算累计开停机次数&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 2：根据指定时间段内状态突变次数计算累计开停机次数&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;146:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;指定时间段内设备开停机次数的计算过程主要涉及的字段为 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;146:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt;，该字段记录了设备的状态。其中，0 表示关机，1 表示开机。计算过程如下：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:3;148:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;148:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;148:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;deltas&lt;/codeph&gt; 函数计算相邻两个 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;148:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt; 间的差值。可能结果有三种：0、1 和 -1。其中，0 表示状态没有变化，1 表示状态由开机变为关机，-1 表示状态由关机变为开机。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;149:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;统计结果中 1 和 -1 的个数，以获得开停机的次数。这些数据可以进一步推送到业务系统，帮助运维人员了解设备的状态，并制定维护计划。&lt;/li&gt;&lt;/ol&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;151:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 2：根据指定时间段内状态突变次数计算累计开停机次数 t= select *,deltas(propertyValue) from dt where ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59 //输出 select count(*) from t where deltas_propertyValue in (1,-1) group by deviceCode,logicalPositionId,physicalPositionId,bar(ts,1H),deltas_propertyValue&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-3根据状态值计算设备最大持续运行时间&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 3：根据状态值，计算设备最大持续运行时间&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;160:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;设备的最大持续运行时间是设备全寿命周期管理中一个常见的指标。在计算过程中的主要关注字段为设备状态字段 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;160:52&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt;，其中，0 表示设备关机，1 表示设备开机。因此，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;160:92&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt; 的值由 0 变为 1 表示一次开机，由 1 变为 0 表示一次停机。通过计算各状态的持续时长，并进行筛选最大值便可得到设备最大持续运行时间。得益于众多功能强大的内置函数，DolphinDB 只需要三条语句便可实现这个复杂的逻辑过程。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;162:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;在 DolphinDB 中，可以使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;162:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;deltas&lt;/codeph&gt;、&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;162:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;segment&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;162:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;iif&lt;/codeph&gt; 等函数来实现该计算，过程如下：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:4;164:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;164:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;164:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;deltas&lt;/codeph&gt; 函数计算时间戳之间的差值，得到每个时间点与前一个时间点的时间差。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;165:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:17;165:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;segment&lt;/codeph&gt; 函数对数据按设备状态进行分组，将具有相同 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:18;165:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt; 值的数据分为一组。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;166:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:19;166:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;iif&lt;/codeph&gt; 函数对每个数据进行条件判断，在 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:20;166:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;propertyValue&lt;/codeph&gt; 为 1 时返回时间差，否则返回 0。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;167:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:21;167:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;sum&lt;/codeph&gt; 函数求和得到开机状态持续的时长。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;168:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:22;168:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;max&lt;/codeph&gt; 函数筛选出最长的持续时间，即为设备的最大持续运行时间。&lt;/li&gt;&lt;/ol&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Iot_intelligent_O&amp;amp;M/02.png&#34; placement=&#34;break&#34; xtrc=&#34;image:2;170:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; dita-ot:image-width=&#34;590&#34; dita-ot:image-height=&#34;463&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:2;170:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;02&lt;/alt&gt;&lt;/image&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;172:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;segment 函数&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;174:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 3：根据状态值，计算设备最大持续运行时间 //数据准备，累计时间 t = select *,deltas(ts) as duration from dt where ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59 order by ts t=select sum(iif(propertyValue==1, duration, 0)) as duration_running_max,sum(iif(propertyValue==1, 0,duration)) as duration_stop_max from t group by deviceCode,logicalPositionId,physicalPositionId,segment(propertyValue) //输出（分钟） select max(duration_running_max)/60 as duration_running_max,max(duration_stop_max)/60 as duration_stop_max from t group by deviceCode,logicalPositionId,physicalPositionId&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;42-生产监控&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;183:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;183:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4.2 生产监控&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;183:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-4计算生料磨每小时的总产量&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;185:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;185:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 4：计算生料磨每小时的总产量&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;185:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;187:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;在工业场景中，计算单位时间内的产量是一项常见需求。以下以计算生料磨每小时的总产量为例，介绍 DolphinDB 提供的解决方案。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;189:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;通过使用 DolphinDB 中的&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:23;189:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;bar&lt;/codeph&gt;、&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:24;189:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;group by&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:25;189:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;sum&lt;/codeph&gt; 函数，一条语句就能够轻松地完成任务。其中，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:26;189:64&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;bar(ts, 1H)&lt;/codeph&gt; 函数能够将时间戳 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:27;189:87&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;ts&lt;/codeph&gt; 按小时划分，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:28;189:98&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;group by&lt;/codeph&gt; 函数能够对数据进行分组，而 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:29;189:123&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;sum&lt;/codeph&gt; 函数则能够对组内数据进行求和，从而得到每小时的总产量。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;191:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;此外，DolphinDB 还提供了函数视图功能，它类似关系数据库中的存储过程，可以封装复杂的业务逻辑，方便用户调用。&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Iot_intelligent_O&amp;amp;M/03.png&#34; placement=&#34;break&#34; xtrc=&#34;image:3;193:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; dita-ot:image-width=&#34;986&#34; dita-ot:image-height=&#34;590&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:3;193:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;03&lt;/alt&gt;&lt;/image&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;195:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 4：实时计算生料磨每小时的汇总产量 device=&#34;361RP88&#34; //设备编号 point=&#34;361RP88001&#34; //测点编号,记录产量的测点，得到的 propertyValue 表示产量值 pt=loadTable(&#34;dfs://db_test&#34;,`collect) timer t=select deviceCode,logicalPositionId,physicalPositionId,sum(propertyValue) as production_amount_hour,ts from pt where ts between 2022.01.01 00:00:00 : 2022.01.01 02:59:59 and deviceCode=device and propertyCode=point group by bar(ts,1H) as ts,deviceCode,logicalPositionId,physicalPositionId t //自定义函数视图，供应用端调用： def production_amount_hour(device,point,begintime,endtime){ //业务判断，合法性校验 if (datetime(endtime)-datetime(begintime)&amp;gt;24*3600*30){ return(toStdJson([-1,&#34;查询时间不能超过30天&#34;])) } t=select deviceCode,logicalPositionId,physicalPositionId,sum(propertyValue) as production_amount_hour,ts from loadTable(&#34;dfs://db_test&#34;,`collect) where ts between begintime : endtime and deviceCode=device and propertyCode=point group by bar(ts,1H) as ts,deviceCode,logicalPositionId,physicalPositionId return t } //添加函数视图 addFunctionView(production_amount_hour) production_amount_hour(device,point,2022.01.01 00:00:00,2022.03.01 00:00:00) //业务判断 production_amount_hour(device,point,2022.01.01 00:00:00,2022.01.01 23:59:59) //应用端正常查询，并输出结果&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-5根据指定指标计算变化率&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:14;220:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:14;220:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 5：根据指定指标计算变化率&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:14;220:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;222:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;电流是工业物联网中常见的监控指标之一，电流保持平稳状态对设备的正常运行至关重要。电流突变可能会导致电路的短路、过载、电压波动等问题，严重情况下甚至会引发火灾、爆炸等安全事故。因此，实时监测电流变化并进行安全预警具有重要意义。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 能够实时计算电流的变化率，并对超出指定值的数据进行记录和推送信息，形成安全预警，从而预防安全事故的发生。电流突变率的计算表达式为 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:30;224:76&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;（当前电流值 - 前一时刻的电流值）/ 前一时刻的电流值&lt;/codeph&gt;。DolphinDB 可以用一条语句轻松实现获取当前时间的前一时刻的数据。具体实现过程是：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:5;226:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;226:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:31;226:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;deltas&lt;/codeph&gt; 计算当前数据与前一时刻数据的差值。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;227:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;计算获得最终结果数据。&lt;/li&gt;&lt;/ol&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;229:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;对于计算出来的电流突变率，如果超过了指定阈值，DolphinDB 会将其记录下来，并推送给管理人员进行安全预警，从而及时防范安全事故的发生。这种实时监测和预警的方法可以有效地提高设备的安全性和稳定性。&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Iot_intelligent_O&amp;amp;M/04.png&#34; placement=&#34;break&#34; xtrc=&#34;image:4;231:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; dita-ot:image-width=&#34;422&#34; dita-ot:image-height=&#34;291&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:4;231:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;04&lt;/alt&gt;&lt;/image&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;233:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;deltas 函数&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 5：根据可加指标实时计算变化率,超出指定值进行记录 //数据准备 device=&#34;361RP88&#34; //设备编号 point=&#34;361RP88006&#34; //测点编号，记录电流的测点，得到的 propertyValue 表示电流值 t=select * from pt where deviceCode=device and propertyCode=point and ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59 //统计变化率 t = select *,propertyValue-deltas(propertyValue) as propertyValue_before,propertyValue as propertyValue_now from t select ts,deviceCode,logicalPositionId,physicalPositionId,propertyCode,propertyValue_before,propertyValue_now, string(format(abs(propertyValue_now-propertyValue_before)*100.0/propertyValue_before,&#34;0.00&#34;))+&#34;%&#34; as rate from t where abs(propertyValue_now-propertyValue_before)/propertyValue_before&amp;gt;1&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-6根据电流计算一段时间内设备的累计空载时间&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:15;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:15;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 6：根据电流计算一段时间内设备的累计空载时间&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:15;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;248:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;设备空载通常指设备在运行时没有工作负载或负载非常小。例如，一台电动机在没有连接到任何负载或者连接到一个非常小的负载时，它处于空载状态。在这种状态下，设备的运行通常会浪费能源，也可能会对设备造成损坏。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;250:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;电流值小于 60 时，我们可以认为设备处于空载状态。以下是 DolphinDB 实现计算累计空载时间的过程，得到的结果之后可以推送给业务系统进行空载状态预警。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;252:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 6：根据电流计算一段时间内设备的累计空载时间 device=&#34;361RP17&#34; //设备编号 point=&#34;361RP17007&#34; //测点编号，记录电流的测点，得到的 propertyValue 表示电流值 t=select * from pt where deviceCode=device and propertyCode=point and ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59 //统计空载时间 t = select *,deltas(ts) as duration,nullFill(prev(propertyValue),propertyValue) as before from t where deviceCode=device and propertyCode=point and ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59 //输出 select sum(duration)/60 from t where before&amp;lt;=60 group by bar(ts,1H),deviceCode,logicalPositionId,physicalPositionId&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-7计算指定时间段范围内窗口时间电机轴承的平均温度&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:16;263:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:16;263:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 7：计算指定时间段范围内（窗口时间）电机轴承的平均温度&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:16;263:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;265:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;电机轴承的温度是设备正常运行的一个重要指标。为实时监测电机轴承温度并进行安全预警，DolphinDB 使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:32;265:55&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;mavg&lt;/codeph&gt; 函数计算 10 分钟窗口内电机轴承温度的平均值，从而有效地反映电机轴承的运行状态。并且，基于这个平均温度，可以计算出温度突变率，及时发现异常情况 ，并进行相应的安全预警。通过这种实时监测和预警的方法，可以有效地保障设备的安全性和稳定性，提高设备的运行效率和寿命。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;267:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 7：计算指定时间段范围内（窗口时间）电机轴承的平均温度 device=&#34;361RP17&#34; //设备编号 point=&#34;361RP17008&#34; //测点编号，记录电机轴承温度的测点，得到的 propertyValue 表示温度 //输出 select *,mavg(propertyValue,2) from pt where deviceCode=device and propertyCode=point and ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-8指标根据表达式的二次计算&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:17;275:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:17;275:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 8：指标根据表达式的二次计算&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:17;275:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;277:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 支持根据指定规则批量修改表内容，灵活方便。DolphinDB 可以根据指定的规则对表中的数据进行分类和修改。以下是根据温度进行等级划分的规则：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;279:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;279:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;A 等级：温度小于或等于 60&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;280:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;B 等级：温度大于 60 小于 80&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;281:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;C 等级：温度大于或等于 80&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;283:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;根据这个规则，可以对数据进行分类并加上相应的等级标签。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;285:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 采用列式存储方式，可以轻松地实现对指定列的批量修改。与传统的关系数据库如 MySQL 和 PostgreSQL 采用的行式存储不同，DolphinDB 避免了逐个元素赋值的繁琐复杂过程，大大节省了时间。这种灵活、方便的批量修改表内容的功能为数据分析和管理提供了更多的便利和效率。&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Iot_intelligent_O&amp;amp;M/05.jpg&#34; placement=&#34;break&#34; xtrc=&#34;image:5;287:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; dita-ot:image-width=&#34;720&#34; dita-ot:image-height=&#34;181&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:5;287:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;05&lt;/alt&gt;&lt;/image&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;289:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;列式存储和行式存储&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;291:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 8：指标根据表达式的二次计算 device=&#34;361RP17&#34; //设备编号 point=&#34;361RP17009&#34; //测点编号，记录温度的测点，得到的 propertyValue 表示温度 dt=select * from pt where deviceCode=device and propertyCode=point update!(dt,`propertyValue,rand(100,dt.size())) //取值 a=select * from dt where propertyValue &amp;lt;=60 b=select * from dt where propertyValue &amp;gt;60 and propertyValue&amp;lt;80 c=select * from dt where propertyValue &amp;gt;=80 //分类 a.addColumn(`temperature_level,SYMBOL) b.addColumn(`temperature_level,SYMBOL) c.addColumn(`temperature_level,SYMBOL) a[`temperature_level]=&#34;A&#34; b[`temperature_level]=&#34;B&#34; c[`temperature_level]=&#34;C&#34; //合并数据 t=a.append!(b).append!(c) //输出 select * from t order by ts&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-9分组汇总计算条件筛选&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:18;314:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:18;314:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 9：分组汇总计算，条件筛选&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:18;314:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;316:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 可以轻松地支持亿级数据的分组汇总计算和条件筛选，并且能够在毫秒级别响应请求。以下是计算设备 361RP88 在 2022 年 1 月 1 日 23:00:00 之前一小时内平均温度的示例代码：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;318:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 9：分组汇总计算，条件筛选 device=&#34;361RP88&#34; //设备编号 point=&#34;361RP88010&#34; //测点编号，记录温度的测点，得到的 propertyValue 表示温度 //过去一小时数据 now=2022.01.01 23:00:00 dt=select * from pt where ts&amp;gt;=datetime(now)-3600 and ts&amp;lt;now and deviceCode=device and propertyCode=point //输出 select deviceCode,propertyCode,now as max_ts,avg(propertyValue) as hour_avg from dt group by deviceCode,propertyCode&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;43-实时流计算&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:19;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:19;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;4.3 实时流计算&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:19;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;331:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;实时流处理是指对持续增长的动态数据进行实时的收集、清洗、统计和存储，并实时展示处理结果。在智能运维领域，流数据处理需求非常常见。例如，在工业物联网中，设备传感器会持续产生数据，智能运维系统需要实时监控这些数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;333:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 可以在实时数据流计算场景中高效地计算。用户可以通过简单的表达式实现复杂的流计算。DolphinDB 的流式数据处理引擎能够实现低延迟、高吞吐的流式数据分析，并提供了十种不同的引擎以满足不同的计算需求。此外，DolphinDB 数据库支持多种数据终端输出，如共享内存表、流数据表、消息中间件、数据库和 API 等。在计算复杂表达式时，用户还可以通过级联多个流数据引擎来实现复杂的数据流拓扑。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-10每个整点的平均值相减&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:20;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:20;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 10：每个整点的平均值相减&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:20;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;337:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 内置的多种流数据处理引擎支持流数据的发布、订阅、预处理、实时内存计算、复杂指标的滚动窗口计算、实时关联以及异常数据检测。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;339:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;下例展示了如何通过 DolphinDB 实现每个整点平均值的相减，过程如下：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:6;341:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:22;341:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;建立一个时序引擎以计算每个整点内数据平均值。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:23;342:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;用响应式状态引擎计算平均值间的差值。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:24;343:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;输出计算结果到 result 表。&lt;/li&gt;&lt;/ol&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Iot_intelligent_O&amp;amp;M/06.png&#34; placement=&#34;break&#34; xtrc=&#34;image:6;345:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; dita-ot:image-width=&#34;564&#34; dita-ot:image-height=&#34;290&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:6;345:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;06&lt;/alt&gt;&lt;/image&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;347:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 10：每个整点的平均值相减，比如 1~2 点的值减去 0~1 点的值，如此循环。 //步骤说明： //步骤一：用时序引擎，数据按整点规整。 //步骤二：用响应式状态引擎，进行差值计算。 //步骤三：输出到 result 表 //数据写入 share streamTable(1000:0, `ts`deviceCode`logicalPositionId`physicalPositionId`propertyCode`propertyValue, [DATETIME,SYMBOL,SYMBOL,SYMBOL,SYMBOL,DOUBLE]) as inTable //时序引擎的输出表 share streamTable(1000:0, `ts`deviceCode`propertyCode`propertyValue, [DATETIME,SYMBOL,SYMBOL,DOUBLE]) as outTable //时序引擎，实时计算均值指标（窗口 1 h，步长 1 h，每个设备的每个测点为一组进行分组计算） hour = createTimeSeriesEngine(name=&#34;hour&#34;, windowSize=3600, step=3600, metrics=&amp;lt;[avg(propertyValue)]&amp;gt;, dummyTable=inTable, outputTable=outTable, timeColumn=`ts, keyColumn=[`deviceCode,`propertyCode]) subscribeTable(tableName=&#34;inTable&#34;, actionName=&#34;act_hour&#34;, offset=0, handler=append!{hour}, msgAsTable=true, batchSize=50, throttle=1, hash=0) //状态响应引擎，每个相邻整点值相减 share streamTable(1000:0, `deviceCode`propertyCode`ts`sub_propertyValue, [SYMBOL,SYMBOL,DATETIME,DOUBLE]) as result sub_hour = createReactiveStateEngine(name=&#34;sub_hour&#34;, metrics = &amp;lt;[ts,deltas(propertyValue)]&amp;gt;, dummyTable=outTable, outputTable=result, keyColumn=[`deviceCode,`propertyCode]) subscribeTable(tableName=&#34;outTable&#34;, actionName=&#34;act_sub_hour&#34;, offset=0, handler=append!{sub_hour}, msgAsTable=true, batchSize=50, throttle=1, hash=0) //将某个设备的数据写入，启动流式框架 pt = loadTable(&#34;dfs://db_test&#34;, &#34;collect&#34;); select count(*) from pt; t = select * from pt where deviceCode = &#34;361RP00&#34; and propertyCode = &#34;361RP00000&#34; inTable.append!(t); //流数据引擎计算窗口内的平均值 select * from outTable where deviceCode = &#34;361RP00&#34; and propertyCode = &#34;361RP00000&#34;; //sql 查询窗口内的平均值 select format(avg(propertyValue),&#34;0.00&#34;) from t where deviceCode = &#34;361RP00&#34; and propertyCode = &#34;361RP00000&#34; group by datehour(ts)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-11根据状态突变抽取记录实时流计算&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:21;384:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:21;384:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 11：根据状态突变，抽取记录（实时流计算）&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:21;384:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;386:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;下例展示了流数据响应式状态引擎如何检测设备的状态变化，并将测得的开停机记录推送给 Python 端的实现过程。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:12;388:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//案例 11：根据状态突变，抽取记录（实时流计算） //新建流数据表，接收实时写入数据 share streamTable(20000:0,pt.schema().colDefs.name,pt.schema().colDefs.typeString) as mainStream //新建流数据表，保存处理后结果数据 share streamTable(20000:0,`propertyCode`ts`deviceCode`logicalPositionId`physicalPositionId`propertyValue,[SYMBOL,DATETIME,SYMBOL,INT,INT,INT]) as calc_result //使用流数据异常检测引擎，进行数据筛选处理 engine = createReactiveStateEngine(&#34;engine_status&#34;, &amp;lt;[ts,deviceCode,logicalPositionId,physicalPositionId,propertyValue]&amp;gt;, mainStream, calc_result,`propertyCode,&amp;lt;propertyValue!=prev(propertyValue)&amp;gt;) //开启订阅 subscribeTable(tableName=&#34;mainStream&#34;, actionName=&#34;act_subscribe_calculate&#34;, offset=0, handler=append!{engine}, msgAsTable=true, batchSize=10000, throttle=1,hash=1); //使用回放，模拟持续写入流数据表的场景 dt=select * from pt where deviceCode=&#34;361RP17&#34; and propertyCode=&#34;361RP17002&#34; and ts between 2022.01.01 00:00:00:2022.01.01 01:00:00 order by ts update!(dt,`propertyValue,rand(0 1,dt.size())) //批处理调用 replay 函数，后台执行回放 rate=5*60 //回放倍速（每秒播放5分钟的数据，每小时数据12秒执行完毕） submitJob(&#34;replay_output&#34;, &#34;replay_output_stream&#34;, replay, dt ,mainStream, `ts, `ts, rate,false) //推送到应用端。subScribe_result.py，详情可查看 python 对流数据的订阅。 /*** python代码开始 **** from threading import Event import dolphindb as ddb import pandas as pd import numpy as np s = ddb.session() s.enableStreaming(8000) def handler(lst): print(lst) s.subscribe(&#34;127.0.0.1&#34;, 8848, handler, &#34;calc_result&#34;) Event().wait() *** python 代码结束 ****/&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;案例-12实时检测异常值以指标变化率为例&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:22;426:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:22;426:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;案例 12：实时检测异常值，以指标变化率为例&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:22;426:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:43;428:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;为了帮助用户检测异常情况，DolphinDB 提供了流数据异常检测引擎。该引擎可根据指定的异常指标，检测每条记录，将异常的结果输出。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:44;430:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;下例以案例 5 中指标变化率为指标，实时检测指标变化率是否超过阈值，将案例 5 中的事后异常分析转为实时异常检测。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:13;432:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//新建流数据表,接收实时写入数据 share streamTable(20000:0,pt.schema().colDefs.name,pt.schema().colDefs.typeString) as mainStream //新建流数据表，保存异常结果 share streamTable(1000:0, `ts`propertyCode`type`metric, [DATETIME, SYMBOL, INT, STRING]) as anomalyRes // 创建异常检测引擎 detect_rate = createAnomalyDetectionEngine(name=&#34;detect_rate&#34;,metrics=&amp;lt;[abs(propertyValue \ prev(propertyValue)-1)&amp;gt;1]&amp;gt;,dummyTable=mainStream, outputTable=abnormalRes,timeColumn=`ts,keyColumn=`propertyCode) // 订阅实时数据 subscribeTable(tableName=`mainStream,actionName='detect_rate',offset=-1,handler=append!{detect_rate},msgAsTable=true) //使用回放，模拟持续写入流数据表的场景 device=&#34;361RP017&#34; point=&#34;361RP017006&#34; rate=5*60 //回放倍速（每秒播放 5 分钟的数据，每小时数据 12 秒执行完毕） begintime=2022.01.01 00:00:00 //数据开始时间 endtime =2022.01.01 02:00:00 //数据结束时间 dt=select * from pt where deviceCode=device and propertyCode=point and ts between begintime:endtime order by ts submitJob(&#34;replay_output&#34;, &#34;replay_output_stream&#34;, replay, dt ,mainStream, `ts, `ts, rate,false) select * from abnormalRes &lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;5-可视化运维与告警&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:23;457:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:23;457:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;5 可视化运维与告警&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:23;457:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;51-运维指标可视化&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:24;459:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:24;459:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;5.1 运维指标可视化&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:24;459:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:45;461:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 开发了 Grafana 数据源插件 (dolphindb-datasource)，让用户在 Grafana 面板 (dashboard) 上通过编写查询脚本、订阅流数据表的方式，与 DolphinDB 进行交互 (基于 WebSocket)，实现 DolphinDB 时序数据的可视化。dolphindb-datasource 的安装使用请参考：&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;../tools/grafana.md&#34; xtrc=&#34;xref:3;461:184&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;Grafana 数据源连接器&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:46;463:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;完成上述部署安装后，即可使用 Grafana 可视化运维指标，本节以案例 4 监控每小时的总产量为例。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:47;465:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;如下图所示，将案例 4 中的计算脚本输入 Grafana 即可将查询结果以图表形式输出。&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/Iot_intelligent_O&amp;amp;M/07.png&#34; placement=&#34;break&#34; xtrc=&#34;image:7;467:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; dita-ot:image-width=&#34;1451&#34; dita-ot:image-height=&#34;817&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:7;467:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;07&lt;/alt&gt;&lt;/image&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:48;469:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;上述查询中，每个 panel 只能监控一个设备的总产量，如果需要监控所有设备的总产量，可将查询语句改为以下查询：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:14;471:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;t = select sum(propertyValue) as production_amount_hour from pt where date(ts)=2022.01.01 group by bar(ts,1H) as ts,deviceCode select production_amount_hour from t pivot by ts,deviceCode&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:49;476:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;pivot by 是 DolphinDB 的独有功能，是对标准 SQL 语句的拓展。它将表中一列或多列的内容按照两个维度重新排列，亦可配合数据转换函数使用，其使用方法详见 &lt;xref class=&#34;- topic/xref &#34; href=&#34;../progr/sql/pivotBy.dita&#34; xtrc=&#34;xref:4;476:87&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;pivot by&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;52-异常告警&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:25;478:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:25;478:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;5.2 异常告警&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:25;478:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:50;480:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;DolphinDB 开发了 httpClient 插件，可以便捷地进行 HTTP 请求或发送邮件，httpClient 插件的部署安装详见：&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;../plugins/httpClient/httpclient.md&#34; xtrc=&#34;xref:5;480:71&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;HttpClient&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:51;482:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;本节将以案例 12 为例，介绍在 DolphinDB 检测出异常数据之后，如何将异常数据进行输出告警。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:15;484:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;//加载 httpClient 插件 try{loadPlugin('./plugins/httpClient/PluginHttpClient.txt')}catch(ex){} //定义邮件发送的订阅函数 def sendEmail(userId,pwd,recipient,mutable msg){ ts = exec ts from msg propertyCode = exec propertyCode from msg sendMsg = string(ts)+&#34; the propertyCode &#34;+string(propertyCode)+&#34; rate is greater than 1&#34; sendMsg = concat(sendMsg,&#34;&amp;lt;br&amp;gt;&#34;) httpClient::sendEmail(userId,pwd,recipient,&#34;rate is greater than 1&#34;,sendMsg) } //订阅异常检测结果表发送告警 userId = 'xxxx' //发送者邮箱 pwd='xxx'//发送者邮箱密码 recipient='xxx'//接收邮箱 //订阅异常检测结果表 subscribeTable(tableName=`abnormalRes,actionName='sendEmail',offset=0,handler=sendEmail{userId,pwd,recipient},msgAsTable=true,batchSize=10000,throttle=10)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:52;506:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;上述脚本将订阅异常检测结果表，实时将异常结果以邮件形式发送给接受者，从而达到实时告警的目的。除了邮件告警的形式外，httpClient 还支持企业微信、钉钉等第三方平台，详见：&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;httpclient_msg_case.md&#34; xtrc=&#34;xref:6;506:89&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;利用 HttpClient 插件整合外部消息&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;6-附录&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:26;508:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:26;508:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;6 附录&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:26;508:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:53;510:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;完整测试代码：&lt;xref class=&#34;- topic/xref &#34; format=&#34;dos&#34; href=&#34;script/Intelligent_O&amp;amp;M_demo.dos&#34; xtrc=&#34;xref:7;510:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/Iot_intelligent_O&amp;amp;M.md&#34;&gt;&lt;?ditaot usertext?&gt;Intelligent_O&amp;amp;M_demo.dos&lt;/xref&gt;&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/Iot_intelligent_O&amp;M.md"/><meta name="wh-out-relpath" content="tutorials/Iot_intelligent_O&amp;M.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="助力工业物联网实现智能运维" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html">物联网场景案例</a></div></div></li><li class="active"><div class="topicref" data-id="助力工业物联网实现智能运维"><div class="title"><a href="../tutorials/Iot_intelligent_O&amp;M.html">助力工业物联网实现智能运维</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="引擎级联监测门禁异常状态-d9713e104828" class="topicref" data-id="引擎级联监测门禁异常状态" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="引擎级联监测门禁异常状态-d9713e104828-link">引擎级联监测门禁异常状态</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-历史数据回放功能应用物联网设备故障分析-d9713e104874" class="topicref" data-id="dolphindb-历史数据回放功能应用物联网设备故障分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/faultAnalysis.html" id="dolphindb-历史数据回放功能应用物联网设备故障分析-d9713e104874-link">DolphinDB 历史数据回放功能应用：物联网设备故障分析</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-在工业物联网的应用-d9713e104920" class="topicref" data-id="dolphindb-在工业物联网的应用" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_demo_2.html" id="dolphindb-在工业物联网的应用-d9713e104920-link">DolphinDB 在工业物联网的应用</a></div></div></li><li role="treeitem"><div data-tocid="出租车行程时间预测-d9713e104966" class="topicref" data-id="出租车行程时间预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/forecast_taxi_trip_dura_2.html" id="出租车行程时间预测-d9713e104966-link">出租车行程时间预测</a></div></div></li><li role="treeitem"><div data-tocid="传感器数据异常检测-d9713e105012" class="topicref" data-id="传感器数据异常检测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_anomaly_detection_2.html" id="传感器数据异常检测-d9713e105012-link">传感器数据异常检测</a></div></div></li><li role="treeitem"><div data-tocid="地震波形数据存储解决方案-d9713e105058" class="topicref" data-id="地震波形数据存储解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/waveform_data_storage_2.html" id="地震波形数据存储解决方案-d9713e105058-link">地震波形数据存储解决方案</a></div></div></li><li role="treeitem"><div data-tocid="工业试验平台高频数据的存储和处理分析-d9713e105104" class="topicref" data-id="工业试验平台高频数据的存储和处理分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/high_freq_data_storage_and_analysis.html" id="工业试验平台高频数据的存储和处理分析-d9713e105104-link">工业试验平台高频数据的存储和处理分析</a></div></div></li><li role="treeitem"><div data-tocid="基于波形数据的地震预测-d9713e105150" class="topicref" data-id="基于波形数据的地震预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/earthquake_prediction_ddb_ml_2.html" id="基于波形数据的地震预测-d9713e105150-link">基于波形数据的地震预测</a></div></div></li><li role="treeitem"><div data-tocid="实时检测传感器状态变化-d9713e105196" class="topicref" data-id="实时检测传感器状态变化" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_str_app_iot_2.html" id="实时检测传感器状态变化-d9713e105196-link">实时检测传感器状态变化</a></div></div></li><li role="treeitem"><div data-tocid="实现设备指标的采集监控和展示-d9713e105242" class="topicref" data-id="实现设备指标的采集监控和展示" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_telegraf_grafana.html" id="实现设备指标的采集监控和展示-d9713e105242-link">实现设备指标的采集监控和展示</a></div></div></li><li role="treeitem"><div data-tocid="随机振动信号分析解决方案-d9713e105288" class="topicref" data-id="随机振动信号分析解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/random_vibr_sig_analysis_2.html" id="随机振动信号分析解决方案-d9713e105288-link">随机振动信号分析解决方案</a></div></div></li><li role="treeitem"><div data-tocid="物联网时序数据查询案例-d9713e105335" class="topicref" data-id="物联网时序数据查询案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_query_case.html" id="物联网时序数据查询案例-d9713e105335-link">物联网时序数据查询案例</a></div></div></li><li role="treeitem"><div data-tocid="物联网实时数据异常率预警-d9713e105381" class="topicref" data-id="物联网实时数据异常率预警" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/knn_iot_2.html" id="物联网实时数据异常率预警-d9713e105381-link">物联网实时数据异常率预警</a></div></div></li><li role="treeitem"><div data-tocid="物联网应用范例-d9713e105427" class="topicref" data-id="物联网应用范例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_examples.html" id="物联网应用范例-d9713e105427-link">物联网应用范例</a></div></div></li><li role="treeitem"><div data-tocid="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案-d9713e105473" class="topicref" data-id="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Virbration_Monitor_Fault_Diagnose.html" id="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案-d9713e105473-link">云边协同：DolphinDB 构建一体化振动监控与故障诊断解决方案</a></div></div></li><li role="treeitem" class="active"><div data-tocid="助力工业物联网实现智能运维-d9713e105519" class="topicref" data-id="助力工业物联网实现智能运维" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Iot_intelligent_O&amp;M.html" id="助力工业物联网实现智能运维-d9713e105519-link">助力工业物联网实现智能运维</a></div></div></li><li role="treeitem"><div data-tocid="使用-node-red-构建-dolphindb-低代码平台-d9713e105565" class="topicref" data-id="使用-node-red-构建-dolphindb-低代码平台" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/node_red_tutorial_iot.html" id="使用-node-red-构建-dolphindb-低代码平台-d9713e105565-link">使用 Node-RED 构建 DolphinDB 低代码平台</a></div></div></li><li role="treeitem"><div data-tocid="基于-glibc-升级的性能优化案例-d9713e105611" class="topicref" data-id="基于-glibc-升级的性能优化案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/perf_opti_glibc.html" id="基于-glibc-升级的性能优化案例-d9713e105611-link">基于 Glibc 升级的性能优化案例</a></div></div></li><li role="treeitem"><div data-tocid="当电力市场碰上量化技术如何构建高效电力交易解决方案-d9713e105657" class="topicref" data-id="当电力市场碰上量化技术如何构建高效电力交易解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/efficient_power_trading_solutions.html" id="当电力市场碰上量化技术如何构建高效电力交易解决方案-d9713e105657-link">当电力市场碰上量化技术，如何构建高效电力交易解决方案？</a></div></div></li><li role="treeitem"><div data-tocid="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析-d9713e105703" class="topicref" data-id="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/behavioral_profiling_of_driving_habits.html" id="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析-d9713e105703-link">使用 DolphinDB 进行汽车用户驾驶习惯行为画像分析</a></div></div></li><li role="treeitem"><div data-tocid="edge_to_cloud-d9713e105749" class="topicref" data-id="edge_to_cloud" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/edge_to_cloud.html" id="edge_to_cloud-d9713e105749-link">DolphinDB 实现边到云的实时数据汇聚</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">助力工业物联网实现智能运维</h1><div class="- topic/body body"><p class="- topic/p p">随着数字化转型的浪潮兴起，越来越多企业认识到工业物联网在提升工业生产安全性和效率方面的关键作用。然而，随着设备规模的扩大和工艺复杂性的提升，智能化运维监管成为工业企业急需解决的重要挑战。</p><p class="- topic/p p">智能运维是一种利用先进技术和数据分析方法来提高生产设备和工艺系统可靠性、安全性与效率的方法。它结合了物联网、人工智能和大数据分析等技术，通过实时监测、故障预测、优化维护计划和自动化操作等手段，帮助企业实现设备故障的及时诊断和修复，降低生产停机时间，并提升设备利用率和生产质量。智能运维不仅可以减少人为错误和人力成本，还可以提高生产过程的可持续性和环境友好性，对提升企业竞争力和促进可持续发展具有重要意义。</p><p class="- topic/p p">DolphinDB 是由浙江智臾科技有限公司研发的一款高性能分布式时序数据库，能够完美解决智能运维领域面临的大数据量和实时性要求高的问题。DolphinDB 不仅支持数据的存储，还具备强大的数据处理和分析能力。它集成了功能强大的编程语言和高容量高速度的流数据分析系统，为智能运维提供了轻量级、一站式的解决方案，而无需复杂的系统架构。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-智能运维面临的挑战"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1 智能运维面临的挑战</h2><div class="- topic/body body"><p class="- topic/p p">智能运维面临着几个关键挑战：</p><ul class="- topic/ul ul"><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">设备异构性</strong>：一个大型工业平台系统通常包含众多不同类型、不同品牌的设备，这些设备可能使用各种不同的通信协议和数据格式。不同设备数据的接入、管理是一大难题。</li><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">数据激增与复杂性</strong>：随着工业设备和系统的智能化程度提高，产生的数据规模急剧增加。这些数据不仅在数量上巨大，而且包含了更多的复杂性和多样性，传统的运维手段难以满足对数据的高效处理和深度分析需求。</li><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">实时性与准确性要求提升</strong>：众多行业对设备状态、生产过程等实时性要求越来越高，需要实时监测和故障诊断，以确保生产的连续性和可靠性。传统的运维模式可能无法满足对实时性和准确性的双重需求，需要更加智能、高效的运维方式。</li></ul></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="2-解决方案"><h2 class="- topic/title title topictitle2" id="ariaid-title3">2 解决方案</h2><div class="- topic/body body"><p class="- topic/p p">本文将通过<strong class="+ topic/ph hi-d/b ph b">十二个</strong>典型工业生产的智能运维场景，来验证 DolphinDB 在工业物联网智能运维方面的应用能力：</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><tbody class="- topic/tbody tbody"><tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0"><strong class="+ topic/ph hi-d/b ph b">场景</strong></td>
<td class="- topic/entry entry colsep-0 rowsep-0"><strong class="+ topic/ph hi-d/b ph b">案例</strong></td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0" rowspan="3">工业智能运维</td>
<td class="- topic/entry entry colsep-0 rowsep-0">根据状态指标计算设备累计开停机时长</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">根据指定时间段内状态突变次数计算累计开停机次数</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">根据状态值计算设备最大持续运行时间</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0" rowspan="6">生产监控</td>
<td class="- topic/entry entry colsep-0 rowsep-0">统计生料磨每小时的汇总产量</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">根据可加指标计算变化率</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">根据电流计算一段时间内设备的累计空载时间</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">计算指定时间段范围内（窗口时间）电机轴承的平均温度</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">指标根据表达式的二次计算</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">合并汇总计算</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0" rowspan="3">实时流计算</td>
<td class="- topic/entry entry colsep-0 rowsep-0">每个整点的平均值相减</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">根据状态突变抽取记录</td>
</tr>
<tr class="- topic/row">
<td class="- topic/entry entry colsep-0 rowsep-0">实时检测异常变化率</td>
</tr>
</tbody></table></div><div class="table-container"></div><p class="- topic/p p">架构图如下：</p><br/><img class="- topic/image image" src="images/Iot_intelligent_O&amp;M/01.png" alt="01"/><br/><p class="- topic/p p">下文中，我们将详细介绍 DolphinDB 的安装部署、数据准备以及功能的实现过程。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title4" id="3-前期准备"><h2 class="- topic/title title topictitle2" id="ariaid-title4">3 前期准备</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="31-安装部署"><h3 class="- topic/title title topictitle3" id="ariaid-title5">3.1 安装部署</h3><div class="- topic/body body"><ol class="- topic/ol ol"><li class="- topic/li li">下载<a class="- topic/xref xref" href="https://www.dolphindb.cn/product#downloads" target="_blank" rel="external noopener">官网</a>社区最新版，建议 2.00.10 或以上版本。</li><li class="- topic/li li">解压缩下载的安装包。<strong class="+ topic/ph hi-d/b ph b">注意</strong>：Windows 解压路径，不能有空格，避免安装到 Program Files 路径下。参考教程：<a class="- topic/xref xref" href="standalone_server.html">单节点部署与升级</a>。</li></ol></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title6" id="32-模拟环境"><h3 class="- topic/title title topictitle3" id="ariaid-title6">3.2 模拟环境</h3><div class="- topic/body body"><p class="- topic/p p">在此案例中，我们需要处理 100 台设备，每台设备有 1000 个测点，采集频率为每 5 分钟 1 次。为了对这些数据进行有效的建模，我们使用了宽表模型，其中包含了 6 个字段，分别为数采时间、设备编号、逻辑位置 ID、物理位置 ID、属性测点编码和测点值。</p><div class="table-container"><table class="- topic/table table" data-cols="7"><caption></caption><colgroup><col/><col/><col/><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="32-模拟环境__entry__1"><strong class="+ topic/ph hi-d/b ph b">字段名</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="32-模拟环境__entry__2"><strong class="+ topic/ph hi-d/b ph b">ts</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="32-模拟环境__entry__3"><strong class="+ topic/ph hi-d/b ph b">deviceCode</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="32-模拟环境__entry__4"><strong class="+ topic/ph hi-d/b ph b">logicalPositionId</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="32-模拟环境__entry__5"><strong class="+ topic/ph hi-d/b ph b">physicalPositionId</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="32-模拟环境__entry__6"><strong class="+ topic/ph hi-d/b ph b">propertyCode</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="32-模拟环境__entry__7"><strong class="+ topic/ph hi-d/b ph b">propertyValue</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__1">字段描述</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__2">数采时间</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__3">设备编号</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__4">逻辑位置ID</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__5">物理位置ID</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__6">属性测点编码</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__7">测点值</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__1">数据类型</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__2">DATETIME</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__3">SYMBOL</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__4">SYMBOL</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__5">SYMBOL</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__6">SYMBOL</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__7">INT</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__1">字节占用</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__2">4</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__3">4</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__4">4</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__5">4</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__6">4</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="32-模拟环境__entry__7">4</td></tr></tbody></table></div><p class="- topic/p p">在此案例中，我们需要记录 100 台设备在 10 天内产生的数据，共 2.88 亿条。</p><p class="- topic/p p">DolphinDB 数据库支持多种分区类型，包括范围分区、哈希分区、值分区、列表分区和复合分区。用户可以根据自己的需求选择不同的分区类型。在本案例中，我们选择了值分区。对于 10 天产生的数据，会按照天进行切分，将每天产生的数据放在同一个分区中。这种分区方式能够提高查询效率，使得查询只需要访问特定的分区，而不需要扫描整个数据表。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>create database "dfs://db_test" partitioned by VALUE([2022.11.01]),engine='TSDB'
create table "dfs://db_test"."collect"(
    ts                    DATETIME,//数采时间  
    deviceCode            SYMBOL,//设备编号    
    logicalPositionId      SYMBOL,//逻辑位置ID    
    physicalPositionId     SYMBOL,//物理位置ID
    propertyCode          SYMBOL,//属性测点编码
    propertyValue         INT//测点值
)
partitioned by ts
sortColumns=[`deviceCode,`ts]</code></pre><p class="- topic/p p">完成了建表建库后，我们将使用自定义函数模拟 100 台设备在 10 天内产生的 2.88 亿条数据，并将生成的数据写入 DolphinDB 数据库。详细的实现过程请参考文章末尾的完整示例代码。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title7" id="4-功能实现"><h2 class="- topic/title title topictitle2" id="ariaid-title7">4 功能实现</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title8" id="41-工业智能运维"><h3 class="- topic/title title topictitle3" id="ariaid-title8">4.1 工业智能运维</h3><div class="- topic/body body"><p class="- topic/p p">首先，DolphinDB 可以实现设备的全寿命周期管理。通过设备完整、实时的监测数据，全面掌握设备的异常及故障情况。根据历史数据及设定的条件，系统自动分析设备维修保养的频度，并生成相应的任务单，并定时提醒相关责任人。同时，DolphinDB 能够在线跟踪维修保养的过程，并进行记录与分析评估。通过实现计划性维修及预测性保养，并能够消除大面积盲目定期大修与保养的大量无效人工，从而保障设备的运行效果，并延长设备的寿命。</p><p class="- topic/p p">此外，DolphinDB 具备强大的数据挖掘和分析能力，可以帮助企业深度挖掘和分析设备数据，生成丰富多样的统计报表。例如，可以对设备的总能耗、分项能耗进行统计分析，包括按日、周、月、年等任意时间段进行同比、环比和趋势预测。还可以对各区域（考核单元）的能耗总量进行统计，并按时间段的占比和排名进行分析。DolphinDB 还能对重点设备的分项能耗占比和排名进行详尽的分析。</p><p class="- topic/p p">最后，实时监测和有效报警是提升运维安全保障能力的关键环节。DolphinDB 可以实时监测设备的运行状态，并配置异常预警报警参数。基于实时监测设备参数变化趋势，DolphinDB 植入了多参数报警算法进行诊断分析，并可对超过预警和报警阈值的设备或参数进行实时报警。报警支持按需订阅，可以通过邮件、手机短信等方式通知相关责任人，并能根据报警信息触发业务工单，及时通知相关维护人员，从而提高设备的安全保障能力。</p><p class="- topic/p p">DolphinDB 的这些功能，包括计算设备累计开停机时长、开停机次数、最大持续运行时间和实时监控设备状态等，能够为工业智能运维提供强有力的支持，详见以下各例。</p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title9" id="案例-1根据状态指标计算设备累计开停机时长"><h4 class="- topic/title title topictitle4" id="ariaid-title9">案例 1：根据状态指标计算设备累计开停机时长</h4><div class="- topic/body body"><p class="- topic/p p">设备累计开停机时长是设备全寿命周期管理中的一个常见指标。</p><p class="- topic/p p">计算过程中主要涉及两个字段：<code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">ts</code>。其中，<code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code> 记录设备的状态，0 表示关机，1 表示开机；<code class="+ topic/ph pr-d/codeph ph codeph">ts</code> 是时间戳。计算过程如下：</p><ol class="- topic/ol ol"><li class="- topic/li li">用 <code class="+ topic/ph pr-d/codeph ph codeph">deltas</code> 函数来计算相邻时间戳之间的差值。</li><li class="- topic/li li">用 <code class="+ topic/ph pr-d/codeph ph codeph">bar(ts,1H)</code> 将时间戳按小时进行划分，将数据分组。</li><li class="- topic/li li">根据设备状态 <code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code> 对同一小时内的数据进行进一步分组。</li><li class="- topic/li li">对同一组内的时间差值求和，从而得到设备的累计开停机时长。</li></ol><p class="- topic/p p">通过以上步骤计算得到的数据可以被推送给业务应用，为运维人员了解设备状态并制定维护计划提供帮助。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 1：根据状态指标计算设备累计开停机时长
dt=select * from pt where deviceCode="361RP88" and propertyCode="361RP88002"
//处理累计时长 
t = select *,deltas(ts) as duration from dt
//输出（分钟）
select sum(duration)/60 as duration from t group by bar(ts,1H) as bar_ts,deviceCode,logicalPositionId,physicalPositionId,propertyValue</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title10" id="案例-2根据指定时间段内状态突变次数计算累计开停机次数"><h4 class="- topic/title title topictitle4" id="ariaid-title10">案例 2：根据指定时间段内状态突变次数计算累计开停机次数</h4><div class="- topic/body body"><p class="- topic/p p">指定时间段内设备开停机次数的计算过程主要涉及的字段为 <code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code>，该字段记录了设备的状态。其中，0 表示关机，1 表示开机。计算过程如下：</p><ol class="- topic/ol ol"><li class="- topic/li li">用 <code class="+ topic/ph pr-d/codeph ph codeph">deltas</code> 函数计算相邻两个 <code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code> 间的差值。可能结果有三种：0、1 和 -1。其中，0 表示状态没有变化，1 表示状态由开机变为关机，-1 表示状态由关机变为开机。</li><li class="- topic/li li">统计结果中 1 和 -1 的个数，以获得开停机的次数。这些数据可以进一步推送到业务系统，帮助运维人员了解设备的状态，并制定维护计划。</li></ol><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 2：根据指定时间段内状态突变次数计算累计开停机次数
t= select *,deltas(propertyValue) from dt where ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59 
//输出
select count(*) from t where deltas_propertyValue in (1,-1) group by deviceCode,logicalPositionId,physicalPositionId,bar(ts,1H),deltas_propertyValue</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title11" id="案例-3根据状态值计算设备最大持续运行时间"><h4 class="- topic/title title topictitle4" id="ariaid-title11">案例 3：根据状态值，计算设备最大持续运行时间</h4><div class="- topic/body body"><p class="- topic/p p">设备的最大持续运行时间是设备全寿命周期管理中一个常见的指标。在计算过程中的主要关注字段为设备状态字段 <code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code>，其中，0 表示设备关机，1 表示设备开机。因此，<code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code> 的值由 0 变为 1 表示一次开机，由 1 变为 0 表示一次停机。通过计算各状态的持续时长，并进行筛选最大值便可得到设备最大持续运行时间。得益于众多功能强大的内置函数，DolphinDB 只需要三条语句便可实现这个复杂的逻辑过程。</p><p class="- topic/p p">在 DolphinDB 中，可以使用 <code class="+ topic/ph pr-d/codeph ph codeph">deltas</code>、<code class="+ topic/ph pr-d/codeph ph codeph">segment</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">iif</code> 等函数来实现该计算，过程如下：</p><ol class="- topic/ol ol"><li class="- topic/li li">用 <code class="+ topic/ph pr-d/codeph ph codeph">deltas</code> 函数计算时间戳之间的差值，得到每个时间点与前一个时间点的时间差。</li><li class="- topic/li li">用 <code class="+ topic/ph pr-d/codeph ph codeph">segment</code> 函数对数据按设备状态进行分组，将具有相同 <code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code> 值的数据分为一组。</li><li class="- topic/li li">用 <code class="+ topic/ph pr-d/codeph ph codeph">iif</code> 函数对每个数据进行条件判断，在 <code class="+ topic/ph pr-d/codeph ph codeph">propertyValue</code> 为 1 时返回时间差，否则返回 0。</li><li class="- topic/li li">用 <code class="+ topic/ph pr-d/codeph ph codeph">sum</code> 函数求和得到开机状态持续的时长。</li><li class="- topic/li li">用 <code class="+ topic/ph pr-d/codeph ph codeph">max</code> 函数筛选出最长的持续时间，即为设备的最大持续运行时间。</li></ol><br/><img class="- topic/image image" src="images/Iot_intelligent_O&amp;M/02.png" alt="02"/><br/><p class="- topic/p p">segment 函数</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 3：根据状态值，计算设备最大持续运行时间
//数据准备，累计时间
t = select *,deltas(ts) as duration from dt where ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59 order by ts
t=select sum(iif(propertyValue==1, duration, 0)) as duration_running_max,sum(iif(propertyValue==1, 0,duration)) as duration_stop_max from t group by deviceCode,logicalPositionId,physicalPositionId,segment(propertyValue)
//输出（分钟）
select max(duration_running_max)/60 as duration_running_max,max(duration_stop_max)/60 as duration_stop_max from t group by deviceCode,logicalPositionId,physicalPositionId</code></pre></div></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title12" id="42-生产监控"><h3 class="- topic/title title topictitle3" id="ariaid-title12">4.2 生产监控</h3><div class="- topic/body body"></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title13" id="案例-4计算生料磨每小时的总产量"><h4 class="- topic/title title topictitle4" id="ariaid-title13">案例 4：计算生料磨每小时的总产量</h4><div class="- topic/body body"><p class="- topic/p p">在工业场景中，计算单位时间内的产量是一项常见需求。以下以计算生料磨每小时的总产量为例，介绍 DolphinDB 提供的解决方案。</p><p class="- topic/p p">通过使用 DolphinDB 中的<code class="+ topic/ph pr-d/codeph ph codeph">bar</code>、<code class="+ topic/ph pr-d/codeph ph codeph">group by</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">sum</code> 函数，一条语句就能够轻松地完成任务。其中，<code class="+ topic/ph pr-d/codeph ph codeph">bar(ts, 1H)</code> 函数能够将时间戳 <code class="+ topic/ph pr-d/codeph ph codeph">ts</code> 按小时划分，<code class="+ topic/ph pr-d/codeph ph codeph">group by</code> 函数能够对数据进行分组，而 <code class="+ topic/ph pr-d/codeph ph codeph">sum</code> 函数则能够对组内数据进行求和，从而得到每小时的总产量。</p><p class="- topic/p p">此外，DolphinDB 还提供了函数视图功能，它类似关系数据库中的存储过程，可以封装复杂的业务逻辑，方便用户调用。</p><br/><img class="- topic/image image" src="images/Iot_intelligent_O&amp;M/03.png" alt="03"/><br/><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 4：实时计算生料磨每小时的汇总产量
device="361RP88"      //设备编号
point="361RP88001"    //测点编号,记录产量的测点，得到的 propertyValue 表示产量值

pt=loadTable("dfs://db_test",`collect)
timer t=select deviceCode,logicalPositionId,physicalPositionId,sum(propertyValue) as production_amount_hour,ts from pt where ts between 2022.01.01 00:00:00 : 2022.01.01 02:59:59 and deviceCode=device and propertyCode=point group by bar(ts,1H) as ts,deviceCode,logicalPositionId,physicalPositionId
t

//自定义函数视图，供应用端调用：
def production_amount_hour(device,point,begintime,endtime){
    //业务判断，合法性校验
    if (datetime(endtime)-datetime(begintime)&gt;24*3600*30){
        return(toStdJson([-1,"查询时间不能超过30天"]))
    }
    t=select deviceCode,logicalPositionId,physicalPositionId,sum(propertyValue) as production_amount_hour,ts from loadTable("dfs://db_test",`collect) where ts between begintime : endtime and deviceCode=device and propertyCode=point group by bar(ts,1H) as ts,deviceCode,logicalPositionId,physicalPositionId
    return t
}
//添加函数视图
addFunctionView(production_amount_hour)

production_amount_hour(device,point,2022.01.01 00:00:00,2022.03.01 00:00:00)    //业务判断
production_amount_hour(device,point,2022.01.01 00:00:00,2022.01.01 23:59:59)    //应用端正常查询，并输出结果</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title14" id="案例-5根据指定指标计算变化率"><h4 class="- topic/title title topictitle4" id="ariaid-title14">案例 5：根据指定指标计算变化率</h4><div class="- topic/body body"><p class="- topic/p p">电流是工业物联网中常见的监控指标之一，电流保持平稳状态对设备的正常运行至关重要。电流突变可能会导致电路的短路、过载、电压波动等问题，严重情况下甚至会引发火灾、爆炸等安全事故。因此，实时监测电流变化并进行安全预警具有重要意义。</p><p class="- topic/p p">DolphinDB 能够实时计算电流的变化率，并对超出指定值的数据进行记录和推送信息，形成安全预警，从而预防安全事故的发生。电流突变率的计算表达式为 <code class="+ topic/ph pr-d/codeph ph codeph">（当前电流值 - 前一时刻的电流值）/ 前一时刻的电流值</code>。DolphinDB 可以用一条语句轻松实现获取当前时间的前一时刻的数据。具体实现过程是：</p><ol class="- topic/ol ol"><li class="- topic/li li">通过 <code class="+ topic/ph pr-d/codeph ph codeph">deltas</code> 计算当前数据与前一时刻数据的差值。</li><li class="- topic/li li">计算获得最终结果数据。</li></ol><p class="- topic/p p">对于计算出来的电流突变率，如果超过了指定阈值，DolphinDB 会将其记录下来，并推送给管理人员进行安全预警，从而及时防范安全事故的发生。这种实时监测和预警的方法可以有效地提高设备的安全性和稳定性。</p><br/><img class="- topic/image image" src="images/Iot_intelligent_O&amp;M/04.png" alt="04"/><br/><p class="- topic/p p">deltas 函数</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 5：根据可加指标实时计算变化率,超出指定值进行记录
//数据准备
device="361RP88"      //设备编号
point="361RP88006"    //测点编号，记录电流的测点，得到的 propertyValue 表示电流值
t=select * from pt where deviceCode=device and propertyCode=point and ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59
//统计变化率
t = select *,propertyValue-deltas(propertyValue) as propertyValue_before,propertyValue as propertyValue_now from t  
select ts,deviceCode,logicalPositionId,physicalPositionId,propertyCode,propertyValue_before,propertyValue_now, string(format(abs(propertyValue_now-propertyValue_before)*100.0/propertyValue_before,"0.00"))+"%" as rate from t where abs(propertyValue_now-propertyValue_before)/propertyValue_before&gt;1</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title15" id="案例-6根据电流计算一段时间内设备的累计空载时间"><h4 class="- topic/title title topictitle4" id="ariaid-title15">案例 6：根据电流计算一段时间内设备的累计空载时间</h4><div class="- topic/body body"><p class="- topic/p p">设备空载通常指设备在运行时没有工作负载或负载非常小。例如，一台电动机在没有连接到任何负载或者连接到一个非常小的负载时，它处于空载状态。在这种状态下，设备的运行通常会浪费能源，也可能会对设备造成损坏。</p><p class="- topic/p p">电流值小于 60 时，我们可以认为设备处于空载状态。以下是 DolphinDB 实现计算累计空载时间的过程，得到的结果之后可以推送给业务系统进行空载状态预警。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 6：根据电流计算一段时间内设备的累计空载时间
device="361RP17"     //设备编号
point="361RP17007"   //测点编号，记录电流的测点，得到的 propertyValue 表示电流值
t=select * from pt where deviceCode=device and propertyCode=point and ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59
//统计空载时间
t = select *,deltas(ts) as duration,nullFill(prev(propertyValue),propertyValue) as before from t where deviceCode=device and propertyCode=point and ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59 
//输出
select sum(duration)/60 from t where before&lt;=60 group by bar(ts,1H),deviceCode,logicalPositionId,physicalPositionId</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title16" id="案例-7计算指定时间段范围内窗口时间电机轴承的平均温度"><h4 class="- topic/title title topictitle4" id="ariaid-title16">案例 7：计算指定时间段范围内（窗口时间）电机轴承的平均温度</h4><div class="- topic/body body"><p class="- topic/p p">电机轴承的温度是设备正常运行的一个重要指标。为实时监测电机轴承温度并进行安全预警，DolphinDB 使用 <code class="+ topic/ph pr-d/codeph ph codeph">mavg</code> 函数计算 10 分钟窗口内电机轴承温度的平均值，从而有效地反映电机轴承的运行状态。并且，基于这个平均温度，可以计算出温度突变率，及时发现异常情况 ，并进行相应的安全预警。通过这种实时监测和预警的方法，可以有效地保障设备的安全性和稳定性，提高设备的运行效率和寿命。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 7：计算指定时间段范围内（窗口时间）电机轴承的平均温度
device="361RP17"     //设备编号
point="361RP17008"   //测点编号，记录电机轴承温度的测点，得到的 propertyValue 表示温度
//输出
select *,mavg(propertyValue,2) from pt where deviceCode=device and propertyCode=point and ts between 2022.01.01 00:00:00 : 2022.01.01 01:59:59</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title17" id="案例-8指标根据表达式的二次计算"><h4 class="- topic/title title topictitle4" id="ariaid-title17">案例 8：指标根据表达式的二次计算</h4><div class="- topic/body body"><p class="- topic/p p">DolphinDB 支持根据指定规则批量修改表内容，灵活方便。DolphinDB 可以根据指定的规则对表中的数据进行分类和修改。以下是根据温度进行等级划分的规则：</p><ul class="- topic/ul ul"><li class="- topic/li li">A 等级：温度小于或等于 60</li><li class="- topic/li li">B 等级：温度大于 60 小于 80</li><li class="- topic/li li">C 等级：温度大于或等于 80</li></ul><p class="- topic/p p">根据这个规则，可以对数据进行分类并加上相应的等级标签。</p><p class="- topic/p p">DolphinDB 采用列式存储方式，可以轻松地实现对指定列的批量修改。与传统的关系数据库如 MySQL 和 PostgreSQL 采用的行式存储不同，DolphinDB 避免了逐个元素赋值的繁琐复杂过程，大大节省了时间。这种灵活、方便的批量修改表内容的功能为数据分析和管理提供了更多的便利和效率。</p><br/><img class="- topic/image image" src="images/Iot_intelligent_O&amp;M/05.jpg" alt="05"/><br/><p class="- topic/p p">列式存储和行式存储</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 8：指标根据表达式的二次计算
device="361RP17"       //设备编号
point="361RP17009"     //测点编号，记录温度的测点，得到的 propertyValue 表示温度
dt=select * from pt where deviceCode=device and propertyCode=point 
update!(dt,`propertyValue,rand(100,dt.size()))
//取值
a=select * from dt where propertyValue &lt;=60
b=select * from dt where propertyValue &gt;60 and propertyValue&lt;80
c=select * from dt where propertyValue &gt;=80
//分类
a.addColumn(`temperature_level,SYMBOL)
b.addColumn(`temperature_level,SYMBOL)
c.addColumn(`temperature_level,SYMBOL)
a[`temperature_level]="A"
b[`temperature_level]="B"
c[`temperature_level]="C"
//合并数据
t=a.append!(b).append!(c)
//输出
select * from t order by ts</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title18" id="案例-9分组汇总计算条件筛选"><h4 class="- topic/title title topictitle4" id="ariaid-title18">案例 9：分组汇总计算，条件筛选</h4><div class="- topic/body body"><p class="- topic/p p">DolphinDB 可以轻松地支持亿级数据的分组汇总计算和条件筛选，并且能够在毫秒级别响应请求。以下是计算设备 361RP88 在 2022 年 1 月 1 日 23:00:00 之前一小时内平均温度的示例代码：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 9：分组汇总计算，条件筛选
device="361RP88"        //设备编号
point="361RP88010"      //测点编号，记录温度的测点，得到的 propertyValue 表示温度
//过去一小时数据
now=2022.01.01 23:00:00
dt=select * from pt where ts&gt;=datetime(now)-3600 and ts&lt;now and deviceCode=device and propertyCode=point
//输出
select deviceCode,propertyCode,now as max_ts,avg(propertyValue) as hour_avg from dt group by deviceCode,propertyCode</code></pre></div></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title19" id="43-实时流计算"><h3 class="- topic/title title topictitle3" id="ariaid-title19">4.3 实时流计算</h3><div class="- topic/body body"><p class="- topic/p p">实时流处理是指对持续增长的动态数据进行实时的收集、清洗、统计和存储，并实时展示处理结果。在智能运维领域，流数据处理需求非常常见。例如，在工业物联网中，设备传感器会持续产生数据，智能运维系统需要实时监控这些数据。</p><p class="- topic/p p">DolphinDB 可以在实时数据流计算场景中高效地计算。用户可以通过简单的表达式实现复杂的流计算。DolphinDB 的流式数据处理引擎能够实现低延迟、高吞吐的流式数据分析，并提供了十种不同的引擎以满足不同的计算需求。此外，DolphinDB 数据库支持多种数据终端输出，如共享内存表、流数据表、消息中间件、数据库和 API 等。在计算复杂表达式时，用户还可以通过级联多个流数据引擎来实现复杂的数据流拓扑。</p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title20" id="案例-10每个整点的平均值相减"><h4 class="- topic/title title topictitle4" id="ariaid-title20">案例 10：每个整点的平均值相减</h4><div class="- topic/body body"><p class="- topic/p p">DolphinDB 内置的多种流数据处理引擎支持流数据的发布、订阅、预处理、实时内存计算、复杂指标的滚动窗口计算、实时关联以及异常数据检测。</p><p class="- topic/p p">下例展示了如何通过 DolphinDB 实现每个整点平均值的相减，过程如下：</p><ol class="- topic/ol ol"><li class="- topic/li li">建立一个时序引擎以计算每个整点内数据平均值。</li><li class="- topic/li li">用响应式状态引擎计算平均值间的差值。</li><li class="- topic/li li">输出计算结果到 result 表。</li></ol><br/><img class="- topic/image image" src="images/Iot_intelligent_O&amp;M/06.png" alt="06"/><br/><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 10：每个整点的平均值相减，比如 1~2 点的值减去 0~1 点的值，如此循环。
//步骤说明：
//步骤一：用时序引擎，数据按整点规整。
//步骤二：用响应式状态引擎，进行差值计算。
//步骤三：输出到 result 表

//数据写入
share streamTable(1000:0, `ts`deviceCode`logicalPositionId`physicalPositionId`propertyCode`propertyValue,
        [DATETIME,SYMBOL,SYMBOL,SYMBOL,SYMBOL,DOUBLE]) as inTable

//时序引擎的输出表
share streamTable(1000:0, `ts`deviceCode`propertyCode`propertyValue,
        [DATETIME,SYMBOL,SYMBOL,DOUBLE]) as outTable

//时序引擎，实时计算均值指标（窗口 1 h，步长 1 h，每个设备的每个测点为一组进行分组计算）
hour = createTimeSeriesEngine(name="hour",  windowSize=3600, step=3600, metrics=&lt;[avg(propertyValue)]&gt;, dummyTable=inTable, outputTable=outTable, timeColumn=`ts, keyColumn=[`deviceCode,`propertyCode])
subscribeTable(tableName="inTable", actionName="act_hour", offset=0, handler=append!{hour}, msgAsTable=true, batchSize=50, throttle=1, hash=0)

//状态响应引擎，每个相邻整点值相减
share streamTable(1000:0, `deviceCode`propertyCode`ts`sub_propertyValue,
        [SYMBOL,SYMBOL,DATETIME,DOUBLE]) as result
sub_hour = createReactiveStateEngine(name="sub_hour", metrics = &lt;[ts,deltas(propertyValue)]&gt;, dummyTable=outTable, outputTable=result, keyColumn=[`deviceCode,`propertyCode])
subscribeTable(tableName="outTable", actionName="act_sub_hour", offset=0, handler=append!{sub_hour}, msgAsTable=true, batchSize=50, throttle=1, hash=0)

//将某个设备的数据写入，启动流式框架
pt = loadTable("dfs://db_test", "collect");
select count(*) from pt; 
t = select * from pt where deviceCode = "361RP00" and propertyCode = "361RP00000"
inTable.append!(t);

//流数据引擎计算窗口内的平均值
select * from outTable where deviceCode = "361RP00" and propertyCode = "361RP00000";
//sql 查询窗口内的平均值
select format(avg(propertyValue),"0.00") from t where deviceCode = "361RP00" and propertyCode = "361RP00000" group by datehour(ts)</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title21" id="案例-11根据状态突变抽取记录实时流计算"><h4 class="- topic/title title topictitle4" id="ariaid-title21">案例 11：根据状态突变，抽取记录（实时流计算）</h4><div class="- topic/body body"><p class="- topic/p p">下例展示了流数据响应式状态引擎如何检测设备的状态变化，并将测得的开停机记录推送给 Python 端的实现过程。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//案例 11：根据状态突变，抽取记录（实时流计算）

//新建流数据表，接收实时写入数据
share streamTable(20000:0,pt.schema().colDefs.name,pt.schema().colDefs.typeString) as mainStream

//新建流数据表，保存处理后结果数据
share streamTable(20000:0,`propertyCode`ts`deviceCode`logicalPositionId`physicalPositionId`propertyValue,[SYMBOL,DATETIME,SYMBOL,INT,INT,INT]) as calc_result

//使用流数据异常检测引擎，进行数据筛选处理
engine = createReactiveStateEngine("engine_status", &lt;[ts,deviceCode,logicalPositionId,physicalPositionId,propertyValue]&gt;, mainStream, calc_result,`propertyCode,&lt;propertyValue!=prev(propertyValue)&gt;)

//开启订阅
subscribeTable(tableName="mainStream", actionName="act_subscribe_calculate", offset=0, handler=append!{engine}, msgAsTable=true, batchSize=10000, throttle=1,hash=1);

//使用回放，模拟持续写入流数据表的场景
dt=select * from pt where deviceCode="361RP17" and propertyCode="361RP17002" and ts between 2022.01.01 00:00:00:2022.01.01 01:00:00 order by ts
update!(dt,`propertyValue,rand(0 1,dt.size()))

//批处理调用 replay 函数，后台执行回放
rate=5*60    //回放倍速（每秒播放5分钟的数据，每小时数据12秒执行完毕）
submitJob("replay_output", "replay_output_stream", replay, dt ,mainStream, `ts, `ts, rate,false)

//推送到应用端。subScribe_result.py，详情可查看 python 对流数据的订阅。
/*** python代码开始 ****
from threading import Event
import dolphindb as ddb
import pandas as pd
import numpy as np
s = ddb.session()
s.enableStreaming(8000)
def handler(lst):
   print(lst)
s.subscribe("127.0.0.1", 8848, handler, "calc_result")
Event().wait()
*** python 代码结束 ****/</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title22" id="案例-12实时检测异常值以指标变化率为例"><h4 class="- topic/title title topictitle4" id="ariaid-title22">案例 12：实时检测异常值，以指标变化率为例</h4><div class="- topic/body body"><p class="- topic/p p">为了帮助用户检测异常情况，DolphinDB 提供了流数据异常检测引擎。该引擎可根据指定的异常指标，检测每条记录，将异常的结果输出。</p><p class="- topic/p p">下例以案例 5 中指标变化率为指标，实时检测指标变化率是否超过阈值，将案例 5 中的事后异常分析转为实时异常检测。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//新建流数据表,接收实时写入数据
share streamTable(20000:0,pt.schema().colDefs.name,pt.schema().colDefs.typeString) as mainStream

//新建流数据表，保存异常结果
share streamTable(1000:0, `ts`propertyCode`type`metric, [DATETIME, SYMBOL, INT, STRING]) as anomalyRes

// 创建异常检测引擎
detect_rate = createAnomalyDetectionEngine(name="detect_rate",metrics=&lt;[abs(propertyValue \ prev(propertyValue)-1)&gt;1]&gt;,dummyTable=mainStream,
                                           outputTable=abnormalRes,timeColumn=`ts,keyColumn=`propertyCode)
// 订阅实时数据
subscribeTable(tableName=`mainStream,actionName='detect_rate',offset=-1,handler=append!{detect_rate},msgAsTable=true)

//使用回放，模拟持续写入流数据表的场景
device="361RP017"
point="361RP017006"
rate=5*60                           //回放倍速（每秒播放 5 分钟的数据，每小时数据 12 秒执行完毕）
begintime=2022.01.01 00:00:00       //数据开始时间
endtime  =2022.01.01 02:00:00       //数据结束时间
dt=select * from pt where deviceCode=device and propertyCode=point and ts between begintime:endtime order by ts
submitJob("replay_output", "replay_output_stream", replay, dt ,mainStream, `ts, `ts, rate,false)

select * from abnormalRes                                      </code></pre></div></article></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title23" id="5-可视化运维与告警"><h2 class="- topic/title title topictitle2" id="ariaid-title23">5 可视化运维与告警</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title24" id="51-运维指标可视化"><h3 class="- topic/title title topictitle3" id="ariaid-title24">5.1 运维指标可视化</h3><div class="- topic/body body"><p class="- topic/p p">DolphinDB 开发了 Grafana 数据源插件 (dolphindb-datasource)，让用户在 Grafana 面板 (dashboard) 上通过编写查询脚本、订阅流数据表的方式，与 DolphinDB 进行交互 (基于 WebSocket)，实现 DolphinDB 时序数据的可视化。dolphindb-datasource 的安装使用请参考：<a class="- topic/xref xref" href="../tools/grafana.html">Grafana 数据源连接器</a>。</p><p class="- topic/p p">完成上述部署安装后，即可使用 Grafana 可视化运维指标，本节以案例 4 监控每小时的总产量为例。</p><p class="- topic/p p">如下图所示，将案例 4 中的计算脚本输入 Grafana 即可将查询结果以图表形式输出。</p><br/><img class="- topic/image image" src="images/Iot_intelligent_O&amp;M/07.png" alt="07"/><br/><p class="- topic/p p">上述查询中，每个 panel 只能监控一个设备的总产量，如果需要监控所有设备的总产量，可将查询语句改为以下查询：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>t = select sum(propertyValue) as production_amount_hour from pt where date(ts)=2022.01.01 group by bar(ts,1H) as ts,deviceCode
select production_amount_hour from t pivot by ts,deviceCode</code></pre><p class="- topic/p p">pivot by 是 DolphinDB 的独有功能，是对标准 SQL 语句的拓展。它将表中一列或多列的内容按照两个维度重新排列，亦可配合数据转换函数使用，其使用方法详见 <a class="- topic/xref xref" href="../progr/sql/pivotBy.html">pivot by</a>。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title25" id="52-异常告警"><h3 class="- topic/title title topictitle3" id="ariaid-title25">5.2 异常告警</h3><div class="- topic/body body"><p class="- topic/p p">DolphinDB 开发了 httpClient 插件，可以便捷地进行 HTTP 请求或发送邮件，httpClient 插件的部署安装详见：<a class="- topic/xref xref" href="../plugins/httpClient/httpclient.html">HttpClient</a>。</p><p class="- topic/p p">本节将以案例 12 为例，介绍在 DolphinDB 检测出异常数据之后，如何将异常数据进行输出告警。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//加载 httpClient 插件
try{loadPlugin('./plugins/httpClient/PluginHttpClient.txt')}catch(ex){}

//定义邮件发送的订阅函数
def sendEmail(userId,pwd,recipient,mutable msg){
    ts = exec ts from msg
    propertyCode = exec propertyCode from msg
    sendMsg = string(ts)+" the propertyCode "+string(propertyCode)+" rate is greater than 1"
    sendMsg = concat(sendMsg,"&lt;br&gt;")
    httpClient::sendEmail(userId,pwd,recipient,"rate is greater than 1",sendMsg)
}

//订阅异常检测结果表发送告警
userId = 'xxxx' //发送者邮箱
pwd='xxx'//发送者邮箱密码
recipient='xxx'//接收邮箱

//订阅异常检测结果表
subscribeTable(tableName=`abnormalRes,actionName='sendEmail',offset=0,handler=sendEmail{userId,pwd,recipient},msgAsTable=true,batchSize=10000,throttle=10)</code></pre><p class="- topic/p p">上述脚本将订阅异常检测结果表，实时将异常结果以邮件形式发送给接受者，从而达到实时告警的目的。除了邮件告警的形式外，httpClient 还支持企业微信、钉钉等第三方平台，详见：<a class="- topic/xref xref" href="httpclient_msg_case.html">利用 HttpClient 插件整合外部消息</a>。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title26" id="6-附录"><h2 class="- topic/title title topictitle2" id="ariaid-title26">6 附录</h2><div class="- topic/body body"><p class="- topic/p p">完整测试代码：<a class="- topic/xref xref" href="script/Intelligent_O&amp;M_demo.dos">Intelligent_O&amp;M_demo.dos</a></p></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E9%9D%A2%E4%B8%B4%E7%9A%84%E6%8C%91%E6%88%98" data-tocid="1-智能运维面临的挑战">1 智能运维面临的挑战</a></li><li class="topic-item"><a href="#2-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" data-tocid="2-解决方案">2 解决方案</a></li><li class="topic-item"><a href="#3-%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87" data-tocid="3-前期准备">3 前期准备</a><ul><li class="topic-item"><a href="#31-%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2" data-tocid="31-安装部署">3.1 安装部署</a></li><li class="topic-item"><a href="#32-%E6%A8%A1%E6%8B%9F%E7%8E%AF%E5%A2%83" data-tocid="32-模拟环境">3.2 模拟环境</a></li></ul></li><li class="topic-item"><a href="#4-%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0" data-tocid="4-功能实现">4 功能实现</a><ul><li class="topic-item"><a href="#41-%E5%B7%A5%E4%B8%9A%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4" data-tocid="41-工业智能运维">4.1 工业智能运维</a><ul><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-1%E6%A0%B9%E6%8D%AE%E7%8A%B6%E6%80%81%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97%E8%AE%BE%E5%A4%87%E7%B4%AF%E8%AE%A1%E5%BC%80%E5%81%9C%E6%9C%BA%E6%97%B6%E9%95%BF" data-tocid="案例-1根据状态指标计算设备累计开停机时长">案例 1：根据状态指标计算设备累计开停机时长</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-2%E6%A0%B9%E6%8D%AE%E6%8C%87%E5%AE%9A%E6%97%B6%E9%97%B4%E6%AE%B5%E5%86%85%E7%8A%B6%E6%80%81%E7%AA%81%E5%8F%98%E6%AC%A1%E6%95%B0%E8%AE%A1%E7%AE%97%E7%B4%AF%E8%AE%A1%E5%BC%80%E5%81%9C%E6%9C%BA%E6%AC%A1%E6%95%B0" data-tocid="案例-2根据指定时间段内状态突变次数计算累计开停机次数">案例 2：根据指定时间段内状态突变次数计算累计开停机次数</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-3%E6%A0%B9%E6%8D%AE%E7%8A%B6%E6%80%81%E5%80%BC%E8%AE%A1%E7%AE%97%E8%AE%BE%E5%A4%87%E6%9C%80%E5%A4%A7%E6%8C%81%E7%BB%AD%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4" data-tocid="案例-3根据状态值计算设备最大持续运行时间">案例 3：根据状态值，计算设备最大持续运行时间</a></li></ul></li><li class="topic-item"><a href="#42-%E7%94%9F%E4%BA%A7%E7%9B%91%E6%8E%A7" data-tocid="42-生产监控">4.2 生产监控</a><ul><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-4%E8%AE%A1%E7%AE%97%E7%94%9F%E6%96%99%E7%A3%A8%E6%AF%8F%E5%B0%8F%E6%97%B6%E7%9A%84%E6%80%BB%E4%BA%A7%E9%87%8F" data-tocid="案例-4计算生料磨每小时的总产量">案例 4：计算生料磨每小时的总产量</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-5%E6%A0%B9%E6%8D%AE%E6%8C%87%E5%AE%9A%E6%8C%87%E6%A0%87%E8%AE%A1%E7%AE%97%E5%8F%98%E5%8C%96%E7%8E%87" data-tocid="案例-5根据指定指标计算变化率">案例 5：根据指定指标计算变化率</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-6%E6%A0%B9%E6%8D%AE%E7%94%B5%E6%B5%81%E8%AE%A1%E7%AE%97%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4%E5%86%85%E8%AE%BE%E5%A4%87%E7%9A%84%E7%B4%AF%E8%AE%A1%E7%A9%BA%E8%BD%BD%E6%97%B6%E9%97%B4" data-tocid="案例-6根据电流计算一段时间内设备的累计空载时间">案例 6：根据电流计算一段时间内设备的累计空载时间</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-7%E8%AE%A1%E7%AE%97%E6%8C%87%E5%AE%9A%E6%97%B6%E9%97%B4%E6%AE%B5%E8%8C%83%E5%9B%B4%E5%86%85%E7%AA%97%E5%8F%A3%E6%97%B6%E9%97%B4%E7%94%B5%E6%9C%BA%E8%BD%B4%E6%89%BF%E7%9A%84%E5%B9%B3%E5%9D%87%E6%B8%A9%E5%BA%A6" data-tocid="案例-7计算指定时间段范围内窗口时间电机轴承的平均温度">案例 7：计算指定时间段范围内（窗口时间）电机轴承的平均温度</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-8%E6%8C%87%E6%A0%87%E6%A0%B9%E6%8D%AE%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E4%BA%8C%E6%AC%A1%E8%AE%A1%E7%AE%97" data-tocid="案例-8指标根据表达式的二次计算">案例 8：指标根据表达式的二次计算</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-9%E5%88%86%E7%BB%84%E6%B1%87%E6%80%BB%E8%AE%A1%E7%AE%97%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89" data-tocid="案例-9分组汇总计算条件筛选">案例 9：分组汇总计算，条件筛选</a></li></ul></li><li class="topic-item"><a href="#43-%E5%AE%9E%E6%97%B6%E6%B5%81%E8%AE%A1%E7%AE%97" data-tocid="43-实时流计算">4.3 实时流计算</a><ul><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-10%E6%AF%8F%E4%B8%AA%E6%95%B4%E7%82%B9%E7%9A%84%E5%B9%B3%E5%9D%87%E5%80%BC%E7%9B%B8%E5%87%8F" data-tocid="案例-10每个整点的平均值相减">案例 10：每个整点的平均值相减</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-11%E6%A0%B9%E6%8D%AE%E7%8A%B6%E6%80%81%E7%AA%81%E5%8F%98%E6%8A%BD%E5%8F%96%E8%AE%B0%E5%BD%95%E5%AE%9E%E6%97%B6%E6%B5%81%E8%AE%A1%E7%AE%97" data-tocid="案例-11根据状态突变抽取记录实时流计算">案例 11：根据状态突变，抽取记录（实时流计算）</a></li><li class="topic-item"><a href="#%E6%A1%88%E4%BE%8B-12%E5%AE%9E%E6%97%B6%E6%A3%80%E6%B5%8B%E5%BC%82%E5%B8%B8%E5%80%BC%E4%BB%A5%E6%8C%87%E6%A0%87%E5%8F%98%E5%8C%96%E7%8E%87%E4%B8%BA%E4%BE%8B" data-tocid="案例-12实时检测异常值以指标变化率为例">案例 12：实时检测异常值，以指标变化率为例</a></li></ul></li></ul></li><li class="topic-item"><a href="#5-%E5%8F%AF%E8%A7%86%E5%8C%96%E8%BF%90%E7%BB%B4%E4%B8%8E%E5%91%8A%E8%AD%A6" data-tocid="5-可视化运维与告警">5 可视化运维与告警</a><ul><li class="topic-item"><a href="#51-%E8%BF%90%E7%BB%B4%E6%8C%87%E6%A0%87%E5%8F%AF%E8%A7%86%E5%8C%96" data-tocid="51-运维指标可视化">5.1 运维指标可视化</a></li><li class="topic-item"><a href="#52-%E5%BC%82%E5%B8%B8%E5%91%8A%E8%AD%A6" data-tocid="52-异常告警">5.2 异常告警</a></li></ul></li><li class="topic-item"><a href="#6-%E9%99%84%E5%BD%95" data-tocid="6-附录">6 附录</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>