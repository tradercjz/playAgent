<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="本文适用于 DolphinDB 如下版本： 130系列：1.30.20及以后的版本 200系列：2.00.8及以后的版本。 本教程适用于整个集群/数据库/表/分区的数据备份、恢复，以及大数据量的数据迁移。如果进行小规模的集群间数据同步，可以参考 集群间数据库在线方式 。 同2.00.8/1.30.20以前的版本的备份恢复功能相比，有如下的改进： ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="数据备份以及恢复-130202008及之后版本"/><title>数据备份以及恢复 （1.30.20/2.00.8及之后版本）</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;数据备份以及恢复-130202008及之后版本&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;数据备份以及恢复 （1.30.20/2.00.8及之后版本）&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;本文适用于 DolphinDB 如下版本：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;4:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;4:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;130系列：1.30.20及以后的版本&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;200系列：2.00.8及以后的版本。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:63;91:81&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-适用场景&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;1. 适用场景&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;本教程适用于整个集群/数据库/表/分区的数据备份、恢复，以及大数据量的数据迁移。如果进行小规模的集群间数据同步，可以参考 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;data_sync_among_clusters.md&#34; xtrc=&#34;xref:1;9:62&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;集群间数据库在线方式&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-特性&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;11:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;11:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;2. 特性&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;11:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;同2.00.8/1.30.20以前的版本的备份恢复功能相比，有如下的改进：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:1;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;15:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;DolphinDB提供了拷贝文件的备份和恢复分布式数据库的方法，大大增加了备份和恢复的性能；&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;17:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;DolphinDB利用底层的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;17:19&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backup&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;17:30&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restore&lt;/codeph&gt; 函数封装了不同场景下的备份和恢复函数。用户可以根据需要选择函数进行备份以及恢复。这大大增加了备份恢复功能的易用性；&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;19:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;DolphinDB 提供了更强大的备份文件校验功能，你可以在备份文件之后立刻检验文件的正确性以及完整性。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-模拟数据&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;3. 模拟数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;本教程对应的数据生成脚本见&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/backup_restore/buildData.txt&#34; xtrc=&#34;xref:2;23:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;附件1&lt;/xref&gt;。数据库结构如下图：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/backup_restore/dbStructure.png&#34; xtrc=&#34;image:1;25:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34; dita-ot:image-width=&#34;161&#34; dita-ot:image-height=&#34;157&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;可以看到，我们构建了两个数据库，分别是OLAP和TSDB数据库。在OLAP数据库中有两张表，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;27:47&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;quotes&lt;/codeph&gt;和&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;27:56&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;quotes_2&lt;/codeph&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;本教程各章节中使用的脚本，集合在&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/backup_restore/backup_restore.txt&#34; xtrc=&#34;xref:3;29:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;附件2&lt;/xref&gt;。&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:2;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;备份和恢复任务有两种提交方式，一种是直接在客户端运行函数启动任务，另一种是通过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;31:43&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;submitJob&lt;/codeph&gt;提交任务到后台执行。鉴于备份和恢复的使用场景通常是大数据量，所需时间较长，建议将备份和恢复任务提交到后台执行，之后的脚本也都将采用这种方式。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;后台任务的状态可以通过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;32:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getRecentJobs&lt;/codeph&gt;查询&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;数据生成脚本运行之后，将往磁盘上写150G左右的数据，所以运行此脚本，请确保有足够的磁盘容量。如果磁盘容量不够，可以调节脚本里的&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;33:68&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;smallDates&lt;/codeph&gt;变量，以减小数据量&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;4-数据备份&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;4. 数据备份&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;38:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;DolphinDB 提供了3种备份数据的方式：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;40:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;(1) 备份单个数据库的数据&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;(2) 备份单张表的数据&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;44:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;(3) 备份部分分区的数据&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;46:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;46:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;注意&lt;/b&gt;：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:3;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;到2.00.8版本，备份暂时只能将文件放在运行备份任务的数据节点所在的机器的目录下。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;49:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;DolphinDB 的备份保证了备份的是在同一时间点的数据。为此，DolphinDB在备份时会给数据加锁（如果使用backupDB则对数据库加锁，如果使用backupTable则对整个表加锁）。加锁期间数据可读但是不可写入。为了避免数据写入失败，请尽量选择没有写入任务的时候进行数据备份&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;41-备份单个数据库&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;4.1. 备份单个数据库&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;要备份单个数据库，可使用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;53:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupDB&lt;/codeph&gt;命令。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;55:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例：将数据库&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;55:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;testdb&lt;/codeph&gt;备份到&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;55:19&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;/home/$USER/backupDB&lt;/codeph&gt;目录下（其中$USER为用户名称）&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;56:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;dbPath=&#34;dfs://testdb&#34; backupDir=&#34;/home/$USER/backupDB&#34; submitJob(&#34;backupDB&#34;,&#34;backup testdb&#34;,backupDB,backupDir,dbPath)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;62:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;62:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupDB&lt;/codeph&gt; 有以下特性：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:4;64:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;64:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;支持断线续备：如果备份中断，再次运行&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;64:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupDB&lt;/codeph&gt;即可从刚才中断时正在备份的分区开始备份，已备份好的分区无需重新备份一遍。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;支持分区级别的增量备份：对于在数据库和备份文件里同时存在的分区， &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;66:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupDB&lt;/codeph&gt;会检查数据库的分区和备份文件里对应的分区的更新时间。DolphinDB 只会对更新时间不一致的分区，用数据库里的数据覆盖备份文件里的。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;备份数据和数据库备份开始时的数据一致：备份文件中存在，而数据库中不存在的分区会被从备份文件中删除；备份文件中不存在，而数据库中存在的分区将会被备份；备份文件和数据库中都存在的分区，参见&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#特性&#34; xtrc=&#34;xref:4;67:96&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;特性&lt;/xref&gt;中第2点&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;42-备份单张表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;4.2. 备份单张表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;要备份一张表，可使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;71:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupTable&lt;/codeph&gt; 命令。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例：将数据库 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;73:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;testdb&lt;/codeph&gt; 的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;73:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;quotes_2&lt;/codeph&gt; 表备份到 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:17;73:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;/home/$USER/backupTb&lt;/codeph&gt; 目录下（其中$USER为用户名称）&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;dbPath=&#34;dfs://testdb&#34; tbName=`quotes_2 backupDir=&#34;/home/$USER/backupTb&#34; submitJob(&#34;backupTable&#34;,&#34;backup quotes_2 in testdb&#34;,backupTable,backupDir,dbPath,tbName)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;81:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:18;81:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupTable&lt;/codeph&gt; 和&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:19;81:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupDB&lt;/codeph&gt;有类似的特性，只不过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:20;81:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupTable&lt;/codeph&gt;是针对分布式表的，而&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:21;81:59&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupDB&lt;/codeph&gt;是针对数据库的。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;43-备份分区&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;83:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;83:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;4.3. 备份分区&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;83:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;要备份同一个表的部分或全部分区，可以将他们的分区路径放入一个向量，并将这个向量传入backup函数中&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;87:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例：将数据库 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:22;87:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;testdb&lt;/codeph&gt; 的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:23;87:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;quotes_2&lt;/codeph&gt; 表的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:24;87:34&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;/Key3/tp/20120101&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:25;87:56&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;/Key4/tp/20120101&lt;/codeph&gt; 分区备份到 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:26;87:82&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;/home/$USER/backupPar&lt;/codeph&gt; 目录下&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;89:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;dbPath=&#34;dfs://testdb&#34; tbName=`quotes_2 backupDir=&#34;/home/$USER/backupPar&#34; pars=[&#34;/Key3/tp/20120101&#34;,&#34;/Key4/tp/20120101&#34;] submitJob(&#34;backupPartitions&#34;,&#34;backup some partitions in quotes_2 in testdb&#34;,backup,backupDir,dbPath,false,true,true,tbName,pars)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;5-备份文件检验函数&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;5. 备份文件检验函数&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;100:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;运行备份任务之后，一个很重要的步骤是检查备份是否成功完成，以及备份文件的完整性。DolphinDB提供了多个函数，用以监控备份任务、检验备份文件：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:27;102:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupStatus&lt;/codeph&gt;：可以用来查看指定用户的backup/restore任务进度&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;103:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:28;103:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupList&lt;/codeph&gt;：可以查看备份的所有分区的基本信息，&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;104:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:29;104:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupMeta&lt;/codeph&gt;：可以查看备份文件的元数据信息，包括表的schema等信息&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;105:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:30;105:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;checkBackup&lt;/codeph&gt;：可以用来检查备份文件的完整性&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;108:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;接下来我们将分别介绍这些函数，并且在最后给出检查备份文件的最佳实践。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;注意&lt;/b&gt;：以上的操作需要在进行备份任务的数据节点运行。你可以通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:31;110:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getNodeAlias&lt;/codeph&gt; 函数查看自己当前所在的数据节点别名。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;51-getbackupstatus&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;5.1. getBackupStatus&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;114:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupStatus可以用来查看指定用户的backup/restore任务进度，同时可以预估任务完成时间。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;116:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例：作为管理员使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:32;116:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupStatus&lt;/codeph&gt; 查看所有用户的 backup/restore 任务&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;117:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;login(`admin, `123456) getBackupStatus()&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;122:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;管理员调用该函数时，若指定了 userName，则返回指定用户的 backup/restore 任务；否则返回所有用户的 backup/restore 任务&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;124:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;非管理员调用该函数时，只能返回当前用户的 backup/restore 任务。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;126:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;返回如下：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/backup_restore/getBackupStatus.png&#34; xtrc=&#34;image:2;128:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34; dita-ot:image-width=&#34;1031&#34; dita-ot:image-height=&#34;76&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;130:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;这张表里会返回每个任务涉及到的数据库和表名，涉及多少个分区，当前已完成了多少分区，和完成百分比。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;132:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;如果任务还未完成，endTime会返回预估完成时间；如果任务已完成，endTime返回实际完成时间。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;注意事项：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:5;136:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;136:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;返回的表里对每张表的备份/恢复任务都有一行新纪录。例如上图的表里返回了两条记录，虽然只进行了一次备份&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;137:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupStatus只会返回这次数据节点启动之后的backup任务的进度。如果重启数据节点，之前的backup任务的进度将丢失&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;52-getbackuplist&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;139:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;139:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;5.2. getBackupList&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;139:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;141:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:33;141:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupList&lt;/codeph&gt; 会返回一个分布式表的备份信息。返回为一张表，表里包含备份文件里这个表的所有的分区。每个分区对应表中的一行。表中会有chunkID、chunkPath、版本号、每个分区包含的行数和最后一次更新的时间戳。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;143:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例：getBackupList获得&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:34;143:19&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;testdb&lt;/codeph&gt;数据库中&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:35;143:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;quotes_2&lt;/codeph&gt;的表的备份信息。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;dbPath=&#34;dfs://testdb&#34; backupDir=&#34;/home/$USER/backupDB&#34; getBackupList(backupDir,dbPath,`quotes_2)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;149:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;部分信息见下图：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/backup_restore/getBackupList.png&#34; xtrc=&#34;image:3;151:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34; dita-ot:image-width=&#34;652&#34; dita-ot:image-height=&#34;132&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;/&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;53-getbackupmeta&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;153:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;153:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;5.3. getBackupMeta&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;153:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:36;155:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupMeta&lt;/codeph&gt; 可以获得某一个分区的相关信息，比如所在的表的表结构，分区的完整路径，行数，ID，版本号等等。详情参见 &lt;xref class=&#34;- topic/xref &#34; href=&#34;../funcs/g/getBackupMeta.dita&#34; xtrc=&#34;xref:5;155:71&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB用户手册&lt;/xref&gt;&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;54-checkbackup&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;5.4. checkBackup&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;160:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:37;160:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;checkBackup&lt;/codeph&gt; 会检查备份文件中每个分区的 checksum。返回一张包含 checksum 检查不通过的分区的表。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;162:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例：检查“备份单个数据库”里的备份文件的完整性&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;163:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;dbPath=&#34;dfs://testdb&#34; backupDir=&#34;/home/$USER/backupDB&#34; checkBackup(backupDir,dbPath)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;168:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;checkBackup运行需要的时间和备份文件时所需的时间相近。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;170:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;如果发现检查不通过的分区，需要通过backup，并设定force为true强制重新备份。如果设置force=false，只会检查分区的元数据信息，那么就有可能不会重新备份有问题的分区。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;172:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;为了展示这个函数的用法，我们将做如下操作：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:6;173:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;173:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;运行 checkBackup&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;174:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;将之前备份好的文件，选取一个移动到别的目录下，并建一个同名的空文件，再运行checkBackup&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:22;175:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;将移除文件涉及的分区重新备份，并再次运行 checkBackup&lt;/li&gt;&lt;/ol&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:43;177:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;为了更快返回结果，我们选择检查OLAP数据库中 quotes_2 的备份文件：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;178:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;checkBackup(backupDir,dbPath,`quotes_2)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:44;181:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;返回为空，说明校验通过。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:45;183:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;然后将&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:38;183:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;086b0c1e-0386-95a4-4b4a-5038f4fd5d51&lt;/codeph&gt;分区中volume.col文件移除，并添加一个同名的空文件。 再次运行checkBackukp，得到结果&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/backup_restore/checkBackup.png&#34; xtrc=&#34;image:4;186:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34; dita-ot:image-width=&#34;788&#34; dita-ot:image-height=&#34;54&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:46;188:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;接下来我们将这个分区重新备份：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;189:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backup(backupDir=backupDir,dbPath=dbPath,force=true,parallel=true,snapshot=true,tableName=`quotes_2,partition=&#34;/Key4/tp/20120103&#34;)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:47;192:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;再运行checkBackup，返回为空，说明校验通过。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:48;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;所以checkBackup可以检查一个备份文件在备份完成之后是否损坏。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;55-备份文件检查最佳实践&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:14;196:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:14;196:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;5.5. 备份文件检查最佳实践&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:14;196:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:49;198:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;备份文件检查分为两个阶段，第一个阶段是备份任务结束之后，需要判断其是否正常完成。第二个阶段是在恢复之前，需要检查备份文件是否有损坏。以下的命令都需要在备份任务所在的节点执行。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;551-判断备份任务是否正常完成&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:15;200:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:15;200:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;5.5.1. 判断备份任务是否正常完成&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:15;200:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:7;202:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:23;202:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:50;202:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:39;202:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupStatus&lt;/codeph&gt;，返回备份任务信息。每一行代表一个表的备份。如果此次备份任务涉及的各行的completed列都为1，则说明任务成功。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:24;204:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:51;204:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;如果 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:40;204:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupStatus&lt;/codeph&gt; 查不到相关的表的备份信息，说明这个备份任务开始到查询期间，数据节点重启过，那么可以用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:41;204:67&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupList&lt;/codeph&gt;函数获取备份的各分区的行数，和数据库中对应的分区的行数进行比对。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:52;206:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;在2.00.9版本及之后，可以在log中查到backup成功或者失败的日志信息&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:25;208:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:53;208:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;如果您提交的是后台备份任务，可以到您配置的&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:42;208:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;homeDir/&amp;lt;nodeAlias&amp;gt;/batchJobs&lt;/codeph&gt;下寻找对应的任务。以“备份单张表”中的任务为例，可以查询&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:43;208:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;backupTable.msg&lt;/codeph&gt;，返回如下： &lt;image class=&#34;- topic/image &#34; href=&#34;images/backup_restore/1.4batchJobmsg.png&#34; xtrc=&#34;image:5;209:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34; dita-ot:image-width=&#34;716&#34; dita-ot:image-height=&#34;54&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:54;211:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;如果有&#34;The job is done.&#34; 则说明任务已完成。&lt;/p&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;552-判断备份文件是否损坏&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:16;213:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:16;213:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;5.5.2. 判断备份文件是否损坏&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:16;213:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:55;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:44;215:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;checkBackup&lt;/codeph&gt; 函数。具体方法见 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#checkbackup&#34; xtrc=&#34;xref:6;215:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;checkbackup&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;6-数据恢复&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:17;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:17;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;6. 数据恢复&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:17;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:56;219:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;现在 DolphinDB 提供了4种恢复数据的方式：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:8;221:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:26;221:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;恢复单个数据库&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:27;222:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;恢复单张表&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:28;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;恢复部分分区&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:29;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;恢复整个集群&lt;/li&gt;&lt;/ol&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:57;226:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;与备份不同，在数据恢复时，不会对涉及分区加锁。比如，在对一张表做恢复的同时，允许对这张表进行写入操作。不过我们建议在恢复的同时不要写入，否则会出现一些无法预测的行为，比如新的写入可能会留在数据库，也可能被恢复任务覆盖。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;61-恢复单个数据库&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:18;228:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:18;228:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;6.1. 恢复单个数据库&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:18;228:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:58;230:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;要恢复单个数据库的数据，可使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:45;230:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreDB&lt;/codeph&gt; 命令。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:59;232:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例1：将“备份单个数据库”中备份的数据恢复到新集群中&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;233:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;dbPath=&#34;dfs://testdb&#34; backupDir=&#34;/home/$USER/backupDB&#34; submitJob(&#34;restoreDB&#34;,&#34;restore testdb in new cluster&#34;,restoreDB,backupDir,dbPath)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:60;238:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;238:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;注意&lt;/b&gt;：此处我们只是声明了备份文件的路径和需要恢复的数据库路径，而 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:46;238:38&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreDB&lt;/codeph&gt; 函数会在新集群按照备份文件创建 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:47;238:66&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;testdb&lt;/codeph&gt; 数据库及库里所有的表，并将所有表的数据导入这个数据库&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:61;240:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;也可以将单个数据库的数据恢复到同一个集群的另一个数据库中，只需要指定数据库的路径即可：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;241:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;# 将“备份单个数据库”中备份的数据恢复到 restoredb 中 dbPath=&#34;dfs://testdb&#34; backupDir=&#34;/home/$USER/backupDB&#34; restoreDBPath=&#34;dfs://restoredb&#34; submitJob(&#34;restoreDB2&#34;,&#34;restore testdb to restoredb in the original cluster&#34;,restoreDB,backupDir,dbPath,restoreDBPath)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:62;249:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:48;249:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreDB&lt;/codeph&gt; 有以下特性：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:9;251:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:30;251:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;支持断线续恢复：如果恢复中断，再次运行 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:49;251:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreDB&lt;/codeph&gt; 即可从刚才中断时正在恢复的分区开始恢复，已恢复好的分区无需重新恢复一遍。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:31;252:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;支持分区级别的增量恢复：对于在新数据库和备份文件里同时存在的分区，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:50;252:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreDB&lt;/codeph&gt; 会检查新数据库的分区和备份文件里对应的分区的更新时间。DolphinDB 只会对更新时间不一致的分区，用备份文件里的数据覆盖新数据库里的。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:32;253:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;备份数据和新数据库恢复开始时的数据一致：备份文件中存在，而新数据库中不存在的分区会被恢复到新数据库中；备份文件中不存在，而数据库中存在的分区将会从新数据库中被删去；备份文件和数据库中都存在的分区，参见&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#特性&#34; xtrc=&#34;xref:7;253:104&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;特性&lt;/xref&gt;中第2点。&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;62-恢复单张表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:19;255:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:19;255:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;6.2. 恢复单张表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:19;255:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:63;257:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;要恢复单张表的数据，可使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:51;257:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreTable&lt;/codeph&gt; 命令。 用例1：将“备份单张表”中备份的数据恢复到新集群中&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;259:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;dbPath=&#34;dfs://testdb&#34; tbName=`quotes_2 backupDir=&#34;/home/$USER/backupTb&#34; submitJob(&#34;restoreTable&#34;,&#34;restore quotes_2 in testdb to new cluster&#34;,restoreTable,backupDir,dbPath,tbName)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:64;265:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;注意：此处我们只是声明了备份文件的路径和需要恢复的表名，而 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:52;265:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreTable&lt;/codeph&gt; 会在新集群按照备份文件创建 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:53;265:60&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;testdb&lt;/codeph&gt; 数据库和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:54;265:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;quotes&lt;/codeph&gt; 表，并将数据恢复到这张表&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:65;267:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;也可以将单张表的数据恢复到同一个集群的另一个数据库中，只需要指定数据库的路径即可：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:12;268:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;# 将&#34;备份单张表&#34;备份的数据恢复到 restoredb2 的 quotes_2 表中 dbPath=&#34;dfs://testdb&#34; tbName=`quotes_2 backupDir=&#34;/home/$USER/backupTb&#34; restoreDBPath=&#34;dfs://restoredb2&#34; submitJob(&#34;restoreTable2&#34;,&#34;restore quotes_2 in testdb to quotes_2 in restoredb&#34;,restoreTable,backupDir,dbPath,tbName,restoreDBPath)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:66;277:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;也可以将单张表的数据恢复到同一个数据库的另一张表中，只需要指定表名即可&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:13;278:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;# 将“备份单张表”中备份的数据恢复到 testdb 的 quotes_restore 表中。 dbPath=&#34;dfs://testdb&#34; tbName=`quotes_2 backupDir=&#34;/home/$USER/backupTb&#34; restoreTb=&#34;quotes_restore&#34; submitJob(&#34;restoreTable3&#34;,&#34;restore quotes_2 to quotes_restore in testdb&#34;,restoreTable,backupDir,dbPath,tbName,,restoreTb)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:67;286:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:55;286:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreTable&lt;/codeph&gt; 和&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:56;286:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreDB&lt;/codeph&gt;有类似的特性，只不过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:57;286:38&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreTable&lt;/codeph&gt;是针对分布式表的，而&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:58;286:62&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreDB&lt;/codeph&gt;是针对数据库的。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;63-恢复单个分区&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:20;288:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:20;288:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;6.3. 恢复单个分区&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:20;288:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:68;290:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;要恢复同一个表的部分分区，可以使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:59;290:19&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restore&lt;/codeph&gt; 函数。和backup备份分区时略有不同，restore中的partition参数只支持传入一个标量，这个标量中可以使用通配符，去匹配多个分区。比如，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:60;290:103&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;%/Key4/tp/%&lt;/codeph&gt; 可以匹配 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:61;290:122&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;/Key4/tp/20120101&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:62;290:142&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;/Key4/tp/20120103&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:63;290:162&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;/Key4/tp/20120104&lt;/codeph&gt;...等分区。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:69;292:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例：将&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#备份分区&#34; xtrc=&#34;xref:8;292:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;备份分区&lt;/xref&gt;中备份的分区恢复到新数据库中&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:14;294:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;dbPath=&#34;dfs://testdb&#34; backupDir=&#34;/home/$USER/backupPar&#34; tbName=`quotes_2 pars=[&#34;/testdb/Key3/tp/20120101&#34;,&#34;/testdb/Key4/tp/20120101&#34;] for (par in pars){ restore(backupDir,dbPath,tbName,par,false,,true,true) }&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;64-恢复整个集群&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:21;304:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:21;304:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;6.4. 恢复整个集群&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:21;304:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:70;306:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;如果需要将整个集群的数据进行迁移，可以先将各个数据库备份至同一个目录下，然后通过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:64;306:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;migrate&lt;/codeph&gt;函数进行恢复。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:71;308:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;用例：备份两个数据库&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:65;308:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;testdb&lt;/codeph&gt;和&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:66;308:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;testdb_tsdb&lt;/codeph&gt;至目录下，然后使用migrate在新集群恢复&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:15;309:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;//旧集群备份testdb和testdb_tsdb dbPath=&#34;dfs://testdb&#34; dbPath2=&#34;dfs://testdb_tsdb&#34; backupDir=&#34;/home/$USER/migrate&#34; submitJob(&#34;backupForMigrate&#34;,&#34;backup testdb for migrate&#34;,backupDB,backupDir,dbPath) submitJob(&#34;backupForMigrate2&#34;,&#34;backup testdb_tsdb for migrate&#34;,backupDB,backupDir,dbPath2) //备份完成后，在新集群恢复这两个数据库 backupDir=&#34;/home/$USER/migrate&#34; submitJob(&#34;migrate&#34;,&#34;migrate testdb and testdb_tsdb to new cluster&#34;,migrate,backupDir)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:72;321:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:67;321:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;migrate&lt;/codeph&gt;和&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:68;321:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;restoreDB&lt;/codeph&gt;类似，但是有如下两个区别：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:10;322:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:33;322:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;migrate可以恢复多个数据库，而restoreDB只能恢复单个数据库。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:34;323:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;当恢复后的数据库名称、表名称与原数据库、原表一致时，migrate 要求原数据库、原表已经被删除，否则无法恢复，而 restoreDB 无此限制。所以migrate无法用于增量恢复和断点续恢复，而一般用于新的集群刚部署完成的时候的数据迁移。&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;65-判断恢复任务是否正常完成&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:22;325:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:22;325:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;6.5. 判断恢复任务是否正常完成&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:22;325:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:73;327:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;恢复的任务信息也可以通过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:69;327:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupStatus&lt;/codeph&gt;查询。若要判断恢复任务是否完成，可以参考 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#判断备份任务是否正常完成&#34; xtrc=&#34;xref:9;327:51&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;判断备份任务是否正常完成&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;7-备份恢复的性能&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:23;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:23;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;7. 备份恢复的性能&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:23;329:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:74;331:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;本次性能测试使用的机器 CPU 为Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:75;333:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;使用的DolphinDB集群为 DolphinDB 普通集群，1个 controller，3个 datanode，每个 datanode 挂载1个普通SSD盘，读写速度约为500MB/s。备份文件所在的磁盘也是SSD盘，读写速度也为500MB/s。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:76;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;cluster.cfg配置如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:16;336:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;maxMemSize=256 maxConnections=512 workerNum=8 chunkCacheEngineMemSize=16 newValuePartitionPolicy=add maxPubConnections=64 subExecutors=4 subPort=8893 lanCluster=0 enableChunkGranularityConfig=true diskIOConcurrencyLevel=0&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:77;349:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;运行备份时，落库为50G大小的数据，观察备份文件所在的磁盘IO，写入速度为490MB/s左右，基本达到了磁盘的性能瓶颈。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:78;351:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;运行恢复时，因为是写入多个磁盘，我们用数据量/时间来估算写入速度。备份文件大小为50G，恢复花费了2分20秒，速度约为365MB/s，低于备份速度。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;8-常见问题&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:24;354:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:24;354:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;8. 常见问题&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:24;354:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;81-是否支持恢复到某个时间点&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:25;356:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:25;356:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;8.1. 是否支持恢复到某个时间点？&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:25;356:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:79;358:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;不支持，DolphinDB的增量备份并不是添加新的binlog，而是直接覆盖原文件。所以，增量备份功能只是跳过了不需要备份的分区，从而加速了备份，而不支持恢复到某个时间点。在 DolphinDB 中，如果你需要恢复到到一周前的任意一天，那么你需要在一周前的每一天都备份一份数据，并且放在不同的目录中。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;82-备份时所有分区的时间点是否一致&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:26;360:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:26;360:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;8.2. 备份时所有分区的时间点是否一致？&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:26;360:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:80;362:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;一致。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;83-是否支持断点续备恢复&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:27;364:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:27;364:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;8.3. 是否支持断点续备/恢复?&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:27;364:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:81;366:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;支持。具体见&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#备份单个数据库&#34; xtrc=&#34;xref:10;366:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;备份单个数据库&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;84-是否支持增量备份恢复&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:28;368:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:28;368:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;8.4. 是否支持增量备份/恢复？&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:28;368:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:82;370:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;支持。具体见&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#备份单个数据库&#34; xtrc=&#34;xref:11;370:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;备份单个数据库&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;85-如何查看备份进度&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:29;372:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:29;372:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;8.5. 如何查看备份进度？&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:29;372:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:83;374:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:70;374:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;getBackupStatus&lt;/codeph&gt; 函数。具体见&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#getbackupstatus&#34; xtrc=&#34;xref:12;374:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;getbackupstatus&lt;/xref&gt;&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;86-如何检查备份是否完成&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:30;376:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:30;376:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;8.6. 如何检查备份是否完成？&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:30;376:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:84;378:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;见&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#判断备份任务是否正常完成&#34; xtrc=&#34;xref:13;378:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;判断备份任务是否正常完成&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;87-如何检查恢复是否完成&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:31;380:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:31;380:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;8.7. 如何检查恢复是否完成？&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:31;380:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:85;382:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;见&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#判断恢复任务是否正常完成&#34; xtrc=&#34;xref:14;382:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/backup-restore-new.md&#34;&gt;&lt;?ditaot usertext?&gt;判断恢复任务是否正常完成&lt;/xref&gt;&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/backup-restore-new.md"/><meta name="wh-out-relpath" content="tutorials/backup-restore-new.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="数据备份以及恢复-130202008及之后版本" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/scheduledJob_2.html">系统运维</a></div></div></li><li class="active"><div class="topicref" data-id="数据备份以及恢复-130202008及之后版本"><div class="title"><a href="../tutorials/backup-restore-new.html">数据备份以及恢复 （1.30.20/2.00.8及之后版本）</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="定时作业-d9713e100956" class="topicref" data-id="定时作业" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="定时作业-d9713e100956-link">定时作业</a></div></div></li><li role="treeitem"><div data-tocid="作业管理-d9713e101002" class="topicref" data-id="作业管理" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/job_management_tutorial_2.html" id="作业管理-d9713e101002-link">作业管理</a></div></div></li><li role="treeitem"><div data-tocid="用户权限管理-d9713e101048" class="topicref" data-id="用户权限管理" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ACL_and_Security_2.html" id="用户权限管理-d9713e101048-link">用户权限管理</a></div></div></li><li role="treeitem" class="active"><div data-tocid="数据备份以及恢复-130202008及之后版本-d9713e101094" class="topicref" data-id="数据备份以及恢复-130202008及之后版本" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/backup-restore-new.html" id="数据备份以及恢复-130202008及之后版本-d9713e101094-link">数据备份以及恢复 （1.30.20/2.00.8及之后版本）</a></div></div></li><li role="treeitem"><div data-tocid="数据备份以及恢复-130202008以前版本-d9713e101140" class="topicref" data-id="数据备份以及恢复-130202008以前版本" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/backup_restore_before_208.html" id="数据备份以及恢复-130202008以前版本-d9713e101140-link">数据备份以及恢复 （1.30.20/2.00.8以前版本）</a></div></div></li><li role="treeitem"><div data-tocid="数据再平衡-d9713e101186" class="topicref" data-id="数据再平衡" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Data_Move_Rebalance.html" id="数据再平衡-d9713e101186-link">数据再平衡</a></div></div></li><li role="treeitem"><div data-tocid="集群间数据库同步-d9713e101232" class="topicref" data-id="集群间数据库同步" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/data_sync_among_clusters.html" id="集群间数据库同步-d9713e101232-link">集群间数据库同步</a></div></div></li><li role="treeitem"><div data-tocid="集群间异步复制-d9713e101278" class="topicref" data-id="集群间异步复制" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/async_replication.html" id="集群间异步复制-d9713e101278-link">集群间异步复制</a></div></div></li><li role="treeitem"><div data-tocid="数据导入最容易忽略的十个细节-d9713e101324" class="topicref" data-id="数据导入最容易忽略的十个细节" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/data_import_details.html" id="数据导入最容易忽略的十个细节-d9713e101324-link">数据导入最容易忽略的十个细节</a></div></div></li><li role="treeitem"><div data-tocid="线程模型-d9713e101370" class="topicref" data-id="线程模型" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/threading_model.html" id="线程模型-d9713e101370-link">线程模型</a></div></div></li><li role="treeitem"><div data-tocid="线程简介-d9713e101416" class="topicref" data-id="线程简介" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/thread_intro_2.html" id="线程简介-d9713e101416-link">线程简介</a></div></div></li><li role="treeitem"><div data-tocid="内存管理-d9713e101463" class="topicref" data-id="内存管理" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/memory_management.html" id="内存管理-d9713e101463-link">内存管理</a></div></div></li><li role="treeitem"><div data-tocid="out-of-memory-d9713e101509" class="topicref" data-id="out-of-memory" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/oom_settlement_2.html" id="out-of-memory-d9713e101509-link">Out of Memory</a></div></div></li><li role="treeitem"><div data-tocid="非标权限管理-d9713e101555" class="topicref" data-id="非标权限管理" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/non-standard_permission_management.html" id="非标权限管理-d9713e101555-link">非标权限管理</a></div></div></li><li role="treeitem"><div data-tocid="节点启动流程简析与常见问题-d9713e101601" class="topicref" data-id="节点启动流程简析与常见问题" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/node_startup_process_and_questions.html" id="节点启动流程简析与常见问题-d9713e101601-link">节点启动流程简析与常见问题</a></div></div></li><li role="treeitem"><div data-tocid="用户级别的资源跟踪详解-d9713e101647" class="topicref" data-id="用户级别的资源跟踪详解" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/user_level_resource_tracking.html" id="用户级别的资源跟踪详解-d9713e101647-link">用户级别的资源跟踪详解</a></div></div></li><li role="treeitem"><div data-tocid="使用-prometheus-监控告警-d9713e101693" class="topicref" data-id="使用-prometheus-监控告警" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/promethues2.html" id="使用-prometheus-监控告警-d9713e101693-link">使用 Prometheus 监控告警</a></div></div></li><li role="treeitem"><div data-tocid="redash-连接-dolphindb-数据源-d9713e101739" class="topicref" data-id="redash-连接-dolphindb-数据源" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/data_interface_for_redash.html" id="redash-连接-dolphindb-数据源-d9713e101739-link">Redash 连接 DolphinDB 数据源</a></div></div></li><li role="treeitem"><div data-tocid="使用-chart-组件展示数据-d9713e101785" class="topicref" data-id="使用-chart-组件展示数据" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/web_chart_integration.html" id="使用-chart-组件展示数据-d9713e101785-link">使用 chart 组件展示数据</a></div></div></li><li role="treeitem"><div data-tocid="debezium--kafka-实时同步-oracle-11g-数据到-dolphindb-运维手册-d9713e101831" class="topicref" data-id="debezium--kafka-实时同步-oracle-11g-数据到-dolphindb-运维手册" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/debezium_kafka_real_time_synchronization_of_oracle_11g_data.html" id="debezium--kafka-实时同步-oracle-11g-数据到-dolphindb-运维手册-d9713e101831-link">Debezium + Kafka 实时同步 Oracle 11g 数据到 DolphinDB 运维手册</a></div></div></li><li role="treeitem"><div data-tocid="基于_zabbix_的_dolphindb_集群运维监控-d9713e101877" class="topicref" data-id="基于_zabbix_的_dolphindb_集群运维监控" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/zabbix_cluster_monitoring.html" id="基于_zabbix_的_dolphindb_集群运维监控-d9713e101877-link">基于 Zabbix 的 DolphinDB 集群运维监控</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">数据备份以及恢复 （1.30.20/2.00.8及之后版本）</h1><div class="- topic/body body"><p class="- topic/p p">本文适用于 DolphinDB 如下版本：</p><ul class="- topic/ul ul"><li class="- topic/li li">130系列：1.30.20及以后的版本</li><li class="- topic/li li">200系列：2.00.8及以后的版本。</li></ul></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-适用场景"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. 适用场景</h2><div class="- topic/body body"><p class="- topic/p p">本教程适用于整个集群/数据库/表/分区的数据备份、恢复，以及大数据量的数据迁移。如果进行小规模的集群间数据同步，可以参考 <a class="- topic/xref xref" href="data_sync_among_clusters.html">集群间数据库在线方式</a>。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="2-特性"><h2 class="- topic/title title topictitle2" id="ariaid-title3">2. 特性</h2><div class="- topic/body body"><p class="- topic/p p">同2.00.8/1.30.20以前的版本的备份恢复功能相比，有如下的改进：</p><ol class="- topic/ol ol"><li class="- topic/li li"><p class="- topic/p p">DolphinDB提供了拷贝文件的备份和恢复分布式数据库的方法，大大增加了备份和恢复的性能；</p></li><li class="- topic/li li"><p class="- topic/p p">DolphinDB利用底层的 <code class="+ topic/ph pr-d/codeph ph codeph">backup</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">restore</code> 函数封装了不同场景下的备份和恢复函数。用户可以根据需要选择函数进行备份以及恢复。这大大增加了备份恢复功能的易用性；</p></li><li class="- topic/li li"><p class="- topic/p p">DolphinDB 提供了更强大的备份文件校验功能，你可以在备份文件之后立刻检验文件的正确性以及完整性。</p></li></ol></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title4" id="3-模拟数据"><h2 class="- topic/title title topictitle2" id="ariaid-title4">3. 模拟数据</h2><div class="- topic/body body"><p class="- topic/p p">本教程对应的数据生成脚本见<a class="- topic/xref xref" href="script/backup_restore/buildData.txt">附件1</a>。数据库结构如下图：</p><img class="- topic/image image" src="images/backup_restore/dbStructure.png"/><br/><p class="- topic/p p">可以看到，我们构建了两个数据库，分别是OLAP和TSDB数据库。在OLAP数据库中有两张表，<code class="+ topic/ph pr-d/codeph ph codeph">quotes</code>和<code class="+ topic/ph pr-d/codeph ph codeph">quotes_2</code>。</p><p class="- topic/p p">本教程各章节中使用的脚本，集合在<a class="- topic/xref xref" href="script/backup_restore/backup_restore.txt">附件2</a>。</p><ol class="- topic/ol ol"><li class="- topic/li li">备份和恢复任务有两种提交方式，一种是直接在客户端运行函数启动任务，另一种是通过<code class="+ topic/ph pr-d/codeph ph codeph">submitJob</code>提交任务到后台执行。鉴于备份和恢复的使用场景通常是大数据量，所需时间较长，建议将备份和恢复任务提交到后台执行，之后的脚本也都将采用这种方式。</li><li class="- topic/li li">后台任务的状态可以通过<code class="+ topic/ph pr-d/codeph ph codeph">getRecentJobs</code>查询</li><li class="- topic/li li">数据生成脚本运行之后，将往磁盘上写150G左右的数据，所以运行此脚本，请确保有足够的磁盘容量。如果磁盘容量不够，可以调节脚本里的<code class="+ topic/ph pr-d/codeph ph codeph">smallDates</code>变量，以减小数据量</li></ol></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title5" id="4-数据备份"><h2 class="- topic/title title topictitle2" id="ariaid-title5">4. 数据备份</h2><div class="- topic/body body"><p class="- topic/p p">DolphinDB 提供了3种备份数据的方式：</p><p class="- topic/p p">(1) 备份单个数据库的数据</p><p class="- topic/p p">(2) 备份单张表的数据</p><p class="- topic/p p">(3) 备份部分分区的数据</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：</p><ol class="- topic/ol ol"><li class="- topic/li li">到2.00.8版本，备份暂时只能将文件放在运行备份任务的数据节点所在的机器的目录下。</li><li class="- topic/li li">DolphinDB 的备份保证了备份的是在同一时间点的数据。为此，DolphinDB在备份时会给数据加锁（如果使用backupDB则对数据库加锁，如果使用backupTable则对整个表加锁）。加锁期间数据可读但是不可写入。为了避免数据写入失败，请尽量选择没有写入任务的时候进行数据备份</li></ol></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title6" id="41-备份单个数据库"><h3 class="- topic/title title topictitle3" id="ariaid-title6">4.1. 备份单个数据库</h3><div class="- topic/body body"><p class="- topic/p p">要备份单个数据库，可使用<code class="+ topic/ph pr-d/codeph ph codeph">backupDB</code>命令。</p><p class="- topic/p p">用例：将数据库<code class="+ topic/ph pr-d/codeph ph codeph">testdb</code>备份到<code class="+ topic/ph pr-d/codeph ph codeph">/home/$USER/backupDB</code>目录下（其中$USER为用户名称）</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbPath="dfs://testdb"
backupDir="/home/$USER/backupDB"
submitJob("backupDB","backup testdb",backupDB,backupDir,dbPath)</code></pre><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">backupDB</code> 有以下特性：</p><ol class="- topic/ol ol"><li class="- topic/li li">支持断线续备：如果备份中断，再次运行<code class="+ topic/ph pr-d/codeph ph codeph">backupDB</code>即可从刚才中断时正在备份的分区开始备份，已备份好的分区无需重新备份一遍。</li><li class="- topic/li li">支持分区级别的增量备份：对于在数据库和备份文件里同时存在的分区，
<code class="+ topic/ph pr-d/codeph ph codeph">backupDB</code>会检查数据库的分区和备份文件里对应的分区的更新时间。DolphinDB 只会对更新时间不一致的分区，用数据库里的数据覆盖备份文件里的。</li><li class="- topic/li li">备份数据和数据库备份开始时的数据一致：备份文件中存在，而数据库中不存在的分区会被从备份文件中删除；备份文件中不存在，而数据库中存在的分区将会被备份；备份文件和数据库中都存在的分区，参见<a class="- topic/xref xref" href="#%E7%89%B9%E6%80%A7">特性</a>中第2点</li></ol></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title7" id="42-备份单张表"><h3 class="- topic/title title topictitle3" id="ariaid-title7">4.2. 备份单张表</h3><div class="- topic/body body"><p class="- topic/p p">要备份一张表，可使用 <code class="+ topic/ph pr-d/codeph ph codeph">backupTable</code> 命令。</p><p class="- topic/p p">用例：将数据库 <code class="+ topic/ph pr-d/codeph ph codeph">testdb</code> 的 <code class="+ topic/ph pr-d/codeph ph codeph">quotes_2</code> 表备份到 <code class="+ topic/ph pr-d/codeph ph codeph">/home/$USER/backupTb</code> 目录下（其中$USER为用户名称）</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbPath="dfs://testdb"
tbName=`quotes_2
backupDir="/home/$USER/backupTb"
submitJob("backupTable","backup quotes_2 in testdb",backupTable,backupDir,dbPath,tbName)</code></pre><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">backupTable</code> 和<code class="+ topic/ph pr-d/codeph ph codeph">backupDB</code>有类似的特性，只不过<code class="+ topic/ph pr-d/codeph ph codeph">backupTable</code>是针对分布式表的，而<code class="+ topic/ph pr-d/codeph ph codeph">backupDB</code>是针对数据库的。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title8" id="43-备份分区"><h3 class="- topic/title title topictitle3" id="ariaid-title8">4.3. 备份分区</h3><div class="- topic/body body"><p class="- topic/p p">要备份同一个表的部分或全部分区，可以将他们的分区路径放入一个向量，并将这个向量传入backup函数中</p><p class="- topic/p p">用例：将数据库 <code class="+ topic/ph pr-d/codeph ph codeph">testdb</code> 的 <code class="+ topic/ph pr-d/codeph ph codeph">quotes_2</code> 表的 <code class="+ topic/ph pr-d/codeph ph codeph">/Key3/tp/20120101</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">/Key4/tp/20120101</code> 分区备份到 <code class="+ topic/ph pr-d/codeph ph codeph">/home/$USER/backupPar</code> 目录下</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbPath="dfs://testdb"
tbName=`quotes_2
backupDir="/home/$USER/backupPar"
pars=["/Key3/tp/20120101","/Key4/tp/20120101"]
submitJob("backupPartitions","backup some partitions in quotes_2 in testdb",backup,backupDir,dbPath,false,true,true,tbName,pars)</code></pre></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title9" id="5-备份文件检验函数"><h2 class="- topic/title title topictitle2" id="ariaid-title9">5. 备份文件检验函数</h2><div class="- topic/body body"><p class="- topic/p p">运行备份任务之后，一个很重要的步骤是检查备份是否成功完成，以及备份文件的完整性。DolphinDB提供了多个函数，用以监控备份任务、检验备份文件：</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">getBackupStatus</code>：可以用来查看指定用户的backup/restore任务进度</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">getBackupList</code>：可以查看备份的所有分区的基本信息，</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">getBackupMeta</code>：可以查看备份文件的元数据信息，包括表的schema等信息</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">checkBackup</code>：可以用来检查备份文件的完整性</li></ul><p class="- topic/p p">接下来我们将分别介绍这些函数，并且在最后给出检查备份文件的最佳实践。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：以上的操作需要在进行备份任务的数据节点运行。你可以通过 <code class="+ topic/ph pr-d/codeph ph codeph">getNodeAlias</code> 函数查看自己当前所在的数据节点别名。</p></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title10" id="51-getbackupstatus"><h3 class="- topic/title title topictitle3" id="ariaid-title10">5.1. getBackupStatus</h3><div class="- topic/body body"><p class="- topic/p p">getBackupStatus可以用来查看指定用户的backup/restore任务进度，同时可以预估任务完成时间。</p><p class="- topic/p p">用例：作为管理员使用 <code class="+ topic/ph pr-d/codeph ph codeph">getBackupStatus</code> 查看所有用户的 backup/restore 任务</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>login(`admin, `123456)
getBackupStatus()</code></pre><p class="- topic/p p">管理员调用该函数时，若指定了 userName，则返回指定用户的 backup/restore 任务；否则返回所有用户的 backup/restore 任务</p><p class="- topic/p p">非管理员调用该函数时，只能返回当前用户的 backup/restore 任务。</p><p class="- topic/p p">返回如下：</p><img class="- topic/image image" src="images/backup_restore/getBackupStatus.png"/><br/><p class="- topic/p p">这张表里会返回每个任务涉及到的数据库和表名，涉及多少个分区，当前已完成了多少分区，和完成百分比。</p><p class="- topic/p p">如果任务还未完成，endTime会返回预估完成时间；如果任务已完成，endTime返回实际完成时间。</p><p class="- topic/p p">注意事项：</p><ol class="- topic/ol ol"><li class="- topic/li li">返回的表里对每张表的备份/恢复任务都有一行新纪录。例如上图的表里返回了两条记录，虽然只进行了一次备份</li><li class="- topic/li li">getBackupStatus只会返回这次数据节点启动之后的backup任务的进度。如果重启数据节点，之前的backup任务的进度将丢失</li></ol></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title11" id="52-getbackuplist"><h3 class="- topic/title title topictitle3" id="ariaid-title11">5.2. getBackupList</h3><div class="- topic/body body"><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">getBackupList</code> 会返回一个分布式表的备份信息。返回为一张表，表里包含备份文件里这个表的所有的分区。每个分区对应表中的一行。表中会有chunkID、chunkPath、版本号、每个分区包含的行数和最后一次更新的时间戳。</p><p class="- topic/p p">用例：getBackupList获得<code class="+ topic/ph pr-d/codeph ph codeph">testdb</code>数据库中<code class="+ topic/ph pr-d/codeph ph codeph">quotes_2</code>的表的备份信息。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbPath="dfs://testdb"
backupDir="/home/$USER/backupDB"
getBackupList(backupDir,dbPath,`quotes_2)</code></pre><p class="- topic/p p">部分信息见下图：</p><img class="- topic/image image" src="images/backup_restore/getBackupList.png"/><br/></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title12" id="53-getbackupmeta"><h3 class="- topic/title title topictitle3" id="ariaid-title12">5.3. getBackupMeta</h3><div class="- topic/body body"><p class="- topic/p p">使用 <code class="+ topic/ph pr-d/codeph ph codeph">getBackupMeta</code> 可以获得某一个分区的相关信息，比如所在的表的表结构，分区的完整路径，行数，ID，版本号等等。详情参见 <a class="- topic/xref xref" href="../funcs/g/getBackupMeta.html">DolphinDB用户手册</a></p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title13" id="54-checkbackup"><h3 class="- topic/title title topictitle3" id="ariaid-title13">5.4. checkBackup</h3><div class="- topic/body body"><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">checkBackup</code> 会检查备份文件中每个分区的 checksum。返回一张包含 checksum 检查不通过的分区的表。</p><p class="- topic/p p">用例：检查“备份单个数据库”里的备份文件的完整性</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbPath="dfs://testdb"
backupDir="/home/$USER/backupDB"
checkBackup(backupDir,dbPath)</code></pre><p class="- topic/p p">checkBackup运行需要的时间和备份文件时所需的时间相近。</p><p class="- topic/p p">如果发现检查不通过的分区，需要通过backup，并设定force为true强制重新备份。如果设置force=false，只会检查分区的元数据信息，那么就有可能不会重新备份有问题的分区。</p><p class="- topic/p p">为了展示这个函数的用法，我们将做如下操作：</p><ol class="- topic/ol ol"><li class="- topic/li li">运行 checkBackup</li><li class="- topic/li li">将之前备份好的文件，选取一个移动到别的目录下，并建一个同名的空文件，再运行checkBackup</li><li class="- topic/li li">将移除文件涉及的分区重新备份，并再次运行 checkBackup</li></ol><p class="- topic/p p">为了更快返回结果，我们选择检查OLAP数据库中 quotes_2 的备份文件：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>checkBackup(backupDir,dbPath,`quotes_2)</code></pre><p class="- topic/p p">返回为空，说明校验通过。</p><p class="- topic/p p">然后将<code class="+ topic/ph pr-d/codeph ph codeph">086b0c1e-0386-95a4-4b4a-5038f4fd5d51</code>分区中volume.col文件移除，并添加一个同名的空文件。
再次运行checkBackukp，得到结果</p><img class="- topic/image image" src="images/backup_restore/checkBackup.png"/><br/><p class="- topic/p p">接下来我们将这个分区重新备份：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>backup(backupDir=backupDir,dbPath=dbPath,force=true,parallel=true,snapshot=true,tableName=`quotes_2,partition="/Key4/tp/20120103")</code></pre><p class="- topic/p p">再运行checkBackup，返回为空，说明校验通过。</p><p class="- topic/p p">所以checkBackup可以检查一个备份文件在备份完成之后是否损坏。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title14" id="55-备份文件检查最佳实践"><h3 class="- topic/title title topictitle3" id="ariaid-title14">5.5. 备份文件检查最佳实践</h3><div class="- topic/body body"><p class="- topic/p p">备份文件检查分为两个阶段，第一个阶段是备份任务结束之后，需要判断其是否正常完成。第二个阶段是在恢复之前，需要检查备份文件是否有损坏。以下的命令都需要在备份任务所在的节点执行。</p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title15" id="551-判断备份任务是否正常完成"><h4 class="- topic/title title topictitle4" id="ariaid-title15">5.5.1. 判断备份任务是否正常完成</h4><div class="- topic/body body"><ol class="- topic/ol ol"><li class="- topic/li li"><p class="- topic/p p">使用 <code class="+ topic/ph pr-d/codeph ph codeph">getBackupStatus</code>，返回备份任务信息。每一行代表一个表的备份。如果此次备份任务涉及的各行的completed列都为1，则说明任务成功。</p></li><li class="- topic/li li"><p class="- topic/p p">如果 <code class="+ topic/ph pr-d/codeph ph codeph">getBackupStatus</code> 查不到相关的表的备份信息，说明这个备份任务开始到查询期间，数据节点重启过，那么可以用<code class="+ topic/ph pr-d/codeph ph codeph">getBackupList</code>函数获取备份的各分区的行数，和数据库中对应的分区的行数进行比对。</p><p class="- topic/p p">在2.00.9版本及之后，可以在log中查到backup成功或者失败的日志信息</p></li><li class="- topic/li li"><div class="- topic/p p">如果您提交的是后台备份任务，可以到您配置的<code class="+ topic/ph pr-d/codeph ph codeph">homeDir/&lt;nodeAlias&gt;/batchJobs</code>下寻找对应的任务。以“备份单张表”中的任务为例，可以查询<code class="+ topic/ph pr-d/codeph ph codeph">backupTable.msg</code>，返回如下：
<img class="- topic/image image" src="images/backup_restore/1.4batchJobmsg.png"/><br/><p class="- topic/p p">如果有"The job is done." 则说明任务已完成。</p></div></li></ol></div><article class="- topic/topic topic nested4" aria-labelledby="ariaid-title16" id="552-判断备份文件是否损坏"><h5 class="- topic/title title topictitle5" id="ariaid-title16">5.5.2. 判断备份文件是否损坏</h5><div class="- topic/body body"><p class="- topic/p p">使用 <code class="+ topic/ph pr-d/codeph ph codeph">checkBackup</code> 函数。具体方法见 <a class="- topic/xref xref" href="#checkbackup">checkbackup</a>。</p></div></article></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title17" id="6-数据恢复"><h3 class="- topic/title title topictitle3" id="ariaid-title17">6. 数据恢复</h3><div class="- topic/body body"><p class="- topic/p p">现在 DolphinDB 提供了4种恢复数据的方式：</p><ol class="- topic/ol ol"><li class="- topic/li li">恢复单个数据库</li><li class="- topic/li li">恢复单张表</li><li class="- topic/li li">恢复部分分区</li><li class="- topic/li li">恢复整个集群</li></ol><p class="- topic/p p">与备份不同，在数据恢复时，不会对涉及分区加锁。比如，在对一张表做恢复的同时，允许对这张表进行写入操作。不过我们建议在恢复的同时不要写入，否则会出现一些无法预测的行为，比如新的写入可能会留在数据库，也可能被恢复任务覆盖。</p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title18" id="61-恢复单个数据库"><h4 class="- topic/title title topictitle4" id="ariaid-title18">6.1. 恢复单个数据库</h4><div class="- topic/body body"><p class="- topic/p p">要恢复单个数据库的数据，可使用 <code class="+ topic/ph pr-d/codeph ph codeph">restoreDB</code> 命令。</p><p class="- topic/p p">用例1：将“备份单个数据库”中备份的数据恢复到新集群中</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbPath="dfs://testdb"
backupDir="/home/$USER/backupDB"
submitJob("restoreDB","restore testdb in new cluster",restoreDB,backupDir,dbPath)</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：此处我们只是声明了备份文件的路径和需要恢复的数据库路径，而 <code class="+ topic/ph pr-d/codeph ph codeph">restoreDB</code> 函数会在新集群按照备份文件创建 <code class="+ topic/ph pr-d/codeph ph codeph">testdb</code> 数据库及库里所有的表，并将所有表的数据导入这个数据库</p><p class="- topic/p p">也可以将单个数据库的数据恢复到同一个集群的另一个数据库中，只需要指定数据库的路径即可：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code># 将“备份单个数据库”中备份的数据恢复到 restoredb 中
dbPath="dfs://testdb"
backupDir="/home/$USER/backupDB"
restoreDBPath="dfs://restoredb"
submitJob("restoreDB2","restore testdb to restoredb in the original cluster",restoreDB,backupDir,dbPath,restoreDBPath)</code></pre><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">restoreDB</code> 有以下特性：</p><ol class="- topic/ol ol"><li class="- topic/li li">支持断线续恢复：如果恢复中断，再次运行 <code class="+ topic/ph pr-d/codeph ph codeph">restoreDB</code> 即可从刚才中断时正在恢复的分区开始恢复，已恢复好的分区无需重新恢复一遍。</li><li class="- topic/li li">支持分区级别的增量恢复：对于在新数据库和备份文件里同时存在的分区，<code class="+ topic/ph pr-d/codeph ph codeph">restoreDB</code> 会检查新数据库的分区和备份文件里对应的分区的更新时间。DolphinDB 只会对更新时间不一致的分区，用备份文件里的数据覆盖新数据库里的。</li><li class="- topic/li li">备份数据和新数据库恢复开始时的数据一致：备份文件中存在，而新数据库中不存在的分区会被恢复到新数据库中；备份文件中不存在，而数据库中存在的分区将会从新数据库中被删去；备份文件和数据库中都存在的分区，参见<a class="- topic/xref xref" href="#%E7%89%B9%E6%80%A7">特性</a>中第2点。</li></ol></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title19" id="62-恢复单张表"><h4 class="- topic/title title topictitle4" id="ariaid-title19">6.2. 恢复单张表</h4><div class="- topic/body body"><p class="- topic/p p">要恢复单张表的数据，可使用 <code class="+ topic/ph pr-d/codeph ph codeph">restoreTable</code> 命令。
用例1：将“备份单张表”中备份的数据恢复到新集群中</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbPath="dfs://testdb"
tbName=`quotes_2
backupDir="/home/$USER/backupTb"
submitJob("restoreTable","restore quotes_2 in testdb to new cluster",restoreTable,backupDir,dbPath,tbName)</code></pre><p class="- topic/p p">注意：此处我们只是声明了备份文件的路径和需要恢复的表名，而 <code class="+ topic/ph pr-d/codeph ph codeph">restoreTable</code> 会在新集群按照备份文件创建 <code class="+ topic/ph pr-d/codeph ph codeph">testdb</code> 数据库和 <code class="+ topic/ph pr-d/codeph ph codeph">quotes</code> 表，并将数据恢复到这张表</p><p class="- topic/p p">也可以将单张表的数据恢复到同一个集群的另一个数据库中，只需要指定数据库的路径即可：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code># 将"备份单张表"备份的数据恢复到 restoredb2 的 quotes_2 表中
dbPath="dfs://testdb"
tbName=`quotes_2
backupDir="/home/$USER/backupTb"
restoreDBPath="dfs://restoredb2"
submitJob("restoreTable2","restore quotes_2 in testdb to quotes_2 in restoredb",restoreTable,backupDir,dbPath,tbName,restoreDBPath)</code></pre><p class="- topic/p p">也可以将单张表的数据恢复到同一个数据库的另一张表中，只需要指定表名即可</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code># 将“备份单张表”中备份的数据恢复到 testdb 的 quotes_restore 表中。
dbPath="dfs://testdb"
tbName=`quotes_2
backupDir="/home/$USER/backupTb"
restoreTb="quotes_restore"
submitJob("restoreTable3","restore quotes_2 to quotes_restore in testdb",restoreTable,backupDir,dbPath,tbName,,restoreTb)</code></pre><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">restoreTable</code> 和<code class="+ topic/ph pr-d/codeph ph codeph">restoreDB</code>有类似的特性，只不过<code class="+ topic/ph pr-d/codeph ph codeph">restoreTable</code>是针对分布式表的，而<code class="+ topic/ph pr-d/codeph ph codeph">restoreDB</code>是针对数据库的。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title20" id="63-恢复单个分区"><h4 class="- topic/title title topictitle4" id="ariaid-title20">6.3. 恢复单个分区</h4><div class="- topic/body body"><p class="- topic/p p">要恢复同一个表的部分分区，可以使用 <code class="+ topic/ph pr-d/codeph ph codeph">restore</code> 函数。和backup备份分区时略有不同，restore中的partition参数只支持传入一个标量，这个标量中可以使用通配符，去匹配多个分区。比如，<code class="+ topic/ph pr-d/codeph ph codeph">%/Key4/tp/%</code> 可以匹配 <code class="+ topic/ph pr-d/codeph ph codeph">/Key4/tp/20120101</code>，<code class="+ topic/ph pr-d/codeph ph codeph">/Key4/tp/20120103</code>，<code class="+ topic/ph pr-d/codeph ph codeph">/Key4/tp/20120104</code>...等分区。</p><p class="- topic/p p">用例：将<a class="- topic/xref xref" href="#%E5%A4%87%E4%BB%BD%E5%88%86%E5%8C%BA">备份分区</a>中备份的分区恢复到新数据库中</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbPath="dfs://testdb"
backupDir="/home/$USER/backupPar"
tbName=`quotes_2
pars=["/testdb/Key3/tp/20120101","/testdb/Key4/tp/20120101"]
for (par in pars){
	restore(backupDir,dbPath,tbName,par,false,,true,true)
}</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title21" id="64-恢复整个集群"><h4 class="- topic/title title topictitle4" id="ariaid-title21">6.4. 恢复整个集群</h4><div class="- topic/body body"><p class="- topic/p p">如果需要将整个集群的数据进行迁移，可以先将各个数据库备份至同一个目录下，然后通过<code class="+ topic/ph pr-d/codeph ph codeph">migrate</code>函数进行恢复。</p><p class="- topic/p p">用例：备份两个数据库<code class="+ topic/ph pr-d/codeph ph codeph">testdb</code>和<code class="+ topic/ph pr-d/codeph ph codeph">testdb_tsdb</code>至目录下，然后使用migrate在新集群恢复</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//旧集群备份testdb和testdb_tsdb
dbPath="dfs://testdb"
dbPath2="dfs://testdb_tsdb"
backupDir="/home/$USER/migrate"
submitJob("backupForMigrate","backup testdb for migrate",backupDB,backupDir,dbPath)
submitJob("backupForMigrate2","backup testdb_tsdb for migrate",backupDB,backupDir,dbPath2)

//备份完成后，在新集群恢复这两个数据库
backupDir="/home/$USER/migrate"
submitJob("migrate","migrate testdb and testdb_tsdb to new cluster",migrate,backupDir)</code></pre><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">migrate</code>和<code class="+ topic/ph pr-d/codeph ph codeph">restoreDB</code>类似，但是有如下两个区别：</p><ol class="- topic/ol ol"><li class="- topic/li li">migrate可以恢复多个数据库，而restoreDB只能恢复单个数据库。</li><li class="- topic/li li">当恢复后的数据库名称、表名称与原数据库、原表一致时，migrate 要求原数据库、原表已经被删除，否则无法恢复，而 restoreDB 无此限制。所以migrate无法用于增量恢复和断点续恢复，而一般用于新的集群刚部署完成的时候的数据迁移。</li></ol></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title22" id="65-判断恢复任务是否正常完成"><h4 class="- topic/title title topictitle4" id="ariaid-title22">6.5. 判断恢复任务是否正常完成</h4><div class="- topic/body body"><p class="- topic/p p">恢复的任务信息也可以通过<code class="+ topic/ph pr-d/codeph ph codeph">getBackupStatus</code>查询。若要判断恢复任务是否完成，可以参考 <a class="- topic/xref xref" href="#%E5%88%A4%E6%96%AD%E5%A4%87%E4%BB%BD%E4%BB%BB%E5%8A%A1%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8%E5%AE%8C%E6%88%90">判断备份任务是否正常完成</a>。</p></div></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title23" id="7-备份恢复的性能"><h3 class="- topic/title title topictitle3" id="ariaid-title23">7. 备份恢复的性能</h3><div class="- topic/body body"><p class="- topic/p p">本次性能测试使用的机器 CPU 为Intel(R) Xeon(R) Silver 4314 CPU @ 2.40GHz</p><p class="- topic/p p">使用的DolphinDB集群为 DolphinDB 普通集群，1个 controller，3个 datanode，每个 datanode 挂载1个普通SSD盘，读写速度约为500MB/s。备份文件所在的磁盘也是SSD盘，读写速度也为500MB/s。</p><p class="- topic/p p">cluster.cfg配置如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>maxMemSize=256
maxConnections=512
workerNum=8
chunkCacheEngineMemSize=16
newValuePartitionPolicy=add
maxPubConnections=64
subExecutors=4
subPort=8893
lanCluster=0
enableChunkGranularityConfig=true
diskIOConcurrencyLevel=0</code></pre><p class="- topic/p p">运行备份时，落库为50G大小的数据，观察备份文件所在的磁盘IO，写入速度为490MB/s左右，基本达到了磁盘的性能瓶颈。</p><p class="- topic/p p">运行恢复时，因为是写入多个磁盘，我们用数据量/时间来估算写入速度。备份文件大小为50G，恢复花费了2分20秒，速度约为365MB/s，低于备份速度。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title24" id="8-常见问题"><h3 class="- topic/title title topictitle3" id="ariaid-title24">8. 常见问题</h3><div class="- topic/body body"></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title25" id="81-是否支持恢复到某个时间点"><h4 class="- topic/title title topictitle4" id="ariaid-title25">8.1. 是否支持恢复到某个时间点？</h4><div class="- topic/body body"><p class="- topic/p p">不支持，DolphinDB的增量备份并不是添加新的binlog，而是直接覆盖原文件。所以，增量备份功能只是跳过了不需要备份的分区，从而加速了备份，而不支持恢复到某个时间点。在 DolphinDB 中，如果你需要恢复到到一周前的任意一天，那么你需要在一周前的每一天都备份一份数据，并且放在不同的目录中。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title26" id="82-备份时所有分区的时间点是否一致"><h4 class="- topic/title title topictitle4" id="ariaid-title26">8.2. 备份时所有分区的时间点是否一致？</h4><div class="- topic/body body"><p class="- topic/p p">一致。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title27" id="83-是否支持断点续备恢复"><h4 class="- topic/title title topictitle4" id="ariaid-title27">8.3. 是否支持断点续备/恢复?</h4><div class="- topic/body body"><p class="- topic/p p">支持。具体见<a class="- topic/xref xref" href="#%E5%A4%87%E4%BB%BD%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93">备份单个数据库</a>。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title28" id="84-是否支持增量备份恢复"><h4 class="- topic/title title topictitle4" id="ariaid-title28">8.4. 是否支持增量备份/恢复？</h4><div class="- topic/body body"><p class="- topic/p p">支持。具体见<a class="- topic/xref xref" href="#%E5%A4%87%E4%BB%BD%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93">备份单个数据库</a>。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title29" id="85-如何查看备份进度"><h4 class="- topic/title title topictitle4" id="ariaid-title29">8.5. 如何查看备份进度？</h4><div class="- topic/body body"><p class="- topic/p p">使用 <code class="+ topic/ph pr-d/codeph ph codeph">getBackupStatus</code> 函数。具体见<a class="- topic/xref xref" href="#getbackupstatus">getbackupstatus</a></p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title30" id="86-如何检查备份是否完成"><h4 class="- topic/title title topictitle4" id="ariaid-title30">8.6. 如何检查备份是否完成？</h4><div class="- topic/body body"><p class="- topic/p p">见<a class="- topic/xref xref" href="#%E5%88%A4%E6%96%AD%E5%A4%87%E4%BB%BD%E4%BB%BB%E5%8A%A1%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8%E5%AE%8C%E6%88%90">判断备份任务是否正常完成</a>。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title31" id="87-如何检查恢复是否完成"><h4 class="- topic/title title topictitle4" id="ariaid-title31">8.7. 如何检查恢复是否完成？</h4><div class="- topic/body body"><p class="- topic/p p">见<a class="- topic/xref xref" href="#%E5%88%A4%E6%96%AD%E6%81%A2%E5%A4%8D%E4%BB%BB%E5%8A%A1%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8%E5%AE%8C%E6%88%90">判断恢复任务是否正常完成</a></p></div></article></article></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF" data-tocid="1-适用场景">1. 适用场景</a></li><li class="topic-item"><a href="#2-%E7%89%B9%E6%80%A7" data-tocid="2-特性">2. 特性</a></li><li class="topic-item"><a href="#3-%E6%A8%A1%E6%8B%9F%E6%95%B0%E6%8D%AE" data-tocid="3-模拟数据">3. 模拟数据</a></li><li class="topic-item"><a href="#4-%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD" data-tocid="4-数据备份">4. 数据备份</a><ul><li class="topic-item"><a href="#41-%E5%A4%87%E4%BB%BD%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93" data-tocid="41-备份单个数据库">4.1. 备份单个数据库</a></li><li class="topic-item"><a href="#42-%E5%A4%87%E4%BB%BD%E5%8D%95%E5%BC%A0%E8%A1%A8" data-tocid="42-备份单张表">4.2. 备份单张表</a></li><li class="topic-item"><a href="#43-%E5%A4%87%E4%BB%BD%E5%88%86%E5%8C%BA" data-tocid="43-备份分区">4.3. 备份分区</a></li></ul></li><li class="topic-item"><a href="#5-%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E6%A3%80%E9%AA%8C%E5%87%BD%E6%95%B0" data-tocid="5-备份文件检验函数">5. 备份文件检验函数</a><ul><li class="topic-item"><a href="#51-getbackupstatus" data-tocid="51-getbackupstatus">5.1. getBackupStatus</a></li><li class="topic-item"><a href="#52-getbackuplist" data-tocid="52-getbackuplist">5.2. getBackupList</a></li><li class="topic-item"><a href="#53-getbackupmeta" data-tocid="53-getbackupmeta">5.3. getBackupMeta</a></li><li class="topic-item"><a href="#54-checkbackup" data-tocid="54-checkbackup">5.4. checkBackup</a></li><li class="topic-item"><a href="#55-%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E6%A3%80%E6%9F%A5%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" data-tocid="55-备份文件检查最佳实践">5.5. 备份文件检查最佳实践</a><ul><li class="topic-item"><a href="#551-%E5%88%A4%E6%96%AD%E5%A4%87%E4%BB%BD%E4%BB%BB%E5%8A%A1%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8%E5%AE%8C%E6%88%90" data-tocid="551-判断备份任务是否正常完成">5.5.1. 判断备份任务是否正常完成</a><ul><li class="topic-item"><a href="#552-%E5%88%A4%E6%96%AD%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E6%8D%9F%E5%9D%8F" data-tocid="552-判断备份文件是否损坏">5.5.2. 判断备份文件是否损坏</a></li></ul></li></ul></li><li class="topic-item"><a href="#6-%E6%95%B0%E6%8D%AE%E6%81%A2%E5%A4%8D" data-tocid="6-数据恢复">6. 数据恢复</a><ul><li class="topic-item"><a href="#61-%E6%81%A2%E5%A4%8D%E5%8D%95%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93" data-tocid="61-恢复单个数据库">6.1. 恢复单个数据库</a></li><li class="topic-item"><a href="#62-%E6%81%A2%E5%A4%8D%E5%8D%95%E5%BC%A0%E8%A1%A8" data-tocid="62-恢复单张表">6.2. 恢复单张表</a></li><li class="topic-item"><a href="#63-%E6%81%A2%E5%A4%8D%E5%8D%95%E4%B8%AA%E5%88%86%E5%8C%BA" data-tocid="63-恢复单个分区">6.3. 恢复单个分区</a></li><li class="topic-item"><a href="#64-%E6%81%A2%E5%A4%8D%E6%95%B4%E4%B8%AA%E9%9B%86%E7%BE%A4" data-tocid="64-恢复整个集群">6.4. 恢复整个集群</a></li><li class="topic-item"><a href="#65-%E5%88%A4%E6%96%AD%E6%81%A2%E5%A4%8D%E4%BB%BB%E5%8A%A1%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8%E5%AE%8C%E6%88%90" data-tocid="65-判断恢复任务是否正常完成">6.5. 判断恢复任务是否正常完成</a></li></ul></li><li class="topic-item"><a href="#7-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E7%9A%84%E6%80%A7%E8%83%BD" data-tocid="7-备份恢复的性能">7. 备份恢复的性能</a></li><li class="topic-item"><a href="#8-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" data-tocid="8-常见问题">8. 常见问题</a><ul><li class="topic-item"><a href="#81-%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81%E6%81%A2%E5%A4%8D%E5%88%B0%E6%9F%90%E4%B8%AA%E6%97%B6%E9%97%B4%E7%82%B9" data-tocid="81-是否支持恢复到某个时间点">8.1. 是否支持恢复到某个时间点？</a></li><li class="topic-item"><a href="#82-%E5%A4%87%E4%BB%BD%E6%97%B6%E6%89%80%E6%9C%89%E5%88%86%E5%8C%BA%E7%9A%84%E6%97%B6%E9%97%B4%E7%82%B9%E6%98%AF%E5%90%A6%E4%B8%80%E8%87%B4" data-tocid="82-备份时所有分区的时间点是否一致">8.2. 备份时所有分区的时间点是否一致？</a></li><li class="topic-item"><a href="#83-%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81%E6%96%AD%E7%82%B9%E7%BB%AD%E5%A4%87%E6%81%A2%E5%A4%8D" data-tocid="83-是否支持断点续备恢复">8.3. 是否支持断点续备/恢复?</a></li><li class="topic-item"><a href="#84-%E6%98%AF%E5%90%A6%E6%94%AF%E6%8C%81%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D" data-tocid="84-是否支持增量备份恢复">8.4. 是否支持增量备份/恢复？</a></li><li class="topic-item"><a href="#85-%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E5%A4%87%E4%BB%BD%E8%BF%9B%E5%BA%A6" data-tocid="85-如何查看备份进度">8.5. 如何查看备份进度？</a></li><li class="topic-item"><a href="#86-%E5%A6%82%E4%BD%95%E6%A3%80%E6%9F%A5%E5%A4%87%E4%BB%BD%E6%98%AF%E5%90%A6%E5%AE%8C%E6%88%90" data-tocid="86-如何检查备份是否完成">8.6. 如何检查备份是否完成？</a></li><li class="topic-item"><a href="#87-%E5%A6%82%E4%BD%95%E6%A3%80%E6%9F%A5%E6%81%A2%E5%A4%8D%E6%98%AF%E5%90%A6%E5%AE%8C%E6%88%90" data-tocid="87-如何检查恢复是否完成">8.7. 如何检查恢复是否完成？</a></li></ul></li></ul></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>