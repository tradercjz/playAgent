<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="DolphinDB 支持通过动态加载用 C++ 编写的插件程序，通过执行 DolphinDB 脚本函数，来调用插件程序的自定义函数，实现自定义功能扩展。 DolphinDB 的 httpClient插件提供以下 3 个函数，用于发送 HTTP 请求和发送邮件。 httpGet : 发送http的Get方法请求。 httpPost : 发送http的Post方法请求。 sendEmail : ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../plugins/httpClient/httpclient.md"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="利用-httpclient-插件整合外部消息"/><title>利用 HttpClient 插件整合外部消息</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;利用-httpclient-插件整合外部消息&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;利用 HttpClient 插件整合外部消息&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;DolphinDB 支持通过动态加载用 C++ 编写的插件程序，通过执行 DolphinDB 脚本函数，来调用插件程序的自定义函数，实现自定义功能扩展。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;DolphinDB 的 httpClient插件提供以下 3 个函数，用于发送 HTTP 请求和发送邮件。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;6:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;6:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;6:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt;: 发送http的Get方法请求。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;7:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost&lt;/codeph&gt;: 发送http的Post方法请求。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;8:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;sendEmail&lt;/codeph&gt;: 发送邮件。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;本文介绍如何通过 httpClient 插件的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;10:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt; 与 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;10:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost&lt;/codeph&gt; 插件函数实现企业微信发送群聊消息、钉钉发送群聊消息，通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;10:77&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;sendEmail&lt;/codeph&gt; 插件函数发送文本邮件。&lt;/p&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:34;50:82&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_plugins.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../plugins/httpClient/httpclient.md&#34; mapclass=&#34;- map/topicref &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:33;49:77&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_plugins.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot gentext?&gt;HttpClient&lt;/linktext&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;在-dolphindb-中加载-httpclient-插件&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;在 DolphinDB 中加载 httpClient 插件&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;linux&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;Linux&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;需要有 libPluginHttpClient.so 和 PluginHttpClient.txt 两个插件程序文件。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;注：可以在&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://gitee.com/dolphindb/DolphinDBPlugin/tree/release200/httpClient&#34; scope=&#34;external&#34; xtrc=&#34;xref:1;19:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;httpClient 插件项目&lt;/xref&gt;的 /bin/linux/ 目录下找到这两个文件，但需要注意分支版本号需要与所用的 DolphinDB server 版本相同。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;确认 PluginHttpClient.txt 和 libPluginHttpClient.so 在同一目录下，执行以下脚本来加载插件：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;22:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;loadPlugin(&#34;&amp;lt;PluginDir&amp;gt;/httpClient/bin/linux64/PluginHttpClient.txt&#34;);&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;三种外部消息平台的使用&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;三种外部消息平台的使用&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;企业微信消息通信的演示案例&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;企业微信消息通信的演示案例&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;以下我们演示一个企业微信发送群聊应用信息的案例。创建一个企业群聊，然后发送群聊信息。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;注意&lt;/b&gt;：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;如果已经有一个群聊并且有群聊标识id，则不需要创建群聊。群聊标识号一定需要通过创建群聊获取。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;46:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;如果需要创建一个企业群聊，需要设置应用的可见范围为根部门。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;在企业微信中，调用不同的http请求API都需要有不同的的请求地址(url)。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;49:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;参考：&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90135/90665&#34; scope=&#34;external&#34; xtrc=&#34;xref:2;49:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;企业微信corpid、userid、部门id、tagid、agentid、secret、access_token&lt;/xref&gt;&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;企业微信内自建新应用&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;企业微信内自建新应用&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90135/90226&#34; scope=&#34;external&#34; xtrc=&#34;xref:3;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:3;54:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;54:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;首先,添加自建应用。管理员账号登录 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome_baidu&#34; scope=&#34;external&#34; xtrc=&#34;xref:4;54:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;企业微信管理端&lt;/xref&gt; -&amp;gt; 应用与小程序 -&amp;gt; 应用 -&amp;gt; 自建，点击“创建应用”，设置应用logo、应用名称等信息，创建应用。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;55:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;创建完成后，在管理端的应用列表里进入该应用，可以看到 Agentid、Secret 等信息，这些信息在使用企业微信 API 时会用到。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;获取-access-token&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;获取 access_token&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;58:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90135/91039&#34; scope=&#34;external&#34; xtrc=&#34;xref:5;58:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:4;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;59:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;access_token 是应用调用 API 的凭证，由 corpid 和 corpsecret 换取。 &lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;60:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;注意&lt;/b&gt;：access_token 的时效为 7200 秒。需要缓存 access_token，用于后续接口的调用（不能频繁调用 gettoken 接口，否则会受到频率拦截）。当 access_token 失效或过期时，可通过查看返回正文的 errocode 来确定，需要重新获取，应实现 access_token 失效时重新获取的逻辑。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;61:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;每个企业都拥有唯一的 corpid。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;62:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;62:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;每个应用都有相应的 corpsecret，用对应应用的 corpsecret 获取的 access_token 就拥有该应用的权限。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;63:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式： GET（HTTPS）&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;65:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址： https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=ID&amp;amp;corpsecret=SECRET&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;这里使用 httpClient 插件函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;67:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet(url,params,timeout,headers)&lt;/codeph&gt;。当前步骤不需要添加 http 请求头，只填写前面 3 个参数。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:5;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url 只需要填写 'https://qyapi.weixin.qq.com/cgi-bin/gettoken', 后面的 corpid 和 corpsecret 参数通过 httpGet 方法中的 param 参数就可以补充完整。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;70:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param 是一个键值对都是 string 的字典。 参数 corpid 的值 (ID) 为企业 ID，corpsecret 的值 (SECRET) 为对应应用的凭证密钥，两个值都需要以字符串的形式加入到 param中。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;timeout 为超时时间，单位为毫秒，数据类型为整型。达到超时时间后 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;71:39&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt; 会直接返回，无论是否收到 HTTP 应答报文。因为这是一个远程网络请求，超时时间最好设置为 1000 毫秒或以上。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数 url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;76:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = 'https://qyapi.weixin.qq.com/cgi-bin/gettoken';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;79:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数 param，ID 和 SECRET 都需要更换为真实的 corpid 和 corpsecret。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;80:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param=dict(string,string); ID='xxxxx'; SECRET='xxxxx'; param['corpid']=ID; param['corpsecret']=SECRET;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;87:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;87:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt; 函数向企业微信发送请求：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;88:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpGet(url,param,1000); print ret['text'];&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;返回值 ret 是一个 dictionary，ret['text'] 是响应正文。如果请求成功，返回的 json 格式的正文 ret['text'] 如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;94:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{ &#34;errcode&#34; : 0, &#34;errmsg&#34; : &#34;ok&#34;, &#34;access_token&#34; : &#34;xxxxxx&#34;, &#34;expires_in&#34; : 7200 } &lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;注意&lt;/b&gt;：errcode 是向企业微信请求信息的错误码，如果请求成功，返回值是 0。不同于 HTTP 协议的请求返回的响应码。如果出现其他 errcode 值，查看错误信息 errmsg。errcode 的值的含义可查看 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90139/90313&#34; scope=&#34;external&#34; xtrc=&#34;xref:6;102:114&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;企业微信错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;104:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;这里我们使用：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;105:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); ERRCODE=body.errcode; ERRMSG=body.errmsg;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;就可以便捷地把 errcode 和 errmsg 解析出来。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;access_token 的值在后续步骤中会用到。如果 errcode 的值为 0，则可以获取到 access_token。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ACCESS_TOKEN=body.access_token;&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;发送应用消息&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;116:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;116:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;发送应用消息&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;116:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;118:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90135/90248&#34; scope=&#34;external&#34; xtrc=&#34;xref:7;118:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;120:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;通过这个步骤，可以在企业微信内发送应用消息。 需要一个 access_token 和一个应用 id(AgentId)。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;123:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，如果返回的 json 正文的 errcode 的值为 40014，则表明 access_token 过期了，需要重新重新获取 access_token。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:6;125:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;125:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;125:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式： POST（HTTPS）&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;127:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址：https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=ACCESS_TOKEN&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;129:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;使用 httpClient 中的函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;129:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost(url,params,timeout,headers)&lt;/codeph&gt;。这里不需要添加 http 请求头，只填写前面 3 个参数。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;132:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，相较于 HTTP 协议的 get 方法，post 方法的参数都是放在请求正文中的，httpPost 方法的 param 参数是填写在 http 报文中的正文部分。在这里，需要补充完整 url。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:7;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;完整的 url：&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;135:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=ACCESS_TOKEN&lt;/codeblock&gt;其中 ACCESS_TOKEN 应该替换为需要发送消息应用的 access_token，由第二个步骤获取。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;139:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;参数都是以json的格式放在post请求正文中。&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;140:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{ &#34;touser&#34; : &#34;@all&#34;, &#34;agentid&#34; : xxxx, &#34;msgtype&#34; : &#34;text&#34;, &#34;text&#34; : { &#34;content&#34; : &#34;This is a test message&#34; } }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:8;150:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;150:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;touser：指定接收消息的成员，成员ID列表。这里我们使用特殊值&#34;@all&#34;,只需要设置好这个应用的可见范围即可向特定的部门、接受人发送消息。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;151:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;msgtype：消息类型。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;152:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;agentid：企业应用的id，整型。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:22;153:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;text：消息正文。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:9;157:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:23;157:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;需要把ACCESS_TOKEN更换成由第二个步骤获得的access_token。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:24;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;作为示例，我们这里发送的消息类型仅是文本信息，还可以有图片信息、视频信息、语音信息等等。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;160:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数 url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;162:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = 'https://qyapi.weixin.qq.com/cgi-bin/message/send?'; ACCESS_TOKEN='xxxxx'; url+='access_token='+ACCESS_TOKEN;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;167:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数 param：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;169:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param='{&#34;touser&#34; : &#34;@all&#34;,&#34;agentid&#34; : xxxx,&#34;msgtype&#34; : &#34;text&#34;,&#34;text&#34; : {&#34;content&#34; : &#34;这是一条测试信息&#34;}';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;172:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;172:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost&lt;/codeph&gt; 在企业微信发送应用消息：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:12;174:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpPost(url,param,1000); print ret['text'];&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;178:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;如果请求成功，企业微信返回的 json 格式正文如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:13;179:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{ &#34;errcode&#34; : 0, &#34;errmsg&#34; : &#34;ok&#34;, }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;185:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;185:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;注意&lt;/b&gt;：errcode 是向企业微信请求信息的错误码，如果请求成功，返回值是 0。不同于 HTTP 协议的请求返回的响应码。如果出现其他 errcode 值，查看错误信息 errmsg。errcode 的值的含义可查看 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90139/90313&#34; scope=&#34;external&#34; xtrc=&#34;xref:8;185:114&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;企业微信错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;187:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;可以通过以下dolphindb脚本从json格式字符串中取出errcode。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:14;188:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); ERRCODE=body.errcode;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;192:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;192:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;注意&lt;/b&gt;：如果部分接收人无权限或不存在，发送仍然执行，但会返回无效的部分（即 invaliduser、invalidparty、invalidtag字段），需要设置应用的可见范围。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;发送群聊消息&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;发送群聊消息&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;创建企业群聊&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;195:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;195:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;创建企业群聊&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;195:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;196:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90135/90245&#34; scope=&#34;external&#34; xtrc=&#34;xref:9;196:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:10;197:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:25;197:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;通过这个步骤，我们创建了一个企业群聊，可以获得一个群聊 id(chatid)。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:26;198:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;设置应用的可见范围是根目录，没有设置会返回 errcode(60011)。可以到应用管理找到这个自建应用，单击这个应用，会跳转到这个应用的详情页面，可以在这个页面编辑这个应用的可见范围。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:27;199:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;首先需要有由第二个步骤获得的 access_token。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:43;201:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，如果返回的 json 正文的 errcode 的值为 40014，则表明 access_token 过期了，需要重新到第二个步骤重新获取 access_token。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:11;203:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:28;203:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:44;203:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式： POST（HTTPS）&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:45;205:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址： https://qyapi.weixin.qq.com/cgi-bin/appchat/create?access_token=ACCESS_TOKEN&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:46;207:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求参数：http正文json格式&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:15;209:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt; {&#34;name&#34; : &#34;NAME&#34;,&#34;owner&#34; : &#34;userid1&#34;,&#34;userlist&#34; : [&#34;userid1&#34;, &#34;userid2&#34;, &#34;userid3&#34;],&#34;chatid&#34; : &#34;CHATID&#34;}&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:47;213:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;这里使用 httpClient 中的函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;213:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost(url,params,timeout,headers)&lt;/codeph&gt;。当前步骤不需要添加 http 请求头，只填写前面 3 个参数。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:48;215:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，相较于http协议的 get 方法，post 方法的参数都是放在请求正文中的，httpPost 方法的 param 参数是填写在 http 报文中的正文部分。在这里，我们需要自行补充完整 url。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:29;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:49;217:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url 需要填写 'https://qyapi.weixin.qq.com/cgi-bin/appchat/create?access_token=ACCESS_TOKEN'。access_token的值(ACCESS_TOKEN)由第二个步骤获得。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:30;218:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:50;218:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param 填写上面的 json 格式，每一个参数值都需要更替为实际参数。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:12;219:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:31;219:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;name：群聊名字。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:32;220:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;owner：群主id。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:33;221:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;userlist：群成员id(userid)列表。每个成员都有唯一的userid。在企业微信网页，管理后台-&amp;gt;“通讯录”-&amp;gt;点进某个成员的详情页，可以看到。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:34;222:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;chatid：群聊标识id。可以指定，也可以不填让系统随机创建，允许字符0-9及字母a-z和A-Z。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:35;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:51;223:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;timeout为超时时间，单位为毫秒，数据类型为整型。达到超时时间后&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;223:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost&lt;/codeph&gt;会直接返回，无论是否收到http应答报文。因为这是一个远程网络请求，超时时间最好设置为1000毫秒或以上。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:52;225:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:53;227:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数 url：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:54;229:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;其中，ACCESS_TOKEN 由第二个步骤获得，param 中每个参数都需要实际的参数。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:16;231:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = 'https://qyapi.weixin.qq.com/cgi-bin/appchat/create?'; url+='access_token='+ACCESS_TOKEN;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:55;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数param。&#34;NAME&#34;,&#34;userid1&#34;,&#34;userid2&#34;,&#34;userid3&#34;,&#34;CHATID&#34;都需要填写为实际的值。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:17;236:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param='{&#34;name&#34; : &#34;NAME&#34;,&#34;owner&#34; : &#34;userid1&#34;,&#34;userlist&#34; : [&#34;userid1&#34;, &#34;userid2&#34;, &#34;userid3&#34;]，&#34;chatid&#34; : &#34;CHATID&#34;}';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:56;239:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用httpPost向企业微信发送创建群聊的请求：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:18;241:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpPost(url,param,1000); print ret['text'];&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:57;245:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;返回值ret是一个dictionary，ret['text']是响应正文。如果请求成功，返回的json格式的正文text如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:19;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt; { &#34;errcode&#34; : 0, &#34;errmsg&#34; : &#34;ok&#34;, &#34;chatid&#34; : &#34;CHATID&#34; }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:58;254:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，errcode 是向企业微信请求信息的错误码，如果请求成功，返回值是 0。不同于 http 协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90139/90313&#34; scope=&#34;external&#34; xtrc=&#34;xref:10;254:106&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;企业微信错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:59;256:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;chatid 的值后面步骤需要用到。这里我们使用：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:20;257:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); ERRCODE=body.errcode; CHATID=body.access_token;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:60;262:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;就可以便捷地把 chatid 和 errcode 的值解析出来。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;利用-post-请求发送群聊消息&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;264:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;264:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;利用 post 请求发送群聊消息&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;264:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:61;265:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90135/90248&#34; scope=&#34;external&#34; xtrc=&#34;xref:11;265:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:62;267:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;通过这最后一个步骤，我们就可以成功地在企业微信内发送群聊信息。 首先，需要一个 access_token 还有一个群聊 id(chatid)，可以通过上一个步骤获得。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:63;270:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，如果返回的 json 正文的 errcode 的值为 40014，则表明 access_token 过期了，需要重新到上一个步骤重新获取access_token。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:13;272:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:36;272:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:64;272:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式： POST（HTTPS）&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:65;274:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址： https://qyapi.weixin.qq.com/cgi-bin/appchat/send?access_token=ACCESS_TOKEN&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:66;276:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;使用httpClient中的函数httpPost(url,params,timeout,headers)。这里不需要添加http请求头，只填写前面3个参数。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:67;278:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，相较于http协议的get方法，post方法的参数都是放在请求正文中的，httpPost方法的param参数是填写在http报文中的正文部分。在这里，需要补充完整url。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:37;280:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:68;280:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;完整的url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:21;281:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;https://qyapi.weixin.qq.com/cgi-bin/appchat/send?access_token=ACCESS_TOKEN,&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:69;284:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;其中ACCESS_TOKEN应该替换为需要发送消息应用的access_token，由第二个步骤获取。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:38;285:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:70;285:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;参数都是以json的格式放在post请求正文中。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:22;286:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{&#34;chatid&#34; : &#34;CHATID&#34;,&#34;msgtype&#34; : &#34;text&#34;,&#34;text&#34; : {&#34;content&#34; : &#34;这是一条测试信息&#34;}}&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:14;289:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:39;289:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;chatid：群聊id，可由上一个步骤获得。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:40;290:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;msgtype：消息类型。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:41;291:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;text：消息正文。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:71;293:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:15;295:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:42;295:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;需要把ACCESS_TOKEN更换成由第二个步骤获得的access_token，CHATID更换成第上一个步骤通过创建群聊获得的chatid。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:43;296:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;作为示例，我们这里发送的消息类型仅是文本信息，还可以有图片信息、视频信息、语音信息等等。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:72;298:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数 url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:23;299:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = 'https://qyapi.weixin.qq.com/cgi-bin/appchat/send?'; ACCESS_TOKEN='xxxxx'; url+='access_token='+ACCESS_TOKEN;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:73;304:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数 param：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:24;305:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param='{&#34;chatid&#34; : &#34;CHATID&#34;,&#34;msgtype&#34; : &#34;text&#34;,&#34;text&#34; : {&#34;content&#34; : &#34;这是一条测试信息&#34;}}';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:74;308:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;308:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost&lt;/codeph&gt; 向企业微信群聊发送消息：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:25;309:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpPost(url,param,1000); print ret['text'];&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:75;313:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;如果请求成功，企业微信返回的json格式正文类似如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:26;314:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{ &#34;errcode&#34; : 0, &#34;errmsg&#34; : &#34;ok&#34;, &#34;invaliduser&#34; : &#34;&#34;, &#34;invalidparty&#34; : &#34;1&#34; }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:76;323:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，errcode 是向企业微信请求信息的错误码，如果请求成功，返回值是 0。不同于 HTTP 协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://work.weixin.qq.com/api/doc/90000/90139/90313&#34; scope=&#34;external&#34; xtrc=&#34;xref:12;323:106&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;企业微信错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:77;325:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;可以通过以下dolphindb脚本从json格式字符串中取出 errcode。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:27;326:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); ERRCODE=body.errcode;&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;钉钉消息通信的演示案例&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;331:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;331:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;钉钉消息通信的演示案例&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;331:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:78;333:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;以下演示一个钉钉发送群聊应用信息的案例。创建一个企业群聊，然后发送群聊信息。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:79;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;注意&lt;/b&gt;：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:16;336:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:44;336:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;如果已经有一个群聊并且有群聊标识id，则不需要创建群聊。群聊标识号一定需要通过创建群聊获取。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:45;337:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用不同的http请求API都需要有不同的的请求地址(url)。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:80;339:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;相比于企业微信，钉钉的进行http的API调用的时候都需要以下的更多的如下操作。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:17;340:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:46;340:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;开通相关的权限。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:47;341:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;设置服务器的出口公网ip地址。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:48;342:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;需要在创建一个群聊时需要多步单次调用多个接口，无法直接到网页端查到每个成员的UserId。首先通过部门查询，然后通过查询该部门下的成员信息得到UserId，最后通过UserId列表创建一个群聊。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:81;344:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/bgb96b/mzd9qg&#34; scope=&#34;external&#34; xtrc=&#34;xref:13;344:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;钉钉CorpId, UserId, UnionId, AppKey, AppSecret, AccessToken, AgentId, AppId, AppSecret的介绍。&lt;/xref&gt;&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;创建企业内部开发应用申请接口调用权限&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;346:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;346:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;创建企业内部开发应用，申请接口调用权限&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;346:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:82;347:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/serverapi2/eev437&#34; scope=&#34;external&#34; xtrc=&#34;xref:14;347:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:83;349:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;首先创建一个微应用。使用钉钉企业管理员账号登录&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://oa.dingtalk.com/?redirect=http%3A%2F%2Foa.dingtalk.com%2Fomp%2Fapi%2Fmicro_app%2Fadmin%2Flanding%3Fcorpid%3Dopen-dev.dingtalk.com%26redirect_url%3Dhttp%3A%2F%2Fopen-dev.dingtalk.com%2F#/login&#34; scope=&#34;external&#34; xtrc=&#34;xref:15;349:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;钉钉开发者后台网站&lt;/xref&gt;，在应用开发页面，选择企业内部开发 &amp;gt; H5微应用，然后单击创建应用,填写应用名称、应用描述和补充应用图标，然后单击确定创建。创建应用可获得appkey，appsecret，在获取access_token中需要用到。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:84;351:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;还需要在这个应用的信息管理页面，设置服务器出口IP，为输入调用钉钉服务端API时使用的IP即企业服务器的公网IP，多个IP请以&#34;,&#34;隔开，支持带一个*号通配符的IP格式。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:85;353:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;需要用到的权限就需要在钉钉开发者平台网页上&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/serverapi2/rnomdt&#34; scope=&#34;external&#34; xtrc=&#34;xref:16;353:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;开启权限&lt;/xref&gt;。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:18;354:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:49;354:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;需要获取部门id，然后通过这个部门号去获取当前部门所有的人的详情--需要通讯录只读权限。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:50;355:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;通过以上获取到的部门id，人员id，创建一个企业群聊--需要企业会话权限。 然后就可以实现利用httpClient插件中的httpGet和httpPost方法向一个企业群聊中发送消息。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;获取access-token&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:14;358:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:14;358:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;获取access_token&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:14;358:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:86;359:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/serverapi2/eev437&#34; scope=&#34;external&#34; xtrc=&#34;xref:17;359:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:19;360:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:51;360:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;access_token是应用调用API的凭证，由 appkey和appsecret换取。&lt;/li&gt;&lt;/ul&gt;&lt;lq class=&#34;- topic/lq &#34; xtrc=&#34;lq:1;361:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:87;361:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，access_token的时效为7200秒。需要缓存access_token，用于后续接口的调用（注意：不能频繁调用gettoken接口，否则会受到频率拦截）。当access_token失效或过期时，需要重新获取，应实现access_token失效时重新获取的逻辑。&lt;/p&gt;&lt;/lq&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:20;362:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:52;362:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:88;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;不同应用都有相应的appkey和appsecret。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:53;363:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:89;363:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式：GET（HTTPS）&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:90;365:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址：https://oapi.dingtalk.com/gettoken?appkey=key&amp;amp;appsecret=secret&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:91;367:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;这里使用httpClient中的函数httpGet(url,params,timeout,headers)。不需要添加http请求头，只需要填写前3个参数。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:21;368:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:54;368:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;参数appkey的值(key)为应用的标识号，appsecret的值(secret)为对应应用的凭证密钥。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:55;369:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url在这里只需要填写'https://oapi.dingtalk.com/gettoken'，后面的appkey和appsecret参数通过httpGet方法中的param参数就可以填写。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:56;370:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param是一个键值对都是string的字典。 参数appkey的值(key)为对应应用id，appsecret的值(secret)为对应应用的凭证密钥，两个值都需要以字符串的形式加入到param中。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:57;371:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;timeout为超时时间，单位为毫秒，数据类型为整型。达到超时时间后&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;371:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt;会直接返回，无论是否收到http应答报文。因为这是一个远程网络请求，超时时间最好设置为1000毫秒或以上。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:92;373:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:93;375:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:28;376:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = 'https://oapi.dingtalk.com/gettoken';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:94;379:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数param：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:29;380:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param=dict(string,string); key='xxxxx'; secret='xxxxx'; param['appkey']=key; param['appsecret']=secret;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:95;387:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;387:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt;向钉钉发送申请access_token的信息：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:30;388:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpGet(url,param,1000); print ret['text'];&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:96;392:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;返回值ret是一个dictionary，ret['text']是响应正文。如果请求成功，返回的json格式的正文ret['text']如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:31;393:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{ &#34;errcode&#34; : 0, &#34;errmsg&#34; : &#34;ok&#34;, &#34;access_token&#34; : &#34;xxxxx&#34; }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:97;400:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg&#34; scope=&#34;external&#34; xtrc=&#34;xref:18;400:104&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;钉钉开发错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:98;402:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;access_token的值后续步骤需要用到。这里我们使用：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:32;403:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); ACCESS_TOKEN=body.access_token; ERRCODE=body.errcode;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:99;408:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;就可以便捷地把access_token和errcode解析出来。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;发送群聊消息-1&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:15;410:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:15;410:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;发送群聊消息&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:15;410:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;获取部门列表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:16;411:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:16;411:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;获取部门列表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:16;411:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:100;413:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/serverapi2/dubakq&#34; scope=&#34;external&#34; xtrc=&#34;xref:19;413:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:22;415:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:58;415:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:101;415:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式：GET（HTTPS）&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:102;417:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址：https://oapi.dingtalk.com/department/list?access_token=ACCESS_TOKEN&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:59;418:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:103;418:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;需要有由第二个步骤获得的access_token。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:60;419:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:104;419:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;参数以json的格式放在请求正文中。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:33;420:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{&#34;fetch_child&#34; : true}&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:23;423:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:61;423:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;fetch_child: 是否递归部门的全部子部门&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:105;425:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:106;427:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:34;428:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = 'https://oapi.dingtalk.com/department/list';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:107;431:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数param,ACCESS_TOKEN需要替换为由第二个步骤获得的access_token。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:35;432:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param=dict(string,string); ACCESS_TOKEN='xxxxx'; param['access_token']=ACCESS_TOKEN;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:108;437:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:17;437:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt;向钉钉发送查询部门信息的请求：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:36;438:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpGet(url,param,1000); print ret['text'];&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:109;442:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;返回值ret是一个dictionary，ret['text']是响应正文。 如果请求成功，返回的json格式的正文text类似：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:37;444:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{ &#34;errcode&#34; : 0,&#34;errmsg&#34; : &#34;ok&#34;,&#34;department&#34; : [ { &#34;id&#34; : 123, &#34;name&#34; : &#34;服务端开发组&#34;, &#34;parentid&#34; : 2, &#34;createDeptGroup&#34; : false, &#34;autoAddUser&#34; : false, &#34;ext&#34; : &#34;{\&#34;deptNo\&#34; : 2}&#34; } ] }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:110;458:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg&#34; scope=&#34;external&#34; xtrc=&#34;xref:20;458:104&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;钉钉开发错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:111;460:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;字段id的值就是部门id，后面的步骤需要用到。这里我们使用：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:38;461:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); DEPTID=string(body[0].id); ERRCODE=body.errcode;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:112;466:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;就可以便捷地把id和errcode解析出来。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;获取部门下成员详情&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:17;468:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:17;468:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;获取部门下成员详情&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:17;468:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:113;469:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/serverapi2/ege851&#34; scope=&#34;external&#34; xtrc=&#34;xref:21;469:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:114;471:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式：GET（HTTPS）&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:39;473:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址：https://oapi.dingtalk.com/user/getDeptMember?access_token=ACCESS_TOKEN&amp;amp;deptId=1&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:24;474:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:62;474:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;首先我们需要有由第二个步骤获得的access_token。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:63;475:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;deptId是部门id，可以通过上一个步骤获得。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:115;477:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;这里使用httpClient中的函数httpGet(url,params,timeout,headers)。不需要添加http请求头，只需要填写前3个参数。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:25;478:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:64;478:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url只需要填写'https://oapi.dingtalk.com/user/getDeptMember'，后面的access_token和deptId参数通过httpGet方法中的param参数就可以填写。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:65;479:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param是一个键值对都是string的字典。 参数access_token的值(ACCESS_TOKEN)为请求接口凭证，deptId的值为部门id，两个值都需要以字符串的形式加入到param中。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:66;480:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;timeout为超时时间，单位为毫秒，数据类型为整型。达到超时时间后&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:18;480:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt;会直接返回，无论是否收到http应答报文。因为这是一个远程网络请求，超时时间最好设置为1000毫秒或以上。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:116;482:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:117;484:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:40;485:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = 'https://oapi.dingtalk.com/user/getDeptMember';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:118;488:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数param,其中ACCESS_TOKEN，DEPTID都需要替换为实际的值。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:41;489:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param=dict(string,string); ACCESS_TOKEN='xxxxx'; DEPTID='xxxxx'; param['access_token']=ACCESS_TOKEN; param['deptId']=DEPTID;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:119;496:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:19;496:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpGet&lt;/codeph&gt;向钉钉发送查询部门人员信息的请求：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:42;497:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpGet(url,param,1000); print ret['text'];&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:120;501:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;返回值ret是一个dictionary，ret['text']是响应正文。如果请求成功，返回的json格式的正文ret['text']类似:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:43;502:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{ &#34;errcode&#34; : 0, &#34;errmsg&#34; : &#34;ok&#34;, &#34;userIds&#34; : [&#34;1&#34;,&#34;2&#34;] }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:121;509:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;列表userIds后面步骤需要用到。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:122;511:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg&#34; scope=&#34;external&#34; xtrc=&#34;xref:22;511:104&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;钉钉开发错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:123;513:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;字段id的值就是部门id，后面的步骤需要用到。这里我们使用：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:44;514:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); Userlds=body.userIds; ERRCODE=body.errcode;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:124;519:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;就可以便捷地把userIds和errcode解析出来。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;创建企业群聊-1&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:18;521:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:18;521:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;创建企业群聊&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:18;521:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:125;523:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/serverapi2/fg9dze&#34; scope=&#34;external&#34; xtrc=&#34;xref:23;523:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:126;525:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式：POST（HTTPS）&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:127;527:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址：https://oapi.dingtalk.com/chat/create?access_token=ACCESS_TOKEN&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:26;528:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:67;528:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;对于post请求，调用钉钉接口需要有一个http请求头(Content-Type:application/json)。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:68;529:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url中的ACCESS_TOKEN可以通过第二个步骤获取。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:69;530:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;参数都是以json的格式放在post请求正文中。&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:45;531:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{&#34;name&#34; : &#34;groupName&#34;,&#34;owner&#34; : &#34;zhangsan&#34;,&#34;useridlist&#34; : [&#34;zxxxx&#34;,&#34;lxxxx&#34;]}&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:27;534:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:70;534:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:128;534:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;name：群名称。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:71;536:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:129;536:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;owner：群主userId，员工唯一标识ID；必须为该会话useridlist的成员之一。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:72;537:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:130;537:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;useridlist：群成员列表，每次最多支持40人。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:131;539:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;这使用httpClient中的函数httpPost(url,params,timeout,headers)。需要添加一个http请求头&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:20;539:68&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;Content-Type : application/json&lt;/codeph&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:132;541:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，相较于http协议的get方法，post方法的参数都是放在请求正文中的，httpPost方法的param参数是填写在http报文中的正文部分。在这里，需要补充完整url。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:133;543:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例:&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:134;545:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:46;546:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = 'https://oapi.dingtalk.com/chat/create?'; ACCESS_TOKEN='xxxxx'; url+='access_token='+ACCESS_TOKEN;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:135;551:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数param：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:47;552:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param='{&#34;name&#34; : &#34;groupName&#34;,&#34;owner&#34; : &#34;zhangsan&#34;,&#34;useridlist&#34; : [&#34;zxxxx&#34;,&#34;lxxxx&#34;]}';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:136;555:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数header，冒号必须紧跟Content-Type，否则钉钉服务端不能识别这个http请求头。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:48;556:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;header='Content-Type: application/json';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:137;559:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:21;559:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost&lt;/codeph&gt;向钉钉发送创建群聊的请求：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:49;560:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpPost(url,param,1000,header); print ret['text'];&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:138;564:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;返回值ret是一个dictionary，ret['text']是响应正文。 如果请求成功，返回的json格式正文类似如下:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:50;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{ &#34;errcode&#34; : 0, &#34;errmsg&#34; : &#34;ok&#34;, &#34;chatid&#34; : &#34;chatxxxxxxxxxxxxxxxxxxx&#34;, &#34;conversationTag&#34; : 2 }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:139;573:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg&#34; scope=&#34;external&#34; xtrc=&#34;xref:24;573:104&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;钉钉开发错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:140;575:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;这里我们使用：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:51;576:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); ERRCODE=body.errcode;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:141;580:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;就可以便捷地把errcode解析出来。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;向企业群聊发送消息&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:19;582:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:19;582:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;向企业群聊发送消息&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:19;582:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:142;583:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/serverapi2/isu6nk&#34; scope=&#34;external&#34; xtrc=&#34;xref:25;583:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;链接&lt;/xref&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:28;584:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:73;584:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:143;584:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求方式：POST（HTTPS）&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:144;586:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请求地址：https://oapi.dingtalk.com/chat/send?access_token=ACCESS_TOKEN&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:74;587:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:145;587:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;对于post请求，调用钉钉接口需要有一个http请求头(&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:22;587:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;Content-Type:application/json&lt;/codeph&gt;)。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:75;588:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:146;588:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url中的ACCESS_TOKEN可以通过第二个步骤获取。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:76;589:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:147;589:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;参数都是以json的格式放在post请求正文中。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:52;590:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{&#34;chatid&#34; : &#34;xxxxx&#34;,&#34;msg&#34; : {&#34;msgtype&#34; : &#34;text&#34;,&#34;text&#34; : {&#34;content&#34; : &#34;这是一条测试信息&#34;}}}&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:29;593:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:77;593:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;chatid:群会话的id。通过创建一个群聊会话获得。可以由上一个步骤获得。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:78;594:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;msg:消息内容。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:148;596:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;这里使用httpClient中的函数httpPost(url,params,timeout,headers)。需要添加一个http请求头&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:23;596:69&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;Content-Type: application/json&lt;/codeph&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:149;598:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，相较于http协议的get方法，post方法的参数都是放在请求正文中的，httpPost方法的param参数是填写在http报文中的正文部分。在这里，需要补充完整url。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:150;600:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例:&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:151;602:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数url：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:53;603:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;url = &#34;https://oapi.dingtalk.com/chat/send?&#34;; ACCESS_TOKEN='xxxxx'; url+='access_token='+ACCESS_TOKEN;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:152;608:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数headers：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:54;609:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;headers=dict(string,string); headers['Content-Type']='application/json';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:153;613:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;填写参数param：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:55;614:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;param='{&#34;chatid&#34; : &#34;xxx&#34;,&#34;msg&#34; : {&#34;msgtype&#34; : &#34;text&#34;,&#34;text&#34; : {&#34;content&#34; : &#34;这是一条测试信息&#34;}}}';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:154;617:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;调用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:24;617:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpPost&lt;/codeph&gt;向钉钉发送群聊消息的请求：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:56;618:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;ret=httpClient::httpPost(url,param,1000,headers); print ret['text'];&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:30;622:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:79;622:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;如果请求成功，返回的json格式正文类似如下，errcode的值为0。&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:57;623:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;{&#34;errcode&#34; : 0,&#34;errmsg&#34; : &#34;ok&#34;,&#34;messageId&#34; : &#34;abcd&#34;}&lt;/codeblock&gt;&lt;lq class=&#34;- topic/lq &#34; xtrc=&#34;lq:2;626:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:155;626:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg&#34; scope=&#34;external&#34; xtrc=&#34;xref:26;626:106&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;?ditaot usertext?&gt;钉钉开发错误码表&lt;/xref&gt;。&lt;/p&gt;&lt;/lq&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:156;628:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;通过以下脚本就能把errcode从json格式正文中取出来。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:58;629:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;body = parseExpr(ret.text).eval(); ERRCODE=body.errcode;&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;邮件发送示例&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:20;634:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:20;634:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;邮件发送示例&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:20;634:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:157;635:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;函数sendEmail支持单发邮件和群发邮件。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;前提&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:21;637:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:21;637:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;前提&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:21;637:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:31;639:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:80;639:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;使用本插件的邮件发送函数通常需要在邮件服务商上面设置开启smtp协议。如果还需要获取邮箱授权码，参数psw为邮箱授权码的字符串，否则psw就是邮箱账号的密码。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:81;640:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;在httpClient插件里面，默认设置了126, 163, yeah.net, sohu, dolphindb, qq邮箱的域名地址和端口。如果使用别的邮箱用户来发送邮件，需要通过emailSmtpConfig自行配置服务器地址和端口:&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:158;642:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;通过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:25;642:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpClient::emailSmtpConfig(emailName,host,port)&lt;/codeph&gt;配置邮箱服务器地址和端口。其中，emailName是邮箱名称，格式为邮箱'@'字符后的字符串；host是邮箱stmp服务器的地址；port是邮箱服务器端口。在httpClient插件里面，默认设置了126, 163, yeah.net, sohu, dolphindb, qq邮箱的域名地址和端口。如果使用别的邮箱用户来发送邮件，需要自行配置服务器地址和端口。配置方式如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:59;644:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;emailName=&#34;yahoo.com&#34;; host=&#34;smtp.yahoo.com&#34;; port=25; httpClient::emailSmtpConfig(emailName,host,port);&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;发送邮件&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:22;651:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:22;651:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;发送邮件&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:22;651:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:159;652:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;通过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:26;652:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;httpClient::sendEmail(user,psw,emailTo,subject,text)&lt;/codeph&gt;发送邮件。其中，user需要填入实际的发送邮箱账号，psw填入实际的邮箱密码(邮箱授权码)。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:160;654:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;示例：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:32;656:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:82;656:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;单发邮件，recipient填入收件人邮箱。&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:60;657:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;user='MailFrom@xxx.com'; psw='xxxxx';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:161;661:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;如果是单发邮件，recipient填写为一个目标邮箱的字符串。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:61;662:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;recipient='Maildestination@xxx.com';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:162;665:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;执行sendEmail函数，需要填写subject和text参数。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:62;666:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;res=httpClient::sendEmail(user,psw,recipient,'This is a subject','It is a text'); assert res[`responseCode]==250;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:163;670:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;返回值是一个字典res，如果发送成功，res['responseCode']==250。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:33;671:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:83;671:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;群发邮件，recipientCollection填入收件人邮箱列表。&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:63;672:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;user='MailFrom@xxx.com'; psw='xxxxx';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:164;677:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;如果是群发邮件，recipient填写为目标邮箱的字符串集合。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:64;678:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;recipientCollection='Maildestination@xxx.com''Maildestination2@xxx.com''Maildestination3@xxx.com';&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:165;681:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;执行sendEmail函数，需要填写subject和text参数。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:65;682:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;res=httpClient::sendEmail(user,psw,recipientCollection,'This is a subject','It is a text'); assert res[`responseCode]==250;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:166;686:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/httpclient_msg_case.md&#34;&gt;返回值是一个字典res，如果发送成功，res['responseCode']==250。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/httpclient_msg_case.md"/><meta name="wh-out-relpath" content="tutorials/httpclient_msg_case.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="利用-httpclient-插件整合外部消息" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="chap6_plugin"><div class="title"><a href="../plugins/plg_intro.html"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li><div class="topicref" data-id="httpclient"><div class="title"><a href="../plugins/httpClient/httpclient.html">HttpClient</a></div></div></li><li class="active"><div class="topicref" data-id="利用-httpclient-插件整合外部消息"><div class="title"><a href="../tutorials/httpclient_msg_case.html">利用 HttpClient 插件整合外部消息</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e94263" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e94263-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_howtos.html" id="tocId-d9713e94263-link">插件使用与开发</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="amdquote-d9713e94448" class="topicref" data-id="amdquote" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action amdquote-d9713e94448-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/amdquote/amdquote_2.html" id="amdquote-d9713e94448-link">amdQuote</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="arrow-d9713e94540" class="topicref" data-id="arrow" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action arrow-d9713e94540-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/Arrow/arrow.html" id="arrow-d9713e94540-link">Arrow</a></div></div></li><li role="treeitem"><div data-tocid="awss3-d9713e94632" class="topicref" data-id="awss3" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/aws/aws.html" id="awss3-d9713e94632-link">AWSS3</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="backtest-d9713e94678" class="topicref" data-id="backtest" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action backtest-d9713e94678-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/backtest.html" id="backtest-d9713e94678-link">Backtest</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="ctp-d9713e95138" class="topicref" data-id="ctp" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action ctp-d9713e95138-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/ctp_2.html" id="ctp-d9713e95138-link">CTP</a></div></div></li><li role="treeitem"><div data-tocid="datafeed-d9713e95230" class="topicref" data-id="datafeed" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/datafeed.html" id="datafeed-d9713e95230-link">DataFeed</a></div></div></li><li role="treeitem"><div data-tocid="efh-d9713e95276" class="topicref" data-id="efh" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/efh.html" id="efh-d9713e95276-link">EFH</a></div></div></li><li role="treeitem"><div data-tocid="encoderdecoder-d9713e95322" class="topicref" data-id="encoderdecoder" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/EncoderDecoder.html" id="encoderdecoder-d9713e95322-link">EncoderDecoder</a></div></div></li><li role="treeitem"><div data-tocid="excel_add_in-d9713e95368" class="topicref" data-id="excel_add_in" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/excel_add_in.html" id="excel_add_in-d9713e95368-link">Excel Add-In</a></div></div></li><li role="treeitem"><div data-tocid="feather-d9713e95415" class="topicref" data-id="feather" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/feather/feather.html" id="feather-d9713e95415-link">Feather</a></div></div></li><li role="treeitem"><div data-tocid="gp-d9713e95461" class="topicref" data-id="gp" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/gp/gp.html" id="gp-d9713e95461-link">GP</a></div></div></li><li role="treeitem"><div data-tocid="gurobi-d9713e95507" class="topicref" data-id="gurobi" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/gurobi.html" id="gurobi-d9713e95507-link">gurobi</a></div></div></li><li role="treeitem"><div data-tocid="hbase-d9713e95553" class="topicref" data-id="hbase" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/hbase/hbase.html" id="hbase-d9713e95553-link">HBase</a></div></div></li><li role="treeitem"><div data-tocid="hdf5-d9713e95599" class="topicref" data-id="hdf5" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/hdf5/hdf5.html" id="hdf5-d9713e95599-link">HDF5</a></div></div></li><li role="treeitem"><div data-tocid="hdfs-d9713e95645" class="topicref" data-id="hdfs" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/hdfs/hdfs.html" id="hdfs-d9713e95645-link">HDFS</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="httpclient-d9713e95691" class="topicref" data-id="httpclient" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action httpclient-d9713e95691-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/httpClient/httpclient.html" id="httpclient-d9713e95691-link">HttpClient</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" class="active"><div data-tocid="利用-httpclient-插件整合外部消息-d9713e95737" class="topicref" data-id="利用-httpclient-插件整合外部消息" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/httpclient_msg_case.html" id="利用-httpclient-插件整合外部消息-d9713e95737-link">利用 HttpClient 插件整合外部消息</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="insight-d9713e95783" class="topicref" data-id="insight" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action insight-d9713e95783-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/insight/insight_2.html" id="insight-d9713e95783-link">INSIGHT</a></div></div></li><li role="treeitem"><div data-tocid="kafka-d9713e95875" class="topicref" data-id="kafka" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/kafka/kafka.html" id="kafka-d9713e95875-link">Kafka</a></div></div></li><li role="treeitem"><div data-tocid="kdb-d9713e95921" class="topicref" data-id="kdb" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/kdb/kdb.html" id="kdb-d9713e95921-link">Kdb+</a></div></div></li><li role="treeitem"><div data-tocid="ldap-d9713e95967" class="topicref" data-id="ldap" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/LDAP.html" id="ldap-d9713e95967-link">LDAP</a></div></div></li><li role="treeitem"><div data-tocid="lgmb-d9713e96014" class="topicref" data-id="lgmb" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/lgbm.html" id="lgmb-d9713e96014-link">lgbm</a></div></div></li><li role="treeitem"><div data-tocid="libtorch-d9713e96060" class="topicref" data-id="libtorch" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/libtorch/libtorch.html" id="libtorch-d9713e96060-link">LibTorch</a></div></div></li><li role="treeitem"><div data-tocid="mat-d9713e96106" class="topicref" data-id="mat" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/mat/mat.html" id="mat-d9713e96106-link">mat</a></div></div></li><li role="treeitem"><div data-tocid="matchingengine-d9713e96152" class="topicref" data-id="matchingengine" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/MatchingEngine/me.html" id="matchingengine-d9713e96152-link">MatchingEngine</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="mes-d9713e96198" class="topicref" data-id="mes" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action mes-d9713e96198-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/matchingEngineSimulator/mes.html" id="mes-d9713e96198-link">MatchingEngineSimulator</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="mdl-d9713e96336" class="topicref" data-id="mdl" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action mdl-d9713e96336-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/MDL.html" id="mdl-d9713e96336-link">MDL</a></div></div></li><li role="treeitem"><div data-tocid="mongodb-d9713e96428" class="topicref" data-id="mongodb" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/mongodb/mongodb.html" id="mongodb-d9713e96428-link">MongoDB</a></div></div></li><li role="treeitem"><div data-tocid="mqtt-d9713e96474" class="topicref" data-id="mqtt" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/mqtt/mqtt.html" id="mqtt-d9713e96474-link">mqtt</a></div></div></li><li role="treeitem"><div data-tocid="mseed-d9713e96520" class="topicref" data-id="mseed" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/mseed/mseed.html" id="mseed-d9713e96520-link">mseed</a></div></div></li><li role="treeitem"><div data-tocid="mysql-d9713e96566" class="topicref" data-id="mysql" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/mysql/mysql.html" id="mysql-d9713e96566-link">MySQL</a></div></div></li><li role="treeitem"><div data-tocid="nsq-d9713e96612" class="topicref" data-id="nsq" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/nsq/nsq_2.html" id="nsq-d9713e96612-link">NSQ</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="odbc-d9713e96659" class="topicref" data-id="odbc" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action odbc-d9713e96659-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/odbc/odbc.html" id="odbc-d9713e96659-link">ODBC</a></div></div></li><li role="treeitem"><div data-tocid="opcua-d9713e96751" class="topicref" data-id="opcua" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/opcua/opcua.html" id="opcua-d9713e96751-link">OPCUA</a></div></div></li><li role="treeitem"><div data-tocid="opc-d9713e96797" class="topicref" data-id="opc" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/opc/opc.html" id="opc-d9713e96797-link">OPC</a></div></div></li><li role="treeitem"><div data-tocid="orc-d9713e96843" class="topicref" data-id="orc" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/orc.html" id="orc-d9713e96843-link">ORC</a></div></div></li><li role="treeitem"><div data-tocid="parquet-d9713e96889" class="topicref" data-id="parquet" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/parquet/parquet.html" id="parquet-d9713e96889-link">Parquet</a></div></div></li><li role="treeitem"><div data-tocid="py-d9713e96935" class="topicref" data-id="py" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/py/py.html" id="py-d9713e96935-link">Py</a></div></div></li><li role="treeitem"><div data-tocid="rabbitmq-d9713e96981" class="topicref" data-id="rabbitmq" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/rabbitMQ.html" id="rabbitmq-d9713e96981-link">RabbitMQ</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="redis-d9713e97027" class="topicref" data-id="redis" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action redis-d9713e97027-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/redis.html" id="redis-d9713e97027-link">Redis</a></div></div></li><li role="treeitem"><div data-tocid="quantlib-d9713e97119" class="topicref" data-id="quantlib" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/quantlib/quantlib.html" id="quantlib-d9713e97119-link">QuantLib</a></div></div></li><li role="treeitem"><div data-tocid="rocketmq-d9713e97165" class="topicref" data-id="rocketmq" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/rocketMQ.html" id="rocketmq-d9713e97165-link">RocketMQ</a></div></div></li><li role="treeitem"><div data-tocid="sevenzip-d9713e97211" class="topicref" data-id="sevenzip" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/sevenzip.html" id="sevenzip-d9713e97211-link">SevenZip</a></div></div></li><li role="treeitem"><div data-tocid="schemalesswriter-d9713e97258" class="topicref" data-id="schemalesswriter" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/slwriter.html" id="schemalesswriter-d9713e97258-link">SchemalessWriter</a></div></div></li><li role="treeitem"><div data-tocid="signal-d9713e97304" class="topicref" data-id="signal" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/signal/signal.html" id="signal-d9713e97304-link">signal</a></div></div></li><li role="treeitem"><div data-tocid="ssequotationfile-d9713e97350" class="topicref" data-id="ssequotationfile" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/SSEQuotationFile.html" id="ssequotationfile-d9713e97350-link">SSEQuotationFile</a></div></div></li><li role="treeitem"><div data-tocid="svm-d9713e97396" class="topicref" data-id="svm" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/svm/svm.html" id="svm-d9713e97396-link">SVM</a></div></div></li><li role="treeitem"><div data-tocid="tcpsocket-d9713e97442" class="topicref" data-id="tcpsocket" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/tcpsocket.html" id="tcpsocket-d9713e97442-link">TCPSocket</a></div></div></li><li role="treeitem"><div data-tocid="websocket-d9713e97488" class="topicref" data-id="websocket" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/websocket.html" id="websocket-d9713e97488-link">WebSocket</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="windtdf-d9713e97534" class="topicref" data-id="windtdf" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action windtdf-d9713e97534-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/windtdf.html" id="windtdf-d9713e97534-link">WindTDF</a></div></div></li><li role="treeitem"><div data-tocid="xgboost-d9713e97626" class="topicref" data-id="xgboost" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/xgboost/xgboost.html" id="xgboost-d9713e97626-link">xgboost</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="xtp-d9713e97672" class="topicref" data-id="xtp" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action xtp-d9713e97672-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/xtp.html" id="xtp-d9713e97672-link">XTP</a></div></div></li><li role="treeitem"><div data-tocid="zip-d9713e97764" class="topicref" data-id="zip" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/zip/zip.html" id="zip-d9713e97764-link">zip</a></div></div></li><li role="treeitem"><div data-tocid="zlib-d9713e97810" class="topicref" data-id="zlib" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/zlib/zlib.html" id="zlib-d9713e97810-link">Zlib</a></div></div></li><li role="treeitem"><div data-tocid="zmq-d9713e97857" class="topicref" data-id="zmq" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../plugins/zmq/zmq.html" id="zmq-d9713e97857-link">zmq</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">利用 HttpClient 插件整合外部消息</h1><div class="- topic/body body"><p class="- topic/p p">DolphinDB 支持通过动态加载用 C++ 编写的插件程序，通过执行 DolphinDB 脚本函数，来调用插件程序的自定义函数，实现自定义功能扩展。</p><p class="- topic/p p">DolphinDB 的 httpClient插件提供以下 3 个函数，用于发送 HTTP 请求和发送邮件。</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code>: 发送http的Get方法请求。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">httpPost</code>: 发送http的Post方法请求。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">sendEmail</code>: 发送邮件。</li></ul><p class="- topic/p p">本文介绍如何通过 httpClient 插件的 <code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code> 与 <code class="+ topic/ph pr-d/codeph ph codeph">httpPost</code> 插件函数实现企业微信发送群聊消息、钉钉发送群聊消息，通过 <code class="+ topic/ph pr-d/codeph ph codeph">sendEmail</code> 插件函数发送文本邮件。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="在-dolphindb-中加载-httpclient-插件"><h2 class="- topic/title title topictitle2" id="ariaid-title2">在 DolphinDB 中加载 httpClient 插件</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title3" id="linux"><h3 class="- topic/title title topictitle3" id="ariaid-title3">Linux</h3><div class="- topic/body body"><p class="- topic/p p">需要有 libPluginHttpClient.so 和 PluginHttpClient.txt 两个插件程序文件。</p><p class="- topic/p p">注：可以在<a class="- topic/xref xref" href="https://gitee.com/dolphindb/DolphinDBPlugin/tree/release200/httpClient" target="_blank" rel="external noopener">httpClient 插件项目</a>的 /bin/linux/ 目录下找到这两个文件，但需要注意分支版本号需要与所用的 DolphinDB server 版本相同。</p><p class="- topic/p p">确认 PluginHttpClient.txt 和 libPluginHttpClient.so 在同一目录下，执行以下脚本来加载插件：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>loadPlugin("&lt;PluginDir&gt;/httpClient/bin/linux64/PluginHttpClient.txt");</code></pre></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title4" id="三种外部消息平台的使用"><h2 class="- topic/title title topictitle2" id="ariaid-title4">三种外部消息平台的使用</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="企业微信消息通信的演示案例"><h3 class="- topic/title title topictitle3" id="ariaid-title5">企业微信消息通信的演示案例</h3><div class="- topic/body body"><p class="- topic/p p">以下我们演示一个企业微信发送群聊应用信息的案例。创建一个企业群聊，然后发送群聊信息。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：</p><ul class="- topic/ul ul"><li class="- topic/li li">如果已经有一个群聊并且有群聊标识id，则不需要创建群聊。群聊标识号一定需要通过创建群聊获取。</li><li class="- topic/li li">如果需要创建一个企业群聊，需要设置应用的可见范围为根部门。</li><li class="- topic/li li">在企业微信中，调用不同的http请求API都需要有不同的的请求地址(url)。</li></ul><p class="- topic/p p">参考：<a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90135/90665" target="_blank" rel="external noopener">企业微信corpid、userid、部门id、tagid、agentid、secret、access_token</a></p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title6" id="企业微信内自建新应用"><h4 class="- topic/title title topictitle4" id="ariaid-title6">企业微信内自建新应用</h4><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90135/90226" target="_blank" rel="external noopener">链接</a></p><ul class="- topic/ul ul"><li class="- topic/li li">首先,添加自建应用。管理员账号登录 <a class="- topic/xref xref" href="https://work.weixin.qq.com/wework_admin/loginpage_wx?from=myhome_baidu" target="_blank" rel="external noopener">企业微信管理端</a> -&gt; 应用与小程序 -&gt; 应用 -&gt; 自建，点击“创建应用”，设置应用logo、应用名称等信息，创建应用。</li><li class="- topic/li li">创建完成后，在管理端的应用列表里进入该应用，可以看到 Agentid、Secret 等信息，这些信息在使用企业微信 API 时会用到。</li></ul></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title7" id="获取-access-token"><h4 class="- topic/title title topictitle4" id="ariaid-title7">获取 access_token</h4><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90135/91039" target="_blank" rel="external noopener">链接</a></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">access_token 是应用调用 API 的凭证，由 corpid 和 corpsecret 换取。
<strong class="+ topic/ph hi-d/b ph b">注意</strong>：access_token 的时效为 7200 秒。需要缓存 access_token，用于后续接口的调用（不能频繁调用 gettoken 接口，否则会受到频率拦截）。当 access_token 失效或过期时，可通过查看返回正文的 errocode 来确定，需要重新获取，应实现 access_token 失效时重新获取的逻辑。</p></li><li class="- topic/li li"><p class="- topic/p p">每个企业都拥有唯一的 corpid。</p></li><li class="- topic/li li"><p class="- topic/p p">每个应用都有相应的 corpsecret，用对应应用的 corpsecret 获取的 access_token 就拥有该应用的权限。</p></li><li class="- topic/li li"><p class="- topic/p p">请求方式： GET（HTTPS）</p><p class="- topic/p p">请求地址： https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=ID&amp;corpsecret=SECRET</p></li></ul><p class="- topic/p p">这里使用 httpClient 插件函数 <code class="+ topic/ph pr-d/codeph ph codeph">httpGet(url,params,timeout,headers)</code>。当前步骤不需要添加 http 请求头，只填写前面 3 个参数。</p><ul class="- topic/ul ul"><li class="- topic/li li">url 只需要填写 'https://qyapi.weixin.qq.com/cgi-bin/gettoken',  后面的 corpid 和 corpsecret 参数通过 httpGet 方法中的 param 参数就可以补充完整。</li><li class="- topic/li li">param 是一个键值对都是 string 的字典。 参数 corpid 的值 (ID) 为企业 ID，corpsecret 的值 (SECRET) 为对应应用的凭证密钥，两个值都需要以字符串的形式加入到 param中。</li><li class="- topic/li li">timeout 为超时时间，单位为毫秒，数据类型为整型。达到超时时间后 <code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code> 会直接返回，无论是否收到 HTTP 应答报文。因为这是一个远程网络请求，超时时间最好设置为 1000 毫秒或以上。</li></ul><p class="- topic/p p">示例：</p><p class="- topic/p p">填写参数 url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = 'https://qyapi.weixin.qq.com/cgi-bin/gettoken';</code></pre><p class="- topic/p p">填写参数 param，ID 和 SECRET 都需要更换为真实的 corpid 和 corpsecret。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param=dict(string,string);
ID='xxxxx';
SECRET='xxxxx';
param['corpid']=ID;
param['corpsecret']=SECRET;</code></pre><p class="- topic/p p">使用 <code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code> 函数向企业微信发送请求：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpGet(url,param,1000);
print ret['text'];</code></pre><p class="- topic/p p">返回值 ret 是一个 dictionary，ret['text'] 是响应正文。如果请求成功，返回的 json 格式的正文 ret['text'] 如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{
    "errcode" : 0,
    "errmsg" : "ok",
    "access_token" : "xxxxxx",
    "expires_in" : 7200
}                     </code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：errcode 是向企业微信请求信息的错误码，如果请求成功，返回值是 0。不同于 HTTP 协议的请求返回的响应码。如果出现其他 errcode 值，查看错误信息 errmsg。errcode 的值的含义可查看 <a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90139/90313" target="_blank" rel="external noopener">企业微信错误码表</a>。</p><p class="- topic/p p">这里我们使用：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
ERRCODE=body.errcode;
ERRMSG=body.errmsg;</code></pre><p class="- topic/p p">就可以便捷地把 errcode 和 errmsg 解析出来。</p><p class="- topic/p p">access_token 的值在后续步骤中会用到。如果 errcode 的值为 0，则可以获取到 access_token。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ACCESS_TOKEN=body.access_token;</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title8" id="发送应用消息"><h4 class="- topic/title title topictitle4" id="ariaid-title8">发送应用消息</h4><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90135/90248" target="_blank" rel="external noopener">链接</a></p><p class="- topic/p p">通过这个步骤，可以在企业微信内发送应用消息。
需要一个 access_token 和一个应用 id(AgentId)。</p><p class="- topic/p p">请注意，如果返回的 json 正文的 errcode 的值为 40014，则表明 access_token 过期了，需要重新重新获取 access_token。</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">请求方式： POST（HTTPS）</p><p class="- topic/p p">请求地址：https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=ACCESS_TOKEN</p></li></ul><p class="- topic/p p">使用 httpClient 中的函数 <code class="+ topic/ph pr-d/codeph ph codeph">httpPost(url,params,timeout,headers)</code>。这里不需要添加 http 请求头，只填写前面 3 个参数。</p><p class="- topic/p p">请注意，相较于 HTTP 协议的 get 方法，post 方法的参数都是放在请求正文中的，httpPost 方法的 param 参数是填写在 http 报文中的正文部分。在这里，需要补充完整 url。</p><ul class="- topic/ul ul"><li class="- topic/li li">完整的 url：<pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=ACCESS_TOKEN</code></pre>其中 ACCESS_TOKEN 应该替换为需要发送消息应用的 access_token，由第二个步骤获取。</li><li class="- topic/li li">参数都是以json的格式放在post请求正文中。<pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{
   "touser" : "@all",
   "agentid" : xxxx,
   "msgtype" : "text",
   "text" : {
       "content" : "This is a test message"
   }
}</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">touser：指定接收消息的成员，成员ID列表。这里我们使用特殊值"@all",只需要设置好这个应用的可见范围即可向特定的部门、接受人发送消息。</li><li class="- topic/li li">msgtype：消息类型。</li><li class="- topic/li li">agentid：企业应用的id，整型。</li><li class="- topic/li li">text：消息正文。</li></ul></li></ul><p class="- topic/p p">示例：</p><ul class="- topic/ul ul"><li class="- topic/li li">需要把ACCESS_TOKEN更换成由第二个步骤获得的access_token。</li><li class="- topic/li li">作为示例，我们这里发送的消息类型仅是文本信息，还可以有图片信息、视频信息、语音信息等等。</li></ul><p class="- topic/p p">填写参数 url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = 'https://qyapi.weixin.qq.com/cgi-bin/message/send?';
ACCESS_TOKEN='xxxxx';
url+='access_token='+ACCESS_TOKEN;</code></pre><p class="- topic/p p">填写参数 param：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param='{"touser" : "@all","agentid" : xxxx,"msgtype" : "text","text" : {"content" : "这是一条测试信息"}';</code></pre><p class="- topic/p p">调用 <code class="+ topic/ph pr-d/codeph ph codeph">httpPost</code> 在企业微信发送应用消息：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpPost(url,param,1000);
print ret['text'];</code></pre><p class="- topic/p p">如果请求成功，企业微信返回的 json 格式正文如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{
   "errcode" : 0,
   "errmsg" : "ok",
}</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：errcode 是向企业微信请求信息的错误码，如果请求成功，返回值是 0。不同于 HTTP 协议的请求返回的响应码。如果出现其他 errcode 值，查看错误信息 errmsg。errcode 的值的含义可查看 <a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90139/90313" target="_blank" rel="external noopener">企业微信错误码表</a>。</p><p class="- topic/p p">可以通过以下dolphindb脚本从json格式字符串中取出errcode。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
ERRCODE=body.errcode;</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：如果部分接收人无权限或不存在，发送仍然执行，但会返回无效的部分（即 invaliduser、invalidparty、invalidtag字段），需要设置应用的可见范围。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title9" id="发送群聊消息"><h4 class="- topic/title title topictitle4" id="ariaid-title9">发送群聊消息</h4><div class="- topic/body body"></div><article class="- topic/topic topic nested4" aria-labelledby="ariaid-title10" id="创建企业群聊"><h5 class="- topic/title title topictitle5" id="ariaid-title10">创建企业群聊</h5><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90135/90245" target="_blank" rel="external noopener">链接</a></p><ul class="- topic/ul ul"><li class="- topic/li li">通过这个步骤，我们创建了一个企业群聊，可以获得一个群聊 id(chatid)。</li><li class="- topic/li li">设置应用的可见范围是根目录，没有设置会返回 errcode(60011)。可以到应用管理找到这个自建应用，单击这个应用，会跳转到这个应用的详情页面，可以在这个页面编辑这个应用的可见范围。</li><li class="- topic/li li">首先需要有由第二个步骤获得的 access_token。</li></ul><p class="- topic/p p">请注意，如果返回的 json 正文的 errcode 的值为 40014，则表明 access_token 过期了，需要重新到第二个步骤重新获取 access_token。</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">请求方式： POST（HTTPS）</p><p class="- topic/p p">请求地址： https://qyapi.weixin.qq.com/cgi-bin/appchat/create?access_token=ACCESS_TOKEN</p><p class="- topic/p p">请求参数：http正文json格式</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>    {"name" : "NAME","owner" : "userid1","userlist" : ["userid1", "userid2", "userid3"],"chatid" : "CHATID"}</code></pre><p class="- topic/p p">这里使用 httpClient 中的函数 <code class="+ topic/ph pr-d/codeph ph codeph">httpPost(url,params,timeout,headers)</code>。当前步骤不需要添加 http 请求头，只填写前面 3 个参数。</p><p class="- topic/p p">请注意，相较于http协议的 get 方法，post 方法的参数都是放在请求正文中的，httpPost 方法的 param 参数是填写在 http 报文中的正文部分。在这里，我们需要自行补充完整 url。</p></li><li class="- topic/li li"><p class="- topic/p p">url 需要填写 'https://qyapi.weixin.qq.com/cgi-bin/appchat/create?access_token=ACCESS_TOKEN'。access_token的值(ACCESS_TOKEN)由第二个步骤获得。</p></li><li class="- topic/li li"><p class="- topic/p p">param 填写上面的 json 格式，每一个参数值都需要更替为实际参数。</p><ul class="- topic/ul ul"><li class="- topic/li li">name：群聊名字。</li><li class="- topic/li li">owner：群主id。</li><li class="- topic/li li">userlist：群成员id(userid)列表。每个成员都有唯一的userid。在企业微信网页，管理后台-&gt;“通讯录”-&gt;点进某个成员的详情页，可以看到。</li><li class="- topic/li li">chatid：群聊标识id。可以指定，也可以不填让系统随机创建，允许字符0-9及字母a-z和A-Z。</li></ul></li><li class="- topic/li li"><p class="- topic/p p">timeout为超时时间，单位为毫秒，数据类型为整型。达到超时时间后<code class="+ topic/ph pr-d/codeph ph codeph">httpPost</code>会直接返回，无论是否收到http应答报文。因为这是一个远程网络请求，超时时间最好设置为1000毫秒或以上。</p></li></ul><p class="- topic/p p">示例：</p><p class="- topic/p p">填写参数 url：</p><p class="- topic/p p">其中，ACCESS_TOKEN 由第二个步骤获得，param 中每个参数都需要实际的参数。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = 'https://qyapi.weixin.qq.com/cgi-bin/appchat/create?';
url+='access_token='+ACCESS_TOKEN;</code></pre><p class="- topic/p p">填写参数param。"NAME","userid1","userid2","userid3","CHATID"都需要填写为实际的值。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param='{"name" : "NAME","owner" : "userid1","userlist" : ["userid1", "userid2", "userid3"]，"chatid" : "CHATID"}';</code></pre><p class="- topic/p p">调用httpPost向企业微信发送创建群聊的请求：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpPost(url,param,1000);
print ret['text'];</code></pre><p class="- topic/p p">返回值ret是一个dictionary，ret['text']是响应正文。如果请求成功，返回的json格式的正文text如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code> {
     "errcode" : 0,
     "errmsg" : "ok",
     "chatid" : "CHATID"
}</code></pre><p class="- topic/p p">请注意，errcode 是向企业微信请求信息的错误码，如果请求成功，返回值是 0。不同于 http 协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看<a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90139/90313" target="_blank" rel="external noopener">企业微信错误码表</a>。</p><p class="- topic/p p">chatid 的值后面步骤需要用到。这里我们使用：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
ERRCODE=body.errcode;
CHATID=body.access_token;</code></pre><p class="- topic/p p">就可以便捷地把 chatid 和 errcode 的值解析出来。</p></div></article><article class="- topic/topic topic nested4" aria-labelledby="ariaid-title11" id="利用-post-请求发送群聊消息"><h5 class="- topic/title title topictitle5" id="ariaid-title11">利用 post 请求发送群聊消息</h5><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90135/90248" target="_blank" rel="external noopener">链接</a></p><p class="- topic/p p">通过这最后一个步骤，我们就可以成功地在企业微信内发送群聊信息。
首先，需要一个 access_token 还有一个群聊 id(chatid)，可以通过上一个步骤获得。</p><p class="- topic/p p">请注意，如果返回的 json 正文的 errcode 的值为 40014，则表明 access_token 过期了，需要重新到上一个步骤重新获取access_token。</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">请求方式： POST（HTTPS）</p><p class="- topic/p p">请求地址： https://qyapi.weixin.qq.com/cgi-bin/appchat/send?access_token=ACCESS_TOKEN</p><p class="- topic/p p">使用httpClient中的函数httpPost(url,params,timeout,headers)。这里不需要添加http请求头，只填写前面3个参数。</p><p class="- topic/p p">请注意，相较于http协议的get方法，post方法的参数都是放在请求正文中的，httpPost方法的param参数是填写在http报文中的正文部分。在这里，需要补充完整url。</p></li><li class="- topic/li li"><p class="- topic/p p">完整的url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>https://qyapi.weixin.qq.com/cgi-bin/appchat/send?access_token=ACCESS_TOKEN,</code></pre><p class="- topic/p p">其中ACCESS_TOKEN应该替换为需要发送消息应用的access_token，由第二个步骤获取。</p></li><li class="- topic/li li"><p class="- topic/p p">参数都是以json的格式放在post请求正文中。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{"chatid" : "CHATID","msgtype" : "text","text" : {"content" : "这是一条测试信息"}}</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">chatid：群聊id，可由上一个步骤获得。</li><li class="- topic/li li">msgtype：消息类型。</li><li class="- topic/li li">text：消息正文。</li></ul></li></ul><p class="- topic/p p">示例：</p><ul class="- topic/ul ul"><li class="- topic/li li">需要把ACCESS_TOKEN更换成由第二个步骤获得的access_token，CHATID更换成第上一个步骤通过创建群聊获得的chatid。</li><li class="- topic/li li">作为示例，我们这里发送的消息类型仅是文本信息，还可以有图片信息、视频信息、语音信息等等。</li></ul><p class="- topic/p p">填写参数 url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = 'https://qyapi.weixin.qq.com/cgi-bin/appchat/send?';
ACCESS_TOKEN='xxxxx';
url+='access_token='+ACCESS_TOKEN;</code></pre><p class="- topic/p p">填写参数 param：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param='{"chatid" : "CHATID","msgtype" : "text","text" : {"content" : "这是一条测试信息"}}';</code></pre><p class="- topic/p p">调用 <code class="+ topic/ph pr-d/codeph ph codeph">httpPost</code> 向企业微信群聊发送消息：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpPost(url,param,1000);
print ret['text'];</code></pre><p class="- topic/p p">如果请求成功，企业微信返回的json格式正文类似如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{
    "errcode" : 0,
    "errmsg" : "ok",
    "invaliduser" : "",
    "invalidparty" : "1"
}</code></pre><p class="- topic/p p">请注意，errcode 是向企业微信请求信息的错误码，如果请求成功，返回值是 0。不同于 HTTP 协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看<a class="- topic/xref xref" href="https://work.weixin.qq.com/api/doc/90000/90139/90313" target="_blank" rel="external noopener">企业微信错误码表</a>。</p><p class="- topic/p p">可以通过以下dolphindb脚本从json格式字符串中取出 errcode。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
ERRCODE=body.errcode;</code></pre></div></article></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title12" id="钉钉消息通信的演示案例"><h3 class="- topic/title title topictitle3" id="ariaid-title12">钉钉消息通信的演示案例</h3><div class="- topic/body body"><p class="- topic/p p">以下演示一个钉钉发送群聊应用信息的案例。创建一个企业群聊，然后发送群聊信息。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：</p><ul class="- topic/ul ul"><li class="- topic/li li">如果已经有一个群聊并且有群聊标识id，则不需要创建群聊。群聊标识号一定需要通过创建群聊获取。</li><li class="- topic/li li">调用不同的http请求API都需要有不同的的请求地址(url)。</li></ul><p class="- topic/p p">相比于企业微信，钉钉的进行http的API调用的时候都需要以下的更多的如下操作。</p><ul class="- topic/ul ul"><li class="- topic/li li">开通相关的权限。</li><li class="- topic/li li">设置服务器的出口公网ip地址。</li><li class="- topic/li li">需要在创建一个群聊时需要多步单次调用多个接口，无法直接到网页端查到每个成员的UserId。首先通过部门查询，然后通过查询该部门下的成员信息得到UserId，最后通过UserId列表创建一个群聊。</li></ul><p class="- topic/p p"><a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/bgb96b/mzd9qg" target="_blank" rel="external noopener">钉钉CorpId, UserId, UnionId, AppKey, AppSecret, AccessToken, AgentId, AppId, AppSecret的介绍。</a></p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title13" id="创建企业内部开发应用申请接口调用权限"><h4 class="- topic/title title topictitle4" id="ariaid-title13">创建企业内部开发应用，申请接口调用权限</h4><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/serverapi2/eev437" target="_blank" rel="external noopener">链接</a></p><p class="- topic/p p">首先创建一个微应用。使用钉钉企业管理员账号登录<a class="- topic/xref xref" href="https://oa.dingtalk.com/?redirect=http%3A%2F%2Foa.dingtalk.com%2Fomp%2Fapi%2Fmicro_app%2Fadmin%2Flanding%3Fcorpid%3Dopen-dev.dingtalk.com%26redirect_url%3Dhttp%3A%2F%2Fopen-dev.dingtalk.com%2F#/login" target="_blank" rel="external noopener">钉钉开发者后台网站</a>，在应用开发页面，选择企业内部开发 &gt; H5微应用，然后单击创建应用,填写应用名称、应用描述和补充应用图标，然后单击确定创建。创建应用可获得appkey，appsecret，在获取access_token中需要用到。</p><p class="- topic/p p">还需要在这个应用的信息管理页面，设置服务器出口IP，为输入调用钉钉服务端API时使用的IP即企业服务器的公网IP，多个IP请以","隔开，支持带一个*号通配符的IP格式。</p><p class="- topic/p p">需要用到的权限就需要在钉钉开发者平台网页上<a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/serverapi2/rnomdt" target="_blank" rel="external noopener">开启权限</a>。</p><ul class="- topic/ul ul"><li class="- topic/li li">需要获取部门id，然后通过这个部门号去获取当前部门所有的人的详情--需要通讯录只读权限。</li><li class="- topic/li li">通过以上获取到的部门id，人员id，创建一个企业群聊--需要企业会话权限。
然后就可以实现利用httpClient插件中的httpGet和httpPost方法向一个企业群聊中发送消息。</li></ul></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title14" id="获取access-token"><h4 class="- topic/title title topictitle4" id="ariaid-title14">获取access_token</h4><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/serverapi2/eev437" target="_blank" rel="external noopener">链接</a></p><ul class="- topic/ul ul"><li class="- topic/li li">access_token是应用调用API的凭证，由 appkey和appsecret换取。</li></ul><blockquote class="- topic/lq lq"><p class="- topic/p p">请注意，access_token的时效为7200秒。需要缓存access_token，用于后续接口的调用（注意：不能频繁调用gettoken接口，否则会受到频率拦截）。当access_token失效或过期时，需要重新获取，应实现access_token失效时重新获取的逻辑。</p></blockquote><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">不同应用都有相应的appkey和appsecret。</p></li><li class="- topic/li li"><p class="- topic/p p">请求方式：GET（HTTPS）</p><p class="- topic/p p">请求地址：https://oapi.dingtalk.com/gettoken?appkey=key&amp;appsecret=secret</p></li></ul><p class="- topic/p p">这里使用httpClient中的函数httpGet(url,params,timeout,headers)。不需要添加http请求头，只需要填写前3个参数。</p><ul class="- topic/ul ul"><li class="- topic/li li">参数appkey的值(key)为应用的标识号，appsecret的值(secret)为对应应用的凭证密钥。</li><li class="- topic/li li">url在这里只需要填写'https://oapi.dingtalk.com/gettoken'，后面的appkey和appsecret参数通过httpGet方法中的param参数就可以填写。</li><li class="- topic/li li">param是一个键值对都是string的字典。 参数appkey的值(key)为对应应用id，appsecret的值(secret)为对应应用的凭证密钥，两个值都需要以字符串的形式加入到param中。</li><li class="- topic/li li">timeout为超时时间，单位为毫秒，数据类型为整型。达到超时时间后<code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code>会直接返回，无论是否收到http应答报文。因为这是一个远程网络请求，超时时间最好设置为1000毫秒或以上。</li></ul><p class="- topic/p p">示例：</p><p class="- topic/p p">填写参数url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = 'https://oapi.dingtalk.com/gettoken';</code></pre><p class="- topic/p p">填写参数param：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param=dict(string,string);
key='xxxxx';
secret='xxxxx';
param['appkey']=key;
param['appsecret']=secret;</code></pre><p class="- topic/p p">调用<code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code>向钉钉发送申请access_token的信息：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpGet(url,param,1000);
print ret['text'];</code></pre><p class="- topic/p p">返回值ret是一个dictionary，ret['text']是响应正文。如果请求成功，返回的json格式的正文ret['text']如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{
    "errcode" : 0,
    "errmsg" : "ok",
    "access_token" : "xxxxx"
}</code></pre><p class="- topic/p p">请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看<a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg" target="_blank" rel="external noopener">钉钉开发错误码表</a>。</p><p class="- topic/p p">access_token的值后续步骤需要用到。这里我们使用：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
ACCESS_TOKEN=body.access_token;
ERRCODE=body.errcode;</code></pre><p class="- topic/p p">就可以便捷地把access_token和errcode解析出来。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title15" id="发送群聊消息-1"><h4 class="- topic/title title topictitle4" id="ariaid-title15">发送群聊消息</h4><div class="- topic/body body"></div><article class="- topic/topic topic nested4" aria-labelledby="ariaid-title16" id="获取部门列表"><h5 class="- topic/title title topictitle5" id="ariaid-title16">获取部门列表</h5><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/serverapi2/dubakq" target="_blank" rel="external noopener">链接</a></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">请求方式：GET（HTTPS）</p><p class="- topic/p p">请求地址：https://oapi.dingtalk.com/department/list?access_token=ACCESS_TOKEN</p></li><li class="- topic/li li"><p class="- topic/p p">需要有由第二个步骤获得的access_token。</p></li><li class="- topic/li li"><p class="- topic/p p">参数以json的格式放在请求正文中。</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{"fetch_child" : true}</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">fetch_child:	是否递归部门的全部子部门</li></ul><p class="- topic/p p">示例：</p><p class="- topic/p p">填写参数url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = 'https://oapi.dingtalk.com/department/list';</code></pre><p class="- topic/p p">填写参数param,ACCESS_TOKEN需要替换为由第二个步骤获得的access_token。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param=dict(string,string);
ACCESS_TOKEN='xxxxx';
param['access_token']=ACCESS_TOKEN;</code></pre><p class="- topic/p p">调用<code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code>向钉钉发送查询部门信息的请求：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpGet(url,param,1000);
print ret['text'];</code></pre><p class="- topic/p p">返回值ret是一个dictionary，ret['text']是响应正文。
如果请求成功，返回的json格式的正文text类似：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{
    "errcode" : 0,"errmsg" : "ok","department" : [
        {
            "id" : 123,
            "name" : "服务端开发组",
            "parentid" : 2,
            "createDeptGroup" : false,
            "autoAddUser" : false,
            "ext" : "{\"deptNo\" : 2}"
        }
    ]
}</code></pre><p class="- topic/p p">请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看<a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg" target="_blank" rel="external noopener">钉钉开发错误码表</a>。</p><p class="- topic/p p">字段id的值就是部门id，后面的步骤需要用到。这里我们使用：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
DEPTID=string(body[0].id);
ERRCODE=body.errcode;</code></pre><p class="- topic/p p">就可以便捷地把id和errcode解析出来。</p></div></article><article class="- topic/topic topic nested4" aria-labelledby="ariaid-title17" id="获取部门下成员详情"><h5 class="- topic/title title topictitle5" id="ariaid-title17">获取部门下成员详情</h5><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/serverapi2/ege851" target="_blank" rel="external noopener">链接</a></p><p class="- topic/p p">请求方式：GET（HTTPS）</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>请求地址：https://oapi.dingtalk.com/user/getDeptMember?access_token=ACCESS_TOKEN&amp;deptId=1</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">首先我们需要有由第二个步骤获得的access_token。</li><li class="- topic/li li">deptId是部门id，可以通过上一个步骤获得。</li></ul><p class="- topic/p p">这里使用httpClient中的函数httpGet(url,params,timeout,headers)。不需要添加http请求头，只需要填写前3个参数。</p><ul class="- topic/ul ul"><li class="- topic/li li">url只需要填写'https://oapi.dingtalk.com/user/getDeptMember'，后面的access_token和deptId参数通过httpGet方法中的param参数就可以填写。</li><li class="- topic/li li">param是一个键值对都是string的字典。 参数access_token的值(ACCESS_TOKEN)为请求接口凭证，deptId的值为部门id，两个值都需要以字符串的形式加入到param中。</li><li class="- topic/li li">timeout为超时时间，单位为毫秒，数据类型为整型。达到超时时间后<code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code>会直接返回，无论是否收到http应答报文。因为这是一个远程网络请求，超时时间最好设置为1000毫秒或以上。</li></ul><p class="- topic/p p">示例：</p><p class="- topic/p p">填写参数url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = 'https://oapi.dingtalk.com/user/getDeptMember';</code></pre><p class="- topic/p p">填写参数param,其中ACCESS_TOKEN，DEPTID都需要替换为实际的值。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param=dict(string,string);
ACCESS_TOKEN='xxxxx';
DEPTID='xxxxx';
param['access_token']=ACCESS_TOKEN;
param['deptId']=DEPTID;</code></pre><p class="- topic/p p">调用<code class="+ topic/ph pr-d/codeph ph codeph">httpGet</code>向钉钉发送查询部门人员信息的请求：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpGet(url,param,1000);
print ret['text'];</code></pre><p class="- topic/p p">返回值ret是一个dictionary，ret['text']是响应正文。如果请求成功，返回的json格式的正文ret['text']类似:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{
    "errcode" : 0,
    "errmsg" : "ok",
    "userIds" : ["1","2"]
}</code></pre><p class="- topic/p p">列表userIds后面步骤需要用到。</p><p class="- topic/p p">请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看<a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg" target="_blank" rel="external noopener">钉钉开发错误码表</a>。</p><p class="- topic/p p">字段id的值就是部门id，后面的步骤需要用到。这里我们使用：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
Userlds=body.userIds;
ERRCODE=body.errcode;</code></pre><p class="- topic/p p">就可以便捷地把userIds和errcode解析出来。</p></div></article><article class="- topic/topic topic nested4" aria-labelledby="ariaid-title18" id="创建企业群聊-1"><h5 class="- topic/title title topictitle5" id="ariaid-title18">创建企业群聊</h5><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/serverapi2/fg9dze" target="_blank" rel="external noopener">链接</a></p><p class="- topic/p p">请求方式：POST（HTTPS）</p><p class="- topic/p p">请求地址：https://oapi.dingtalk.com/chat/create?access_token=ACCESS_TOKEN</p><ul class="- topic/ul ul"><li class="- topic/li li">对于post请求，调用钉钉接口需要有一个http请求头(Content-Type:application/json)。</li><li class="- topic/li li">url中的ACCESS_TOKEN可以通过第二个步骤获取。</li><li class="- topic/li li">参数都是以json的格式放在post请求正文中。</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{"name" : "groupName","owner" : "zhangsan","useridlist" : ["zxxxx","lxxxx"]}</code></pre><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">name：群名称。</p></li><li class="- topic/li li"><p class="- topic/p p">owner：群主userId，员工唯一标识ID；必须为该会话useridlist的成员之一。</p></li><li class="- topic/li li"><p class="- topic/p p">useridlist：群成员列表，每次最多支持40人。</p></li></ul><p class="- topic/p p">这使用httpClient中的函数httpPost(url,params,timeout,headers)。需要添加一个http请求头<code class="+ topic/ph pr-d/codeph ph codeph">Content-Type : application/json</code>。</p><p class="- topic/p p">请注意，相较于http协议的get方法，post方法的参数都是放在请求正文中的，httpPost方法的param参数是填写在http报文中的正文部分。在这里，需要补充完整url。</p><p class="- topic/p p">示例:</p><p class="- topic/p p">填写参数url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = 'https://oapi.dingtalk.com/chat/create?';
ACCESS_TOKEN='xxxxx';
url+='access_token='+ACCESS_TOKEN;</code></pre><p class="- topic/p p">填写参数param：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param='{"name" : "groupName","owner" : "zhangsan","useridlist" : ["zxxxx","lxxxx"]}';</code></pre><p class="- topic/p p">填写参数header，冒号必须紧跟Content-Type，否则钉钉服务端不能识别这个http请求头。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>header='Content-Type: application/json';</code></pre><p class="- topic/p p">调用<code class="+ topic/ph pr-d/codeph ph codeph">httpPost</code>向钉钉发送创建群聊的请求：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpPost(url,param,1000,header);
print ret['text'];</code></pre><p class="- topic/p p">返回值ret是一个dictionary，ret['text']是响应正文。
如果请求成功，返回的json格式正文类似如下:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{   "errcode" : 0,
    "errmsg" : "ok",
    "chatid" : "chatxxxxxxxxxxxxxxxxxxx",
    "conversationTag" : 2
}</code></pre><p class="- topic/p p">请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看<a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg" target="_blank" rel="external noopener">钉钉开发错误码表</a>。</p><p class="- topic/p p">这里我们使用：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
ERRCODE=body.errcode;</code></pre><p class="- topic/p p">就可以便捷地把errcode解析出来。</p></div></article><article class="- topic/topic topic nested4" aria-labelledby="ariaid-title19" id="向企业群聊发送消息"><h5 class="- topic/title title topictitle5" id="ariaid-title19">向企业群聊发送消息</h5><div class="- topic/body body"><p class="- topic/p p"><a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/serverapi2/isu6nk" target="_blank" rel="external noopener">链接</a></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">请求方式：POST（HTTPS）</p><p class="- topic/p p">请求地址：https://oapi.dingtalk.com/chat/send?access_token=ACCESS_TOKEN</p></li><li class="- topic/li li"><p class="- topic/p p">对于post请求，调用钉钉接口需要有一个http请求头(<code class="+ topic/ph pr-d/codeph ph codeph">Content-Type:application/json</code>)。</p></li><li class="- topic/li li"><p class="- topic/p p">url中的ACCESS_TOKEN可以通过第二个步骤获取。</p></li><li class="- topic/li li"><p class="- topic/p p">参数都是以json的格式放在post请求正文中。</p></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{"chatid" : "xxxxx","msg" : {"msgtype" : "text","text" : {"content" : "这是一条测试信息"}}}</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">chatid:群会话的id。通过创建一个群聊会话获得。可以由上一个步骤获得。</li><li class="- topic/li li">msg:消息内容。</li></ul><p class="- topic/p p">这里使用httpClient中的函数httpPost(url,params,timeout,headers)。需要添加一个http请求头<code class="+ topic/ph pr-d/codeph ph codeph">Content-Type: application/json</code>。</p><p class="- topic/p p">请注意，相较于http协议的get方法，post方法的参数都是放在请求正文中的，httpPost方法的param参数是填写在http报文中的正文部分。在这里，需要补充完整url。</p><p class="- topic/p p">示例:</p><p class="- topic/p p">填写参数url：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>url = "https://oapi.dingtalk.com/chat/send?";
ACCESS_TOKEN='xxxxx';
url+='access_token='+ACCESS_TOKEN;</code></pre><p class="- topic/p p">填写参数headers：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>headers=dict(string,string);
headers['Content-Type']='application/json';</code></pre><p class="- topic/p p">填写参数param：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>param='{"chatid" : "xxx","msg" : {"msgtype" : "text","text" : {"content" : "这是一条测试信息"}}}';</code></pre><p class="- topic/p p">调用<code class="+ topic/ph pr-d/codeph ph codeph">httpPost</code>向钉钉发送群聊消息的请求：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ret=httpClient::httpPost(url,param,1000,headers);
print ret['text'];</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">如果请求成功，返回的json格式正文类似如下，errcode的值为0。</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>{"errcode" : 0,"errmsg" : "ok","messageId" : "abcd"}</code></pre><blockquote class="- topic/lq lq"><p class="- topic/p p">请注意，errcode是向钉钉开发平台请求信息的错误码，如果请求成功，返回值是0。不同于http协议的请求返回的响应码。如果出现其他errcode值，查看错误信息errmsg。errcode的值的含义可查看<a class="- topic/xref xref" href="https://ding-doc.dingtalk.com/doc#/faquestions/rftpfg" target="_blank" rel="external noopener">钉钉开发错误码表</a>。</p></blockquote><p class="- topic/p p">通过以下脚本就能把errcode从json格式正文中取出来。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>body = parseExpr(ret.text).eval();
ERRCODE=body.errcode;</code></pre></div></article></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title20" id="邮件发送示例"><h3 class="- topic/title title topictitle3" id="ariaid-title20">邮件发送示例</h3><div class="- topic/body body"><p class="- topic/p p">函数sendEmail支持单发邮件和群发邮件。</p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title21" id="前提"><h4 class="- topic/title title topictitle4" id="ariaid-title21">前提</h4><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">使用本插件的邮件发送函数通常需要在邮件服务商上面设置开启smtp协议。如果还需要获取邮箱授权码，参数psw为邮箱授权码的字符串，否则psw就是邮箱账号的密码。</li><li class="- topic/li li">在httpClient插件里面，默认设置了126, 163, yeah.net, sohu, dolphindb, qq邮箱的域名地址和端口。如果使用别的邮箱用户来发送邮件，需要通过emailSmtpConfig自行配置服务器地址和端口:</li></ul><p class="- topic/p p">通过<code class="+ topic/ph pr-d/codeph ph codeph">httpClient::emailSmtpConfig(emailName,host,port)</code>配置邮箱服务器地址和端口。其中，emailName是邮箱名称，格式为邮箱'@'字符后的字符串；host是邮箱stmp服务器的地址；port是邮箱服务器端口。在httpClient插件里面，默认设置了126, 163, yeah.net, sohu, dolphindb, qq邮箱的域名地址和端口。如果使用别的邮箱用户来发送邮件，需要自行配置服务器地址和端口。配置方式如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>emailName="yahoo.com";
host="smtp.yahoo.com";
port=25;
httpClient::emailSmtpConfig(emailName,host,port);</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title22" id="发送邮件"><h4 class="- topic/title title topictitle4" id="ariaid-title22">发送邮件</h4><div class="- topic/body body"><p class="- topic/p p">通过<code class="+ topic/ph pr-d/codeph ph codeph">httpClient::sendEmail(user,psw,emailTo,subject,text)</code>发送邮件。其中，user需要填入实际的发送邮箱账号，psw填入实际的邮箱密码(邮箱授权码)。</p><p class="- topic/p p">示例：</p><ul class="- topic/ul ul"><li class="- topic/li li">单发邮件，recipient填入收件人邮箱。</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>user='MailFrom@xxx.com';
psw='xxxxx';</code></pre><p class="- topic/p p">如果是单发邮件，recipient填写为一个目标邮箱的字符串。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>recipient='Maildestination@xxx.com';</code></pre><p class="- topic/p p">执行sendEmail函数，需要填写subject和text参数。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>res=httpClient::sendEmail(user,psw,recipient,'This is a subject','It is a text');
assert  res[`responseCode]==250;</code></pre><p class="- topic/p p">返回值是一个字典res，如果发送成功，res['responseCode']==250。</p><ul class="- topic/ul ul"><li class="- topic/li li">群发邮件，recipientCollection填入收件人邮箱列表。</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>user='MailFrom@xxx.com';
psw='xxxxx';</code></pre><p class="- topic/p p">如果是群发邮件，recipient填写为目标邮箱的字符串集合。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>recipientCollection='Maildestination@xxx.com''Maildestination2@xxx.com''Maildestination3@xxx.com';</code></pre><p class="- topic/p p">执行sendEmail函数，需要填写subject和text参数。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>res=httpClient::sendEmail(user,psw,recipientCollection,'This is a subject','It is a text');
assert  res[`responseCode]==250;</code></pre><p class="- topic/p p">返回值是一个字典res，如果发送成功，res['responseCode']==250。</p></div></article></article></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#%E5%9C%A8-dolphindb-%E4%B8%AD%E5%8A%A0%E8%BD%BD-httpclient-%E6%8F%92%E4%BB%B6" data-tocid="在-dolphindb-中加载-httpclient-插件">在 DolphinDB 中加载 httpClient 插件</a><ul><li class="topic-item"><a href="#linux" data-tocid="linux">Linux</a></li></ul></li><li class="topic-item"><a href="#%E4%B8%89%E7%A7%8D%E5%A4%96%E9%83%A8%E6%B6%88%E6%81%AF%E5%B9%B3%E5%8F%B0%E7%9A%84%E4%BD%BF%E7%94%A8" data-tocid="三种外部消息平台的使用">三种外部消息平台的使用</a><ul><li class="topic-item"><a href="#%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%B6%88%E6%81%AF%E9%80%9A%E4%BF%A1%E7%9A%84%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B" data-tocid="企业微信消息通信的演示案例">企业微信消息通信的演示案例</a><ul><li class="topic-item"><a href="#%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E5%86%85%E8%87%AA%E5%BB%BA%E6%96%B0%E5%BA%94%E7%94%A8" data-tocid="企业微信内自建新应用">企业微信内自建新应用</a></li><li class="topic-item"><a href="#%E8%8E%B7%E5%8F%96-access-token" data-tocid="获取-access-token">获取 access_token</a></li><li class="topic-item"><a href="#%E5%8F%91%E9%80%81%E5%BA%94%E7%94%A8%E6%B6%88%E6%81%AF" data-tocid="发送应用消息">发送应用消息</a></li><li class="topic-item"><a href="#%E5%8F%91%E9%80%81%E7%BE%A4%E8%81%8A%E6%B6%88%E6%81%AF" data-tocid="发送群聊消息">发送群聊消息</a><ul><li class="topic-item"><a href="#%E5%88%9B%E5%BB%BA%E4%BC%81%E4%B8%9A%E7%BE%A4%E8%81%8A" data-tocid="创建企业群聊">创建企业群聊</a></li><li class="topic-item"><a href="#%E5%88%A9%E7%94%A8-post-%E8%AF%B7%E6%B1%82%E5%8F%91%E9%80%81%E7%BE%A4%E8%81%8A%E6%B6%88%E6%81%AF" data-tocid="利用-post-请求发送群聊消息">利用 post 请求发送群聊消息</a></li></ul></li></ul></li><li class="topic-item"><a href="#%E9%92%89%E9%92%89%E6%B6%88%E6%81%AF%E9%80%9A%E4%BF%A1%E7%9A%84%E6%BC%94%E7%A4%BA%E6%A1%88%E4%BE%8B" data-tocid="钉钉消息通信的演示案例">钉钉消息通信的演示案例</a><ul><li class="topic-item"><a href="#%E5%88%9B%E5%BB%BA%E4%BC%81%E4%B8%9A%E5%86%85%E9%83%A8%E5%BC%80%E5%8F%91%E5%BA%94%E7%94%A8%E7%94%B3%E8%AF%B7%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E6%9D%83%E9%99%90" data-tocid="创建企业内部开发应用申请接口调用权限">创建企业内部开发应用，申请接口调用权限</a></li><li class="topic-item"><a href="#%E8%8E%B7%E5%8F%96access-token" data-tocid="获取access-token">获取access_token</a></li><li class="topic-item"><a href="#%E5%8F%91%E9%80%81%E7%BE%A4%E8%81%8A%E6%B6%88%E6%81%AF-1" data-tocid="发送群聊消息-1">发送群聊消息</a><ul><li class="topic-item"><a href="#%E8%8E%B7%E5%8F%96%E9%83%A8%E9%97%A8%E5%88%97%E8%A1%A8" data-tocid="获取部门列表">获取部门列表</a></li><li class="topic-item"><a href="#%E8%8E%B7%E5%8F%96%E9%83%A8%E9%97%A8%E4%B8%8B%E6%88%90%E5%91%98%E8%AF%A6%E6%83%85" data-tocid="获取部门下成员详情">获取部门下成员详情</a></li><li class="topic-item"><a href="#%E5%88%9B%E5%BB%BA%E4%BC%81%E4%B8%9A%E7%BE%A4%E8%81%8A-1" data-tocid="创建企业群聊-1">创建企业群聊</a></li><li class="topic-item"><a href="#%E5%90%91%E4%BC%81%E4%B8%9A%E7%BE%A4%E8%81%8A%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF" data-tocid="向企业群聊发送消息">向企业群聊发送消息</a></li></ul></li></ul></li><li class="topic-item"><a href="#%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E7%A4%BA%E4%BE%8B" data-tocid="邮件发送示例">邮件发送示例</a><ul><li class="topic-item"><a href="#%E5%89%8D%E6%8F%90" data-tocid="前提">前提</a></li><li class="topic-item"><a href="#%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6" data-tocid="发送邮件">发送邮件</a></li></ul></li></ul></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>