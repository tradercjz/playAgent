<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="根据某个基金每日的净值数据计算得到的因子称作“基金日频因子”。基金日频因子能反映出基金的近况，是衡量基金收益、波动、风险等的重要指标。随着数据规模与日俱增，对大规模数量级的数据进行处理的需求日益旺盛，在计算的速度、准确性上对计算工具提出了更高的要求。 本教程将为大家介绍如何基于 DolphinDB 计算多个基金的日频因子，并通过 Python ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="计算基金日频因子"/><title>计算基金日频因子</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;计算基金日频因子&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;计算基金日频因子&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;根据某个基金每日的净值数据计算得到的因子称作“基金日频因子”。基金日频因子能反映出基金的近况，是衡量基金收益、波动、风险等的重要指标。随着数据规模与日俱增，对大规模数量级的数据进行处理的需求日益旺盛，在计算的速度、准确性上对计算工具提出了更高的要求。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;本教程将为大家介绍如何基于 DolphinDB 计算多个基金的日频因子，并通过 Python 实现相同因子的计算，对比两者的计算性能。所用数据约220万条，均为与沪深300指数按日期对齐后的基金净值数据。结果表明在不同 CPU 核数下，DolphinDB 较 Python 均有明显的性能优势。&lt;/p&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:108;143:91&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-测试环境&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;1. 测试环境&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;安装 DolphinDB server，配置为单节点模式，其默认端口号为&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;10:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;8848&lt;/codeph&gt;。本次测试所涉及到的硬件环境和软件环境如下：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;12:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;12:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;硬件环境&lt;/b&gt;&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:1;14:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:1;14:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:1;14:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:2;14:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:1;14:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:1;14:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:1;14:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;硬件名称&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:2;14:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;配置信息&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:1;16:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:2;16:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:3;16:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;操作系统&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:4;16:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;64位 CentOS Linux 7 (Core)&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:3;17:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:5;17:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;内存&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:6;17:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;256 GB&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:4;18:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:7;18:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;CPU 类型&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:8;18:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Intel(R) Xeon(R) Silver 4216 CPU @ 2.10GHz&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;20:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;20:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;20:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;软件环境&lt;/b&gt;&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:2;22:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrc=&#34;tgroup:2;22:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:3;22:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:4;22:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:5;22:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:2;22:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:5;22:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:9;22:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;软件名称&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:10;22:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;版本信息&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:11;22:72&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;教程&amp;amp;下载链接&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:2;24:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:6;24:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:12;24:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:13;24:67&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;2.00.7&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:14;24:79&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;standalone_server.md&#34; xtrc=&#34;xref:1;24:80&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB单节点部署教程&lt;/xref&gt;；&lt;xref class=&#34;- topic/xref &#34; format=&#34;php&#34; href=&#34;https://dolphindb.cn/alone/alone.php?id=10&#34; scope=&#34;external&#34; xtrc=&#34;xref:2;24:121&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB下载链接&lt;/xref&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:7;25:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:15;25:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB GUI&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:16;25:67&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;1.30.19.2&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:17;25:79&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;php&#34; href=&#34;https://dolphindb.cn/alone/alone.php?id=10&#34; scope=&#34;external&#34; xtrc=&#34;xref:3;25:80&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB GUI下载链接&lt;/xref&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:8;26:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:18;26:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python（包含numpy、pandas、scipy等库以及 DolphinDB 的 Python API，需要预先安装）&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:19;26:69&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;3.7.9&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:20;26:82&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://www.python.org/&#34; scope=&#34;external&#34; xtrc=&#34;xref:4;26:83&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;?ditaot usertext?&gt;Python官网&lt;/xref&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-基金日频因子背景介绍及代码实现&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;2. 基金日频因子背景介绍及代码实现&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;30:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;本教程选取了10个基金日频因子，涵盖基金评价体系的各个方面，作为性能测试的指标。其相关的背景含义、计算公式及在 DolphinDB 脚本和 Python 中的定义如下所示：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;注意&lt;/b&gt;：下文提到的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;32:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DailyValue&lt;/codeph&gt; 指日净值，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;32:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DailyReturn&lt;/codeph&gt; 指日收益率，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;32:52&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;BeginningValue&lt;/codeph&gt; 指基金日净值序列中的第一个净值数据，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;32:87&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;EndingValue&lt;/codeph&gt; 指基金日净值序列中的最后一个净值数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;34:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;34:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;年化收益率&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;36:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：将当前收益率转换为一年内（按252个交易日计算）的收益率；&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;37:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation1.png&#34; placement=&#34;break&#34; xtrc=&#34;image:1;39:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;523&#34; dita-ot:image-height=&#34;38&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:1;39:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation1&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:3;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; defg getAnnualReturn(value){ return pow(1 + ((last(value) - first(value))\first(value)), 252\730) - 1 }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:4;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getAnnualReturn(value): return pow(1 + ((value[-1] - value[0])/value[0]), 252/730)-1&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;年化波动率&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:5;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;59:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：衡量基金的波动风险&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;60:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;60:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation2.png&#34; placement=&#34;break&#34; xtrc=&#34;image:2;62:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;461&#34; dita-ot:image-height=&#34;71&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:2;62:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation2&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;64:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:6;66:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;66:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;68:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; defg getAnnualVolatility(value){ return std(deltas(value)\prev(value)) * sqrt(252) }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:7;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getAnnualVolatility(value): diff_value = np.diff(value) rolling_value = np.roll(value, 1) rolling_value = np.delete(rolling_value, [0]) return np.std(np.true_divide(diff_value, rolling_value), ddof=1) * np.sqrt(252)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;83:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;83:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;收益率偏度&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:8;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;85:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：衡量收益偏斜程度&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;86:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;86:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation3.png&#34; placement=&#34;break&#34; xtrc=&#34;image:3;88:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;411&#34; dita-ot:image-height=&#34;83&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:3;88:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation3&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;90:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:9;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;94:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; defg getAnnualSkew(value){ return skew(deltas(value)\prev(value)) }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:10;100:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;100:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getAnnualSkew(value): diff_value = np.diff(value) rolling_value = np.roll(value, 1) rolling_value = np.delete(rolling_value, [0]) return st.skew(np.true_divide(diff_value, rolling_value))&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:7;110:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;收益率峰度&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:11;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;112:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;112:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：基金日收益率的分布相对于正态分布的峰值程度和尾部厚度&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;113:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation4.png&#34; placement=&#34;break&#34; xtrc=&#34;image:4;115:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;384&#34; dita-ot:image-height=&#34;79&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:4;115:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation4&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;117:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:12;119:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;119:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;121:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; defg getAnnualKur(value){ return kurtosis(deltas(value)\prev(value)) }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:13;127:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;127:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;129:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getAnnualKur(value): diff_value = np.diff(value) rolling_value = np.roll(value, 1) rolling_value = np.delete(rolling_value, [0]) return st.kurtosis(np.true_divide(diff_value, rolling_value), fisher=False)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;137:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:8;137:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;夏普比率&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:14;139:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;139:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;139:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：反映单位风险基金净值增长率超过无风险收益率的程度&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;140:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation5.png&#34; placement=&#34;break&#34; xtrc=&#34;image:5;142:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;407&#34; dita-ot:image-height=&#34;17&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:5;142:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation5&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;144:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:15;146:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;146:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;148:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; defg getSharp(value){ return (getAnnualReturn(value) - 0.03)\getAnnualVolatility(value) as sharpeRat }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:16;153:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:22;153:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getSharp(value): return (getAnnualReturn(value) - 0.03)/getAnnualVolatility(value) if getAnnualVolatility(value) != 0 else 0&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;160:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:9;160:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;最大回撤率&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:17;162:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:23;162:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;162:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：指在选定周期内任一历史时点往后推，产品净值走到最低点时的收益率回撤幅度的最大值&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:24;163:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;163:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：在某个时间周期的净值序列中，记 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;163:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;i&lt;/codeph&gt; 为某一天，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;163:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DailyValuei&lt;/codeph&gt; 为第 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;163:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;i&lt;/codeph&gt; 天的净值，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;163:57&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;j&lt;/codeph&gt; 为 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;163:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;i&lt;/codeph&gt; 之前的某一天，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;163:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DailyValuej&lt;/codeph&gt; 为第 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;163:91&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;j&lt;/codeph&gt; 天的净值，找到一组 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;163:105&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;i&lt;/codeph&gt;, &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;163:111&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;j&lt;/codeph&gt; 使得其收益率回撤幅度最大记为最大回撤率 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;163:135&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;MaxDrawdown&lt;/codeph&gt;，&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation6.png&#34; placement=&#34;break&#34; xtrc=&#34;image:6;165:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;309&#34; dita-ot:image-height=&#34;40&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:6;165:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation6&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;167:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;170:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getMaxDrawdown(value){ i = imax((cummax(value) - value) \ cummax(value)) if (i==0){ return 0 } j = imax(value[:i]) return (value[j] - value[i]) \ (value[j]) }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:18;181:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:25;181:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:12;183:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getMaxDrawdown(value): i = np.argmax((np.maximum.accumulate(value) - value) / np.maximum.accumulate(value)) if i == 0: return 0 j = np.argmax(value[:i]) return (value[j] - value[i]) / value[j]&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;192:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:10;192:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;收益回撤比&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:19;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:26;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;194:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：是收益和风险的比值，可以用来衡量一只基金产品投资策略的好坏。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:27;195:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;195:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation7.png&#34; placement=&#34;break&#34; xtrc=&#34;image:7;197:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;404&#34; dita-ot:image-height=&#34;17&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:7;197:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation7&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;199:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:20;201:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:28;201:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:13;203:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getDrawdownRatio(value){ return getAnnualReturn(value) \ getMaxDrawdown(value) }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:21;209:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:29;209:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:14;211:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getDrawdownRatio(value): return getAnnualReturn(value) / getMaxDrawdown(value) if getMaxDrawdown(value) != 0 else 0&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;216:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:11;216:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;β系数&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:22;218:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:30;218:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;218:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：一种风险指数，可以衡量股票基金相对于整个股市的波动情况&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:31;219:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;219:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation8.png&#34; placement=&#34;break&#34; xtrc=&#34;image:8;221:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;390&#34; dita-ot:image-height=&#34;59&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:8;221:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation8&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;其中分子为日净值收益率和日基准收益率的协方差，分母为日基准收益率的方差&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;225:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:23;226:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:32;226:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:15;227:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getBeta(value, price){ return covar(deltas(value)\prev(value), deltas(price)\prev(price)) \ std(deltas(price)\prev(price)) }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:24;232:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:33;232:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:16;233:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getBeta(value, price): diff_price = np.diff(price) rolling_price = np.roll(price, 1) rolling_price = np.delete(rolling_price, [0]) diff_value = np.diff(value) rolling_value = np.roll(value, 1) rolling_value = np.delete(rolling_value, [0]) return np.cov(np.true_divide(diff_value, rolling_value), np.true_divide(diff_price, rolling_price))[0][1] / np.std(np.true_divide(diff_price, rolling_price), ddof=1)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;244:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:12;244:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;α系数&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:25;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:34;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;246:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：一种风险指数，用于衡量与市场波动无关的超额收益&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:35;247:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:43;247:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation9.png&#34; placement=&#34;break&#34; xtrc=&#34;image:9;249:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;450&#34; dita-ot:image-height=&#34;17&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:9;249:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation9&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:44;251:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:26;253:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:36;253:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:17;254:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getAlpha(value, price){ return getAnnualReturn(value) - 0.03 - getBeta(value, price) * (getAnnualReturn(price) - 0.03) }&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:27;259:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:37;259:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:18;261:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def getAlpha(value, price): return getAnnualReturn(value) - 0.03 - getBeta(value, price) * (getAnnualReturn(price) - 0.03)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:45;266:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:13;266:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;赫斯特指数&lt;/b&gt;&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:28;268:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:38;268:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:46;268:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;因子含义：体现时间序列的自相关性，尤其是序列中隐藏的长期趋势的指标。此处用来揭示某只基金序列中的隐藏长期趋势。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:39;269:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:47;269:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;计算方法：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:48;271:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;a. 将收益率序列按照不同的粒度（记为 k）切分成不同的片段，此处从粒度2到粒度365开始切分序列； b. 计算每个片段的均值，此处要计算2+3+4+...+365种；&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:40;274:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:49;274:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation10.png&#34; placement=&#34;break&#34; xtrc=&#34;image:10;276:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;249&#34; dita-ot:image-height=&#34;39&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:10;276:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation10&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:50;278:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;c. 计算每个片段的离差序列，即用每个片段的均值分别减该片段内的每个元素；&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:29;280:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:41;280:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:51;280:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation11.png&#34; placement=&#34;break&#34; xtrc=&#34;image:11;282:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;366&#34; dita-ot:image-height=&#34;15&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:11;282:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation11&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:52;284:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;d. 计算每个片段离差序列中的最大值减去最小值，记为 R；&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:30;286:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:42;286:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:53;286:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation12.png&#34; placement=&#34;break&#34; xtrc=&#34;image:12;288:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;345&#34; dita-ot:image-height=&#34;17&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:12;288:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation12&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:54;290:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;e. 计算每个片段的标准差，记为 S；&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:31;292:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:43;292:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:55;292:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation13.png&#34; placement=&#34;break&#34; xtrc=&#34;image:13;294:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;174&#34; dita-ot:image-height=&#34;51&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:13;294:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation13&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:56;296:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;f. 计算每个片段的 R/S 值，并计算按照不同粒度划分的所有片段中各片段元素的均值；&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:32;298:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:44;298:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:57;298:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/equation14.png&#34; placement=&#34;break&#34; xtrc=&#34;image:14;300:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;129&#34; dita-ot:image-height=&#34;38&#34;&gt;&lt;alt class=&#34;- topic/alt &#34; xtrc=&#34;alt:14;300:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;equation14&lt;/alt&gt;&lt;/image&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:58;302:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;g. 以划分的标准粒度为自变量，以对应的各片段元素的均值为因变量，计算回归方程，截距即为赫斯特指数；&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:33;304:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:45;304:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;公式：AVS=a*k+b，经过计算后系数 a 为赫斯特指数&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:59;306:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;代码实现：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:34;307:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:46;307:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:60;307:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:19;308:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def calAllRs2(mret, symList, k){ rowCount = mret.rows()/k * k demeanCum = rolling(cumsum, mret[0:rowCount,] - each(stretch{, rowCount}, rolling(avg, mret, k, k)), k, k) a = rolling(max, demeanCum, k, k) - rolling(min, demeanCum, k, k) RS = nullFill!(a/rolling(stdp, mret, k, k), 1.0).mean().log() return table(symList as fundNum, take(log(k), symList.size()) as knum, RS as factor1) }&lt;/codeblock&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:47;317:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:61;317:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:20;319:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; def calHurst(value_list, min_k): n = len(value_list) max_k = int(np.floor(n / 2)) r_s_dict = [] for k in range(min_k, max_k +1): subset_list = [value_list[i: i+k] for i in range(0, n, k)] if np.mod(n, k) &amp;gt; 0: subset_list.pop() df_subset = np.array(subset_list) df_mean = df_subset.mean(axis=1).reshape(-1,1) df_cusum = (df_subset - df_mean).cumsum(axis=1) r = df_cusum.max(axis=1) - df_cusum.min(axis=1) + np.spacing(1) s = df_subset.std(axis=1, ddof=0) + np.spacing(1) r_s_dict.append({'R_S': (r / s).mean(), 'N': k}) log_r_s=[] log_n=[] for i in range(len(r_s_dict)): log_r_s.append(np.log(r_s_dict[i]['R_S'])) log_n.append(np.log(r_s_dict[i]['N'])) try: res = np.polyfit(log_n, log_r_s, 1)[0] except: res = None return res&lt;/codeblock&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-dolphindb-中因子计算实现及性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;346:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;346:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;3. DolphinDB 中因子计算实现及性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;346:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;31-数据导入及概览&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;348:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;348:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;3.1. 数据导入及概览&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;348:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:35;350:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:48;350:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:62;350:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:14;350:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;数据结构&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:63;352:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;本教程选取了2018.05.24 - 2021.05.27期间3000多支基金的日净值数据，总数据量为330多万条。以下是净值表在 DolphinDB 中的数据结构：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:3;354:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrc=&#34;tgroup:3;354:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:6;354:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:7;354:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:8;354:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:3;354:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:9;354:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:21;354:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;字段名&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:22;354:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;字段含义&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:23;354:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;数据类型（DolphinDB）&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:3;356:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:10;356:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:24;356:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;tradingDate&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:25;356:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;交易日期&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:26;356:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DATE&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:11;357:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:27;357:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;fundNum&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:28;357:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;基金交易代码&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:29;357:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:12;358:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:30;358:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;value&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:31;358:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;基金日净值&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:32;358:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:64;360:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;同时，本教程选取了2018.05.24 - 2021.05.27期间沪深300指数的数据，共734条，用于和基金日净值数据作对齐操作。以下是指数表在 DolphinDB 中的数据结构：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:4;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrc=&#34;tgroup:4;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:9;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:10;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:11;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:4;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:13;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:33;362:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;字段名&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:34;362:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;字段含义&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:35;362:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;数据类型（DolphinDB）&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:4;364:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:14;364:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:36;364:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;tradingDate&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:37;364:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;交易日期&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:38;364:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DATE&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:15;365:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:39;365:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;fundNum&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:40;365:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;指数名称（此处均为沪深300）&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:41;365:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:16;366:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:42;366:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;value&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:43;366:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;沪深300收盘价格&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:44;366:42&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:49;368:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:65;368:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:15;368:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;数据导入&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:66;370:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;本教程所使用的数据分别存储在两个 CSV 为格式的文件中，使用前需要先导入到 DolphinDB 的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;370:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;fund_OLAP&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:17;370:68&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;fund_hs_OLAP&lt;/codeph&gt; 维度表中。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:67;372:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;首先，通过 DolphinDB GUI 连接 DolphinDB 后，定义函数分别读取 CSV 文件：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:21;374:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;//获取 CSV 数据列名 def readColumnsFromWideCSV(absoluteFilename){ schema1 = extractTextSchema(absoluteFilename) update schema1 set type = `STRING allSymbol = loadText(absoluteFilename,,schema1)[0, 1:] titleSchema = extractTextSchema(absoluteFilename, skipRows = 0); for(x in allSymbol){ testValue = exec x[name] from titleSchema testValue = testValue[1:] } return testValue } //获取 CSV 文件数据内容 def readIndexedMatrixFromWideCSV(absoluteFilename){ contracts = readColumnsFromWideCSV(absoluteFilename) dataZoneSchema = extractTextSchema(absoluteFilename, skipRows = 1) update dataZoneSchema set type = &#34;DOUBLE&#34; where name != &#34;col0&#34;//所有行除第一行外全部改成double update dataZoneSchema set type = &#34;DATE&#34; where name = &#34;col0&#34;//所有行除第一行外全部改成DATE dataZoneWithIndexColumn = loadText(absoluteFilename, skipRows = 1, schema = dataZoneSchema) indexVector = exec col0 from dataZoneWithIndexColumn dataZoneWithoutIndex = dataZoneWithIndexColumn[:, 1:] dataMatrix = matrix(dataZoneWithoutIndex) dataMatrix.rename!(indexVector, contracts) return dataMatrix }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:68;402:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;其次，调用该函数获取文件中的数据，将之转换分别赋予新的列名，存入 DolphinDB 的内存表：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:22;404:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;//基金日净值数据 allSymbols = readColumnsFromWideCSV(csvPath)$STRING dataMatrix = readIndexedMatrixFromWideCSV(csvPath) fundTable = table(dataMatrix.rowNames() as tradingdate, dataMatrix) result = fundTable.unpivot(`tradingDate, allSymbols).rename!(`tradingdate`fundNum`value) //沪深300指数 allSymbols1 = readColumnsFromWideCSV(csvPath1)$STRING dataMatrix1 = readIndexedMatrixFromWideCSV(csvPath1) fundTable1 = table(dataMatrix1.rowNames() as tradingDate, dataMatrix1) result1 = fundTable1.unpivot(`tradingDate, allSymbols1).rename!(`tradingdate`fundNum`value)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:69;418:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;最后，建立分布式数据库 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:18;418:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;dfs://fund_OLAP&lt;/codeph&gt; 和维度表 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:19;418:38&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;fund_OLAP&lt;/codeph&gt;, &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:20;418:51&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;fund_hs_OLAP&lt;/codeph&gt;，并导入数据：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:23;420:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;//创建数据库 dbName = &#34;dfs://fund_OLAP&#34; dataDate = database(, VALUE, 2021.01.01..2021.12.31) symbol = database(, HASH, [SYMBOL, 20]) if(existsDatabase(dbName)){ dropDatabase(dbName) } db = database(dbName, COMPO, [dataDate, symbol]) //定义表结构 name = `tradingdate`fundNum`value type = `DATE`SYMBOL`DOUBLE tbTemp = table(1:0, name, type) //创建维度表 fund_OLAP tbName1 = &#34;fund_OLAP&#34; db.createTable(tbTemp, tbName1) loadTable(dbName, tbName1).append!(result) //创建维度表 fund_hs_OLAP tbName2 = &#34;fund_hs_OLAP&#34; db.createTable(tbTemp, tbName2) loadTable(dbName, tbName2).append!(result1)&lt;/codeblock&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:50;443:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:70;443:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:16;443:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;数据概览&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:71;445:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;数据导入成功后，执行如下代码查看前十条 fund_OLAP 数据：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:24;447:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;select top 10 * from loadTable(&#34;dfs://fund_OLAP&#34;, &#34;fund_OLAP&#34;)&lt;/codeblock&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/fund_10.png&#34; width=&#34;300&#34; xtrc=&#34;image:15;451:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;190&#34; dita-ot:image-height=&#34;222&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:72;453:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;同样，执行如下代码查看前十条 fund_hs_OLAP 数据：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:25;455:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;select top 10 * from loadTable(&#34;dfs://fund_OLAP&#34;, &#34;fund_hs_OLAP&#34;)&lt;/codeblock&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/fund_hs_10.png&#34; width=&#34;300&#34; xtrc=&#34;image:16;459:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;210&#34; dita-ot:image-height=&#34;223&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;32-数据处理&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;461:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;461:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;3.2. 数据处理&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;461:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:73;463:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;分别从两张表中取出数据，同沪深300指数按日期对齐（使用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:21;463:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;aj&lt;/codeph&gt;），填充空缺值，仅保留两表中日期相同的数据：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:26;465:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;fund_OLAP=select * from loadTable(&#34;dfs://fund_OLAP&#34;, &#34;fund_OLAP&#34;) fund_hs_OLAP=select * from loadTable(&#34;dfs://fund_OLAP&#34;, &#34;fund_hs_OLAP&#34;) ajResult=select tradingDate, fundNum, value, fund_hs_OLAP.tradingDate as hstradingDate, fund_hs_OLAP.value as price from aj(fund_OLAP, fund_hs_OLAP, `tradingDate) result2=select tradingDate, fundNum, iif(isNull(value), ffill!(value), value) as value, price from ajResult where tradingDate == hstradingDate&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:74;472:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;同时，计算多个基金的日收益率，进行赫斯特指数的计算：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:27;474:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;symList = exec distinct(fundNum) as fundNum from result2 order by fundNum portfolio = select fundNum as fundNum, (deltas(value)\prev(value)) as log, tradingDate as tradingDate from result2 where tradingDate in 2018.05.24..2021.05.27 and fundNum in symList m_log = exec log from portfolio pivot by tradingDate, fundNum mlog = m_log[1:,]&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:75;481:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;处理后的数据共220万条，结构如下：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:5;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrc=&#34;tgroup:5;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:12;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:13;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:14;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:5;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:17;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:45;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;字段名&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:46;483:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;字段含义&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:47;483:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;数据类型（DolphinDB）&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:5;485:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:18;485:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:48;485:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;tradingDate&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:49;485:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;交易日期&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:50;485:30&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DATE&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:19;486:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:51;486:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;fundNum&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:52;486:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;基金交易代码&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:53;486:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:20;487:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:54;487:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;value&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:55;487:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;基金日净值&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:56;487:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:21;488:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:57;488:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;price&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:58;488:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;沪深300收盘价格&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:59;488:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:22;489:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:60;489:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;log&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:61;489:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;基金日收益率&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:62;489:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;33-性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;491:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;491:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;3.3. 性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;491:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:76;493:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;本节测试了DolphinDB的性能与任务量以及cpu核数的关系。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:36;495:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:51;495:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;任务量：修改提交作业的数量。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:52;496:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;CPU 核数：修改 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:22;496:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;dolphindb.cfg&lt;/codeph&gt; 文件中的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:23;496:34&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;workerNum&lt;/codeph&gt;参数，其配置值表示计算时所用到的CPU 核数。注意：每次参数修改后，需要重启 DolphinDB Server 才能生效。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:77;498:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;本教程以提交后台作业的计算时间来反映 DolphinDB 性能。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:37;500:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:53;500:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:78;500:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;在性能测试前，首先定义计算9个因子（不包含赫斯特指数）的函数：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:28;502:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;def getmetric(result2, symList){ Return = select fundNum, getAnnualReturn(value) as annualReturn, getAnnualVolatility(value) as annualVolRat, getAnnualSkew(value) as skewValue, getAnnualKur(value) as kurValue, getSharp(value) as sharpValue, getMaxDrawdown(value) as MaxDrawdown, getDrawdownRatio(value) as DrawdownRatio, getBeta(value, price) as Beta, getAlpha(value, price) as Alpha from result2 where TradeDate in 2018.05.24..2021.05.27 and fundNum in symList group by fundNum }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:79;519:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;其中，部分运算结果如下图所示:&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/fund_factor_contrasted_by_py/calculating_outcome.png&#34; width=&#34;400&#34; xtrc=&#34;image:17;521:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34; dita-ot:image-width=&#34;728&#34; dita-ot:image-height=&#34;259&#34; dita-ot:horizontal-dpi=&#34;96&#34; dita-ot:vertical-dpi=&#34;96&#34;/&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:80;523:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:17;523:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;注意&lt;/b&gt;：该计算流程执行前需要预先运行之前预定义过的 DolphinDB 实现的因子函数。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:38;525:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:54;525:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:81;525:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;计算10个因子的响应时间:&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:82;527:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;定义获取10个因子计算和数据操作的时间的函数，并提交 job：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:29;529:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;def parJob(){ timer{fund_OLAP=select * from loadTable(&#34;dfs://fund_OLAP&#34;, &#34;fund_OLAP&#34;) fund_hs_OLAP=select * from loadTable(&#34;dfs://fund_OLAP&#34;, &#34;fund_hs_OLAP&#34;) ajResult = select tradingdate, fundNum, value, fund_hs_OLAP.tradingDate as hstradingDate, fund_hs_OLAP.value as price from aj(fund_OLAP, fund_hs_OLAP, `tradingDate) result2 = select tradingdate, fundNum, iif(isNull(value), ffill!(value), value) as value,price from ajResult where tradingDate == hstradingDate symList = exec distinct(fundNum) as fundNum from result2 order by fundNum symList2 = symList.cut(250) portfolio = select fundNum as fundNum, (deltas(value)\prev(value)) as log, tradingDate as tradingDate from result2 where tradingDate in 2018.05.24..2021.05.27 and fundNum in symList m_log = exec log from portfolio pivot by tradingDate, fundNum mlog = m_log[1:,] knum = 2..365 }//此处，将任务切分，按每次250个不同基金数据进行计算. timer{ploop(getFactor{result2}, symList2) a = ploop(calAllRs2{mlog,symList}, knum).unionAll(false) res2 = select fundNum, ols(factor1, kNum)[0] as hist, ols(factor1, kNum)[1] as hist2, ols(factor1, kNum)[2] as hist3 from a group by fundNum} }//定义获取10个因子计算和数据操作的时间的函数 /** * 提交1个 job（单用户） */ submitJob(&#34;parallJob1&#34;, &#34;parallJob_single_ten&#34;, parJob) /** * 提交5个 job（多用户） */ for(i in 0..4){ submitJob(&#34;parallJob5&#34;, &#34;parallJob_multi_ten&#34;, parJob) }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:83;559:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;分别计算两种情形下的响应时间：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:30;561:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt; //获取单个用户的运行时间 select max(endTime) - min(startTime) from getRecentJobs() where jobDesc = &#34;parallJob_single_ten&#34; //获取多个用户的运行时间 select max(endTime) - min(startTime) from getRecentJobs() where jobDesc = &#34;parallJob_multi_ten&#34;&lt;/codeblock&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;34-结果展示&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;568:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;568:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;3.4. 结果展示&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;568:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:39;570:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:55;570:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:84;570:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;单任务（单位：秒）&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:6;572:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:6;572:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:15;572:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:16;572:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:6;572:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:23;572:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:63;572:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;CPU数&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:64;572:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;10个因子&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:6;574:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:24;574:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:65;574:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:66;574:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;26.03&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:25;575:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:67;575:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:68;575:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;7.23&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:26;576:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:69;576:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;12&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:70;576:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;4.23&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:56;578:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:85;578:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;多任务（此处为5用户，单位：秒）&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:7;580:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:7;580:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:17;580:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:18;580:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:7;580:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:27;580:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:71;580:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;CPU数&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:72;580:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;10个因子&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:7;582:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:28;582:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:73;582:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:74;582:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;140.50&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:29;583:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:75;583:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:76;583:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;27.53&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:30;584:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:77;584:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;12&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:78;584:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;15.66&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:86;587:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:18;587:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;注意&lt;/b&gt;：由于赫斯特指数需要按照2+3+4+...+365种不同的粒度方式切分成不同种类的序列划分，同时分别对不同粒度的每一段序列分别计算均值、离差和标准差等，并最终求平均的 R/S 值，计算的子指标过大，时间复杂度较高，因此耗时相较于其它因子更长。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;4-python-中因子计算实现及性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;589:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;589:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;4. Python 中因子计算实现及性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;589:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:87;591:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;本章节中，我们基于 Python 实现了相同的因子计算并统计计算时间。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:88;593:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;通过引入了 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:24;593:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;joblib&lt;/codeph&gt; 库中的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:25;593:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Parallel&lt;/codeph&gt; 方法，通过设置其 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:26;593:40&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;n_jobs&lt;/codeph&gt; 参数模拟不同 CPU 核数的运行环境。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:89;595:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;在性能测试中，使用 Python 定义测算基金日收益率的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:27;595:30&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;getLog()&lt;/codeph&gt; 函数和执行因子计算任务的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:28;595:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;main()&lt;/codeph&gt; 函数 (因子计算通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:29;595:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;numpy&lt;/codeph&gt;, &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:30;595:83&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;pandas&lt;/codeph&gt;, &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:31;595:93&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;scipy&lt;/codeph&gt; 等库实现)：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:31;597:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;def getLog(value): diff_value = np.diff(value) rolling_value = np.roll(value, 1) rolling_value = np.delete(rolling_value, [0]) return np.insert(np.true_divide(diff_value, rolling_value), 0, np.nan) def main(li): value = np.array(li[&#34;value&#34;]) price = np.array(li[&#34;price&#34;]) log = np.array(li[&#34;log&#34;]) getAnnualReturn(value) getAnnualVolatility(value) getAnnualSkew(value) getAnnualKur(value) getSharp(value) getMaxDrawdown(value) getDrawdownRatio(value) getBeta(value, price) getAlpha(value, price) calHurst(log, 2)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:90;620:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;使用 Python API 进行取数等数据处理操作，使用Python对其进行数据对齐和计算基金日收益率的操作。统计整个计算流程的时间：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; outputclass=&#34;python&#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:32;622:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;s = ddb.session() s.connect(&#34;127.0.0.1&#34;, 8848, &#34;admin&#34;, &#34;123456&#34;) start = time.time() fund_OLAP = s.loadTable(dbPath=&#34;dfs://fund_OLAP&#34;, tableName=&#34;fund_OLAP&#34;).select(&#34;*&#34;).toDF().sort_values(['tradingDate']) fund_hs_OLAP = s.loadTable(dbPath=&#34;dfs://fund_OLAP&#34;, tableName=&#34;fund_hs_OLAP&#34;).select(&#34;*&#34;).toDF() fund_hs_OLAP.rename(columns={'tradingDate': 'hstradingDate'}, inplace=True) fund_hs_OLAP = fund_hs_OLAP.sort_values(['hstradingDate']) fund_dui_OLAP = pd.merge_asof(fund_OLAP, fund_hs_OLAP, left_on=&#34;tradingDate&#34;, right_on=&#34;hstradingDate&#34;).sort_values(['fundNum_x', 'tradingDate']) fund_dui_OLAP = fund_dui_OLAP[fund_dui_OLAP['tradingDate'] == fund_dui_OLAP['hstradingDate']] fund_dui_OLAP.reset_index(drop=True, inplace=True) fund_dui_OLAP.drop(columns=['fundNum_y', 'hstradingDate'], inplace=True) fund_dui_OLAP.columns = ['tradingDate', 'fundNum', 'value', 'price'] fund_dui_OLAP[&#34;log&#34;] = pd.Series(getLog(fund_dui_OLAP[&#34;value&#34;])) list = fund_dui_OLAP[(fund_dui_OLAP['tradingDate'] &amp;gt;= datetime(2018, 5, 24)) &amp;amp; (fund_dui_OLAP['tradingDate'] &amp;lt;= datetime(2021, 5, 27))].groupby('fundNum') Parallel(n_jobs=1)(delayed(main)(i) for _,i in list) end = time.time() print(end-start)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;5-性能计算结果对比分析&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;642:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;642:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;5. 性能计算结果对比分析&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;642:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:40;644:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:57;644:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:91;644:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;单任务（单位：秒）&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:8;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;4&#34; xtrc=&#34;tgroup:8;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:19;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:20;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:21;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:22;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:8;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:31;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:79;646:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;CPU数&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:80;646:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB 响应时间&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:81;646:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python 响应时间&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:82;646:42&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python/DolphinDB&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:8;648:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:32;648:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:83;648:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:84;648:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;26.03&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:85;648:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;112.34&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:86;648:60&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;4.32&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:33;649:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:87;649:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:88;649:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;7.23&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:89;649:45&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;55.35&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:90;649:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;7.66&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:34;650:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:91;650:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;12&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:92;650:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;4.23&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:93;650:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;36.19&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:94;650:46&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;8.56&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:58;652:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:92;652:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;多任务（此处为5用户，单位：秒）&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:9;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;4&#34; xtrc=&#34;tgroup:9;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:23;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:24;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:25;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:26;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:9;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:35;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:95;654:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;CPU数&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:96;654:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB 响应时间&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:97;654:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python 响应时间&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:98;654:42&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;Python/DolphinDB&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:9;656:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:36;656:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:99;656:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:100;656:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;140.49&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:101;656:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;511.89&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:102;656:56&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;3.64&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:37;657:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:103;657:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:104;657:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;27.52&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:105;657:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;226.45&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:106;657:43&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;8.22&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:38;658:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:107;658:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;12&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:108;658:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;15.66&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:109;658:45&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;224.80&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:110;658:60&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;14.35&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:93;660:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:19;660:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;注意&lt;/b&gt;：教程中我们只选取了部分测试结果进行展示。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:94;662:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;在控制其它变量一致的前提下，无论是单任务还是多任务，在不同 CPU 核数环境下 DolphinDB 均表现出了比 Python 更优越的性能。其中性能差异最高可接近 Python 的14倍，平均性能超10倍。究其原因，主要有以下几点：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:41;664:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:59;664:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB 强大的向量化计算能力：DolphinDB 最大程度上兼顾了向量化计算的性能，即其计算引擎的设计针对涉及到向量的计算进行了性能上的优化，而 Python 作为解释型脚本语句，每运行一句都要进行相应的解释，且对向量化计算能力的优化较 DolphinDB 有一定的欠缺，这使得针对数组的向量化计算显示出了比 Python 更优越的性能；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:60;665:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB 丰富的内置函数：DolphinDB 预定义了1000多个可以直接调用的函数。相较于 Python 减少了因子定义的代码量和封装次数，在计算过程中性能损耗更少；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:61;666:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;DolphinDB 自带的持久化数据存储：DolphinDB 内置数据存储引擎，可以将数据按照不同分区方式存入分布式数据库表，因子计算时的数据读取更高效；Python 在因子计算的过程中需要引入外部数据源，数据读取效率相对较低。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;6-总结&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;668:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;668:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;6. 总结&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;668:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:95;670:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;本教程基于3000多只基金的日净值数据，对比测试了不同 CPU 核数环境下以及任务提交数下，Python 和 DolphinDB 计算相同因子的性能差异。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:96;672:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;可以看到，由于DolphinDB具有强大的向量化计算的能力，包含丰富的内置函数功能，以及具备自带的持久化数据存储，因而无论在多线程还是多任务情况下，DolphinDB 在计算因子时都有相较于 Python 更为优异的表现。因此相较之下，DolphinDB 表现出更为显著的优势。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;7-附件&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;674:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;674:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;7. 附件&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;674:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:42;676:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:62;676:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;zip&#34; href=&#34;https://www.dolphindb.cn/downloads/docs/fund_factor_contrasted_by_py.zip&#34; scope=&#34;external&#34; xtrc=&#34;xref:5;676:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;?ditaot usertext?&gt;测试数据&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:63;677:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/fund_factor_contrasted_by_py/fund_data_load.txt&#34; xtrc=&#34;xref:6;677:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;?ditaot usertext?&gt;数据导入到 DolphinDB 的脚本&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:64;678:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/fund_factor_contrasted_by_py/fund_factor_ddb.txt&#34; xtrc=&#34;xref:7;678:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;?ditaot usertext?&gt;基于 DolphinDB 的基金日频因子实现与性能测试&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:65;679:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;py&#34; href=&#34;script/fund_factor_contrasted_by_py/fund_factor.py&#34; xtrc=&#34;xref:8;679:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/fund_factor_contrasted_by_py.md&#34;&gt;&lt;?ditaot usertext?&gt;基于 Python 的十个基金日频因子实现与性能测试&lt;/xref&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/fund_factor_contrasted_by_py.md"/><meta name="wh-out-relpath" content="tutorials/fund_factor_contrasted_by_py.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="计算基金日频因子" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/OHLC_2.html">金融场景案例</a></div></div></li><li class="active"><div class="topicref" data-id="计算基金日频因子"><div class="title"><a href="../tutorials/fund_factor_contrasted_by_py.html">计算基金日频因子</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="k-线计算-d9713e102569" class="topicref" data-id="k-线计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="k-线计算-d9713e102569-link">K 线计算</a></div></div></li><li role="treeitem"><div data-tocid="使用-klinechart-展示-dolphindb-k-线-d9713e102615" class="topicref" data-id="使用-klinechart-展示-dolphindb-k-线" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/displaying_the_dolphindb_k-line_with_klinechart.html" id="使用-klinechart-展示-dolphindb-k-线-d9713e102615-link">使用 KLineChart 展示 DolphinDB K 线</a></div></div></li><li role="treeitem"><div data-tocid="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比-d9713e102661" class="topicref" data-id="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Python_HDF5_vs_DolphinDB.html" id="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比-d9713e102661-link">Python + HDF5 因子计算与 DolphinDB 一体化因子计算方案对比</a></div></div></li><li role="treeitem"><div data-tocid="python--文件存储与-dolphindb-因子计算性能比较-d9713e102707" class="topicref" data-id="python--文件存储与-dolphindb-因子计算性能比较" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/DolphinDB_VS_PythonFile_Storage.html" id="python--文件存储与-dolphindb-因子计算性能比较-d9713e102707-link">Python + 文件存储与 DolphinDB 因子计算性能比较</a></div></div></li><li role="treeitem"><div data-tocid="python-parser-在金融量化分析场景的应用入门-d9713e102753" class="topicref" data-id="python-parser-在金融量化分析场景的应用入门" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/py_parser__quant_fin.html" id="python-parser-在金融量化分析场景的应用入门-d9713e102753-link">Python Parser 在金融量化分析场景的应用入门</a></div></div></li><li role="treeitem"><div data-tocid="处理-level-2-行情数据实例-d9713e102799" class="topicref" data-id="处理-level-2-行情数据实例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/l2_stk_data_proc_2.html" id="处理-level-2-行情数据实例-d9713e102799-link">处理 Level-2 行情数据实例</a></div></div></li><li role="treeitem"><div data-tocid="存储金融数据的分区方案最佳实践-d9713e102845" class="topicref" data-id="存储金融数据的分区方案最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practices_for_partitioned_storage.html" id="存储金融数据的分区方案最佳实践-d9713e102845-link">存储金融数据的分区方案最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="公募基金历史数据基础分析教程-d9713e102891" class="topicref" data-id="公募基金历史数据基础分析教程" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/public_fund_basic_analysis.html" id="公募基金历史数据基础分析教程-d9713e102891-link">公募基金历史数据基础分析教程</a></div></div></li><li role="treeitem"><div data-tocid="股票行情回放-d9713e102937" class="topicref" data-id="股票行情回放" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stock_market_replay_2.html" id="股票行情回放-d9713e102937-link">股票行情回放</a></div></div></li><li role="treeitem"><div data-tocid="搭建行情回放服务的最佳实践-d9713e102983" class="topicref" data-id="搭建行情回放服务的最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/appendices_market_replay_bp.html" id="搭建行情回放服务的最佳实践-d9713e102983-link">搭建行情回放服务的最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="国内股票行情数据导入实例-d9713e103029" class="topicref" data-id="国内股票行情数据导入实例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stockdata_csv_import_demo.html" id="国内股票行情数据导入实例-d9713e103029-link">国内股票行情数据导入实例</a></div></div></li><li role="treeitem"><div data-tocid="基金份额参考价值-iopv-计算-d9713e103076" class="topicref" data-id="基金份额参考价值-iopv-计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_IOPV_2.html" id="基金份额参考价值-iopv-计算-d9713e103076-link">基金份额参考价值 IOPV 计算</a></div></div></li><li role="treeitem"><div data-tocid="基于快照行情的股票和基金-k-线合成-d9713e103122" class="topicref" data-id="基于快照行情的股票和基金-k-线合成" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/k.html" id="基于快照行情的股票和基金-k-线合成-d9713e103122-link">基于快照行情的股票和基金 K 线合成</a></div></div></li><li role="treeitem" class="active"><div data-tocid="计算基金日频因子-d9713e103168" class="topicref" data-id="计算基金日频因子" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/fund_factor_contrasted_by_py.html" id="计算基金日频因子-d9713e103168-link">计算基金日频因子</a></div></div></li><li role="treeitem"><div data-tocid="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎-d9713e103214" class="topicref" data-id="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/orderBookSnapshotEngine.html" id="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎-d9713e103214-link">基于逐笔数据合成高频 Orderbook：DolphinDB Orderbook 引擎</a></div></div></li><li role="treeitem"><div data-tocid="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇-d9713e103260" class="topicref" data-id="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/LoadDataForPoc.html" id="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇-d9713e103260-link">金融 PoC 用户历史数据导入指导手册之股票 Level-2 逐笔篇</a></div></div></li><li role="treeitem"><div data-tocid="金融实时实际波动率预测-d9713e103306" class="topicref" data-id="金融实时实际波动率预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ml_volatility_2.html" id="金融实时实际波动率预测-d9713e103306-link">金融实时实际波动率预测</a></div></div></li><li role="treeitem"><div data-tocid="金融因子流式实现-d9713e103352" class="topicref" data-id="金融因子流式实现" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/str_comp_fin_quant_2.html" id="金融因子流式实现-d9713e103352-link">金融因子流式实现</a></div></div></li><li role="treeitem"><div data-tocid="开发股票波动率预测模型的-676-个输入特征-d9713e103398" class="topicref" data-id="开发股票波动率预测模型的-676-个输入特征" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/metacode_derived_features_2.html" id="开发股票波动率预测模型的-676-个输入特征-d9713e103398-link">开发股票波动率预测模型的 676 个输入特征</a></div></div></li><li role="treeitem"><div data-tocid="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践-d9713e103444" class="topicref" data-id="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/l2_snapshot_factor_calc_2.html" id="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践-d9713e103444-link">快速搭建 Level-2 快照数据流批一体因子计算平台最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="量化金融范例-d9713e103490" class="topicref" data-id="量化金融范例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/quant_finance_examples.html" id="量化金融范例-d9713e103490-link">量化金融范例</a></div></div></li><li role="treeitem"><div data-tocid="流式计算中证-1000-指数主买主卖交易量-d9713e103536" class="topicref" data-id="流式计算中证-1000-指数主买主卖交易量" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/CSI_1000_2.html" id="流式计算中证-1000-指数主买主卖交易量-d9713e103536-link">流式计算中证 1000 指数主买/主卖交易量</a></div></div></li><li role="treeitem"><div data-tocid="深度不平衡买卖压力指标波动率计算-d9713e103583" class="topicref" data-id="深度不平衡买卖压力指标波动率计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/sql_performance_optimization_wap_di_rv.html" id="深度不平衡买卖压力指标波动率计算-d9713e103583-link">深度不平衡、买卖压力指标、波动率计算</a></div></div></li><li role="treeitem"><div data-tocid="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用-d9713e103629" class="topicref" data-id="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/insight_plugin_orderbook_engine_application.html" id="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用-d9713e103629-link">实时合成自定义频订单簿快照：DolphinDB INSIGHT 行情插件与订单簿引擎应用</a></div></div></li><li role="treeitem"><div data-tocid="实时计算分钟资金流-d9713e103675" class="topicref" data-id="实时计算分钟资金流" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_capital_flow_order_by_order_2.html" id="实时计算分钟资金流-d9713e103675-link">实时计算分钟资金流</a></div></div></li><li role="treeitem"><div data-tocid="实时计算高频因子-d9713e103721" class="topicref" data-id="实时计算高频因子" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/hf_factor_streaming_2.html" id="实时计算高频因子-d9713e103721-link">实时计算高频因子</a></div></div></li><li role="treeitem"><div data-tocid="实时计算日累计逐单资金流-d9713e103767" class="topicref" data-id="实时计算日累计逐单资金流" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_capital_flow_daily_2.html" id="实时计算日累计逐单资金流-d9713e103767-link">实时计算日累计逐单资金流</a></div></div></li><li role="treeitem"><div data-tocid="实时计算涨幅榜-d9713e103813" class="topicref" data-id="实时计算涨幅榜" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/rt_stk_price_inc_calc_2.html" id="实时计算涨幅榜-d9713e103813-link">实时计算涨幅榜</a></div></div></li><li role="treeitem"><div data-tocid="实时选取外汇行情多价源最优价-d9713e103859" class="topicref" data-id="实时选取外汇行情多价源最优价" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_price_selection.html" id="实时选取外汇行情多价源最优价-d9713e103859-link">实时选取外汇行情多价源最优价</a></div></div></li><li role="treeitem"><div data-tocid="外汇掉期估值计算-d9713e103905" class="topicref" data-id="外汇掉期估值计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/FxSwapValuation.html" id="外汇掉期估值计算-d9713e103905-link">外汇掉期估值计算</a></div></div></li><li role="treeitem"><div data-tocid="因子计算平台构建-d9713e103951" class="topicref" data-id="因子计算平台构建" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Python_Celery.html" id="因子计算平台构建-d9713e103951-link">因子计算平台构建</a></div></div></li><li role="treeitem"><div data-tocid="因子计算最佳实践-d9713e103997" class="topicref" data-id="因子计算最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practice_for_factor_calculation.html" id="因子计算最佳实践-d9713e103997-link">因子计算最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="mvo_tutorial-d9713e104043" class="topicref" data-id="mvo_tutorial" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/MVO.html" id="mvo_tutorial-d9713e104043-link">优化投资组合：DolphinDB 最优化求解系列函数应用指南</a></div></div></li><li role="treeitem"><div data-tocid="中高频多因子库存储最佳实践-d9713e104090" class="topicref" data-id="中高频多因子库存储最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practices_for_multi_factor.html" id="中高频多因子库存储最佳实践-d9713e104090-link">中高频多因子库存储最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="alphalens-在-dolphindb-中的应用因子分析建模实践-d9713e104136" class="topicref" data-id="alphalens-在-dolphindb-中的应用因子分析建模实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Practical_Factor_Analysis_Modeling.html" id="alphalens-在-dolphindb-中的应用因子分析建模实践-d9713e104136-link">Alphalens 在 DolphinDB 中的应用：因子分析建模实践</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-与-dolphinscheduler-的集成-d9713e104182" class="topicref" data-id="dolphindb-与-dolphinscheduler-的集成" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphinscheduler_integration.html" id="dolphindb-与-dolphinscheduler-的集成-d9713e104182-link">DolphinDB 与 DolphinScheduler 的集成</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-与-python-airflow-最佳实践-d9713e104228" class="topicref" data-id="dolphindb-与-python-airflow-最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_airflow.html" id="dolphindb-与-python-airflow-最佳实践-d9713e104228-link">DolphinDB 与 Python AirFlow 最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="gplearn-d9713e104274" class="topicref" data-id="gplearn" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/gplearn.html" id="gplearn-d9713e104274-link">Shark GPLearn 快速上手</a></div></div></li><li role="treeitem"><div data-tocid="利用jit加速计算-etf-期权隐含波动率和希腊值-d9713e104320" class="topicref" data-id="利用jit加速计算-etf-期权隐含波动率和希腊值" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/IV_Greeks_Calculation_for_ETF_Options_Using_JIT.html" id="利用jit加速计算-etf-期权隐含波动率和希腊值-d9713e104320-link">利用JIT加速计算 ETF 期权隐含波动率和希腊值</a></div></div></li><li role="treeitem"><div data-tocid="基于-dolphindb-的-brinson-绩效归因模型实践-d9713e104366" class="topicref" data-id="基于-dolphindb-的-brinson-绩效归因模型实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/brinson.html" id="基于-dolphindb-的-brinson-绩效归因模型实践-d9713e104366-link">基于 DolphinDB 的 Brinson 绩效归因模型实践</a></div></div></li><li role="treeitem"><div data-tocid="基于-dolphindb-的-campisi-绩效归因模型实践-d9713e104412" class="topicref" data-id="基于-dolphindb-的-campisi-绩效归因模型实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/campisi.html" id="基于-dolphindb-的-campisi-绩效归因模型实践-d9713e104412-link">基于 DolphinDB 的 Campisi 绩效归因模型实践</a></div></div></li><li role="treeitem"><div data-tocid="期货分钟频cta策略回测案例-d9713e104458" class="topicref" data-id="期货分钟频cta策略回测案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/futures_minute_frequency_cta_strategy_backtest_example.html" id="期货分钟频cta策略回测案例-d9713e104458-link">期货分钟频CTA策略回测案例</a></div></div></li><li role="treeitem"><div data-tocid="exchdata-交易所历史股票数据自动化导入功能模块使用教程-d9713e104504" class="topicref" data-id="exchdata-交易所历史股票数据自动化导入功能模块使用教程" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/exchdata_exchange_historical_stock_data_auto_import_module_tutorial.html" id="exchdata-交易所历史股票数据自动化导入功能模块使用教程-d9713e104504-link">ExchData 交易所历史股票数据自动化导入功能模块使用教程</a></div></div></li><li role="treeitem"><div data-tocid="ficc_func_uasge_and_performance-d9713e104550" class="topicref" data-id="ficc_func_uasge_and_performance" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ficc_func_uasge_and_performance.html" id="ficc_func_uasge_and_performance-d9713e104550-link">FICC 固收系列函数使用示例及性能</a></div></div></li><li role="treeitem"><div data-tocid="title1-d9713e104597" class="topicref" data-id="title1" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ficc_funcs_application.html" id="title1-d9713e104597-link">FICC 固收系列函数应用场景</a></div></div></li><li role="treeitem"><div data-tocid="最优化函数_socp_的使用及转化案例-d9713e104643" class="topicref" data-id="最优化函数_socp_的使用及转化案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/socp_usage_case.html" id="最优化函数_socp_的使用及转化案例-d9713e104643-link">最优化函数 socp 的使用及转化案例</a></div></div></li><li role="treeitem"><div data-tocid="k_line_calculation-d9713e104689" class="topicref" data-id="k_line_calculation" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/k_line_calculation%20.html" id="k_line_calculation-d9713e104689-link">基于期货快照行情数据计算合约 K 线以及主连行情</a></div></div></li><li role="treeitem"><div data-tocid="backtest_introduction_usage-d9713e104735" class="topicref" data-id="backtest_introduction_usage" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/backtest_introduction_usage.html" id="backtest_introduction_usage-d9713e104735-link">融资融券策略回测使用说明及回测案例</a></div></div></li><li role="treeitem"><div data-tocid="stock_backtest-d9713e104781" class="topicref" data-id="stock_backtest" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stock_backtest.html" id="stock_backtest-d9713e104781-link">股票中低频投资组合回测案例实现</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">计算基金日频因子</h1><div class="- topic/body body"><p class="- topic/p p">根据某个基金每日的净值数据计算得到的因子称作“基金日频因子”。基金日频因子能反映出基金的近况，是衡量基金收益、波动、风险等的重要指标。随着数据规模与日俱增，对大规模数量级的数据进行处理的需求日益旺盛，在计算的速度、准确性上对计算工具提出了更高的要求。</p><p class="- topic/p p">本教程将为大家介绍如何基于 DolphinDB 计算多个基金的日频因子，并通过 Python 实现相同因子的计算，对比两者的计算性能。所用数据约220万条，均为与沪深300指数按日期对齐后的基金净值数据。结果表明在不同 CPU 核数下，DolphinDB 较 Python 均有明显的性能优势。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-测试环境"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. 测试环境</h2><div class="- topic/body body"><p class="- topic/p p">安装 DolphinDB server，配置为单节点模式，其默认端口号为<code class="+ topic/ph pr-d/codeph ph codeph">8848</code>。本次测试所涉及到的硬件环境和软件环境如下：</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">硬件环境</strong></p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="1-测试环境__entry__1">硬件名称</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="1-测试环境__entry__2">配置信息</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__1">操作系统</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__2">64位 CentOS Linux 7 (Core)</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__1">内存</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__2">256 GB</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__1">CPU 类型</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__2">Intel(R) Xeon(R) Silver 4216 CPU @ 2.10GHz</td></tr></tbody></table></div></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">软件环境</strong></p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="1-测试环境__entry__9">软件名称</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="1-测试环境__entry__10">版本信息</th><th class="- topic/entry entry colsep-0 rowsep-0" id="1-测试环境__entry__11">教程&amp;下载链接</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__9">DolphinDB</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__10">2.00.7</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="1-测试环境__entry__11"><a class="- topic/xref xref" href="standalone_server.html">DolphinDB单节点部署教程</a>；<a class="- topic/xref xref" href="https://dolphindb.cn/alone/alone.php?id=10" target="_blank" rel="external noopener">DolphinDB下载链接</a></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__9">DolphinDB GUI</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__10">1.30.19.2</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="1-测试环境__entry__11"><a class="- topic/xref xref" href="https://dolphindb.cn/alone/alone.php?id=10" target="_blank" rel="external noopener">DolphinDB GUI下载链接</a></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__9">Python（包含numpy、pandas、scipy等库以及 DolphinDB 的 Python API，需要预先安装）</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="1-测试环境__entry__10">3.7.9</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="1-测试环境__entry__11"><a class="- topic/xref xref" href="https://www.python.org/" target="_blank" rel="external noopener">Python官网</a></td></tr></tbody></table></div></li></ul></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="2-基金日频因子背景介绍及代码实现"><h2 class="- topic/title title topictitle2" id="ariaid-title3">2. 基金日频因子背景介绍及代码实现</h2><div class="- topic/body body"><p class="- topic/p p">本教程选取了10个基金日频因子，涵盖基金评价体系的各个方面，作为性能测试的指标。其相关的背景含义、计算公式及在 DolphinDB 脚本和 Python 中的定义如下所示：</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：下文提到的 <code class="+ topic/ph pr-d/codeph ph codeph">DailyValue</code> 指日净值，<code class="+ topic/ph pr-d/codeph ph codeph">DailyReturn</code> 指日收益率，<code class="+ topic/ph pr-d/codeph ph codeph">BeginningValue</code> 指基金日净值序列中的第一个净值数据，<code class="+ topic/ph pr-d/codeph ph codeph">EndingValue</code> 指基金日净值序列中的最后一个净值数据。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">年化收益率</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：将当前收益率转换为一年内（按252个交易日计算）的收益率；</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation1.png" alt="equation1"/><br/></li></ul><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      defg getAnnualReturn(value){
            return pow(1 + ((last(value) - first(value))\first(value)), 252\730) - 1
      }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> getAnnualReturn(value):
          <strong class="hl-keyword">return</strong> pow(<span class="hl-number">1</span> + ((value[-<span class="hl-number">1</span>] - value[<span class="hl-number">0</span>])/value[<span class="hl-number">0</span>]), <span class="hl-number">252</span>/<span class="hl-number">730</span>)-<span class="hl-number">1</span></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">年化波动率</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：衡量基金的波动风险</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation2.png" alt="equation2"/><br/></li></ul><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>        defg getAnnualVolatility(value){
        	return std(deltas(value)\prev(value)) * sqrt(252)
        }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">        <strong class="hl-keyword">def</strong> getAnnualVolatility(value):
              diff_value = np.diff(value)
              rolling_value = np.roll(value, <span class="hl-number">1</span>)
            rolling_value = np.delete(rolling_value, [<span class="hl-number">0</span>])
            <strong class="hl-keyword">return</strong> np.std(np.true_divide(diff_value, rolling_value), ddof=<span class="hl-number">1</span>) * np.sqrt(<span class="hl-number">252</span>)</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">收益率偏度</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：衡量收益偏斜程度</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation3.png" alt="equation3"/><br/></li></ul><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      defg getAnnualSkew(value){
      	return skew(deltas(value)\prev(value))
      }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> getAnnualSkew(value):
          diff_value = np.diff(value)
          rolling_value = np.roll(value, <span class="hl-number">1</span>)
          rolling_value = np.delete(rolling_value, [<span class="hl-number">0</span>])
          <strong class="hl-keyword">return</strong> st.skew(np.true_divide(diff_value, rolling_value))</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">收益率峰度</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：基金日收益率的分布相对于正态分布的峰值程度和尾部厚度</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation4.png" alt="equation4"/><br/></li></ul><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      defg getAnnualKur(value){
      	return kurtosis(deltas(value)\prev(value)) 
      }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> getAnnualKur(value):
          diff_value = np.diff(value)
          rolling_value = np.roll(value, <span class="hl-number">1</span>)
          rolling_value = np.delete(rolling_value, [<span class="hl-number">0</span>])
          <strong class="hl-keyword">return</strong> st.kurtosis(np.true_divide(diff_value, rolling_value), fisher=False)</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">夏普比率</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：反映单位风险基金净值增长率超过无风险收益率的程度</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation5.png" alt="equation5"/><br/></li></ul><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      defg getSharp(value){
      	return (getAnnualReturn(value) - 0.03)\getAnnualVolatility(value) as sharpeRat
      }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> getSharp(value):
          <strong class="hl-keyword">return</strong> (getAnnualReturn(value) - <span class="hl-number">0.03</span>)/getAnnualVolatility(value) <strong class="hl-keyword">if</strong> getAnnualVolatility(value) != <span class="hl-number">0</span> <strong class="hl-keyword">else</strong> <span class="hl-number">0</span></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">最大回撤率</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：指在选定周期内任一历史时点往后推，产品净值走到最低点时的收益率回撤幅度的最大值</p></li><li class="- topic/li li"><p class="- topic/p p">公式：在某个时间周期的净值序列中，记 <code class="+ topic/ph pr-d/codeph ph codeph">i</code> 为某一天，<code class="+ topic/ph pr-d/codeph ph codeph">DailyValuei</code> 为第 <code class="+ topic/ph pr-d/codeph ph codeph">i</code> 天的净值，<code class="+ topic/ph pr-d/codeph ph codeph">j</code> 为 <code class="+ topic/ph pr-d/codeph ph codeph">i</code> 之前的某一天，<code class="+ topic/ph pr-d/codeph ph codeph">DailyValuej</code> 为第 <code class="+ topic/ph pr-d/codeph ph codeph">j</code> 天的净值，找到一组 <code class="+ topic/ph pr-d/codeph ph codeph">i</code>,  <code class="+ topic/ph pr-d/codeph ph codeph">j</code> 使得其收益率回撤幅度最大记为最大回撤率 <code class="+ topic/ph pr-d/codeph ph codeph">MaxDrawdown</code>，</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation6.png" alt="equation6"/><br/></li></ul><p class="- topic/p p">代码实现：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      def getMaxDrawdown(value){
      	i = imax((cummax(value) - value) \ cummax(value))
      	if (i==0){
      		return 0
      	}
      	j = imax(value[:i])
      	return (value[j] - value[i]) \ (value[j])
      }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> getMaxDrawdown(value):
          i = np.argmax((np.maximum.accumulate(value) - value) / np.maximum.accumulate(value))
          <strong class="hl-keyword">if</strong> i == <span class="hl-number">0</span>:
              <strong class="hl-keyword">return</strong> <span class="hl-number">0</span>
          j = np.argmax(value[:i])
          <strong class="hl-keyword">return</strong> (value[j] - value[i]) / value[j]</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">收益回撤比</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：是收益和风险的比值，可以用来衡量一只基金产品投资策略的好坏。</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation7.png" alt="equation7"/><br/></li></ul><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      def getDrawdownRatio(value){
      	return getAnnualReturn(value) \ getMaxDrawdown(value)
      }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> getDrawdownRatio(value):
          <strong class="hl-keyword">return</strong> getAnnualReturn(value) / getMaxDrawdown(value) <strong class="hl-keyword">if</strong> getMaxDrawdown(value) != <span class="hl-number">0</span> <strong class="hl-keyword">else</strong> <span class="hl-number">0</span></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">β系数</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：一种风险指数，可以衡量股票基金相对于整个股市的波动情况</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation8.png" alt="equation8"/><br/></li></ul><p class="- topic/p p">其中分子为日净值收益率和日基准收益率的协方差，分母为日基准收益率的方差</p><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      def getBeta(value, price){
      	return covar(deltas(value)\prev(value), deltas(price)\prev(price)) \ std(deltas(price)\prev(price))
      }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> getBeta(value, price):
          diff_price = np.diff(price)
          rolling_price = np.roll(price, <span class="hl-number">1</span>)
          rolling_price = np.delete(rolling_price, [<span class="hl-number">0</span>])
          diff_value = np.diff(value)
          rolling_value = np.roll(value, <span class="hl-number">1</span>)
          rolling_value = np.delete(rolling_value, [<span class="hl-number">0</span>])
          <strong class="hl-keyword">return</strong> np.cov(np.true_divide(diff_value, rolling_value), np.true_divide(diff_price, rolling_price))[<span class="hl-number">0</span>][<span class="hl-number">1</span>] / np.std(np.true_divide(diff_price, rolling_price), ddof=<span class="hl-number">1</span>)</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">α系数</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：一种风险指数，用于衡量与市场波动无关的超额收益</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation9.png" alt="equation9"/><br/></li></ul><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      def getAlpha(value, price){
      	return getAnnualReturn(value) - 0.03 - getBeta(value, price) * (getAnnualReturn(price) - 0.03)
      }</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">Python：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> getAlpha(value, price):
          <strong class="hl-keyword">return</strong> getAnnualReturn(value) - <span class="hl-number">0.03</span> - getBeta(value, price) * (getAnnualReturn(price) - <span class="hl-number">0.03</span>)</pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">赫斯特指数</strong></p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">因子含义：体现时间序列的自相关性，尤其是序列中隐藏的长期趋势的指标。此处用来揭示某只基金序列中的隐藏长期趋势。</p></li><li class="- topic/li li"><p class="- topic/p p">计算方法：</p><p class="- topic/p p">a. 将收益率序列按照不同的粒度（记为 k）切分成不同的片段，此处从粒度2到粒度365开始切分序列；
b. 计算每个片段的均值，此处要计算2+3+4+...+365种；</p></li><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation10.png" alt="equation10"/><br/></li></ul><p class="- topic/p p">c. 计算每个片段的离差序列，即用每个片段的均值分别减该片段内的每个元素；</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation11.png" alt="equation11"/><br/></li></ul><p class="- topic/p p">d. 计算每个片段离差序列中的最大值减去最小值，记为 R；</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation12.png" alt="equation12"/><br/></li></ul><p class="- topic/p p">e. 计算每个片段的标准差，记为 S；</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation13.png" alt="equation13"/><br/></li></ul><p class="- topic/p p">f. 计算每个片段的 R/S 值，并计算按照不同粒度划分的所有片段中各片段元素的均值；</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">公式：</p><br/><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/equation14.png" alt="equation14"/><br/></li></ul><p class="- topic/p p">g. 以划分的标准粒度为自变量，以对应的各片段元素的均值为因变量，计算回归方程，截距即为赫斯特指数；</p><ul class="- topic/ul ul"><li class="- topic/li li">公式：AVS=a*k+b，经过计算后系数 a 为赫斯特指数</li></ul><p class="- topic/p p">代码实现：</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">DolphinDB：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>      def calAllRs2(mret, symList, k){
              rowCount = mret.rows()/k * k
              demeanCum = rolling(cumsum, mret[0:rowCount,] - each(stretch{, rowCount}, rolling(avg, mret, k, k)), k, k)
              a = rolling(max, demeanCum, k, k) - rolling(min, demeanCum, k, k)
              RS = nullFill!(a/rolling(stdp, mret, k, k), 1.0).mean().log()
              return table(symList as fundNum, take(log(k), symList.size()) as knum, RS as factor1)
      }</code></pre></li><li class="- topic/li li"><p class="- topic/p p">Python：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python">      <strong class="hl-keyword">def</strong> calHurst(value_list, min_k):
          n = len(value_list)
          max_k = int(np.floor(n / <span class="hl-number">2</span>))
          r_s_dict = []
          <strong class="hl-keyword">for</strong> k <strong class="hl-keyword">in</strong> range(min_k, max_k +<span class="hl-number">1</span>):
              subset_list = [value_list[i: i+k] <strong class="hl-keyword">for</strong> i <strong class="hl-keyword">in</strong> range(<span class="hl-number">0</span>, n, k)]
              <strong class="hl-keyword">if</strong> np.mod(n, k) &gt; <span class="hl-number">0</span>:
                  subset_list.pop()
              df_subset = np.array(subset_list)
              df_mean = df_subset.mean(axis=<span class="hl-number">1</span>).reshape(-<span class="hl-number">1</span>,<span class="hl-number">1</span>)
              df_cusum = (df_subset - df_mean).cumsum(axis=<span class="hl-number">1</span>)
              r = df_cusum.max(axis=<span class="hl-number">1</span>) - df_cusum.min(axis=<span class="hl-number">1</span>) + np.spacing(<span class="hl-number">1</span>)
              s = df_subset.std(axis=<span class="hl-number">1</span>, ddof=<span class="hl-number">0</span>) + np.spacing(<span class="hl-number">1</span>)
              r_s_dict.append({<span class="hl-string">'R_S'</span>: (r / s).mean(), <span class="hl-string">'N'</span>: k})
          log_r_s=[]
          log_n=[]
          <strong class="hl-keyword">for</strong> i <strong class="hl-keyword">in</strong> range(len(r_s_dict)):
              log_r_s.append(np.log(r_s_dict[i][<span class="hl-string">'R_S'</span>]))
              log_n.append(np.log(r_s_dict[i][<span class="hl-string">'N'</span>]))
          <strong class="hl-keyword">try</strong>:
              res = np.polyfit(log_n, log_r_s, <span class="hl-number">1</span>)[<span class="hl-number">0</span>]
          <strong class="hl-keyword">except</strong>:
              res = None
          <strong class="hl-keyword">return</strong> res</pre></li></ul></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title4" id="3-dolphindb-中因子计算实现及性能测试"><h2 class="- topic/title title topictitle2" id="ariaid-title4">3. DolphinDB 中因子计算实现及性能测试</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="31-数据导入及概览"><h3 class="- topic/title title topictitle3" id="ariaid-title5">3.1. 数据导入及概览</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">数据结构</strong></p><p class="- topic/p p">本教程选取了2018.05.24 - 2021.05.27期间3000多支基金的日净值数据，总数据量为330多万条。以下是净值表在 DolphinDB 中的数据结构：</p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="31-数据导入及概览__entry__1">字段名</th><th class="- topic/entry entry colsep-0 rowsep-0" id="31-数据导入及概览__entry__2">字段含义</th><th class="- topic/entry entry colsep-0 rowsep-0" id="31-数据导入及概览__entry__3">数据类型（DolphinDB）</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__1">tradingDate</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__2">交易日期</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__3">DATE</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__1">fundNum</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__2">基金交易代码</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__3">SYMBOL</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__1">value</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__2">基金日净值</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__3">DOUBLE</td></tr></tbody></table></div><p class="- topic/p p">同时，本教程选取了2018.05.24 - 2021.05.27期间沪深300指数的数据，共734条，用于和基金日净值数据作对齐操作。以下是指数表在 DolphinDB 中的数据结构：</p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="31-数据导入及概览__entry__13">字段名</th><th class="- topic/entry entry colsep-0 rowsep-0" id="31-数据导入及概览__entry__14">字段含义</th><th class="- topic/entry entry colsep-0 rowsep-0" id="31-数据导入及概览__entry__15">数据类型（DolphinDB）</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__13">tradingDate</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__14">交易日期</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__15">DATE</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__13">fundNum</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__14">指数名称（此处均为沪深300）</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__15">SYMBOL</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__13">value</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__14">沪深300收盘价格</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="31-数据导入及概览__entry__15">DOUBLE</td></tr></tbody></table></div></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">数据导入</strong></p><p class="- topic/p p">本教程所使用的数据分别存储在两个 CSV 为格式的文件中，使用前需要先导入到 DolphinDB 的 <code class="+ topic/ph pr-d/codeph ph codeph">fund_OLAP</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">fund_hs_OLAP</code> 维度表中。</p><p class="- topic/p p">首先，通过 DolphinDB GUI 连接 DolphinDB 后，定义函数分别读取 CSV 文件：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//获取 CSV 数据列名
def readColumnsFromWideCSV(absoluteFilename){
        schema1 = extractTextSchema(absoluteFilename)
        update schema1 set type = `STRING 
        allSymbol = loadText(absoluteFilename,,schema1)[0, 1:]
        titleSchema = extractTextSchema(absoluteFilename, skipRows = 0);
        for(x in allSymbol){
                testValue = exec x[name] from titleSchema
                testValue = testValue[1:]
        }
        return testValue
}
//获取 CSV 文件数据内容
def readIndexedMatrixFromWideCSV(absoluteFilename){
        contracts = readColumnsFromWideCSV(absoluteFilename)
        dataZoneSchema = extractTextSchema(absoluteFilename, skipRows = 1)
        update dataZoneSchema set type = "DOUBLE" where name != "col0"//所有行除第一行外全部改成double
        update dataZoneSchema set type = "DATE" where name = "col0"//所有行除第一行外全部改成DATE
        dataZoneWithIndexColumn = loadText(absoluteFilename, skipRows = 1, schema = dataZoneSchema)
        indexVector = exec col0 from dataZoneWithIndexColumn
        dataZoneWithoutIndex = dataZoneWithIndexColumn[:, 1:]
        dataMatrix = matrix(dataZoneWithoutIndex)
        dataMatrix.rename!(indexVector, contracts)
        return dataMatrix
}</code></pre><p class="- topic/p p">其次，调用该函数获取文件中的数据，将之转换分别赋予新的列名，存入 DolphinDB 的内存表：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//基金日净值数据
allSymbols = readColumnsFromWideCSV(csvPath)$STRING
dataMatrix = readIndexedMatrixFromWideCSV(csvPath)
fundTable = table(dataMatrix.rowNames() as tradingdate, dataMatrix)
result = fundTable.unpivot(`tradingDate, allSymbols).rename!(`tradingdate`fundNum`value)

//沪深300指数
allSymbols1 = readColumnsFromWideCSV(csvPath1)$STRING
dataMatrix1 = readIndexedMatrixFromWideCSV(csvPath1)
fundTable1 = table(dataMatrix1.rowNames() as tradingDate, dataMatrix1)
result1 = fundTable1.unpivot(`tradingDate, allSymbols1).rename!(`tradingdate`fundNum`value)</code></pre><p class="- topic/p p">最后，建立分布式数据库 <code class="+ topic/ph pr-d/codeph ph codeph">dfs://fund_OLAP</code> 和维度表 <code class="+ topic/ph pr-d/codeph ph codeph">fund_OLAP</code>, <code class="+ topic/ph pr-d/codeph ph codeph">fund_hs_OLAP</code>，并导入数据：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>//创建数据库
dbName = "dfs://fund_OLAP"
dataDate = database(, VALUE, 2021.01.01..2021.12.31)
symbol = database(, HASH, [SYMBOL, 20])
if(existsDatabase(dbName)){
	dropDatabase(dbName)
}
db = database(dbName, COMPO, [dataDate, symbol])
//定义表结构
name = `tradingdate`fundNum`value
type = `DATE`SYMBOL`DOUBLE
tbTemp = table(1:0, name, type)
//创建维度表 fund_OLAP
tbName1 = "fund_OLAP"
db.createTable(tbTemp, tbName1)
loadTable(dbName, tbName1).append!(result)
//创建维度表 fund_hs_OLAP
tbName2 = "fund_hs_OLAP"
db.createTable(tbTemp, tbName2)
loadTable(dbName, tbName2).append!(result1)</code></pre></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">数据概览</strong></p><p class="- topic/p p">数据导入成功后，执行如下代码查看前十条 fund_OLAP 数据：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select top 10 * from loadTable("dfs://fund_OLAP", "fund_OLAP")</code></pre><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/fund_10.png" width="300"/><br/><p class="- topic/p p">同样，执行如下代码查看前十条 fund_hs_OLAP 数据：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select top 10 * from loadTable("dfs://fund_OLAP", "fund_hs_OLAP")</code></pre><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/fund_hs_10.png" width="300"/><br/></li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title6" id="32-数据处理"><h3 class="- topic/title title topictitle3" id="ariaid-title6">3.2. 数据处理</h3><div class="- topic/body body"><p class="- topic/p p">分别从两张表中取出数据，同沪深300指数按日期对齐（使用<code class="+ topic/ph pr-d/codeph ph codeph">aj</code>），填充空缺值，仅保留两表中日期相同的数据：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>fund_OLAP=select * from loadTable("dfs://fund_OLAP", "fund_OLAP")
fund_hs_OLAP=select * from loadTable("dfs://fund_OLAP", "fund_hs_OLAP")
ajResult=select tradingDate, fundNum, value, fund_hs_OLAP.tradingDate as hstradingDate, fund_hs_OLAP.value as price from aj(fund_OLAP, fund_hs_OLAP, `tradingDate)
result2=select tradingDate, fundNum, iif(isNull(value), ffill!(value), value) as value, price from ajResult where tradingDate == hstradingDate</code></pre><p class="- topic/p p">同时，计算多个基金的日收益率，进行赫斯特指数的计算：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>symList = exec distinct(fundNum) as fundNum from result2 order by fundNum
portfolio = select fundNum as fundNum, (deltas(value)\prev(value)) as log, tradingDate as tradingDate from result2 where tradingDate in 2018.05.24..2021.05.27 and fundNum in symList
m_log = exec log from portfolio pivot by tradingDate, fundNum
mlog =  m_log[1:,]</code></pre><p class="- topic/p p">处理后的数据共220万条，结构如下：</p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="32-数据处理__entry__1">字段名</th><th class="- topic/entry entry colsep-0 rowsep-0" id="32-数据处理__entry__2">字段含义</th><th class="- topic/entry entry colsep-0 rowsep-0" id="32-数据处理__entry__3">数据类型（DolphinDB）</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__1">tradingDate</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__2">交易日期</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__3">DATE</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__1">fundNum</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__2">基金交易代码</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__3">SYMBOL</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__1">value</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__2">基金日净值</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__3">DOUBLE</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__1">price</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__2">沪深300收盘价格</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__3">DOUBLE</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__1">log</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__2">基金日收益率</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="32-数据处理__entry__3">DOUBLE</td></tr></tbody></table></div></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title7" id="33-性能测试"><h3 class="- topic/title title topictitle3" id="ariaid-title7">3.3. 性能测试</h3><div class="- topic/body body"><p class="- topic/p p">本节测试了DolphinDB的性能与任务量以及cpu核数的关系。</p><ul class="- topic/ul ul"><li class="- topic/li li">任务量：修改提交作业的数量。</li><li class="- topic/li li">CPU 核数：修改 <code class="+ topic/ph pr-d/codeph ph codeph">dolphindb.cfg</code> 文件中的 <code class="+ topic/ph pr-d/codeph ph codeph">workerNum</code>参数，其配置值表示计算时所用到的CPU 核数。注意：每次参数修改后，需要重启 DolphinDB Server 才能生效。</li></ul><p class="- topic/p p">本教程以提交后台作业的计算时间来反映 DolphinDB 性能。</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">在性能测试前，首先定义计算9个因子（不包含赫斯特指数）的函数：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def getmetric(result2, symList){
	Return = select fundNum, 
	            getAnnualReturn(value) as annualReturn,
	            getAnnualVolatility(value) as annualVolRat,
	            getAnnualSkew(value) as skewValue,
	            getAnnualKur(value) as kurValue,
	            getSharp(value) as sharpValue,
	            getMaxDrawdown(value) as MaxDrawdown,
	            getDrawdownRatio(value) as DrawdownRatio,
	            getBeta(value, price) as Beta,
	            getAlpha(value, price) as Alpha	
             from result2
             where TradeDate in 2018.05.24..2021.05.27 and fundNum in symList group by fundNum
 }</code></pre><p class="- topic/p p">其中，部分运算结果如下图所示:</p><img class="- topic/image image" src="images/fund_factor_contrasted_by_py/calculating_outcome.png" width="400"/><br/></li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：该计算流程执行前需要预先运行之前预定义过的 DolphinDB 实现的因子函数。</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">计算10个因子的响应时间:</p><p class="- topic/p p">定义获取10个因子计算和数据操作的时间的函数，并提交 job：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def parJob(){
  	timer{fund_OLAP=select * from loadTable("dfs://fund_OLAP", "fund_OLAP")
  		  fund_hs_OLAP=select * from loadTable("dfs://fund_OLAP", "fund_hs_OLAP")
  		  ajResult = select tradingdate, fundNum, value, fund_hs_OLAP.tradingDate as hstradingDate, fund_hs_OLAP.value as price from aj(fund_OLAP, fund_hs_OLAP, `tradingDate)
  		  result2 = select tradingdate, fundNum, iif(isNull(value), ffill!(value), value) as value,price from ajResult where tradingDate == hstradingDate
  		  symList = exec distinct(fundNum) as fundNum from result2 order by fundNum
          symList2 = symList.cut(250)
  		  portfolio = select fundNum as fundNum, (deltas(value)\prev(value)) as log, tradingDate as tradingDate from result2 where tradingDate in 2018.05.24..2021.05.27 and fundNum in symList
          m_log = exec log from portfolio pivot by tradingDate, fundNum
          mlog =  m_log[1:,]
          knum = 2..365
            }//此处，将任务切分，按每次250个不同基金数据进行计算.
    timer{ploop(getFactor{result2}, symList2)
          a = ploop(calAllRs2{mlog,symList}, knum).unionAll(false)
          res2 = select fundNum, ols(factor1, kNum)[0] as hist, ols(factor1, kNum)[1] as hist2, ols(factor1, kNum)[2] as hist3 from a group by fundNum}
  }//定义获取10个因子计算和数据操作的时间的函数
  /**
   * 提交1个 job（单用户）
   */
  submitJob("parallJob1", "parallJob_single_ten", parJob)

  /**
   * 提交5个 job（多用户）
   */
  for(i in 0..4){
  	submitJob("parallJob5", "parallJob_multi_ten", parJob)
  }</code></pre><p class="- topic/p p">分别计算两种情形下的响应时间：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>  //获取单个用户的运行时间
  select max(endTime) - min(startTime) from getRecentJobs() where jobDesc = "parallJob_single_ten"
  //获取多个用户的运行时间
  select max(endTime) - min(startTime) from getRecentJobs() where jobDesc = "parallJob_multi_ten"</code></pre></li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title8" id="34-结果展示"><h3 class="- topic/title title topictitle3" id="ariaid-title8">3.4. 结果展示</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">单任务（单位：秒）</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="34-结果展示__entry__1">CPU数</th><th class="- topic/entry entry colsep-0 rowsep-0" id="34-结果展示__entry__2">10个因子</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__1">1</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__2">26.03</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__1">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__2">7.23</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__1">12</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__2">4.23</td></tr></tbody></table></div></li><li class="- topic/li li"><p class="- topic/p p">多任务（此处为5用户，单位：秒）</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="34-结果展示__entry__9">CPU数</th><th class="- topic/entry entry colsep-0 rowsep-0" id="34-结果展示__entry__10">10个因子</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__9">1</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__10">140.50</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__9">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__10">27.53</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__9">12</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="34-结果展示__entry__10">15.66</td></tr></tbody></table></div></li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：由于赫斯特指数需要按照2+3+4+...+365种不同的粒度方式切分成不同种类的序列划分，同时分别对不同粒度的每一段序列分别计算均值、离差和标准差等，并最终求平均的 R/S 值，计算的子指标过大，时间复杂度较高，因此耗时相较于其它因子更长。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title9" id="4-python-中因子计算实现及性能测试"><h2 class="- topic/title title topictitle2" id="ariaid-title9">4. Python 中因子计算实现及性能测试</h2><div class="- topic/body body"><p class="- topic/p p">本章节中，我们基于 Python 实现了相同的因子计算并统计计算时间。</p><p class="- topic/p p">通过引入了 <code class="+ topic/ph pr-d/codeph ph codeph">joblib</code> 库中的 <code class="+ topic/ph pr-d/codeph ph codeph">Parallel</code> 方法，通过设置其 <code class="+ topic/ph pr-d/codeph ph codeph">n_jobs</code> 参数模拟不同 CPU 核数的运行环境。</p><p class="- topic/p p">在性能测试中，使用 Python 定义测算基金日收益率的 <code class="+ topic/ph pr-d/codeph ph codeph">getLog()</code> 函数和执行因子计算任务的 <code class="+ topic/ph pr-d/codeph ph codeph">main()</code> 函数 (因子计算通过 <code class="+ topic/ph pr-d/codeph ph codeph">numpy</code>, <code class="+ topic/ph pr-d/codeph ph codeph">pandas</code>, <code class="+ topic/ph pr-d/codeph ph codeph">scipy</code> 等库实现)：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python"><strong class="hl-keyword">def</strong> getLog(value):
    diff_value = np.diff(value)
    rolling_value = np.roll(value, <span class="hl-number">1</span>)
    rolling_value = np.delete(rolling_value, [<span class="hl-number">0</span>])
    <strong class="hl-keyword">return</strong> np.insert(np.true_divide(diff_value, rolling_value), <span class="hl-number">0</span>, np.nan)

<strong class="hl-keyword">def</strong> main(li):
    value = np.array(li[<span class="hl-string">"value"</span>])
    price = np.array(li[<span class="hl-string">"price"</span>])
    log = np.array(li[<span class="hl-string">"log"</span>])
    getAnnualReturn(value)
    getAnnualVolatility(value)
    getAnnualSkew(value)
    getAnnualKur(value)
    getSharp(value)
    getMaxDrawdown(value)
    getDrawdownRatio(value)
    getBeta(value, price)
    getAlpha(value, price)
    calHurst(log, <span class="hl-number">2</span>)</pre><p class="- topic/p p">使用 Python API 进行取数等数据处理操作，使用Python对其进行数据对齐和计算基金日收益率的操作。统计整个计算流程的时间：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python">s = ddb.session()
s.connect(<span class="hl-string">"127.0.0.1"</span>, <span class="hl-number">8848</span>, <span class="hl-string">"admin"</span>, <span class="hl-string">"123456"</span>)
start = time.time()
fund_OLAP = s.loadTable(dbPath=<span class="hl-string">"dfs://fund_OLAP"</span>, tableName=<span class="hl-string">"fund_OLAP"</span>).select(<span class="hl-string">"*"</span>).toDF().sort_values([<span class="hl-string">'tradingDate'</span>])
fund_hs_OLAP = s.loadTable(dbPath=<span class="hl-string">"dfs://fund_OLAP"</span>, tableName=<span class="hl-string">"fund_hs_OLAP"</span>).select(<span class="hl-string">"*"</span>).toDF()
fund_hs_OLAP.rename(columns={<span class="hl-string">'tradingDate'</span>: <span class="hl-string">'hstradingDate'</span>}, inplace=True)
fund_hs_OLAP = fund_hs_OLAP.sort_values([<span class="hl-string">'hstradingDate'</span>])
fund_dui_OLAP = pd.merge_asof(fund_OLAP, fund_hs_OLAP, left_on=<span class="hl-string">"tradingDate"</span>, right_on=<span class="hl-string">"hstradingDate"</span>).sort_values([<span class="hl-string">'fundNum_x'</span>, <span class="hl-string">'tradingDate'</span>])
fund_dui_OLAP = fund_dui_OLAP[fund_dui_OLAP[<span class="hl-string">'tradingDate'</span>] == fund_dui_OLAP[<span class="hl-string">'hstradingDate'</span>]]
fund_dui_OLAP.reset_index(drop=True, inplace=True)
fund_dui_OLAP.drop(columns=[<span class="hl-string">'fundNum_y'</span>, <span class="hl-string">'hstradingDate'</span>], inplace=True)
fund_dui_OLAP.columns = [<span class="hl-string">'tradingDate'</span>, <span class="hl-string">'fundNum'</span>, <span class="hl-string">'value'</span>, <span class="hl-string">'price'</span>]
fund_dui_OLAP[<span class="hl-string">"log"</span>] = pd.Series(getLog(fund_dui_OLAP[<span class="hl-string">"value"</span>]))
list = fund_dui_OLAP[(fund_dui_OLAP[<span class="hl-string">'tradingDate'</span>] &gt;= datetime(<span class="hl-number">2018</span>, <span class="hl-number">5</span>, <span class="hl-number">24</span>)) &amp; (fund_dui_OLAP[<span class="hl-string">'tradingDate'</span>] &lt;= datetime(<span class="hl-number">2021</span>, <span class="hl-number">5</span>, <span class="hl-number">27</span>))].groupby(<span class="hl-string">'fundNum'</span>)
Parallel(n_jobs=<span class="hl-number">1</span>)(delayed(main)(i) <strong class="hl-keyword">for</strong> _,i <strong class="hl-keyword">in</strong> list)
end = time.time()
<strong class="hl-keyword">print</strong>(end-start)</pre></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title10" id="5-性能计算结果对比分析"><h2 class="- topic/title title topictitle2" id="ariaid-title10">5. 性能计算结果对比分析</h2><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">单任务（单位：秒）</p><div class="table-container"><table class="- topic/table table" data-cols="4"><caption></caption><colgroup><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="5-性能计算结果对比分析__entry__1">CPU数</th><th class="- topic/entry entry colsep-0 rowsep-0" id="5-性能计算结果对比分析__entry__2">DolphinDB 响应时间</th><th class="- topic/entry entry colsep-0 rowsep-0" id="5-性能计算结果对比分析__entry__3">Python 响应时间</th><th class="- topic/entry entry colsep-0 rowsep-0" id="5-性能计算结果对比分析__entry__4">Python/DolphinDB</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__1">1</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__2">26.03</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__3">112.34</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__4">4.32</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__1">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__2">7.23</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__3">55.35</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__4">7.66</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__1">12</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__2">4.23</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__3">36.19</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__4">8.56</td></tr></tbody></table></div></li><li class="- topic/li li"><p class="- topic/p p">多任务（此处为5用户，单位：秒）</p><div class="table-container"><table class="- topic/table table" data-cols="4"><caption></caption><colgroup><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="5-性能计算结果对比分析__entry__17">CPU数</th><th class="- topic/entry entry colsep-0 rowsep-0" id="5-性能计算结果对比分析__entry__18">DolphinDB 响应时间</th><th class="- topic/entry entry colsep-0 rowsep-0" id="5-性能计算结果对比分析__entry__19">Python 响应时间</th><th class="- topic/entry entry colsep-0 rowsep-0" id="5-性能计算结果对比分析__entry__20">Python/DolphinDB</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__17">1</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__18">140.49</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__19">511.89</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__20">3.64</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__17">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__18">27.52</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__19">226.45</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__20">8.22</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__17">12</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__18">15.66</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__19">224.80</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="5-性能计算结果对比分析__entry__20">14.35</td></tr></tbody></table></div></li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：教程中我们只选取了部分测试结果进行展示。</p><p class="- topic/p p">在控制其它变量一致的前提下，无论是单任务还是多任务，在不同 CPU 核数环境下 DolphinDB 均表现出了比 Python 更优越的性能。其中性能差异最高可接近 Python 的14倍，平均性能超10倍。究其原因，主要有以下几点：</p><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB 强大的向量化计算能力：DolphinDB 最大程度上兼顾了向量化计算的性能，即其计算引擎的设计针对涉及到向量的计算进行了性能上的优化，而 Python 作为解释型脚本语句，每运行一句都要进行相应的解释，且对向量化计算能力的优化较 DolphinDB 有一定的欠缺，这使得针对数组的向量化计算显示出了比 Python 更优越的性能；</li><li class="- topic/li li">DolphinDB 丰富的内置函数：DolphinDB 预定义了1000多个可以直接调用的函数。相较于 Python 减少了因子定义的代码量和封装次数，在计算过程中性能损耗更少；</li><li class="- topic/li li">DolphinDB 自带的持久化数据存储：DolphinDB 内置数据存储引擎，可以将数据按照不同分区方式存入分布式数据库表，因子计算时的数据读取更高效；Python 在因子计算的过程中需要引入外部数据源，数据读取效率相对较低。</li></ul></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title11" id="6-总结"><h2 class="- topic/title title topictitle2" id="ariaid-title11">6. 总结</h2><div class="- topic/body body"><p class="- topic/p p">本教程基于3000多只基金的日净值数据，对比测试了不同 CPU 核数环境下以及任务提交数下，Python 和 DolphinDB 计算相同因子的性能差异。</p><p class="- topic/p p">可以看到，由于DolphinDB具有强大的向量化计算的能力，包含丰富的内置函数功能，以及具备自带的持久化数据存储，因而无论在多线程还是多任务情况下，DolphinDB 在计算因子时都有相较于 Python 更为优异的表现。因此相较之下，DolphinDB 表现出更为显著的优势。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title12" id="7-附件"><h2 class="- topic/title title topictitle2" id="ariaid-title12">7. 附件</h2><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><a class="- topic/xref xref" href="https://www.dolphindb.cn/downloads/docs/fund_factor_contrasted_by_py.zip" target="_blank" rel="external noopener">测试数据</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/fund_factor_contrasted_by_py/fund_data_load.txt">数据导入到 DolphinDB 的脚本</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/fund_factor_contrasted_by_py/fund_factor_ddb.txt">基于 DolphinDB 的基金日频因子实现与性能测试</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/fund_factor_contrasted_by_py/fund_factor.py">基于 Python 的十个基金日频因子实现与性能测试</a></li></ul></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83" data-tocid="1-测试环境">1. 测试环境</a></li><li class="topic-item"><a href="#2-%E5%9F%BA%E9%87%91%E6%97%A5%E9%A2%91%E5%9B%A0%E5%AD%90%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D%E5%8F%8A%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0" data-tocid="2-基金日频因子背景介绍及代码实现">2. 基金日频因子背景介绍及代码实现</a></li><li class="topic-item"><a href="#3-dolphindb-%E4%B8%AD%E5%9B%A0%E5%AD%90%E8%AE%A1%E7%AE%97%E5%AE%9E%E7%8E%B0%E5%8F%8A%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="3-dolphindb-中因子计算实现及性能测试">3. DolphinDB 中因子计算实现及性能测试</a><ul><li class="topic-item"><a href="#31-%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E5%8F%8A%E6%A6%82%E8%A7%88" data-tocid="31-数据导入及概览">3.1. 数据导入及概览</a></li><li class="topic-item"><a href="#32-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86" data-tocid="32-数据处理">3.2. 数据处理</a></li><li class="topic-item"><a href="#33-%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="33-性能测试">3.3. 性能测试</a></li><li class="topic-item"><a href="#34-%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA" data-tocid="34-结果展示">3.4. 结果展示</a></li></ul></li><li class="topic-item"><a href="#4-python-%E4%B8%AD%E5%9B%A0%E5%AD%90%E8%AE%A1%E7%AE%97%E5%AE%9E%E7%8E%B0%E5%8F%8A%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="4-python-中因子计算实现及性能测试">4. Python 中因子计算实现及性能测试</a></li><li class="topic-item"><a href="#5-%E6%80%A7%E8%83%BD%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90" data-tocid="5-性能计算结果对比分析">5. 性能计算结果对比分析</a></li><li class="topic-item"><a href="#6-%E6%80%BB%E7%BB%93" data-tocid="6-总结">6. 总结</a></li><li class="topic-item"><a href="#7-%E9%99%84%E4%BB%B6" data-tocid="7-附件">7. 附件</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>