<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="DolphinDB提供了多种轻量且使用方便的流数据引擎。本教程讲述流数据时序引擎。 流数据时序引擎由函数 createTimeSeriesEngine 创建。该函数返回一个抽象的表对象，为时序引擎入口。向这个抽象表写入数据，就意味着数据进入时序引擎进行计算。 createTimeSeriesEngine 函数必须与 subscribeTable 函数配合使用。通过 subscribeTable ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="时序聚合引擎"/><title>时序聚合引擎</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;时序聚合引擎&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:1;1:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:1;1:1&#34;&gt;时序聚合引擎&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:1;1:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:1;3:1&#34;&gt;DolphinDB提供了多种轻量且使用方便的流数据引擎。本教程讲述流数据时序引擎。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;1-创建时序引擎&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:2;5:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:2;5:1&#34;&gt;1. 创建时序引擎&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:2;5:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:2;7:1&#34;&gt;流数据时序引擎由函数&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:1;7:11&#34;&gt;createTimeSeriesEngine&lt;/codeph&gt;创建。该函数返回一个抽象的表对象，为时序引擎入口。向这个抽象表写入数据，就意味着数据进入时序引擎进行计算。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:3;9:1&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:2;9:1&#34;&gt;createTimeSeriesEngine&lt;/codeph&gt;函数必须与&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:3;9:30&#34;&gt;subscribeTable&lt;/codeph&gt;函数配合使用。通过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:4;9:55&#34;&gt;subscribeTable&lt;/codeph&gt;函数，时序引擎入口订阅一个流数据表。新数据进入流数据表后会被推送到时序引擎入口，按照指定规则进行计算，并将计算结果输出。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;11-语法&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:3;11:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:3;11:1&#34;&gt;1.1. 语法&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:3;11:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:4;13:1&#34;&gt;createTimeSeriesEngine(name, windowSize, step, metrics, dummyTable, outputTable, [timeColumn], [useSystemTime=false], [keyColumn], [garbageSize], [updateTime], [useWindowStartTime], [roundTime=true], [snapshotDir], [snapshotIntervalInMsgCount], [fill='none'])&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;12-参数介绍&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:4;15:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:4;15:1&#34;&gt;1.2. 参数介绍&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:4;15:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:5;17:1&#34;&gt;本节对各参数进行简单介绍。在下一小节中，对部分参数结合实例进行详细介绍。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:1;19:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:1;19:1&#34;&gt;name&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:6;21:1&#34;&gt;类型: 字符串&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:7;23:1&#34;&gt;必选参数，表示时序引擎的名称，是时序引擎在一个数据节点上的唯一标识。可包含字母，数字和下划线，但必须以字母开头。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:2;25:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:2;25:1&#34;&gt;useSystemTime&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:8;27:1&#34;&gt;类型：布尔值&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:9;29:1&#34;&gt;可选参数，表示时序引擎计算的触发方式。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:10;31:1&#34;&gt;当参数值为true时，引擎会按照数据进入引擎的时刻（毫秒精度的本地系统时间，与数据中的时间列无关），每隔固定时间截取固定长度窗口的流数据进行计算。只要一个数据窗口中含有数据，数据窗口结束后就会自动进行计算。结果中的第一列为计算发生的时间戳，与数据中的时间无关。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:11;33:1&#34;&gt;当参数值为false（默认值）时，引擎根据流数据中的timeColumn列来截取数据窗口。一个数据窗口结束后的第一条新数据才会触发该数据窗口的计算。请注意，触发计算的数据并不会参与该次计算。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:12;35:1&#34;&gt;例如，一个数据窗口从10:10:10到10:10:19。若useSystemTime=true，则只要该窗口中至少有一条数据，该窗口的计算会在窗口结束后的10:10:20触发。若useSystemTime=false，且10:10:19后的第一条数据为10:10:25，则该窗口的计算会在10:10:25触发。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:3;37:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:3;37:1&#34;&gt;windowSize&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:13;39:1&#34;&gt;类型：整型或者整型的数组&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:14;41:1&#34;&gt;必选参数，指定数据窗口长度。数据窗口包含左边界，但不包含右边界。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:4;43:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:4;43:1&#34;&gt;step&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:15;45:1&#34;&gt;类型：整型&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:16;47:1&#34;&gt;必选参数，指定窗口每次移动的时间间隔。windowSize必须可被step整除。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:17;49:1&#34;&gt;windowSize与step的单位取决于useSystemTime参数。若useSystemTime=true，windowSize与step的单位是毫秒。若useSystemTime=false，windowSize与step的单位是timeColumn列的精度。例如，若timeColumn列是timestamp类型，那么windowSize与step的单位是毫秒；如果timeColumn列是datetime类型，那么windowSize与step的单位是秒。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:18;51:1&#34;&gt;为了方便观察和对比计算结果，系统会对第一个数据窗口的起始时刻进行规整。例如若第一条数据进入引擎的时刻为2018.10.10T03:26:39.178，且step=100，那么系统会将第一个窗口起始时间规整为2018.10.10T03:26:39.100。规整数据窗口的细节在第1.3.1小节中介绍。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:19;53:1&#34;&gt;当引擎使用分组计算时，所有分组的窗口均进行统一的规整。相同时刻的数据窗口在各组均有相同的边界。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:5;55:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:5;55:1&#34;&gt;metrics&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:20;57:1&#34;&gt;类型：元代码或者元代码的数组&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:21;59:1&#34;&gt;必选参数。引擎的核心参数，以元代码的格式表示计算公式。它可以是一个或多个系统内置或用户自定义的聚合函数，比如&amp;lt;[sum(volume),avg(price)]&amp;gt;；可对聚合结果使用表达式，比如&amp;lt;[avg(price1)-avg(price2)]&amp;gt;；也可对列与列的计算结果进行聚合计算，例如&amp;lt;[std(price1-price2)]&amp;gt;；也可以是一个函数返回多个指标。若自定义函数 func(price)返回两个结果，则可以指定metrics为&amp;lt;[func(price) as ['res1','res2']&amp;gt; 。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:22;61:1&#34;&gt;如果windowSize为数组，则metrics必须和windowSize大小一致的数组，一一对应计算。比如定义windowSize=[3,6], metrics=[&amp;lt;[sum(volume),avg(price)]&amp;gt;, &amp;lt;std(volume)&amp;gt;], 则sum(volume)和avg(price)按windowSize=3聚合，std(volume)按windowSize=6聚合。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:23;63:1&#34;&gt;DolphinDB 针对部分内置的聚合函数在流数据时序引擎中的使用进行了优化，最大程度降低了重复计算，显著提高运行速度，详情参照用户手册createTimeSeriesEngine函数。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:6;66:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:6;66:1&#34;&gt;dummyTable&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:24;68:1&#34;&gt;类型：表&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:25;70:1&#34;&gt;必选参数。该表的唯一作用是为引擎提供流数据中每一列的数据类型，可以含有数据，亦可为空表。该表的schema必须与订阅的流数据表相同。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:7;72:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:7;72:1&#34;&gt;outputTable&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:26;74:1&#34;&gt;类型：表&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:27;76:1&#34;&gt;必选参数，为结果的输出表。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:28;78:1&#34;&gt;在使用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:5;78:4&#34;&gt;createTimeSeriesEngine&lt;/codeph&gt;函数之前，需要将输出表预先设立为一个空表，并指定各列列名以及数据类型。流数据引擎会将计算结果插入该表。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:29;80:1&#34;&gt;输出表的schema需要遵循以下规范：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:30;82:1&#34;&gt;(1) 输出表的第一列必须是时间类型。若useSystemTime=true，为TIMESTAMP类型；若useSystemTime=false，数据类型与timeColumn列一致。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:31;84:1&#34;&gt;(2) 如果分组列keyColumn参数不为空，那么输出表的第二列必须是分组列。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:32;86:1&#34;&gt;(3) 最后保存计算结果。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:33;88:1&#34;&gt;输出表的schema为&#34;时间列，分组列(可选)，结果列1，结果列2...&#34;这样的格式。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:8;90:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:8;90:1&#34;&gt;timeColumn&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:34;92:1&#34;&gt;类型：字符串&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:35;94:1&#34;&gt;可选参数。当useSystemTime=false时，指定订阅的流数据表中时间列的名称。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:9;96:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:9;96:1&#34;&gt;keyColumn&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:36;98:1&#34;&gt;类型：字符串标量&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:37;100:1&#34;&gt;可选参数，表示分组字段名。若设置，则分组进行计算，例如以每支股票为一组进行计算。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:10;102:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:10;102:1&#34;&gt;garbageSize&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:38;104:1&#34;&gt;类型：整型&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:39;106:1&#34;&gt;随着订阅的流数据在时序引擎中不断积累，存放在内存中的数据会越来越多，这时需要清理不再需要的历史数据。当内存中历史数据行数超过garbageSize值时，系统会清理本次计算不需要的历史数据。garbageSize的默认值是50,000。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:40;108:1&#34;&gt;如果指定了keyColumn，内存清理是各组内独立进行的。当一个组在内存中的历史数据记录数超出garbageSize时，会清理该组中本次计算中不需要的历史数据。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:11;110:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:11;110:1&#34;&gt;updateTime&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:41;112:1&#34;&gt;类型：整型&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:42;114:1&#34;&gt;如果没有指定updateTime，一个数据窗口结束前，不会发生对该数据窗口数据的计算。若要求在当前窗口结束前对当前窗口已有数据进行计算，可指定updateTime。step必须是updateTime的整数倍。要设置updateTime，useSystemTime必须设为false。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:43;116:1&#34;&gt;如果指定了updateTime，当前窗口内可能会发生多次计算。这些计算触发的规则为：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:44;118:1&#34;&gt;(1) 将当前窗口分为windowSize/updateTime个小窗口，每个小窗口长度为updateTime。一个小窗口结束后，若有一条新数据到达，且在此之前当前窗口内有未参加计算的的数据，会触发一次计算。请注意，该次计算不包括这条新数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:45;120:1&#34;&gt;(2) 一条数据到达时序引擎之后经过2*updateTime（若2*updateTime不足2秒，则设置为2秒），若其仍未参与计算，会触发一次计算。该次计算包括当时当前窗口内的所有数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:46;122:1&#34;&gt;若分组计算，则每组内进行上述操作。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:47;124:1&#34;&gt;请注意，当前窗口内每次计算结果的时间戳均为当前数据窗口开始时间或开始时间 + windowSize（由参数useWindowStartTime决定），而非当前窗口内的时刻。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:48;126:1&#34;&gt;如果指定了updateTime，输出表必须是键值内存表（使用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:6;126:31&#34;&gt;keyedTable&lt;/codeph&gt;函数创建）：如果没有指定keyColumn，输出表的主键是timeColumn；如果指定了keyColumn，输出表的主键是timeColumn和keyColumn。输出表若使用普通内存表或流数据表，每次计算均会增加一条记录，会产生大量带有相同时间戳的结果。输出表亦不可为键值流数据表，因为键值流数据表不可更新记录。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:49;128:1&#34;&gt;1.3.6小节使用例子详细介绍了指定updateTime参数后的计算过程。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:12;130:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:12;130:1&#34;&gt;useWindowStartTime&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:50;132:1&#34;&gt;类型：布尔类型&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:51;134:1&#34;&gt;可选参数，表示输出表中的时间是否为数据窗口起始时间。默认值为false，表示输出表中的时间为数据窗口起始时间 + windowSize。如果windowSize为多个窗口大小，则必须为fasle。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:13;136:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:13;136:1&#34;&gt;roundTime&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:52;138:1&#34;&gt;类型：布尔类型&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:53;140:1&#34;&gt;可选参数，是一个布尔值，表示若数据时间精度为毫秒或者秒且step&amp;gt;一分钟，如何对窗口边界值进行规整处理。默认值为true，表示按照既定的多分钟规则进行规整。若为false，则按一分钟规则进行窗口规整。细节请参阅 1.3.1 小节中有关 step 部分的alignmentSize取值规则。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:14;142:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:14;142:1&#34;&gt;snapshotDir&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:54;144:1&#34;&gt;类型：字符串类型&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:55;146:1&#34;&gt;可选参数，表示保存引擎快照的文件目录，可以用于系统出现异常之后，对引擎进行恢复。该目录必须存在，否则系统会提示异常。创建流数据引擎的时候，如果指定了snapshotDir，也会检查相应的快照是否存在。如果存在，会加载该快照，恢复引擎的状态。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:15;148:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:15;148:1&#34;&gt;snapshotIntervalInMsgCount&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:56;150:1&#34;&gt;类型：整型&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:57;152:1&#34;&gt;可选参数，表示保存引擎快照的消息间隔。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:16;154:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:16;154:1&#34;&gt;fill&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:17;155:5&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:17;155:5&#34;&gt;'none': 不输出结果。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:18;156:5&#34;&gt;'null': 输出结果为NULL.&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:19;157:5&#34;&gt;'ffill': 输出上一个有数据的窗口的结果。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:20;158:5&#34;&gt;'具体数值'：该值的数据类型需要和对应的metrics计算结果的类型保持一致。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:58;160:1&#34;&gt;可选参数，是一个标量或向量，表示若（某个key的）某个窗口无数据时，如何处理。可取如上值。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:59;163:1&#34;&gt;fill可以输入向量，为每个metrics指定不同的fill方式。其中，向量中各项只能是'null', 'ffill'或一个数值，不能是'none'。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;13-参数详细介绍及用例&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:5;165:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:5;165:1&#34;&gt;1.3. 参数详细介绍及用例&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:5;165:1&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;131-step&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:6;167:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:6;167:1&#34;&gt;1.3.1. step&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:6;167:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:60;169:1&#34;&gt;系统按照数据时间精度以及参数step的值确定一个规整尺度alignmentSize，对第一个数据窗口的边界值进行规整处理。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:61;171:1&#34;&gt;若timeColumn精度为秒，如DATETIME或SECOND类型，alignmentSize取值规则如下表：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:1;173:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:1;173:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:1;173:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:2;173:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:1;173:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:1;173:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:1;173:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;step&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:2;173:8&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;alignmentSize&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:1;175:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:2;175:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:3;175:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;0~2&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:4;175:8&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;2&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:3;176:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:5;176:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;3&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:6;176:5&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;3&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:4;177:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:7;177:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;4~5&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:8;177:8&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;5&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:5;178:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:9;178:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;6~10&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:10;178:8&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;10&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:6;179:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:11;179:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;11~15&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:12;179:9&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;15&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:7;180:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:13;180:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;16~20&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:14;180:9&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;20&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:8;181:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:15;181:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;21~30&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:16;181:9&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;30&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:9;182:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:17;182:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;31~60&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:18;182:9&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;60&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:62;184:1&#34;&gt;如果 roundTime = false, 对于step &amp;gt; 60, alignmentSize 都为60。 如果 roundTime = true，则alignmentSize取值规则如下表：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:2;186:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:2;186:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:3;186:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:4;186:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:2;186:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:10;186:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:19;186:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;step&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:20;186:14&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;alignmentSize&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:2;188:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:11;188:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:21;188:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;61～120&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:22;188:13&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;120（2分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:12;189:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:23;189:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;121~180&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:24;189:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;180（3分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:13;190:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:25;190:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;181~300&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:26;190:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;300（5分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:14;191:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:27;191:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;301~600&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:28;191:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;600（10分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:15;192:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:29;192:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;601~900&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:30;192:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;900（15分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:16;193:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:31;193:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;901~1200&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:32;193:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;1200（20分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:17;194:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:33;194:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;1201~1800&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:34;194:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;1800（30分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:18;195:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:35;195:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;&amp;gt;1800&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:36;195:14&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;3600（1小时）&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:63;197:1&#34;&gt;若数据时间精度为毫秒，如TIMESTAMP或TIME类型，alignmentSize取值规则如下表：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:3;199:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:3;199:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:5;199:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:6;199:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:3;199:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:19;199:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:37;199:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;step&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:38;199:8&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;alignmentSize&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:3;201:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:20;201:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:39;201:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;0~2&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:40;201:8&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;2&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:21;202:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:41;202:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;3~5&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:42;202:8&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;5&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:22;203:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:43;203:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;6~10&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:44;203:9&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;10&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:23;204:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:45;204:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;11~20&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:46;204:10&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;20&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:24;205:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:47;205:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;21~25&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:48;205:10&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;25&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:25;206:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:49;206:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;26~50&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:50;206:9&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;50&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:26;207:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:51;207:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;51~100&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:52;207:10&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;100&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:27;208:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:53;208:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;101~200&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:54;208:11&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;200&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:28;209:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:55;209:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34;&gt;201~250&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:56;209:11&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34;&gt;250&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:29;210:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:57;210:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34;&gt;251~500&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:58;210:11&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34;&gt;500&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:30;211:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:59;211:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;12&#34;&gt;501~1000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:60;211:12&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;12&#34;&gt;1000（1秒）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:31;212:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:61;212:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;13&#34;&gt;1001~2000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:62;212:13&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;13&#34;&gt;2000（2秒）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:32;213:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:63;213:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;14&#34;&gt;2001~3000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:64;213:13&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;14&#34;&gt;3000（3秒）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:33;214:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:65;214:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;15&#34;&gt;3001~5000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:66;214:13&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;15&#34;&gt;5000（5秒）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:34;215:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:67;215:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;16&#34;&gt;5001~10000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:68;215:14&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;16&#34;&gt;10000（10秒）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:35;216:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:69;216:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;17&#34;&gt;10001~15000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:70;216:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;17&#34;&gt;15000（15秒）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:36;217:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:71;217:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;18&#34;&gt;15001~20000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:72;217:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;18&#34;&gt;20000（20秒）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:37;218:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:73;218:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;19&#34;&gt;20001~30000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:74;218:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;19&#34;&gt;30000（30秒）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:38;219:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:75;219:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;20&#34;&gt;30001~60000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:76;219:15&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;20&#34;&gt;60000（1分钟）&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:64;221:1&#34;&gt;如果 roundTime = false, 对于step &amp;gt; 60000, alignmentSize 都为60000。 如果 roundTime = true，则alignmentSize取值规则如下表：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:4;223:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:4;223:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:7;223:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:8;223:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:4;223:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:39;223:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:77;223:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;step&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:78;223:20&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;alignmentSize&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:4;225:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:40;225:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:79;225:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;60001~120000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:80;225:21&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;120000（2分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:41;226:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:81;226:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;120001~180000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:82;226:21&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;180000（3分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:42;227:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:83;227:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;120001~300000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:84;227:21&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;300000（5分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:43;228:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:85;228:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;300001~600000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:86;228:21&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;600000（10分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:44;229:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:87;229:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;600001~900000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:88;229:21&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;900000（15分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:45;230:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:89;230:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;900001~1200000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:90;230:21&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;1200000（20分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:46;231:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:91;231:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;1200001~1800000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:92;231:21&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;1800000（30分钟）&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:47;232:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:93;232:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;&amp;gt;= 1800001&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:94;232:20&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;3600000（1小时）&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:65;234:1&#34;&gt;DolphinDB系统将各种时间类型数据存储为以最小精度为单位的整形。例如，13:30:10存储为13*60*60+30*60+10=48610。系统将第一个数据窗口的左边界规整为第一条数据时刻之前最后一个可被alignmentSize整除的时刻。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:66;236:1&#34;&gt;若第一条数据时刻为x，数据类型为TIMESTAMP，那么第一个数据窗口的左边界经过规整后为timestamp(x/alignmentSize*alignmentSize)，其中&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:7;236:90&#34;&gt;/&lt;/codeph&gt;代表相除后取整。例如，若第一条数据的时间为2018.10.08T01:01:01.365，step为60000，那么alignmentSize为60000，第一个数据窗口的左边界为timestamp(2018.10.08T01:01:01.365/60000*60000)，即2018.10.08T01:01:00.000。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:67;238:1&#34;&gt;下例说明数据窗口如何规整以及流数据时序引擎如何进行计算。以下代码建立流数据表trades，包含time和volume两列。创建时序引擎streamAggr1，每3毫秒对过去6毫秒的数据计算sum(volume)。time列的精度为毫秒，模拟插入的数据流频率也设为每毫秒一条数据。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:1;240:1&#34;&gt;share streamTable(1000:0, `time`volume, [TIMESTAMP, INT]) as trades outputTable = table(10000:0, `time`sumVolume, [TIMESTAMP, INT]) tradesAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;[sum(volume)]&amp;gt;, dummyTable=trades, outputTable=outputTable, timeColumn=`time) subscribeTable(tableName=&#34;trades&#34;, actionName=&#34;append_tradesAggregator&#34;, offset=0, handler=append!{tradesAggregator}, msgAsTable=true) &lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:68;247:1&#34;&gt;向流数据表trades中写入10条数据，并查看流数据表trades内容：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:2;249:1&#34;&gt;def writeData(t, n){ timev = 2018.10.08T01:01:01.001 + timestamp(1..n) volumev = take(1, n) insert into t values(timev, volumev) } writeData(trades, 10) select * from trades;&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:5;260:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:5;260:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:9;260:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:10;260:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:5;260:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:48;260:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:95;260:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:96;260:6&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;volume&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:5;262:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:49;262:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:97;262:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:01:01.002&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:98;262:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:50;263:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:99;263:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:01:01.003&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:100;263:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:51;264:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:101;264:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:01:01.004&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:102;264:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:52;265:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:103;265:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2018.10.08T01:01:01.005&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:104;265:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:53;266:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:105;266:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2018.10.08T01:01:01.006&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:106;266:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:54;267:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:107;267:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2018.10.08T01:01:01.007&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:108;267:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:55;268:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:109;268:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;2018.10.08T01:01:01.008&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:110;268:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:56;269:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:111;269:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;2018.10.08T01:01:01.009&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:112;269:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:57;270:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:113;270:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34;&gt;2018.10.08T01:01:01.010&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:114;270:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:58;271:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:115;271:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34;&gt;2018.10.08T01:01:01.011&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:116;271:25&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:69;273:1&#34;&gt;再查看结果表outputTable:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:3;274:1&#34;&gt;select * from outputTable;&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:6;277:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:6;277:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:11;277:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:12;277:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:6;277:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:59;277:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:117;277:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:118;277:6&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sumVolume&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:6;279:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:60;279:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:119;279:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:01:01.003&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:120;279:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:61;280:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:121;280:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:01:01.006&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:122;280:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;4&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:62;281:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:123;281:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:01:01.009&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:124;281:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;6&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:70;283:1&#34;&gt;根据第一条数据时刻规整第一个窗口的起始时间后，窗口以step为步长移动。下面详细解释时序引擎的计算过程。为简便起见，以下提到时间时，省略相同的2018.10.08T01:01:01部分，只列出毫秒部分。基于第一行数据的时间002，第一个窗口的起始时间规整为000，到002结束，只包含002一条记录，计算被003记录触发，sum(volume)的结果是1；第二个窗口从000到005，包含了四条数据，计算被006记录触发，计算结果为4；第三个窗口从003到008，包含6条数据，计算被009记录触发，计算结果为6。虽然第四个窗口从006到011且含有6条数据，但是由于该窗口结束之后没有数据，所以该窗口的计算没有被触发。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:71;285:1&#34;&gt;若需要重复执行以上程序，应首先解除订阅，并将流数据表trades与时序引擎streamAggr1二者删除：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:4;287:1&#34;&gt;unsubscribeTable(tableName=&#34;trades&#34;, actionName=&#34;append_tradesAggregator&#34;) undef(`trades, SHARED) dropStreamEngine(&#34;streamAggr1&#34;)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;132-windowsize&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:7;293:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:7;293:1&#34;&gt;1.3.2. windowSize&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:7;293:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:72;295:1&#34;&gt;DolphinDB时序引擎支持多个窗口。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:73;297:1&#34;&gt;下例说如何对相同的metrics按不同的windowSize聚合。以下代码建立流数据表trades，包含time和volume两列。创建时序引擎streamAggr1，每3毫秒对过去6毫秒和过去12毫秒的数据计算sum(volume)。time列的精度为毫秒，模拟插入的数据流频率也设为每毫秒一条数据。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:5;299:1&#34;&gt;share streamTable(1000:0, `time`volume, [TIMESTAMP, INT]) as trades outputTable = table(10000:0, `time`sumVolume1`sumVolume2, [TIMESTAMP, INT,INT]) tradesAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=[6,12], step=3, metrics=[&amp;lt;sum(volume)&amp;gt;,&amp;lt;sum(volume)&amp;gt;], dummyTable=trades, outputTable=outputTable, timeColumn=`time) subscribeTable(tableName=&#34;trades&#34;, actionName=&#34;append_tradesAggregator&#34;, offset=0, handler=append!{tradesAggregator}, msgAsTable=true) &lt;/codeblock&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:6;306:1&#34;&gt;def writeData(t, n){ timev = 2018.10.08T01:01:01.001 + timestamp(1..n) volumev = take(1, n) insert into t values(timev, volumev) } writeData(trades, 20) select * from trades;&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:74;317:1&#34;&gt;再查看结果表outputTable:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:7;319:1&#34;&gt;select * from outputTable;&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:7;323:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:7;323:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:13;323:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:14;323:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:15;323:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:7;323:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:63;323:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:125;323:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:126;323:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sumVolume1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:127;323:41&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;sumVolume2&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:7;325:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:64;325:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:128;325:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:01:01.003&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:129;325:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:130;325:41&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:65;326:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:131;326:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:01:01.006&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:132;326:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;4&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:133;326:41&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34;&gt;4&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:66;327:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:134;327:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:01:01.009&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:135;327:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:136;327:41&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34;&gt;7&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:67;328:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:137;328:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2018.10.08T01:01:01.012&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:138;328:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:139;328:41&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34;&gt;10&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:68;329:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:140;329:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2018.10.08T01:01:01.015&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:141;329:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:142;329:41&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34;&gt;12&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:69;330:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:143;330:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2018.10.08T01:01:01.018&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:144;330:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:145;330:41&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;7&#34;&gt;12&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:70;331:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:146;331:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;2018.10.08T01:01:01.021&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:147;331:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;6&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:148;331:41&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;8&#34;&gt;12&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;133-metrics&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:8;333:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:8;333:1&#34;&gt;1.3.3. metrics&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:8;333:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:75;335:1&#34;&gt;DolphinDB 时序引擎支持使用多种表达式进行实时计算。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:18;337:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:21;337:1&#34;&gt;一个或多个聚合函数&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:8;339:1&#34;&gt;tsAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;sum(ask)&amp;gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:19;343:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:22;343:1&#34;&gt;使用聚合结果进行计算&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:9;345:1&#34;&gt;tsAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;max(ask)-min(ask)&amp;gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:20;349:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:23;349:1&#34;&gt;对列与列的操作结果进行聚合计算&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:10;351:1&#34;&gt;tsAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;max(ask-bid)&amp;gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:21;355:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:24;355:1&#34;&gt;输出多个聚合结果&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:11;357:1&#34;&gt;tsAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;[max((ask-bid)/(ask+bid)*2), min((ask-bid)/(ask+bid)*2)]&amp;gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:22;361:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:25;361:1&#34;&gt;使用多参数聚合函数&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:12;363:1&#34;&gt;tsAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;corr(ask,bid)&amp;gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time) tsAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;percentile(ask-bid,99)/sum(ask)&amp;gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:23;369:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:26;369:1&#34;&gt;使用自定义函数&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:13;371:1&#34;&gt;defg diff(x,y){ return sum(x)-sum(y) } tsAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;diff(ask, bid)&amp;gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:24;378:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:27;378:1&#34;&gt;使用多个返回结果的函数&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:14;380:1&#34;&gt;defg sums(x){ return [sum(x),sum2(x)] } tsAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=6, step=3, metrics=&amp;lt;sums(ask) as `sumAsk`sum2Ask&amp;gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time) &lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:76;388:1&#34;&gt;注意：不支持聚合函数嵌套调用，例如sum(spread(ask,bid))。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;134-dummytable&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:9;390:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:9;390:1&#34;&gt;1.3.4. dummyTable&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:9;390:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:77;392:1&#34;&gt;系统利用dummyTable的schema来决定订阅的流数据中每一列的数据类型。dummyTable有无数据对结果没有任何影响。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:15;393:1&#34;&gt;share streamTable(1000:0, `time`volume, [TIMESTAMP, INT]) as trades modelTable = table(1000:0, `time`volume, [TIMESTAMP, INT]) outputTable = table(10000:0, `time`sumVolume, [TIMESTAMP, INT]) tradesAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=5, step=5, metrics=&amp;lt;[sum(volume)]&amp;gt;, dummyTable=modelTable, outputTable=outputTable, timeColumn=`time) subscribeTable(tableName=&#34;trades&#34;, actionName=&#34;append_tradesAggregator&#34;, offset=0, handler=append!{tradesAggregator}, msgAsTable=true) def writeData(t,n){ timev = 2018.10.08T01:01:01.001 + timestamp(1..n) volumev = take(1, n) insert into t values(timev, volumev) } writeData(trades, 6) sleep(1) select * from outputTable&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;135-outputtable&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:10;412:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:10;412:1&#34;&gt;1.3.5. outputTable&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:10;412:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:78;414:1&#34;&gt;计算结果可以输出到内存表或流数据表。输出到内存表的数据可以更新或删除，而输出到流数据表的数据无法更新或删除，但是可以通过流数据表将结果作为另一个引擎的数据源再次发布。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:79;416:1&#34;&gt;下例中，时序引擎electricityAggregator1订阅流数据表electricity，进行移动均值计算，并将结果输出到流数据表outputTable1。时序引擎electricityAggregator2订阅outputTable1表，并对移动均值计算结果求移动峰值。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:16;418:1&#34;&gt;share streamTable(1000:0,`time`voltage`current,[TIMESTAMP,DOUBLE,DOUBLE]) as electricity //将第一个时序引擎的输出表定义为流数据表，可以再次订阅 share streamTable(10000:0,`time`avgVoltage`avgCurrent,[TIMESTAMP,DOUBLE,DOUBLE]) as outputTable1 electricityAggregator1 = createTimeSeriesEngine(name=&#34;electricityAggregator1&#34;, windowSize=10, step=10, metrics=&amp;lt;[avg(voltage), avg(current)]&amp;gt;, dummyTable=electricity, outputTable=outputTable1, timeColumn=`time, garbageSize=2000) subscribeTable(tableName=&#34;electricity&#34;, actionName=&#34;avgElectricity&#34;, offset=0, handler=append!{electricityAggregator1}, msgAsTable=true) //订阅计算结果，再次进行聚合计算 outputTable2 =table(10000:0, `time`maxVoltage`maxCurrent, [TIMESTAMP,DOUBLE,DOUBLE]) electricityAggregator2 = createTimeSeriesEngine(name=&#34;electricityAggregator2&#34;, windowSize=100, step=100, metrics=&amp;lt;[max(avgVoltage), max(avgCurrent)]&amp;gt;, dummyTable=outputTable1, outputTable=outputTable2, timeColumn=`time, garbageSize=2000) subscribeTable(tableName=&#34;outputTable1&#34;, actionName=&#34;maxElectricity&#34;, offset=0, handler=append!{electricityAggregator2}, msgAsTable=true); //向electricity表中插入500条数据 def writeData(t, n){ timev = 2018.10.08T01:01:01.000 + timestamp(1..n) voltage = 1..n * 0.1 current = 1..n * 0.05 insert into t values(timev, voltage, current) } writeData(electricity, 500);&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:80;441:1&#34;&gt;聚合计算结果:&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:17;442:1&#34;&gt;select * from outputTable2;&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:8;445:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:8;445:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:16;445:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:17;445:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:18;445:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:8;445:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:71;445:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:149;445:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:150;445:7&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;maxVoltage&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:151;445:19&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;maxCurrent&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:8;447:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:72;447:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:152;447:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:01:01.100&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:153;447:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;8.45&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:154;447:32&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;4.225&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:73;448:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:155;448:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:01:01.200&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:156;448:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;18.45&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:157;448:33&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34;&gt;9.225&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:74;449:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:158;449:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:01:01.300&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:159;449:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;28.45&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:160;449:33&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34;&gt;14.225&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:75;450:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:161;450:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2018.10.08T01:01:01.400&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:162;450:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;38.45&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:163;450:33&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34;&gt;19.225&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:76;451:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:164;451:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2018.10.08T01:01:01.500&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:165;451:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;48.45&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:166;451:33&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34;&gt;24.225&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:81;453:1&#34;&gt;若要对上述脚本进行重复使用，需先执行以下脚本以清除共享表、订阅以及流数据引擎：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:18;454:1&#34;&gt;unsubscribeTable(tableName=&#34;electricity&#34;, actionName=&#34;avgElectricity&#34;) undef(`electricity, SHARED) unsubscribeTable(tableName=&#34;outputTable1&#34;, actionName=&#34;maxElectricity&#34;) undef(`outputTable1, SHARED) dropStreamEngine(&#34;electricityAggregator1&#34;) dropStreamEngine(&#34;electricityAggregator2&#34;)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;136-keycolumn&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:11;463:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:11;463:1&#34;&gt;1.3.6. keyColumn&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:11;463:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:82;465:1&#34;&gt;下例中，设定keyColumn参数为sym。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:19;466:1&#34;&gt;share streamTable(1000:0, `time`sym`volume, [TIMESTAMP, SYMBOL, INT]) as trades outputTable = table(10000:0, `time`sym`sumVolume, [TIMESTAMP, SYMBOL, INT]) tradesAggregator = createTimeSeriesEngine(name=&#34;streamAggr1&#34;, windowSize=3, step=3, metrics=&amp;lt;[sum(volume)]&amp;gt;, dummyTable=trades, outputTable=outputTable, timeColumn=`time, useSystemTime=false, keyColumn=`sym, garbageSize=50) subscribeTable(tableName=&#34;trades&#34;, actionName=&#34;append_tradesAggregator&#34;, offset=0, handler=append!{tradesAggregator}, msgAsTable=true) def writeData(t, n){ timev = 2018.10.08T01:01:01.001 + timestamp(1..n) symv =take(`A`B, n) volumev = take(1, n) insert into t values(timev, symv, volumev) } writeData(trades, 6)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:83;481:1&#34;&gt;为了方便观察，对&#34;trades&#34;表的sym列排序输出：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:20;483:1&#34;&gt;select * from trades order by sym;&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:9;487:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:9;487:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:19;487:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:20;487:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:21;487:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:9;487:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:77;487:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:167;487:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:168;487:6&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sym&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:169;487:10&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;volume&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:9;489:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:78;489:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:170;489:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:01:01.002&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:171;489:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:172;489:29&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:79;490:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:173;490:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:01:01.004&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:174;490:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:175;490:29&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:80;491:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:176;491:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:01:01.006&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:177;491:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:178;491:29&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:81;492:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:179;492:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2018.10.08T01:01:01.003&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:180;492:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:181;492:29&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:82;493:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:182;493:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2018.10.08T01:01:01.005&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:183;493:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:184;493:29&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:83;494:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:185;494:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2018.10.08T01:01:01.007&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:186;494:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:187;494:29&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;7&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:84;496:1&#34;&gt;分组计算结果：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:21;498:1&#34;&gt;select * from outputTable; &lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:10;502:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:10;502:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:22;502:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:23;502:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:24;502:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:10;502:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:84;502:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:188;502:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:189;502:7&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sym&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:190;502:11&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;sumVolume&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:10;504:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:85;504:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:191;504:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:01:01.003&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:192;504:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:193;504:28&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:86;505:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:194;505:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:01:01.006&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:195;505:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:196;505:28&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:87;506:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:197;506:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:01:01.006&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:198;506:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:199;506:28&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34;&gt;2&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:85;508:1&#34;&gt;各组窗口规整后统一从000时间点开始，根据windowSize=3以及step=3，每个组的窗口会按照000-003-006划分。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:25;509:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:28;509:1&#34;&gt;(1) 在003，B组有一条数据，但是由于B组在第一个窗口没有任何数据，不会进行计算也不会产生结果，所以B组第一个窗口没有结果输出。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:29;510:1&#34;&gt;(2) 004的A组数据触发A组第一个窗口的计算。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:30;511:1&#34;&gt;(3) 006的A组数据触发A组第二个窗口的计算。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:31;512:1&#34;&gt;(4) 007的B组数据触发B组第二个窗口的计算。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:86;514:1&#34;&gt;如果进行分组聚合计算，流数据源中的每个分组中的'timeColumn'必须是递增的，但是整个数据源的'timeColumn'可以不是递增的；如果没有进行分组聚合，那么整个数据源的'timeColumn'必须是递增的，否则时序引擎的输出结果会与预期不符。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;137-updatetime&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:12;516:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:12;516:1&#34;&gt;1.3.7. updateTime&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:12;516:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:87;518:1&#34;&gt;通过以下两个例子，可以理解updateTime的作用。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:88;520:1&#34;&gt;首先创建流数据表并写入数据：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:22;522:1&#34;&gt;share streamTable(1000:0, `time`sym`volume, [TIMESTAMP, SYMBOL, INT]) as trades insert into trades values(2018.10.08T01:01:01.785,`A,10) insert into trades values(2018.10.08T01:01:02.125,`B,26) insert into trades values(2018.10.08T01:01:10.263,`B,14) insert into trades values(2018.10.08T01:01:12.457,`A,28) insert into trades values(2018.10.08T01:02:10.789,`A,15) insert into trades values(2018.10.08T01:02:12.005,`B,9) insert into trades values(2018.10.08T01:02:30.021,`A,10) insert into trades values(2018.10.08T01:04:02.236,`A,29) insert into trades values(2018.10.08T01:04:04.412,`B,32) insert into trades values(2018.10.08T01:04:05.152,`B,23);&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:26;536:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:32;536:1&#34;&gt;不指定updateTime：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:23;538:1&#34;&gt;output1 = table(10000:0, `time`sym`sumVolume, [TIMESTAMP, SYMBOL, INT]) agg1 = createTimeSeriesEngine(name=&#34;agg1&#34;, windowSize=60000, step=60000, metrics=&amp;lt;[sum(volume)]&amp;gt;, dummyTable=trades, outputTable=output1, timeColumn=`time, useSystemTime=false, keyColumn=`sym, garbageSize=50, useWindowStartTime=false) subscribeTable(tableName=&#34;trades&#34;, actionName=&#34;agg1&#34;, offset=0, handler=append!{agg1}, msgAsTable=true) sleep(10) select * from output1;&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:11;548:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:11;548:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:25;548:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:26;548:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:27;548:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:11;548:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:88;548:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:200;548:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:201;548:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sym&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:202;548:30&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;sumVolume&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:11;550:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:89;550:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:203;550:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:02:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:204;550:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:205;550:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;38&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:90;551:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:206;551:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:03:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:207;551:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:208;551:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34;&gt;25&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:91;552:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:209;552:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:02:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:210;552:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:211;552:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34;&gt;40&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:92;553:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:212;553:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2018.10.08T01:03:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:213;553:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:214;553:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34;&gt;9&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:27;555:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:33;555:1&#34;&gt;将updateTime设为1000：&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:24;557:1&#34;&gt;output2 = keyedTable(`time`sym,10000:0, `time`sym`sumVolume, [TIMESTAMP, SYMBOL, INT]) agg2 = createTimeSeriesEngine(name=&#34;agg2&#34;, windowSize=60000, step=60000, metrics=&amp;lt;[sum(volume)]&amp;gt;, dummyTable=trades, outputTable=output2, timeColumn=`time, useSystemTime=false, keyColumn=`sym, garbageSize=50, updateTime=1000, useWindowStartTime=false) subscribeTable(tableName=&#34;trades&#34;, actionName=&#34;agg2&#34;, offset=0, handler=append!{agg2}, msgAsTable=true) sleep(2010) select * from output2;&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:12;567:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:12;567:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:28;567:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:29;567:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:30;567:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:12;567:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:93;567:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:215;567:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:216;567:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sym&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:217;567:30&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;sumVolume&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:12;569:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:94;569:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:218;569:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:02:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:219;569:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:220;569:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;38&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:95;570:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:221;570:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:03:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:222;570:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:223;570:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34;&gt;25&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:96;571:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:224;571:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:02:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:225;571:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:226;571:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34;&gt;40&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:97;572:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:227;572:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2018.10.08T01:03:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:228;572:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:229;572:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34;&gt;9&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:98;573:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:230;573:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2018.10.08T01:05:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:231;573:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;B&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:232;573:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34;&gt;55&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:99;574:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:233;574:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2018.10.08T01:05:00.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:234;574:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;A&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:235;574:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;7&#34;&gt;29&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:89;576:1&#34;&gt;下面我们介绍以上两个例子在最后一个数据窗口（01:04:00.000到01:05:00.000）的区别。为简便起见，我们省略日期部分，只列出（小时:分钟:秒.毫秒）部分。假设time列时间亦为数据进入时序引擎的时刻。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:90;578:1&#34;&gt;(1) 在01:04:04.236时，A分组的第一条记录到达后已经过2000毫秒，触发一次A组计算，输出表增加一条记录(01:05:00.000, `A, 29)。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:91;580:1&#34;&gt;(2) 在01:04:05.152时的B组记录为01:04:04.412所在小窗口[01:04:04.000, 01:04:05.000)之后第一条记录，触发一次B组计算，输出表增加一条记录(01:05:00.000,&#34;B&#34;,32)。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:92;582:1&#34;&gt;(3) 2000毫秒后，在01:04:07.152时，由于01:04:05.152时的B组记录仍未参与计算，触发一次B组计算，输出一条记录(01:05:00.000,&#34;B&#34;,55)。由于输出表的主键为time和sym，并且输出表中已有(01:05:00.000,&#34;B&#34;,32)这条记录，因此将该记录更新为(01:05:00.000,&#34;B&#34;,55)。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;138-snapshot&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:13;584:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:13;584:1&#34;&gt;1.3.8. snapshot&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:13;584:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:93;586:1&#34;&gt;通过以下这个例子，可以理解snapshotDir和snapshotIntervalInMsgCount的作用。如果启用snapshot，引擎订阅流数据表时，handler需是appendMsg函数，需指定handlerNeedMsgId=true，用来记录快照的消息位置。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:25;588:1&#34;&gt;share streamTable(10000:0,`time`sym`price`id, [TIMESTAMP,SYMBOL,INT,INT]) as trades output1 =table(10000:0, `time`sumprice, [TIMESTAMP,INT]); Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&amp;lt;sum(price)&amp;gt;, dummyTable=trades, outputTable=output1, timeColumn=`time, snapshotDir=&#34;/home/server1/snapshotDir&#34;, snapshotIntervalInMsgCount=100) subscribeTable(server=&#34;&#34;, tableName=&#34;trades&#34;, actionName=&#34;Agg1&#34;,offset= 0, handler=appendMsg{Agg1}, msgAsTable=true, handlerNeedMsgId=true) n=500 timev=timestamp(1..n) + 2021.03.12T15:00:00.000 symv = take(`abc`def, n) pricev = int(1..n) id = take(-1, n) insert into trades values(timev, symv, pricev, id) select * from output1&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:13;604:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:13;604:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:31;604:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:32;604:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:13;604:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:100;604:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:236;604:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:237;604:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sumprice&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:13;606:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:101;606:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:238;606:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2021.03.12T15:00:00.050&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:239;606:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;1225&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:102;607:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:240;607:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2021.03.12T15:00:00.100&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:241;607:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;4950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:103;608:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:242;608:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2021.03.12T15:00:00.150&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:243;608:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;9950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:104;609:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:244;609:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2021.03.12T15:00:00.200&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:245;609:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;14950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:105;610:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:246;610:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2021.03.12T15:00:00.250&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:247;610:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;19950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:106;611:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:248;611:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2021.03.12T15:00:00.300&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:249;611:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;24950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:107;612:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:250;612:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;2021.03.12T15:00:00.350&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:251;612:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;29950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:108;613:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:252;613:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;2021.03.12T15:00:00.400&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:253;613:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;34950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:109;614:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:254;614:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34;&gt;2021.03.12T15:00:00.450&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:255;614:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34;&gt;39950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:110;615:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:256;615:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34;&gt;2021.03.12T15:00:00.500&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:257;615:28&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34;&gt;44950&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:26;617:1&#34;&gt;getSnapshotMsgId(Agg1) &amp;gt;499&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:94;622:1&#34;&gt;取消订阅并删除引擎来模拟系统异常&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:27;624:1&#34;&gt;unsubscribeTable(, &#34;trades&#34;, &#34;Agg1&#34;) dropStreamEngine(&#34;Agg1&#34;) Agg1=NULL&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:95;630:1&#34;&gt;此时发布端仍在写入数据&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:28;632:1&#34;&gt;n=500 timev=timestamp(501..1000) + 2021.03.12T15:00:00.000 symv = take(`abc`def, n) pricev = int(1..n) id = take(-1, n) insert into trades values(timev, symv, pricev, id)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:96;641:1&#34;&gt;再次创建aggr, 加载snapshot，从上次处理最后一条消息开始重新订阅&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:29;643:1&#34;&gt;Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&amp;lt;sum(price)&amp;gt;, dummyTable=trades, outputTable=output1, timeColumn=`time, snapshotDir=&#34;/home/server1/snapshotDir&#34;, snapshotIntervalInMsgCount=100) ofst=getSnapshotMsgId(Agg1) print(ofst) &amp;gt;499 subscribeTable(server=&#34;&#34;, tableName=&#34;trades&#34;, actionName=&#34;Agg1&#34;,offset=ofst+1, handler=appendMsg{Agg1}, msgAsTable=true, handlerNeedMsgId=true) select * from output1&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:14;655:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:14;655:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:33;655:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:34;655:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:14;655:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:111;655:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:258;655:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:259;655:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sumprice&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:14;657:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:112;657:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:260;657:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2021.03.12T15:00:00.050&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:261;657:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;1225&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:113;658:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:262;658:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2021.03.12T15:00:00.100&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:263;658:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;4950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:114;659:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:264;659:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2021.03.12T15:00:00.150&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:265;659:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;9950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:115;660:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:266;660:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2021.03.12T15:00:00.200&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:267;660:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;14950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:116;661:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:268;661:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2021.03.12T15:00:00.250&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:269;661:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;19950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:117;662:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:270;662:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2021.03.12T15:00:00.300&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:271;662:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;24950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:118;663:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:272;663:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;2021.03.12T15:00:00.350&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:273;663:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;29950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:119;664:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:274;664:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;2021.03.12T15:00:00.400&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:275;664:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;34950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:120;665:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:276;665:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34;&gt;2021.03.12T15:00:00.450&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:277;665:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34;&gt;39950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:121;666:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:278;666:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34;&gt;2021.03.12T15:00:00.500&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:279;666:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34;&gt;44950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:122;667:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:280;667:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;12&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:1;667:3&#34;&gt;2021.03.12T15:00:00.550&lt;/b&gt;&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:281;667:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;12&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:2;667:33&#34;&gt;25450&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:123;668:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:282;668:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;13&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:3;668:3&#34;&gt;2021.03.12T15:00:00.600&lt;/b&gt;&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:283;668:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;13&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:4;668:33&#34;&gt;5450&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:124;669:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:284;669:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;14&#34;&gt;2021.03.12T15:00:00.650&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:285;669:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;14&#34;&gt;9950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:125;670:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:286;670:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;15&#34;&gt;2021.03.12T15:00:00.700&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:287;670:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;15&#34;&gt;14950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:126;671:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:288;671:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;16&#34;&gt;2021.03.12T15:00:00.750&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:289;671:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;16&#34;&gt;19950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:127;672:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:290;672:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;17&#34;&gt;2021.03.12T15:00:00.800&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:291;672:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;17&#34;&gt;24950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:128;673:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:292;673:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;18&#34;&gt;2021.03.12T15:00:00.850&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:293;673:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;18&#34;&gt;29950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:129;674:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:294;674:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;19&#34;&gt;2021.03.12T15:00:00.900&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:295;674:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;19&#34;&gt;34950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:130;675:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:296;675:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;20&#34;&gt;2021.03.12T15:00:00.950&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:297;675:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;20&#34;&gt;39950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:131;676:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:298;676:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;21&#34;&gt;2021.03.12T15:00:01.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:299;676:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;21&#34;&gt;44950&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:97;678:1&#34;&gt;结果和订阅不中断一样。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:30;680:1&#34;&gt;share streamTable(10000:0,`time`sym`price`id, [TIMESTAMP,SYMBOL,INT,INT]) as trades output1 =table(10000:0, `time`sumprice, [TIMESTAMP,INT]); Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&amp;lt;sum(price)&amp;gt;, dummyTable=trades, outputTable=output1, timeColumn=`time) subscribeTable(server=&#34;&#34;, tableName=&#34;trades&#34;, actionName=&#34;Agg1&#34;,offset= 0, handler=append!{Agg1}, msgAsTable=true) n=500 timev=timestamp(1..n) + 2021.03.12T15:00:00.000 symv = take(`abc`def, n) pricev = int(1..n) id = take(-1, n) insert into trades values(timev, symv, pricev, id) n=500 timev=timestamp(501..1000) + 2021.03.12T15:00:00.000 symv = take(`abc`def, n) pricev = int(1..n) id = take(-1, n) insert into trades values(timev, symv, pricev, id) select * from output1&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:15;703:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:15;703:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:35;703:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:36;703:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:15;703:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:132;703:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:300;703:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:301;703:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sumprice&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:15;705:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:133;705:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:302;705:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2021.03.12T15:00:00.050&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:303;705:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;1225&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:134;706:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:304;706:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2021.03.12T15:00:00.100&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:305;706:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;4950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:135;707:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:306;707:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2021.03.12T15:00:00.150&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:307;707:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;9950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:136;708:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:308;708:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2021.03.12T15:00:00.200&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:309;708:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;14950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:137;709:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:310;709:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2021.03.12T15:00:00.250&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:311;709:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;19950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:138;710:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:312;710:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2021.03.12T15:00:00.300&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:313;710:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;24950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:139;711:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:314;711:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;2021.03.12T15:00:00.350&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:315;711:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;29950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:140;712:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:316;712:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;2021.03.12T15:00:00.400&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:317;712:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;34950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:141;713:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:318;713:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34;&gt;2021.03.12T15:00:00.450&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:319;713:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34;&gt;39950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:142;714:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:320;714:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34;&gt;2021.03.12T15:00:00.500&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:321;714:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34;&gt;44950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:143;715:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:322;715:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;12&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:5;715:3&#34;&gt;2021.03.12T15:00:00.550&lt;/b&gt;&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:323;715:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;12&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:6;715:33&#34;&gt;25450&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:144;716:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:324;716:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;13&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:7;716:3&#34;&gt;2021.03.12T15:00:00.600&lt;/b&gt;&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:325;716:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;13&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:8;716:33&#34;&gt;5450&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:145;717:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:326;717:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;14&#34;&gt;2021.03.12T15:00:00.650&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:327;717:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;14&#34;&gt;9950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:146;718:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:328;718:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;15&#34;&gt;2021.03.12T15:00:00.700&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:329;718:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;15&#34;&gt;14950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:147;719:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:330;719:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;16&#34;&gt;2021.03.12T15:00:00.750&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:331;719:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;16&#34;&gt;19950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:148;720:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:332;720:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;17&#34;&gt;2021.03.12T15:00:00.800&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:333;720:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;17&#34;&gt;24950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:149;721:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:334;721:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;18&#34;&gt;2021.03.12T15:00:00.850&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:335;721:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;18&#34;&gt;29950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:150;722:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:336;722:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;19&#34;&gt;2021.03.12T15:00:00.900&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:337;722:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;19&#34;&gt;34950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:151;723:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:338;723:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;20&#34;&gt;2021.03.12T15:00:00.950&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:339;723:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;20&#34;&gt;39950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:152;724:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:340;724:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;21&#34;&gt;2021.03.12T15:00:01.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:341;724:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;21&#34;&gt;44950&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:98;726:1&#34;&gt;如果不开启snapshot，即使从上次中断的地方开始订阅，得到的结果也与订阅不中断不一样。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:31;728:1&#34;&gt;share streamTable(10000:0,`time`sym`price`id, [TIMESTAMP,SYMBOL,INT,INT]) as trades output1 =table(10000:0, `time`sumprice, [TIMESTAMP,INT]); Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&amp;lt;sum(price)&amp;gt;, dummyTable=trades, outputTable=output1, timeColumn=`time) subscribeTable(server=&#34;&#34;, tableName=&#34;trades&#34;, actionName=&#34;Agg1&#34;,offset= 0, handler=append!{Agg1}, msgAsTable=true) n=500 timev=timestamp(1..n) + 2021.03.12T15:00:00.000 symv = take(`abc`def, n) pricev = int(1..n) id = take(-1, n) insert into trades values(timev, symv, pricev, id) unsubscribeTable(, &#34;trades&#34;, &#34;Agg1&#34;) dropStreamEngine(&#34;Agg1&#34;) Agg1=NULL n=500 timev=timestamp(501..1000) + 2021.03.12T15:00:00.000 symv = take(`abc`def, n) pricev = int(1..n) id = take(-1, n) insert into trades values(timev, symv, pricev, id) Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&amp;lt;sum(price)&amp;gt;, dummyTable=trades, outputTable=output1, timeColumn=`time) subscribeTable(server=&#34;&#34;, tableName=&#34;trades&#34;, actionName=&#34;Agg1&#34;,offset= 500, handler=append!{Agg1}, msgAsTable=true) select * from output1&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:16;758:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:16;758:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:37;758:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:38;758:1&#34; colnum=&#34;2&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:16;758:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:153;758:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:342;758:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:343;758:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;sumprice&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:16;760:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:154;760:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:344;760:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2021.03.12T15:00:00.050&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:345;760:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;1225&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:155;761:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:346;761:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2021.03.12T15:00:00.100&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:347;761:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;4950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:156;762:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:348;762:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2021.03.12T15:00:00.150&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:349;762:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;9950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:157;763:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:350;763:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2021.03.12T15:00:00.200&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:351;763:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;14950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:158;764:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:352;764:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2021.03.12T15:00:00.250&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:353;764:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;19950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:159;765:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:354;765:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2021.03.12T15:00:00.300&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:355;765:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;24950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:160;766:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:356;766:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;2021.03.12T15:00:00.350&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:357;766:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;29950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:161;767:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:358;767:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;2021.03.12T15:00:00.400&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:359;767:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;34950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:162;768:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:360;768:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34;&gt;2021.03.12T15:00:00.450&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:361;768:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34;&gt;39950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:163;769:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:362;769:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34;&gt;2021.03.12T15:00:00.500&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:363;769:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34;&gt;44950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:164;770:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:364;770:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;12&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:9;770:3&#34;&gt;2021.03.12T15:00:00.550&lt;/b&gt;&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:365;770:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;12&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:10;770:33&#34;&gt;1225&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:165;771:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:366;771:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;13&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:11;771:3&#34;&gt;2021.03.12T15:00:00.600&lt;/b&gt;&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:367;771:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;13&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;b:12;771:33&#34;&gt;4950&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:166;772:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:368;772:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;14&#34;&gt;2021.03.12T15:00:00.650&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:369;772:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;14&#34;&gt;9950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:167;773:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:370;773:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;15&#34;&gt;2021.03.12T15:00:00.700&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:371;773:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;15&#34;&gt;14950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:168;774:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:372;774:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;16&#34;&gt;2021.03.12T15:00:00.750&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:373;774:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;16&#34;&gt;19950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:169;775:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:374;775:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;17&#34;&gt;2021.03.12T15:00:00.800&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:375;775:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;17&#34;&gt;24950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:170;776:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:376;776:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;18&#34;&gt;2021.03.12T15:00:00.850&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:377;776:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;18&#34;&gt;29950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:171;777:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:378;777:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;19&#34;&gt;2021.03.12T15:00:00.900&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:379;777:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;19&#34;&gt;34950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:172;778:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:380;778:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;20&#34;&gt;2021.03.12T15:00:00.950&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:381;778:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;20&#34;&gt;39950&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:173;779:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; align=&#34;left&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:382;779:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;21&#34;&gt;2021.03.12T15:00:01.000&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:383;779:32&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;21&#34;&gt;44950&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;2-过滤流数据&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:14;781:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:14;781:1&#34;&gt;2. 过滤流数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:14;781:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:99;783:1&#34;&gt;使用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:8;783:3&#34;&gt;subscribeTable&lt;/codeph&gt;函数时，可利用handler参数过滤订阅的流数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:100;785:1&#34;&gt;在下例中，传感器采集电压和电流数据并实时上传作为流数据源，其中电压voltage&amp;lt;=122或电流current=NULL的数据需要在进入时序引擎之前过滤掉。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:32;787:1&#34;&gt;share streamTable(1000:0, `time`voltage`current, [TIMESTAMP, DOUBLE, DOUBLE]) as electricity outputTable = table(10000:0, `time`avgVoltage`avgCurrent, [TIMESTAMP, DOUBLE, DOUBLE]) //自定义数据处理过程，过滤 voltage&amp;lt;=122 或 current=NULL的无效数据。 def append_after_filtering(inputTable, msg){ t = select * from msg where voltage&amp;gt;122, isValid(current) if(size(t)&amp;gt;0){ insert into inputTable values(t.time,t.voltage,t.current) } } electricityAggregator = createTimeSeriesEngine(name=&#34;electricityAggregator&#34;, windowSize=6, step=3, metrics=&amp;lt;[avg(voltage), avg(current)]&amp;gt;, dummyTable=electricity, outputTable=outputTable, timeColumn=`time, garbageSize=2000) subscribeTable(tableName=&#34;electricity&#34;, actionName=&#34;avgElectricity&#34;, offset=0, handler=append_after_filtering{electricityAggregator}, msgAsTable=true) //模拟产生数据 def writeData(t, n){ timev = 2018.10.08T01:01:01.001 + timestamp(1..n) voltage = 120+1..n * 1.0 current = take([1,NULL,2]*0.1, n) insert into t values(timev, voltage, current); } writeData(electricity, 10)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:101;810:1&#34;&gt;流数据表：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:33;812:1&#34;&gt;select * from electricity&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:17;816:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:17;816:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:39;816:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:40;816:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:41;816:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:17;816:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:174;816:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:384;816:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:385;816:7&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;voltage&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:386;816:16&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;current&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:17;818:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:175;818:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:387;818:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:01:01.002&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:388;818:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;121&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:389;818:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;0.1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:176;819:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:390;819:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:01:01.003&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:391;819:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;122&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:177;820:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:392;820:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34;&gt;2018.10.08T01:01:01.004&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:393;820:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34;&gt;123&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:394;820:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34;&gt;0.2&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:178;821:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:395;821:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34;&gt;2018.10.08T01:01:01.005&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:396;821:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34;&gt;124&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:397;821:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34;&gt;0.1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:179;822:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:398;822:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34;&gt;2018.10.08T01:01:01.006&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:399;822:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34;&gt;125&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:180;823:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:400;823:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34;&gt;2018.10.08T01:01:01.007&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:401;823:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34;&gt;126&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:402;823:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;7&#34;&gt;0.2&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:181;824:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:403;824:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34;&gt;2018.10.08T01:01:01.008&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:404;824:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34;&gt;127&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:405;824:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;8&#34;&gt;0.1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:182;825:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:406;825:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34;&gt;2018.10.08T01:01:01.009&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:407;825:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34;&gt;128&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:183;826:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:408;826:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34;&gt;2018.10.08T01:01:01.010&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:409;826:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34;&gt;129&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:410;826:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;10&#34;&gt;0.2&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:184;827:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:411;827:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34;&gt;2018.10.08T01:01:01.011&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:412;827:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34;&gt;130&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:413;827:31&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;11&#34;&gt;0.1&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:102;829:1&#34;&gt;聚合计算结果：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:34;831:1&#34;&gt;select * from outputTable&lt;/codeblock&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;table:18;835:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tgroup:18;835:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:42;835:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:43;835:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;colspec:44;835:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;thead:18;835:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:185;835:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:414;835:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;time&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:415;835:7&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;avgVoltage&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:416;835:19&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;avgCurrent&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;tbody:18;837:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:186;837:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:417;837:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;2018.10.08T01:01:01.006&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:418;837:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;123.5&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:419;837:33&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;0.15&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;row:187;838:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:420;838:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2018.10.08T01:01:01.009&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:421;838:26&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;125&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;entry:422;838:32&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34;&gt;0.15&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:103;840:1&#34;&gt;由于voltage&amp;lt;=122或current=NULL的数据已经在进入时序引擎时被过滤了，所以第一个窗口[000,003)里没有数据，也就没有发生计算。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;3-多个引擎串联使用&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:15;842:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:15;842:1&#34;&gt;3. 多个引擎串联使用&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:15;842:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:104;844:1&#34;&gt;outputTable参数除了可以是表之外还可以是其他流数据计算引擎：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeblock:35;846:1&#34;&gt;share streamTable(1000:0, `time`sym`price`volume, [TIMESTAMP, SYMBOL, DOUBLE, INT]) as trades share streamTable(1000:0, `time`sym`open`close`high`low`volume, [TIMESTAMP, SYMBOL, DOUBLE, DOUBLE, DOUBLE, DOUBLE, INT]) as kline outputTable=table(1000:0, `sym`factor1, [SYMBOL, DOUBLE]) Rengine=createReactiveStateEngine(name=&#34;reactive&#34;, metrics=&amp;lt;[mavg(open, 3)]&amp;gt;, dummyTable=kline, outputTable=outputTable, keyColumn=&#34;sym&#34;) Tengine=createTimeSeriesEngine(name=&#34;timeseries&#34;, windowSize=6000, step=6000, metrics=&amp;lt;[first(price), last(price), max(price), min(price), sum(volume)]&amp;gt;, dummyTable=trades, outputTable=Rengine, timeColumn=`time, useSystemTime=false, keyColumn=`sym) //时间序列引擎的结果输入响应式状态引擎 subscribeTable(server=&#34;&#34;, tableName=&#34;trades&#34;, actionName=&#34;timeseries&#34;, offset=0, handler=append!{Tengine}, msgAsTable=true) &lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;4-流数据引擎管理函数&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;topic:16;861:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;title:16;861:1&#34;&gt;4. 流数据引擎管理函数&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;body:16;861:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;p:105;863:1&#34;&gt;DolphinDB database提供流数据引擎的管理函数，方便查询和管理系统中已经存在的流数据引擎。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;ul:28;865:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:34;865:1&#34;&gt;获取已定义的流数据引擎清单，可使用函数&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:9;865:22&#34;&gt;getStreamEngineStat (deprecated name: getAggregatorStat)&lt;/codeph&gt;。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:35;866:1&#34;&gt;获取流数据引擎的句柄，可使用函数&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:10;866:19&#34;&gt;getStreamEngine (deprecated name: getAggregator)&lt;/codeph&gt;。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;li:36;867:1&#34;&gt;删除流数据引擎，可使用函数&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/stream_aggregator.md&#34; xtrc=&#34;codeph:11;867:16&#34;&gt;dropStreamEngine (deprecated name: dropAggregator)&lt;/codeph&gt;。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/stream_aggregator.md"/><meta name="wh-out-relpath" content="tutorials/stream_aggregator.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="时序聚合引擎" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                    
                    <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12" id="wh_topic_body">
                        
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">时序聚合引擎</h1><div class="- topic/body body"><p class="- topic/p p">DolphinDB提供了多种轻量且使用方便的流数据引擎。本教程讲述流数据时序引擎。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-创建时序引擎"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. 创建时序引擎</h2><div class="- topic/body body"><p class="- topic/p p">流数据时序引擎由函数<code class="+ topic/ph pr-d/codeph ph codeph">createTimeSeriesEngine</code>创建。该函数返回一个抽象的表对象，为时序引擎入口。向这个抽象表写入数据，就意味着数据进入时序引擎进行计算。</p><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">createTimeSeriesEngine</code>函数必须与<code class="+ topic/ph pr-d/codeph ph codeph">subscribeTable</code>函数配合使用。通过<code class="+ topic/ph pr-d/codeph ph codeph">subscribeTable</code>函数，时序引擎入口订阅一个流数据表。新数据进入流数据表后会被推送到时序引擎入口，按照指定规则进行计算，并将计算结果输出。</p></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title3" id="11-语法"><h3 class="- topic/title title topictitle3" id="ariaid-title3">1.1. 语法</h3><div class="- topic/body body"><p class="- topic/p p">createTimeSeriesEngine(name, windowSize, step, metrics, dummyTable, outputTable, [timeColumn], [useSystemTime=false], [keyColumn], [garbageSize], [updateTime], [useWindowStartTime], [roundTime=true], [snapshotDir], [snapshotIntervalInMsgCount], [fill='none'])</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="12-参数介绍"><h3 class="- topic/title title topictitle3" id="ariaid-title4">1.2. 参数介绍</h3><div class="- topic/body body"><p class="- topic/p p">本节对各参数进行简单介绍。在下一小节中，对部分参数结合实例进行详细介绍。</p><ul class="- topic/ul ul"><li class="- topic/li li">name</li></ul><p class="- topic/p p">类型: 字符串</p><p class="- topic/p p">必选参数，表示时序引擎的名称，是时序引擎在一个数据节点上的唯一标识。可包含字母，数字和下划线，但必须以字母开头。</p><ul class="- topic/ul ul"><li class="- topic/li li">useSystemTime</li></ul><p class="- topic/p p">类型：布尔值</p><p class="- topic/p p">可选参数，表示时序引擎计算的触发方式。</p><p class="- topic/p p">当参数值为true时，引擎会按照数据进入引擎的时刻（毫秒精度的本地系统时间，与数据中的时间列无关），每隔固定时间截取固定长度窗口的流数据进行计算。只要一个数据窗口中含有数据，数据窗口结束后就会自动进行计算。结果中的第一列为计算发生的时间戳，与数据中的时间无关。</p><p class="- topic/p p">当参数值为false（默认值）时，引擎根据流数据中的timeColumn列来截取数据窗口。一个数据窗口结束后的第一条新数据才会触发该数据窗口的计算。请注意，触发计算的数据并不会参与该次计算。</p><p class="- topic/p p">例如，一个数据窗口从10:10:10到10:10:19。若useSystemTime=true，则只要该窗口中至少有一条数据，该窗口的计算会在窗口结束后的10:10:20触发。若useSystemTime=false，且10:10:19后的第一条数据为10:10:25，则该窗口的计算会在10:10:25触发。</p><ul class="- topic/ul ul"><li class="- topic/li li">windowSize</li></ul><p class="- topic/p p">类型：整型或者整型的数组</p><p class="- topic/p p">必选参数，指定数据窗口长度。数据窗口包含左边界，但不包含右边界。</p><ul class="- topic/ul ul"><li class="- topic/li li">step</li></ul><p class="- topic/p p">类型：整型</p><p class="- topic/p p">必选参数，指定窗口每次移动的时间间隔。windowSize必须可被step整除。</p><p class="- topic/p p">windowSize与step的单位取决于useSystemTime参数。若useSystemTime=true，windowSize与step的单位是毫秒。若useSystemTime=false，windowSize与step的单位是timeColumn列的精度。例如，若timeColumn列是timestamp类型，那么windowSize与step的单位是毫秒；如果timeColumn列是datetime类型，那么windowSize与step的单位是秒。</p><p class="- topic/p p">为了方便观察和对比计算结果，系统会对第一个数据窗口的起始时刻进行规整。例如若第一条数据进入引擎的时刻为2018.10.10T03:26:39.178，且step=100，那么系统会将第一个窗口起始时间规整为2018.10.10T03:26:39.100。规整数据窗口的细节在第1.3.1小节中介绍。</p><p class="- topic/p p">当引擎使用分组计算时，所有分组的窗口均进行统一的规整。相同时刻的数据窗口在各组均有相同的边界。</p><ul class="- topic/ul ul"><li class="- topic/li li">metrics</li></ul><p class="- topic/p p">类型：元代码或者元代码的数组</p><p class="- topic/p p">必选参数。引擎的核心参数，以元代码的格式表示计算公式。它可以是一个或多个系统内置或用户自定义的聚合函数，比如&lt;[sum(volume),avg(price)]&gt;；可对聚合结果使用表达式，比如&lt;[avg(price1)-avg(price2)]&gt;；也可对列与列的计算结果进行聚合计算，例如&lt;[std(price1-price2)]&gt;；也可以是一个函数返回多个指标。若自定义函数 func(price)返回两个结果，则可以指定metrics为&lt;[func(price) as ['res1','res2']&gt; 。</p><p class="- topic/p p">如果windowSize为数组，则metrics必须和windowSize大小一致的数组，一一对应计算。比如定义windowSize=[3,6], metrics=[&lt;[sum(volume),avg(price)]&gt;, &lt;std(volume)&gt;], 则sum(volume)和avg(price)按windowSize=3聚合，std(volume)按windowSize=6聚合。</p><p class="- topic/p p">DolphinDB 针对部分内置的聚合函数在流数据时序引擎中的使用进行了优化，最大程度降低了重复计算，显著提高运行速度，详情参照用户手册createTimeSeriesEngine函数。</p><ul class="- topic/ul ul"><li class="- topic/li li">dummyTable</li></ul><p class="- topic/p p">类型：表</p><p class="- topic/p p">必选参数。该表的唯一作用是为引擎提供流数据中每一列的数据类型，可以含有数据，亦可为空表。该表的schema必须与订阅的流数据表相同。</p><ul class="- topic/ul ul"><li class="- topic/li li">outputTable</li></ul><p class="- topic/p p">类型：表</p><p class="- topic/p p">必选参数，为结果的输出表。</p><p class="- topic/p p">在使用<code class="+ topic/ph pr-d/codeph ph codeph">createTimeSeriesEngine</code>函数之前，需要将输出表预先设立为一个空表，并指定各列列名以及数据类型。流数据引擎会将计算结果插入该表。</p><p class="- topic/p p">输出表的schema需要遵循以下规范：</p><p class="- topic/p p">(1) 输出表的第一列必须是时间类型。若useSystemTime=true，为TIMESTAMP类型；若useSystemTime=false，数据类型与timeColumn列一致。</p><p class="- topic/p p">(2) 如果分组列keyColumn参数不为空，那么输出表的第二列必须是分组列。</p><p class="- topic/p p">(3) 最后保存计算结果。</p><p class="- topic/p p">输出表的schema为"时间列，分组列(可选)，结果列1，结果列2..."这样的格式。</p><ul class="- topic/ul ul"><li class="- topic/li li">timeColumn</li></ul><p class="- topic/p p">类型：字符串</p><p class="- topic/p p">可选参数。当useSystemTime=false时，指定订阅的流数据表中时间列的名称。</p><ul class="- topic/ul ul"><li class="- topic/li li">keyColumn</li></ul><p class="- topic/p p">类型：字符串标量</p><p class="- topic/p p">可选参数，表示分组字段名。若设置，则分组进行计算，例如以每支股票为一组进行计算。</p><ul class="- topic/ul ul"><li class="- topic/li li">garbageSize</li></ul><p class="- topic/p p">类型：整型</p><p class="- topic/p p">随着订阅的流数据在时序引擎中不断积累，存放在内存中的数据会越来越多，这时需要清理不再需要的历史数据。当内存中历史数据行数超过garbageSize值时，系统会清理本次计算不需要的历史数据。garbageSize的默认值是50,000。</p><p class="- topic/p p">如果指定了keyColumn，内存清理是各组内独立进行的。当一个组在内存中的历史数据记录数超出garbageSize时，会清理该组中本次计算中不需要的历史数据。</p><ul class="- topic/ul ul"><li class="- topic/li li">updateTime</li></ul><p class="- topic/p p">类型：整型</p><p class="- topic/p p">如果没有指定updateTime，一个数据窗口结束前，不会发生对该数据窗口数据的计算。若要求在当前窗口结束前对当前窗口已有数据进行计算，可指定updateTime。step必须是updateTime的整数倍。要设置updateTime，useSystemTime必须设为false。</p><p class="- topic/p p">如果指定了updateTime，当前窗口内可能会发生多次计算。这些计算触发的规则为：</p><p class="- topic/p p">(1) 将当前窗口分为windowSize/updateTime个小窗口，每个小窗口长度为updateTime。一个小窗口结束后，若有一条新数据到达，且在此之前当前窗口内有未参加计算的的数据，会触发一次计算。请注意，该次计算不包括这条新数据。</p><p class="- topic/p p">(2) 一条数据到达时序引擎之后经过2*updateTime（若2*updateTime不足2秒，则设置为2秒），若其仍未参与计算，会触发一次计算。该次计算包括当时当前窗口内的所有数据。</p><p class="- topic/p p">若分组计算，则每组内进行上述操作。</p><p class="- topic/p p">请注意，当前窗口内每次计算结果的时间戳均为当前数据窗口开始时间或开始时间 + windowSize（由参数useWindowStartTime决定），而非当前窗口内的时刻。</p><p class="- topic/p p">如果指定了updateTime，输出表必须是键值内存表（使用<code class="+ topic/ph pr-d/codeph ph codeph">keyedTable</code>函数创建）：如果没有指定keyColumn，输出表的主键是timeColumn；如果指定了keyColumn，输出表的主键是timeColumn和keyColumn。输出表若使用普通内存表或流数据表，每次计算均会增加一条记录，会产生大量带有相同时间戳的结果。输出表亦不可为键值流数据表，因为键值流数据表不可更新记录。</p><p class="- topic/p p">1.3.6小节使用例子详细介绍了指定updateTime参数后的计算过程。</p><ul class="- topic/ul ul"><li class="- topic/li li">useWindowStartTime</li></ul><p class="- topic/p p">类型：布尔类型</p><p class="- topic/p p">可选参数，表示输出表中的时间是否为数据窗口起始时间。默认值为false，表示输出表中的时间为数据窗口起始时间 + windowSize。如果windowSize为多个窗口大小，则必须为fasle。</p><ul class="- topic/ul ul"><li class="- topic/li li">roundTime</li></ul><p class="- topic/p p">类型：布尔类型</p><p class="- topic/p p">可选参数，是一个布尔值，表示若数据时间精度为毫秒或者秒且step&gt;一分钟，如何对窗口边界值进行规整处理。默认值为true，表示按照既定的多分钟规则进行规整。若为false，则按一分钟规则进行窗口规整。细节请参阅 1.3.1 小节中有关 step 部分的alignmentSize取值规则。</p><ul class="- topic/ul ul"><li class="- topic/li li">snapshotDir</li></ul><p class="- topic/p p">类型：字符串类型</p><p class="- topic/p p">可选参数，表示保存引擎快照的文件目录，可以用于系统出现异常之后，对引擎进行恢复。该目录必须存在，否则系统会提示异常。创建流数据引擎的时候，如果指定了snapshotDir，也会检查相应的快照是否存在。如果存在，会加载该快照，恢复引擎的状态。</p><ul class="- topic/ul ul"><li class="- topic/li li">snapshotIntervalInMsgCount</li></ul><p class="- topic/p p">类型：整型</p><p class="- topic/p p">可选参数，表示保存引擎快照的消息间隔。</p><ul class="- topic/ul ul"><li class="- topic/li li">fill<ul class="- topic/ul ul"><li class="- topic/li li">'none': 不输出结果。</li><li class="- topic/li li">'null': 输出结果为NULL.</li><li class="- topic/li li">'ffill': 输出上一个有数据的窗口的结果。</li><li class="- topic/li li">'具体数值'：该值的数据类型需要和对应的metrics计算结果的类型保持一致。</li></ul></li></ul><p class="- topic/p p">可选参数，是一个标量或向量，表示若（某个key的）某个窗口无数据时，如何处理。可取如上值。</p><p class="- topic/p p">fill可以输入向量，为每个metrics指定不同的fill方式。其中，向量中各项只能是'null', 'ffill'或一个数值，不能是'none'。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="13-参数详细介绍及用例"><h3 class="- topic/title title topictitle3" id="ariaid-title5">1.3. 参数详细介绍及用例</h3><div class="- topic/body body"></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title6" id="131-step"><h4 class="- topic/title title topictitle4" id="ariaid-title6">1.3.1. step</h4><div class="- topic/body body"><p class="- topic/p p">系统按照数据时间精度以及参数step的值确定一个规整尺度alignmentSize，对第一个数据窗口的边界值进行规整处理。</p><p class="- topic/p p">若timeColumn精度为秒，如DATETIME或SECOND类型，alignmentSize取值规则如下表：</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__1">step</th><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__2">alignmentSize</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__1">0~2</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__2">2</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__1">3</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__2">3</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__1">4~5</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__2">5</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__1">6~10</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__2">10</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__1">11~15</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__2">15</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__1">16~20</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__2">20</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__1">21~30</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__2">30</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__1">31~60</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__2">60</td></tr></tbody></table></div><p class="- topic/p p">如果 roundTime = false, 对于step &gt; 60, alignmentSize 都为60。 如果 roundTime = true，则alignmentSize取值规则如下表：</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__19">step</th><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__20">alignmentSize</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__19">61～120</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__20">120（2分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__19">121~180</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__20">180（3分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__19">181~300</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__20">300（5分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__19">301~600</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__20">600（10分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__19">601~900</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__20">900（15分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__19">901~1200</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__20">1200（20分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__19">1201~1800</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__20">1800（30分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__19">&gt;1800</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__20">3600（1小时）</td></tr></tbody></table></div><p class="- topic/p p">若数据时间精度为毫秒，如TIMESTAMP或TIME类型，alignmentSize取值规则如下表：</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__37">step</th><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__38">alignmentSize</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">0~2</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">2</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">3~5</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">5</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">6~10</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">10</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">11~20</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">20</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">21~25</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">25</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">26~50</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">50</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">51~100</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">100</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">101~200</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">200</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">201~250</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">250</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">251~500</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">500</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">501~1000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">1000（1秒）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">1001~2000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">2000（2秒）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">2001~3000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">3000（3秒）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">3001~5000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">5000（5秒）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">5001~10000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">10000（10秒）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">10001~15000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">15000（15秒）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">15001~20000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">20000（20秒）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">20001~30000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">30000（30秒）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__37">30001~60000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__38">60000（1分钟）</td></tr></tbody></table></div><p class="- topic/p p">如果 roundTime = false, 对于step &gt; 60000, alignmentSize 都为60000。 如果 roundTime = true，则alignmentSize取值规则如下表：</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__77">step</th><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__78">alignmentSize</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__77">60001~120000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__78">120000（2分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__77">120001~180000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__78">180000（3分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__77">120001~300000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__78">300000（5分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__77">300001~600000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__78">600000（10分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__77">600001~900000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__78">900000（15分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__77">900001~1200000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__78">1200000（20分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__77">1200001~1800000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__78">1800000（30分钟）</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__77">&gt;= 1800001</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__78">3600000（1小时）</td></tr></tbody></table></div><p class="- topic/p p">DolphinDB系统将各种时间类型数据存储为以最小精度为单位的整形。例如，13:30:10存储为13*60*60+30*60+10=48610。系统将第一个数据窗口的左边界规整为第一条数据时刻之前最后一个可被alignmentSize整除的时刻。</p><p class="- topic/p p">若第一条数据时刻为x，数据类型为TIMESTAMP，那么第一个数据窗口的左边界经过规整后为timestamp(x/alignmentSize*alignmentSize)，其中<code class="+ topic/ph pr-d/codeph ph codeph">/</code>代表相除后取整。例如，若第一条数据的时间为2018.10.08T01:01:01.365，step为60000，那么alignmentSize为60000，第一个数据窗口的左边界为timestamp(2018.10.08T01:01:01.365/60000*60000)，即2018.10.08T01:01:00.000。</p><p class="- topic/p p">下例说明数据窗口如何规整以及流数据时序引擎如何进行计算。以下代码建立流数据表trades，包含time和volume两列。创建时序引擎streamAggr1，每3毫秒对过去6毫秒的数据计算sum(volume)。time列的精度为毫秒，模拟插入的数据流频率也设为每毫秒一条数据。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(1000:0, `time`volume, [TIMESTAMP, INT]) as trades
outputTable = table(10000:0, `time`sumVolume, [TIMESTAMP, INT])
tradesAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;[sum(volume)]&gt;, dummyTable=trades, outputTable=outputTable, timeColumn=`time)
subscribeTable(tableName="trades", actionName="append_tradesAggregator", offset=0, handler=append!{tradesAggregator}, msgAsTable=true)    </code></pre><p class="- topic/p p">向流数据表trades中写入10条数据，并查看流数据表trades内容：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def writeData(t, n){
    timev = 2018.10.08T01:01:01.001 + timestamp(1..n)
    volumev = take(1, n)
    insert into t values(timev, volumev)
}
writeData(trades, 10)

select * from trades;</code></pre><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__95">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__96">volume</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.002</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.003</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.004</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.005</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.006</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.007</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.008</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.009</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.010</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__95">2018.10.08T01:01:01.011</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__96">1</td></tr></tbody></table></div><p class="- topic/p p">再查看结果表outputTable:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select * from outputTable;</code></pre><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__117">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="131-step__entry__118">sumVolume</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__117">2018.10.08T01:01:01.003</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__118">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__117">2018.10.08T01:01:01.006</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__118">4</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__117">2018.10.08T01:01:01.009</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="131-step__entry__118">6</td></tr></tbody></table></div><p class="- topic/p p">根据第一条数据时刻规整第一个窗口的起始时间后，窗口以step为步长移动。下面详细解释时序引擎的计算过程。为简便起见，以下提到时间时，省略相同的2018.10.08T01:01:01部分，只列出毫秒部分。基于第一行数据的时间002，第一个窗口的起始时间规整为000，到002结束，只包含002一条记录，计算被003记录触发，sum(volume)的结果是1；第二个窗口从000到005，包含了四条数据，计算被006记录触发，计算结果为4；第三个窗口从003到008，包含6条数据，计算被009记录触发，计算结果为6。虽然第四个窗口从006到011且含有6条数据，但是由于该窗口结束之后没有数据，所以该窗口的计算没有被触发。</p><p class="- topic/p p">若需要重复执行以上程序，应首先解除订阅，并将流数据表trades与时序引擎streamAggr1二者删除：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>unsubscribeTable(tableName="trades", actionName="append_tradesAggregator")
undef(`trades, SHARED)
dropStreamEngine("streamAggr1")</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title7" id="132-windowsize"><h4 class="- topic/title title topictitle4" id="ariaid-title7">1.3.2. windowSize</h4><div class="- topic/body body"><p class="- topic/p p">DolphinDB时序引擎支持多个窗口。</p><p class="- topic/p p">下例说如何对相同的metrics按不同的windowSize聚合。以下代码建立流数据表trades，包含time和volume两列。创建时序引擎streamAggr1，每3毫秒对过去6毫秒和过去12毫秒的数据计算sum(volume)。time列的精度为毫秒，模拟插入的数据流频率也设为每毫秒一条数据。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(1000:0, `time`volume, [TIMESTAMP, INT]) as trades
outputTable = table(10000:0, `time`sumVolume1`sumVolume2, [TIMESTAMP, INT,INT])
tradesAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=[6,12], step=3, metrics=[&lt;sum(volume)&gt;,&lt;sum(volume)&gt;], dummyTable=trades, outputTable=outputTable, timeColumn=`time)
subscribeTable(tableName="trades", actionName="append_tradesAggregator", offset=0, handler=append!{tradesAggregator}, msgAsTable=true)    </code></pre><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def writeData(t, n){
    timev = 2018.10.08T01:01:01.001 + timestamp(1..n)
    volumev = take(1, n)
    insert into t values(timev, volumev)
}
writeData(trades, 20)

select * from trades;</code></pre><p class="- topic/p p">再查看结果表outputTable:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select * from outputTable;</code></pre><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="132-windowsize__entry__1">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="132-windowsize__entry__2">sumVolume1</th><th class="- topic/entry entry colsep-0 rowsep-0" id="132-windowsize__entry__3">sumVolume2</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__1">2018.10.08T01:01:01.003</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__2">1</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__3">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__1">2018.10.08T01:01:01.006</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__2">4</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__3">4</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__1">2018.10.08T01:01:01.009</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__2">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__3">7</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__1">2018.10.08T01:01:01.012</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__2">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__3">10</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__1">2018.10.08T01:01:01.015</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__2">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__3">12</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__1">2018.10.08T01:01:01.018</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__2">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__3">12</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__1">2018.10.08T01:01:01.021</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__2">6</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="132-windowsize__entry__3">12</td></tr></tbody></table></div></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title8" id="133-metrics"><h4 class="- topic/title title topictitle4" id="ariaid-title8">1.3.3. metrics</h4><div class="- topic/body body"><p class="- topic/p p">DolphinDB 时序引擎支持使用多种表达式进行实时计算。</p><ul class="- topic/ul ul"><li class="- topic/li li">一个或多个聚合函数</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>tsAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;sum(ask)&gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">使用聚合结果进行计算</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>tsAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;max(ask)-min(ask)&gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">对列与列的操作结果进行聚合计算</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>tsAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;max(ask-bid)&gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">输出多个聚合结果</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>tsAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;[max((ask-bid)/(ask+bid)*2), min((ask-bid)/(ask+bid)*2)]&gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">使用多参数聚合函数</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>tsAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;corr(ask,bid)&gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)

tsAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;percentile(ask-bid,99)/sum(ask)&gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">使用自定义函数</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>defg diff(x,y){
	return sum(x)-sum(y)
}
tsAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;diff(ask, bid)&gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">使用多个返回结果的函数</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>defg sums(x){
	return [sum(x),sum2(x)]
}
tsAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=6, step=3, metrics=&lt;sums(ask) as `sumAsk`sum2Ask&gt;, dummyTable=quotes, outputTable=outputTable, timeColumn=`time)
</code></pre><p class="- topic/p p">注意：不支持聚合函数嵌套调用，例如sum(spread(ask,bid))。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title9" id="134-dummytable"><h4 class="- topic/title title topictitle4" id="ariaid-title9">1.3.4. dummyTable</h4><div class="- topic/body body"><p class="- topic/p p">系统利用dummyTable的schema来决定订阅的流数据中每一列的数据类型。dummyTable有无数据对结果没有任何影响。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(1000:0, `time`volume, [TIMESTAMP, INT]) as trades
modelTable = table(1000:0, `time`volume, [TIMESTAMP, INT])
outputTable = table(10000:0, `time`sumVolume, [TIMESTAMP, INT])
tradesAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=5, step=5, metrics=&lt;[sum(volume)]&gt;, dummyTable=modelTable, outputTable=outputTable, timeColumn=`time)
subscribeTable(tableName="trades", actionName="append_tradesAggregator", offset=0, handler=append!{tradesAggregator}, msgAsTable=true)    

def writeData(t,n){
    timev = 2018.10.08T01:01:01.001 + timestamp(1..n)
    volumev = take(1, n)
    insert into t values(timev, volumev)
}

writeData(trades, 6)

sleep(1)
select * from outputTable</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title10" id="135-outputtable"><h4 class="- topic/title title topictitle4" id="ariaid-title10">1.3.5. outputTable</h4><div class="- topic/body body"><p class="- topic/p p">计算结果可以输出到内存表或流数据表。输出到内存表的数据可以更新或删除，而输出到流数据表的数据无法更新或删除，但是可以通过流数据表将结果作为另一个引擎的数据源再次发布。</p><p class="- topic/p p">下例中，时序引擎electricityAggregator1订阅流数据表electricity，进行移动均值计算，并将结果输出到流数据表outputTable1。时序引擎electricityAggregator2订阅outputTable1表，并对移动均值计算结果求移动峰值。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(1000:0,`time`voltage`current,[TIMESTAMP,DOUBLE,DOUBLE]) as electricity

//将第一个时序引擎的输出表定义为流数据表，可以再次订阅
share streamTable(10000:0,`time`avgVoltage`avgCurrent,[TIMESTAMP,DOUBLE,DOUBLE]) as outputTable1 

electricityAggregator1 = createTimeSeriesEngine(name="electricityAggregator1", windowSize=10, step=10, metrics=&lt;[avg(voltage), avg(current)]&gt;, dummyTable=electricity, outputTable=outputTable1, timeColumn=`time, garbageSize=2000)
subscribeTable(tableName="electricity", actionName="avgElectricity", offset=0, handler=append!{electricityAggregator1}, msgAsTable=true)

//订阅计算结果，再次进行聚合计算
outputTable2 =table(10000:0, `time`maxVoltage`maxCurrent, [TIMESTAMP,DOUBLE,DOUBLE])
electricityAggregator2 = createTimeSeriesEngine(name="electricityAggregator2", windowSize=100, step=100, metrics=&lt;[max(avgVoltage), max(avgCurrent)]&gt;, dummyTable=outputTable1, outputTable=outputTable2, timeColumn=`time, garbageSize=2000)
subscribeTable(tableName="outputTable1", actionName="maxElectricity", offset=0, handler=append!{electricityAggregator2}, msgAsTable=true);

//向electricity表中插入500条数据
def writeData(t, n){
        timev = 2018.10.08T01:01:01.000 + timestamp(1..n)
        voltage = 1..n * 0.1
        current = 1..n * 0.05
        insert into t values(timev, voltage, current)
}
writeData(electricity, 500);</code></pre><p class="- topic/p p">聚合计算结果:</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select * from outputTable2;</code></pre><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="135-outputtable__entry__1">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="135-outputtable__entry__2">maxVoltage</th><th class="- topic/entry entry colsep-0 rowsep-0" id="135-outputtable__entry__3">maxCurrent</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__1">2018.10.08T01:01:01.100</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__2">8.45</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__3">4.225</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__1">2018.10.08T01:01:01.200</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__2">18.45</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__3">9.225</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__1">2018.10.08T01:01:01.300</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__2">28.45</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__3">14.225</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__1">2018.10.08T01:01:01.400</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__2">38.45</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__3">19.225</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__1">2018.10.08T01:01:01.500</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__2">48.45</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="135-outputtable__entry__3">24.225</td></tr></tbody></table></div><p class="- topic/p p">若要对上述脚本进行重复使用，需先执行以下脚本以清除共享表、订阅以及流数据引擎：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>unsubscribeTable(tableName="electricity", actionName="avgElectricity")
undef(`electricity, SHARED)
unsubscribeTable(tableName="outputTable1", actionName="maxElectricity")
undef(`outputTable1, SHARED)
dropStreamEngine("electricityAggregator1")
dropStreamEngine("electricityAggregator2")</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title11" id="136-keycolumn"><h4 class="- topic/title title topictitle4" id="ariaid-title11">1.3.6. keyColumn</h4><div class="- topic/body body"><p class="- topic/p p">下例中，设定keyColumn参数为sym。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(1000:0, `time`sym`volume, [TIMESTAMP, SYMBOL, INT]) as trades
outputTable = table(10000:0, `time`sym`sumVolume, [TIMESTAMP, SYMBOL, INT])
tradesAggregator = createTimeSeriesEngine(name="streamAggr1", windowSize=3, step=3, metrics=&lt;[sum(volume)]&gt;, dummyTable=trades, outputTable=outputTable, timeColumn=`time, useSystemTime=false, keyColumn=`sym, garbageSize=50)
subscribeTable(tableName="trades", actionName="append_tradesAggregator", offset=0, handler=append!{tradesAggregator}, msgAsTable=true)    

def writeData(t, n){
    timev = 2018.10.08T01:01:01.001 + timestamp(1..n)
    symv =take(`A`B, n)
    volumev = take(1, n)
    insert into t values(timev, symv, volumev)
}

writeData(trades, 6)</code></pre><p class="- topic/p p">为了方便观察，对"trades"表的sym列排序输出：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select * from trades order by sym;</code></pre><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="136-keycolumn__entry__1">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="136-keycolumn__entry__2">sym</th><th class="- topic/entry entry colsep-0 rowsep-0" id="136-keycolumn__entry__3">volume</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__1">2018.10.08T01:01:01.002</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__2">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__3">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__1">2018.10.08T01:01:01.004</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__2">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__3">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__1">2018.10.08T01:01:01.006</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__2">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__3">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__1">2018.10.08T01:01:01.003</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__2">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__3">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__1">2018.10.08T01:01:01.005</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__2">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__3">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__1">2018.10.08T01:01:01.007</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__2">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__3">1</td></tr></tbody></table></div><p class="- topic/p p">分组计算结果：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select * from outputTable; </code></pre><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="136-keycolumn__entry__22">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="136-keycolumn__entry__23">sym</th><th class="- topic/entry entry colsep-0 rowsep-0" id="136-keycolumn__entry__24">sumVolume</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__22">2018.10.08T01:01:01.003</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__23">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__24">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__22">2018.10.08T01:01:01.006</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__23">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__24">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__22">2018.10.08T01:01:01.006</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__23">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="136-keycolumn__entry__24">2</td></tr></tbody></table></div><p class="- topic/p p">各组窗口规整后统一从000时间点开始，根据windowSize=3以及step=3，每个组的窗口会按照000-003-006划分。</p><ul class="- topic/ul ul"><li class="- topic/li li">(1) 在003，B组有一条数据，但是由于B组在第一个窗口没有任何数据，不会进行计算也不会产生结果，所以B组第一个窗口没有结果输出。</li><li class="- topic/li li">(2) 004的A组数据触发A组第一个窗口的计算。</li><li class="- topic/li li">(3) 006的A组数据触发A组第二个窗口的计算。</li><li class="- topic/li li">(4) 007的B组数据触发B组第二个窗口的计算。</li></ul><p class="- topic/p p">如果进行分组聚合计算，流数据源中的每个分组中的'timeColumn'必须是递增的，但是整个数据源的'timeColumn'可以不是递增的；如果没有进行分组聚合，那么整个数据源的'timeColumn'必须是递增的，否则时序引擎的输出结果会与预期不符。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title12" id="137-updatetime"><h4 class="- topic/title title topictitle4" id="ariaid-title12">1.3.7. updateTime</h4><div class="- topic/body body"><p class="- topic/p p">通过以下两个例子，可以理解updateTime的作用。</p><p class="- topic/p p">首先创建流数据表并写入数据：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(1000:0, `time`sym`volume, [TIMESTAMP, SYMBOL, INT]) as trades
insert into trades values(2018.10.08T01:01:01.785,`A,10)
insert into trades values(2018.10.08T01:01:02.125,`B,26)
insert into trades values(2018.10.08T01:01:10.263,`B,14)
insert into trades values(2018.10.08T01:01:12.457,`A,28)
insert into trades values(2018.10.08T01:02:10.789,`A,15)
insert into trades values(2018.10.08T01:02:12.005,`B,9)
insert into trades values(2018.10.08T01:02:30.021,`A,10)
insert into trades values(2018.10.08T01:04:02.236,`A,29)
insert into trades values(2018.10.08T01:04:04.412,`B,32)
insert into trades values(2018.10.08T01:04:05.152,`B,23);</code></pre><ul class="- topic/ul ul"><li class="- topic/li li">不指定updateTime：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>output1 = table(10000:0, `time`sym`sumVolume, [TIMESTAMP, SYMBOL, INT])
agg1 = createTimeSeriesEngine(name="agg1", windowSize=60000, step=60000, metrics=&lt;[sum(volume)]&gt;, dummyTable=trades, outputTable=output1, timeColumn=`time, useSystemTime=false, keyColumn=`sym, garbageSize=50, useWindowStartTime=false)
subscribeTable(tableName="trades", actionName="agg1", offset=0, handler=append!{agg1}, msgAsTable=true)

sleep(10)

select * from output1;</code></pre><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="137-updatetime__entry__1">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="137-updatetime__entry__2">sym</th><th class="- topic/entry entry colsep-0 rowsep-0" id="137-updatetime__entry__3">sumVolume</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__1">2018.10.08T01:02:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__2">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__3">38</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__1">2018.10.08T01:03:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__2">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__3">25</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__1">2018.10.08T01:02:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__2">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__3">40</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__1">2018.10.08T01:03:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__2">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__3">9</td></tr></tbody></table></div><ul class="- topic/ul ul"><li class="- topic/li li">将updateTime设为1000：</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>output2 = keyedTable(`time`sym,10000:0, `time`sym`sumVolume, [TIMESTAMP, SYMBOL, INT])
agg2 = createTimeSeriesEngine(name="agg2", windowSize=60000, step=60000, metrics=&lt;[sum(volume)]&gt;, dummyTable=trades, outputTable=output2, timeColumn=`time, useSystemTime=false, keyColumn=`sym, garbageSize=50, updateTime=1000, useWindowStartTime=false)
subscribeTable(tableName="trades", actionName="agg2", offset=0, handler=append!{agg2}, msgAsTable=true)

sleep(2010)

select * from output2;</code></pre><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="137-updatetime__entry__16">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="137-updatetime__entry__17">sym</th><th class="- topic/entry entry colsep-0 rowsep-0" id="137-updatetime__entry__18">sumVolume</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__16">2018.10.08T01:02:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__17">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__18">38</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__16">2018.10.08T01:03:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__17">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__18">25</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__16">2018.10.08T01:02:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__17">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__18">40</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__16">2018.10.08T01:03:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__17">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__18">9</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__16">2018.10.08T01:05:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__17">B</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__18">55</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__16">2018.10.08T01:05:00.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__17">A</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="137-updatetime__entry__18">29</td></tr></tbody></table></div><p class="- topic/p p">下面我们介绍以上两个例子在最后一个数据窗口（01:04:00.000到01:05:00.000）的区别。为简便起见，我们省略日期部分，只列出（小时:分钟:秒.毫秒）部分。假设time列时间亦为数据进入时序引擎的时刻。</p><p class="- topic/p p">(1) 在01:04:04.236时，A分组的第一条记录到达后已经过2000毫秒，触发一次A组计算，输出表增加一条记录(01:05:00.000, `A, 29)。</p><p class="- topic/p p">(2) 在01:04:05.152时的B组记录为01:04:04.412所在小窗口[01:04:04.000, 01:04:05.000)之后第一条记录，触发一次B组计算，输出表增加一条记录(01:05:00.000,"B",32)。</p><p class="- topic/p p">(3) 2000毫秒后，在01:04:07.152时，由于01:04:05.152时的B组记录仍未参与计算，触发一次B组计算，输出一条记录(01:05:00.000,"B",55)。由于输出表的主键为time和sym，并且输出表中已有(01:05:00.000,"B",32)这条记录，因此将该记录更新为(01:05:00.000,"B",55)。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title13" id="138-snapshot"><h4 class="- topic/title title topictitle4" id="ariaid-title13">1.3.8. snapshot</h4><div class="- topic/body body"><p class="- topic/p p">通过以下这个例子，可以理解snapshotDir和snapshotIntervalInMsgCount的作用。如果启用snapshot，引擎订阅流数据表时，handler需是appendMsg函数，需指定handlerNeedMsgId=true，用来记录快照的消息位置。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(10000:0,`time`sym`price`id, [TIMESTAMP,SYMBOL,INT,INT]) as trades
output1 =table(10000:0, `time`sumprice, [TIMESTAMP,INT]);
Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&lt;sum(price)&gt;, dummyTable=trades, outputTable=output1, timeColumn=`time, snapshotDir="/home/server1/snapshotDir", snapshotIntervalInMsgCount=100)
subscribeTable(server="", tableName="trades", actionName="Agg1",offset= 0, handler=appendMsg{Agg1}, msgAsTable=true, handlerNeedMsgId=true)

n=500
timev=timestamp(1..n) + 2021.03.12T15:00:00.000
symv = take(`abc`def, n)
pricev = int(1..n)
id = take(-1, n)
insert into trades values(timev, symv, pricev, id)

select * from output1</code></pre><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="138-snapshot__entry__1">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="138-snapshot__entry__2">sumprice</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.050</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">1225</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.100</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">4950</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.150</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">9950</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.200</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">14950</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.250</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">19950</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.300</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">24950</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.350</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">29950</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.400</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">34950</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.450</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">39950</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__1">2021.03.12T15:00:00.500</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__2">44950</td></tr></tbody></table></div><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>getSnapshotMsgId(Agg1)
&gt;499</code></pre><p class="- topic/p p">取消订阅并删除引擎来模拟系统异常</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>unsubscribeTable(, "trades", "Agg1")
dropStreamEngine("Agg1")
Agg1=NULL</code></pre><p class="- topic/p p">此时发布端仍在写入数据</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>n=500
timev=timestamp(501..1000) + 2021.03.12T15:00:00.000
symv = take(`abc`def, n)
pricev = int(1..n)
id = take(-1, n)
insert into trades values(timev, symv, pricev, id)</code></pre><p class="- topic/p p">再次创建aggr, 加载snapshot，从上次处理最后一条消息开始重新订阅</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&lt;sum(price)&gt;, dummyTable=trades, outputTable=output1, timeColumn=`time, snapshotDir="/home/server1/snapshotDir", snapshotIntervalInMsgCount=100)

ofst=getSnapshotMsgId(Agg1)
print(ofst)
&gt;499

subscribeTable(server="", tableName="trades", actionName="Agg1",offset=ofst+1, handler=appendMsg{Agg1}, msgAsTable=true, handlerNeedMsgId=true)

select * from output1</code></pre><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="138-snapshot__entry__23">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="138-snapshot__entry__24">sumprice</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.050</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">1225</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.100</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">4950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.150</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">9950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.200</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">14950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.250</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">19950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.300</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">24950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.350</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">29950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.400</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">34950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.450</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">39950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.500</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">44950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23"><strong class="+ topic/ph hi-d/b ph b">2021.03.12T15:00:00.550</strong></td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24"><strong class="+ topic/ph hi-d/b ph b">25450</strong></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23"><strong class="+ topic/ph hi-d/b ph b">2021.03.12T15:00:00.600</strong></td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24"><strong class="+ topic/ph hi-d/b ph b">5450</strong></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.650</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">9950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.700</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">14950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.750</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">19950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.800</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">24950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.850</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">29950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.900</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">34950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:00.950</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">39950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__23">2021.03.12T15:00:01.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__24">44950</td></tr></tbody></table></div><p class="- topic/p p">结果和订阅不中断一样。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(10000:0,`time`sym`price`id, [TIMESTAMP,SYMBOL,INT,INT]) as trades
output1 =table(10000:0, `time`sumprice, [TIMESTAMP,INT]);
Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&lt;sum(price)&gt;, dummyTable=trades, outputTable=output1, timeColumn=`time)
subscribeTable(server="", tableName="trades", actionName="Agg1",offset= 0, handler=append!{Agg1}, msgAsTable=true)

n=500
timev=timestamp(1..n) + 2021.03.12T15:00:00.000
symv = take(`abc`def, n)
pricev = int(1..n)
id = take(-1, n)
insert into trades values(timev, symv, pricev, id)

n=500
timev=timestamp(501..1000) + 2021.03.12T15:00:00.000
symv = take(`abc`def, n)
pricev = int(1..n)
id = take(-1, n)
insert into trades values(timev, symv, pricev, id)

select * from output1</code></pre><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="138-snapshot__entry__65">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="138-snapshot__entry__66">sumprice</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.050</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">1225</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.100</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">4950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.150</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">9950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.200</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">14950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.250</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">19950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.300</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">24950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.350</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">29950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.400</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">34950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.450</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">39950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.500</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">44950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65"><strong class="+ topic/ph hi-d/b ph b">2021.03.12T15:00:00.550</strong></td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66"><strong class="+ topic/ph hi-d/b ph b">25450</strong></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65"><strong class="+ topic/ph hi-d/b ph b">2021.03.12T15:00:00.600</strong></td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66"><strong class="+ topic/ph hi-d/b ph b">5450</strong></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.650</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">9950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.700</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">14950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.750</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">19950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.800</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">24950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.850</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">29950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.900</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">34950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:00.950</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">39950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__65">2021.03.12T15:00:01.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__66">44950</td></tr></tbody></table></div><p class="- topic/p p">如果不开启snapshot，即使从上次中断的地方开始订阅，得到的结果也与订阅不中断不一样。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(10000:0,`time`sym`price`id, [TIMESTAMP,SYMBOL,INT,INT]) as trades
output1 =table(10000:0, `time`sumprice, [TIMESTAMP,INT]);
Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&lt;sum(price)&gt;, dummyTable=trades, outputTable=output1, timeColumn=`time)
subscribeTable(server="", tableName="trades", actionName="Agg1",offset= 0, handler=append!{Agg1}, msgAsTable=true)

n=500
timev=timestamp(1..n) + 2021.03.12T15:00:00.000
symv = take(`abc`def, n)
pricev = int(1..n)
id = take(-1, n)
insert into trades values(timev, symv, pricev, id)

unsubscribeTable(, "trades", "Agg1")
dropStreamEngine("Agg1")
Agg1=NULL

n=500
timev=timestamp(501..1000) + 2021.03.12T15:00:00.000
symv = take(`abc`def, n)
pricev = int(1..n)
id = take(-1, n)
insert into trades values(timev, symv, pricev, id)

Agg1 = createTimeSeriesEngine(name=`Agg1, windowSize=100, step=50, metrics=&lt;sum(price)&gt;, dummyTable=trades, outputTable=output1, timeColumn=`time)
subscribeTable(server="", tableName="trades", actionName="Agg1",offset= 500, handler=append!{Agg1}, msgAsTable=true)

select * from output1</code></pre><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="138-snapshot__entry__107">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="138-snapshot__entry__108">sumprice</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.050</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">1225</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.100</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">4950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.150</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">9950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.200</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">14950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.250</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">19950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.300</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">24950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.350</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">29950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.400</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">34950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.450</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">39950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.500</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">44950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107"><strong class="+ topic/ph hi-d/b ph b">2021.03.12T15:00:00.550</strong></td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108"><strong class="+ topic/ph hi-d/b ph b">1225</strong></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107"><strong class="+ topic/ph hi-d/b ph b">2021.03.12T15:00:00.600</strong></td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108"><strong class="+ topic/ph hi-d/b ph b">4950</strong></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.650</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">9950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.700</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">14950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.750</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">19950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.800</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">24950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.850</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">29950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.900</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">34950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:00.950</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">39950</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="138-snapshot__entry__107">2021.03.12T15:00:01.000</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="138-snapshot__entry__108">44950</td></tr></tbody></table></div></div></article></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title14" id="2-过滤流数据"><h2 class="- topic/title title topictitle2" id="ariaid-title14">2. 过滤流数据</h2><div class="- topic/body body"><p class="- topic/p p">使用<code class="+ topic/ph pr-d/codeph ph codeph">subscribeTable</code>函数时，可利用handler参数过滤订阅的流数据。</p><p class="- topic/p p">在下例中，传感器采集电压和电流数据并实时上传作为流数据源，其中电压voltage&lt;=122或电流current=NULL的数据需要在进入时序引擎之前过滤掉。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(1000:0, `time`voltage`current, [TIMESTAMP, DOUBLE, DOUBLE]) as electricity
outputTable = table(10000:0, `time`avgVoltage`avgCurrent, [TIMESTAMP, DOUBLE, DOUBLE])

//自定义数据处理过程，过滤 voltage&lt;=122 或 current=NULL的无效数据。
def append_after_filtering(inputTable, msg){
	t = select * from msg where voltage&gt;122, isValid(current)
	if(size(t)&gt;0){
		insert into inputTable values(t.time,t.voltage,t.current)		
	}
}
electricityAggregator = createTimeSeriesEngine(name="electricityAggregator", windowSize=6, step=3, metrics=&lt;[avg(voltage), avg(current)]&gt;, dummyTable=electricity, outputTable=outputTable, timeColumn=`time, garbageSize=2000)
subscribeTable(tableName="electricity", actionName="avgElectricity", offset=0, handler=append_after_filtering{electricityAggregator}, msgAsTable=true)

//模拟产生数据
def writeData(t, n){
        timev = 2018.10.08T01:01:01.001 + timestamp(1..n)
        voltage = 120+1..n * 1.0
        current = take([1,NULL,2]*0.1, n)
        insert into t values(timev, voltage, current);
}
writeData(electricity, 10)</code></pre><p class="- topic/p p">流数据表：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select * from electricity</code></pre><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="2-过滤流数据__entry__1">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="2-过滤流数据__entry__2">voltage</th><th class="- topic/entry entry colsep-0 rowsep-0" id="2-过滤流数据__entry__3">current</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.002</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">121</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__3">0.1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.003</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">122</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.004</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">123</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__3">0.2</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.005</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">124</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__3">0.1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.006</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">125</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.007</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">126</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__3">0.2</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.008</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">127</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__3">0.1</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.009</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">128</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.010</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">129</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__3">0.2</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__1">2018.10.08T01:01:01.011</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__2">130</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__3">0.1</td></tr></tbody></table></div><p class="- topic/p p">聚合计算结果：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select * from outputTable</code></pre><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="2-过滤流数据__entry__31">time</th><th class="- topic/entry entry colsep-0 rowsep-0" id="2-过滤流数据__entry__32">avgVoltage</th><th class="- topic/entry entry colsep-0 rowsep-0" id="2-过滤流数据__entry__33">avgCurrent</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__31">2018.10.08T01:01:01.006</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__32">123.5</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__33">0.15</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__31">2018.10.08T01:01:01.009</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__32">125</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="2-过滤流数据__entry__33">0.15</td></tr></tbody></table></div><p class="- topic/p p">由于voltage&lt;=122或current=NULL的数据已经在进入时序引擎时被过滤了，所以第一个窗口[000,003)里没有数据，也就没有发生计算。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title15" id="3-多个引擎串联使用"><h2 class="- topic/title title topictitle2" id="ariaid-title15">3. 多个引擎串联使用</h2><div class="- topic/body body"><p class="- topic/p p">outputTable参数除了可以是表之外还可以是其他流数据计算引擎：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(1000:0, `time`sym`price`volume, [TIMESTAMP, SYMBOL, DOUBLE, INT]) as trades

share streamTable(1000:0, `time`sym`open`close`high`low`volume, [TIMESTAMP, SYMBOL, DOUBLE, DOUBLE, DOUBLE, DOUBLE, INT]) as kline

outputTable=table(1000:0, `sym`factor1, [SYMBOL, DOUBLE])

Rengine=createReactiveStateEngine(name="reactive", metrics=&lt;[mavg(open, 3)]&gt;, dummyTable=kline, outputTable=outputTable, keyColumn="sym")

Tengine=createTimeSeriesEngine(name="timeseries", windowSize=6000, step=6000, metrics=&lt;[first(price), last(price), max(price), min(price), sum(volume)]&gt;, dummyTable=trades, outputTable=Rengine, timeColumn=`time, useSystemTime=false, keyColumn=`sym)
//时间序列引擎的结果输入响应式状态引擎

subscribeTable(server="", tableName="trades", actionName="timeseries", offset=0, handler=append!{Tengine}, msgAsTable=true)   </code></pre></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title16" id="4-流数据引擎管理函数"><h2 class="- topic/title title topictitle2" id="ariaid-title16">4. 流数据引擎管理函数</h2><div class="- topic/body body"><p class="- topic/p p">DolphinDB database提供流数据引擎的管理函数，方便查询和管理系统中已经存在的流数据引擎。</p><ul class="- topic/ul ul"><li class="- topic/li li">获取已定义的流数据引擎清单，可使用函数<code class="+ topic/ph pr-d/codeph ph codeph">getStreamEngineStat (deprecated name: getAggregatorStat)</code>。</li><li class="- topic/li li">获取流数据引擎的句柄，可使用函数<code class="+ topic/ph pr-d/codeph ph codeph">getStreamEngine (deprecated name: getAggregator)</code>。</li><li class="- topic/li li">删除流数据引擎，可使用函数<code class="+ topic/ph pr-d/codeph ph codeph">dropStreamEngine (deprecated name: dropAggregator)</code>。</li></ul></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E5%88%9B%E5%BB%BA%E6%97%B6%E5%BA%8F%E5%BC%95%E6%93%8E" data-tocid="1-创建时序引擎">1. 创建时序引擎</a><ul><li class="topic-item"><a href="#11-%E8%AF%AD%E6%B3%95" data-tocid="11-语法">1.1. 语法</a></li><li class="topic-item"><a href="#12-%E5%8F%82%E6%95%B0%E4%BB%8B%E7%BB%8D" data-tocid="12-参数介绍">1.2. 参数介绍</a></li><li class="topic-item"><a href="#13-%E5%8F%82%E6%95%B0%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%8F%8A%E7%94%A8%E4%BE%8B" data-tocid="13-参数详细介绍及用例">1.3. 参数详细介绍及用例</a><ul><li class="topic-item"><a href="#131-step" data-tocid="131-step">1.3.1. step</a></li><li class="topic-item"><a href="#132-windowsize" data-tocid="132-windowsize">1.3.2. windowSize</a></li><li class="topic-item"><a href="#133-metrics" data-tocid="133-metrics">1.3.3. metrics</a></li><li class="topic-item"><a href="#134-dummytable" data-tocid="134-dummytable">1.3.4. dummyTable</a></li><li class="topic-item"><a href="#135-outputtable" data-tocid="135-outputtable">1.3.5. outputTable</a></li><li class="topic-item"><a href="#136-keycolumn" data-tocid="136-keycolumn">1.3.6. keyColumn</a></li><li class="topic-item"><a href="#137-updatetime" data-tocid="137-updatetime">1.3.7. updateTime</a></li><li class="topic-item"><a href="#138-snapshot" data-tocid="138-snapshot">1.3.8. snapshot</a></li></ul></li></ul></li><li class="topic-item"><a href="#2-%E8%BF%87%E6%BB%A4%E6%B5%81%E6%95%B0%E6%8D%AE" data-tocid="2-过滤流数据">2. 过滤流数据</a></li><li class="topic-item"><a href="#3-%E5%A4%9A%E4%B8%AA%E5%BC%95%E6%93%8E%E4%B8%B2%E8%81%94%E4%BD%BF%E7%94%A8" data-tocid="3-多个引擎串联使用">3. 多个引擎串联使用</a></li><li class="topic-item"><a href="#4-%E6%B5%81%E6%95%B0%E6%8D%AE%E5%BC%95%E6%93%8E%E7%AE%A1%E7%90%86%E5%87%BD%E6%95%B0" data-tocid="4-流数据引擎管理函数">4. 流数据引擎管理函数</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>