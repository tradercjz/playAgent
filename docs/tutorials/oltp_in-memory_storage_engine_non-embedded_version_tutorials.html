<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="在一些数据库应用场景中，例如金融行业的交易系统，其主要工作负载来源于对关系表的高频度、高并发的更新和查询操作。这样的应用场景要求数据的读写和计算能够具有低延迟、高并发的特征，同时保证极高的数据一致性，并提供 ACID ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="oltp-内存存储引擎非嵌入式版使用教程"/><title>OLTP 内存存储引擎（非嵌入式版）使用教程</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;oltp-内存存储引擎非嵌入式版使用教程&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;OLTP 内存存储引擎（非嵌入式版）使用教程&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;/&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:6;21:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-背景&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;1. 背景&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;在一些数据库应用场景中，例如金融行业的交易系统，其主要工作负载来源于对关系表的高频度、高并发的更新和查询操作。这样的应用场景要求数据的读写和计算能够具有低延迟、高并发的特征，同时保证极高的数据一致性，并提供 ACID 事务的支持，是典型的在线事务处理（OLTP）场景。传统的存储引擎由于其架构的设计出发点是将数据存储在磁盘上，在面对上述场景要求时，软硬件层面面临巨大挑战，无法很好地满足上述苛刻的性能要求。而在这些场景中，往往需要维护的数据量实际上没有那么大，那么，能否把所有的数据都维护在内存里呢？这样就可以减少读写磁盘的带宽，能够大大降低数据库的延迟和提升数据库的并发度。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;基于这个想法，DolphinDB 设计并实现了一款纯自研的内存 OLTP 数据库，它有以下特点：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;将所有数据都存储在内存中，省去磁盘 I/O 的开销；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;以行存的形式来组织数据，主要适用于 OLTP 的场景；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;11:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;支持创建 B+ 树索引 (主键索引和二级索引) 来应对高频度、高并发的更新和查询操作；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;支持事务，默认为 snapshot isolation；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;实现 Write-Ahead-Logging 和 checkpoint 机制以保证数据的持久化和恢复；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;14:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;为加速重启时的恢复过程，实现了并行恢复机制。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;下文将介绍 OLTP 的使用方式。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;18:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;note class=&#34;- topic/note &#34; xtrc=&#34;note:1;18:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;需要在配置文件里加上 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;18:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;enableIMOLTPEngine=true&lt;/codeph&gt; 来开启 OLTP 引擎。&lt;/note&gt;&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-ddl&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;22:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;22:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;2. DDL&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;22:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;21-建库&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;24:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;24:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;2.1 建库&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;24:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;26:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;使用 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/d/database.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:1;26:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;?ditaot usertext?&gt;database&lt;/xref&gt; 函数来创建 OLTP 数据库，语法与创建 OLAP/TSDB 数据库一样，但是有以下注意事项：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:1;28:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;directory&lt;/i&gt; 必须以 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;28:19&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;oltp://&lt;/codeph&gt; 开头。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:2;29:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;engine&lt;/i&gt; 必须为 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;29:16&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTP&lt;/codeph&gt;。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;30:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;OLTP 目前只支持单机版本，分区方式可以任意填写。&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;dbName = &#34;oltp://test_imoltp&#34; db = database(dbName, VALUE, 1..100, , &#34;IMOLTP&#34;)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;22-建表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;2.2 建表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;使用 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/c/createIMOLTPTable.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:2;39:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;?ditaot usertext?&gt;createIMOLTPTable&lt;/xref&gt; 函数来创建 OLTP 表，语法如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;createIMOLTPTable(dbHandle, table, tableName, primaryKey, [secondaryKey], [uniqueFlag])&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:3;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;primaryKey&lt;/i&gt; 用来指定主键索引的键。主键索引有且只有一个，每个 OLTP 表都必须指定。主键索引是 unique 的，插入数据时会检查是否满足唯一性约束（即不能插入重复元素），若违反则报错。主键可以包含多个字段（字段即为列名）。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:4;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;secondaryKey&lt;/i&gt; 用来指定二级索引的键。二级索引可选，并且每个 OLTP 表可以创建多个二级索引。二级索引有 unique 和 non-unique 两种，两者的区别在于 unique 索引需要满足唯一性约束，而 non-unique 索引没有这个限制。由 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:5;47:136&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;uniqueFlag&lt;/i&gt; 来指定二级索引是否是 unique 的。二级索引的键同样可以包含多个字段。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;49:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;// pt1 以 id 为主键，没有二级索引 pt1 = db.createIMOLTPTable(     table(1:0, [&#34;id&#34;, &#34;val1&#34;, &#34;val2&#34;, &#34;sym&#34;], [LONG, INT, LONG, STRING]),     &#34;test_table_1&#34;,     primaryKey=`id ) // pt2 以 id,sym 为主键，有一个 unique 二级索引：以 val2,sym 为键 pt2 = db.createIMOLTPTable(     table(1:0, [&#34;id&#34;, &#34;val1&#34;, &#34;val2&#34;, &#34;sym&#34;], [LONG, INT, LONG, STRING]),     &#34;test_table_2&#34;,     primaryKey=`id`sym,     secondaryKey=`val2`sym,     uniqueFlag=true ) // pt3 以 id 为主键，有一个非 unique 二级索引：以 val1 为键；一个 unique 二级索引：以 sym 为键 pt3 = db.createIMOLTPTable(     table(1:0, [&#34;id&#34;, &#34;val1&#34;, &#34;val2&#34;, &#34;sym&#34;], [LONG, INT, LONG, STRING]),     &#34;test_table_3&#34;,     primaryKey=`id,     secondaryKey=[`val1, `sym],     uniqueFlag=[false, true] )&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;76:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;通常来说，对于查询效率：主键索引优于二级索引优于非索引，如果查询时不能利用任何索引，则只能进行全表扫描。合理地创建二级索引可以提升查询的效率，但是相应地会降低写入的效率，因为写入时 (insert/delete/update) 需要修改相应的索引。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;23-删库删表&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;78:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;78:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;2.3 删库/删表&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;78:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;80:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;使用 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/d/dropTable.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:3;80:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;?ditaot usertext?&gt;dropTable&lt;/xref&gt; 和 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/d/dropDatabase.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:4;80:71&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;?ditaot usertext?&gt;dropDatabase&lt;/xref&gt; 来删表删库，使用方式与 OLAP/TSDB 没有区别。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;82:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;db.dropTable(&#34;test_table_1&#34;) if (existsDatabase(dbName)) {     dropDatabase(dbName) }&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-dml&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;3. DML&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;94:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;后文的例子假设已经执行过下面的脚本来建库建表：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;96:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;dbName = &#34;oltp://test_imoltp&#34; tableName = &#34;test_table&#34; if (existsDatabase(dbName)) {     dropDatabase(dbName) } db = database(dbName, VALUE, 1..100, , &#34;IMOLTP&#34;) // pt 以 id 为主键，没有二级索引 pt = db.createIMOLTPTable(     table(1:0, [&#34;id&#34;, &#34;val1&#34;, &#34;val2&#34;, &#34;sym&#34;], [LONG, INT, LONG, STRING]),     tableName,     primaryKey=`id )&lt;/codeblock&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;31-写入数据&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;114:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;114:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;3.1 写入数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;114:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;116:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;写入数据可以用 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/funcs/a/append!.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:5;116:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;?ditaot usertext?&gt;append!&lt;/xref&gt; 和 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/progr/sql/insertInto.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:6;116:72&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;?ditaot usertext?&gt;insert into&lt;/xref&gt;，使用方式与 OLAP/TSDB 一样。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;118:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;pt = loadTable(&#34;oltp://test_imoltp&#34;, &#34;test_table&#34;) id = 1..100 val1 = id * 10 val2 = rand(10000, size(id)) sym = take(`aaa`bbb`ccc`ddd`eee, size(id)) pt.append!(table(id, val1, val2, sym)) insert into pt values(200, 2000, 1111, `xxx) insert into pt values(201, 2010, 2222, `yyy) insert into pt values(211..220, (211..220)*10, take(9527, 10), take(`xxx`yyy`zzz, 10)) insert into pt(id, sym) values(1000, `aaa) insert into pt(id, sym, val1) values(1001, `bbb, 10010)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;32-查询数据&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;135:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;135:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;3.2 查询数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;135:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;137:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;使用 SQL 来查询数据。where 条件非常重要，如果一次查询无法利用索引，那么性能会大幅降低。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;139:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;pt = loadTable(&#34;oltp://test_imoltp&#34;, &#34;test_table&#34;) select * from pt where id = 10 // 点查，用主键索引 select * from pt where id &amp;gt; 100, id &amp;lt; 200 // 范围查询，用主键索引 select * from pt where val1 = 1000 // 全表扫描，无法利用索引&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;33-更新数据&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;148:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;148:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;3.3 更新数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;148:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;150:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;使用 SQL 来更新数据。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;152:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;pt = loadTable(&#34;oltp://test_imoltp&#34;, &#34;test_table&#34;) update pt set val1 = 100 where id = 1 update pt set val1 = id + val1 where id &amp;lt; 10&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;34-删除数据&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;3.4 删除数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;161:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;使用 SQL 来删除数据。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;163:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;pt = loadTable(&#34;oltp://test_imoltp&#34;, &#34;test_table&#34;) delete from pt where id = 1 delete from pt where id &amp;gt;= 100, id &amp;lt;= 110&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;4-事务&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;171:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;171:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;4. 事务&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;171:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;173:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;使用 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/progr/statements/transaction.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:7;173:4&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;?ditaot usertext?&gt;transaction&lt;/xref&gt; 语句块可以在一个事务内执行多条 DML 语句，在一个事务范围内，所有的 DML 操作都会一起成功或一起失败。若一个事务执行的时候有异常抛出，会自动撤销本次事务的所有更改。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;175:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;pt = loadTable(&#34;oltp://test_imoltp&#34;, &#34;test_table&#34;) delete from pt transaction { insert into pt values(0, 0, 0, `aaa) insert into pt values(1, 1, 1, `bbb) insert into pt values(2, 2, 2, `ccc) commit // 提交事务（可以省略） } assert (exec id from pt order by id) == [0,1,2] transaction { insert into pt values(3, 3, 3, `ddd) insert into pt values(4, 4, 4, `eee) delete from pt where id = 1 update pt set id = 10 where id = 0 assert (exec id from pt order by id) == [2,3,4,10] rollback // 强制回滚事务，撤销所有修改 } assert (exec id from pt order by id) == [0,1,2]&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;200:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;200:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;commit&lt;/codeph&gt; 表示提交本次事务的所有更改，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;200:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;rollback&lt;/codeph&gt; 表示撤销本次事务的所有更改。不需要显式地写 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;200:57&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;commit&lt;/codeph&gt;，出了 transaction 语句块的作用域时会自动 commit。&lt;/p&gt;&lt;note class=&#34;- topic/note &#34; xtrc=&#34;note:2;202:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt; 若不显式地使用 `transaction` 语句块，则每一句 SQL 都是一个事务。 &lt;/note&gt;&lt;note class=&#34;- topic/note &#34; type=&#34;important&#34; xtrc=&#34;note:3;202:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt; DDL 语句（即建表，删表等）不能放在 `transaction` 语句块里面，因为 DDL 目前不支持事务。 &lt;/note&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;5-配置参数&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;211:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;211:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;5. 配置参数&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;211:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;213:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;目前 OLTP 有以下配置参数可以设置：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:3;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:6;215:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;enableIMOLTPEngine&lt;/i&gt;，bool 类型。表示是否开启 OLTP 引擎。默认为 false。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;216:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:7;216:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;enableIMOLTPRedo&lt;/i&gt;，bool 类型。表示是否开启 WAL（Write-Ahead-Log），开启之后才能保证数据不会丢失。默认为 true。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:8;217:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPRedoFilePath&lt;/i&gt;，string 类型。表示 redo 文件（即 WAL 文件）的路径（注意不是目录），可以为绝对路径或者相对路径。当为相对路径时，相对于 home 目录下的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;217:102&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTP&lt;/codeph&gt; 目录。默认为 home 目录下的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;217:128&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTP/im_oltp.redo&lt;/codeph&gt;。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;218:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:9;218:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPSyncOnTxnCommit&lt;/i&gt;，bool 类型。只在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:10;218:38&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;enableIMOLTPRedo&lt;/i&gt; 为 true 时（即开启了 WAL）有意义。默认为 false。详细解释见下文。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;219:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:11;219:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;enableIMOLTPCheckpoint&lt;/i&gt;，bool 类型。表示是否开启 checkpoint。默认为 true。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;220:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:12;220:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPCheckpointFilePath&lt;/i&gt;，string 类型。表示 checkpoint 文件的路径（注意不是目录），可以为绝对路径或者相对路径。当为相对路径时，相对于 home 目录下的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;220:104&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTP&lt;/codeph&gt; 目录。默认为 home 目录下的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;220:130&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTP/im_oltp.ckp&lt;/codeph&gt;。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;221:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:13;221:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPCheckpointThreshold&lt;/i&gt;，long 类型，单位为 MiB。 表示：如果 redo 文件里面的 log 大小达到该阈值后，会触发一次 checkpoint。默认为 100 MiB。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;222:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:14;222:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPCheckpointInterval&lt;/i&gt;，long 类型，单位为秒。表示每隔 # 秒之后强制做一次 checkpoint。默认为 60 秒。&lt;/li&gt;&lt;/ul&gt;&lt;note class=&#34;- topic/note &#34; xtrc=&#34;note:4;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt; &lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;关于 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:15;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPSyncOnTxnCommit&lt;/i&gt; 的含义：&lt;/p&gt; &lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;在开启 WAL 后，事务对数据进行修改之前，会先写日志到持久化存储。系统重启时会回放 redo 文件里的日志，恢复到重启之前的状态。&lt;/p&gt; &lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;如果 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:16;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPSyncOnTxnCommit&lt;/i&gt; 为 false，事务 commit 成功之后，保证日志写到了操作系统的缓存里，但是不保证日志已经写到了持久化存储上。因此，如果进程崩溃, 数据不会丢失, 但是当操作系统崩溃（机器掉电）, 可能会有数据丢失。&lt;/p&gt; &lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;如果 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:17;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPSyncOnTxnCommit&lt;/i&gt; 为 true，在事务 commit 成功之后，保证日志已经写到了持久化存储上，即使操作系统崩溃，数据也不会丢失。(但是如果存储设备故障, 还是可能有数据丢失)。&lt;/p&gt; &lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;如果需要持久化数据，并且对数据的一致性要求较高，绝对无法忍受数据丢失，推荐把 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:18;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;enableIMOLTPRedo&lt;/i&gt; 和 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:19;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPSyncOnTxnCommit&lt;/i&gt; 都设置为 true。这种模式下，（写入）性能较差。&lt;/p&gt; &lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;如果需要持久化数据，并且可以容忍操作系统崩溃（比如机器掉电等小概率事件）导致的数据丢失，推荐把 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:20;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;enableIMOLTPRedo&lt;/i&gt; 设置为 true， 把 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:21;224:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPSyncOnTxnCommit&lt;/i&gt; 设置为 false。这种模式下，（写入）性能较好。默认为这种配置。&lt;/p&gt; &lt;/note&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;6-内置函数-triggercheckpointforimoltp&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:14;236:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:14;236:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;6. 内置函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;236:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;triggerCheckpointForIMOLTP&lt;/codeph&gt;&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:14;236:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;238:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;当开启了 checkpoint 时（即 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:22;238:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;enableIMOLTPCheckpoint&lt;/i&gt; 配置为 true ），系统会在达到以下两个条件之一时自动触发 checkpoint：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:4;240:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;240:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;redo 文件里面的 log 大小达到阈值（&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:23;240:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPCheckpointThreshold&lt;/i&gt; MiB）；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;241:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;或者，距离上一次 checkpoint 过去了 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:24;241:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPCheckpointInterval&lt;/i&gt; 秒。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;243:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;用户也可以手动调用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;243:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;triggerCheckpointForIMOLTP&lt;/codeph&gt; 函数来触发 checkpoint。函数语法如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;245:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;triggerCheckpointForIMOLTP([force=false], [sync=false])&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;249:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;参数：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:5;251:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;251:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:25;251:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;force&lt;/i&gt;，bool 类型，可选。表示是否强制做 checkpoint。如果为 false，并且当前并没有达到做 checkpoint 的条件（即 redo 文件里的 log 大小没有达到 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;251:100&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;IMOLTPCheckpointThreshold&lt;/codeph&gt;），则忽略这次请求。默认为 false。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;252:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:26;252:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;sync&lt;/i&gt;，bool 类型，可选。表示是否异步。如果为 false，则该函数请求一次异步的 checkpoint，并不会等到请求完成再返回；否则该函数会等到请求完成（注意不一定做了 checkpoint）再返回。默认为 false。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;7-总结&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:15;256:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:15;256:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;7. 总结&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:15;256:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;258:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;DolphinDB 推出的OLTP 内存数据库适用于高并发、低延迟的在线事务处理场景。该数据库将数据存储在内存中，支持 B+ 树索引、事务、Write-Ahead-Logging 和 checkpoint 机制。事务通过 transaction 语句块实现，保证了操作的原子性。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;260:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;用户还可以通过配置参数的配置以及内置函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;260:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;triggerCheckpointForIMOLTP&lt;/codeph&gt; 的使用，手动触发 checkpoint。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;262:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md&#34;&gt;总体而言，DolphinDB 的 OLTP 引擎适用于对数据一致性和性能要求较高的场景。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.md"/><meta name="wh-out-relpath" content="tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="oltp-内存存储引擎非嵌入式版使用教程" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/database.html">数据库</a></div></div></li><li class="active"><div class="topicref" data-id="oltp-内存存储引擎非嵌入式版使用教程"><div class="title"><a href="../tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.html">OLTP 内存存储引擎（非嵌入式版）使用教程</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="分区数据库设计和操作-d9713e98328" class="topicref" data-id="分区数据库设计和操作" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="分区数据库设计和操作-d9713e98328-link">分区数据库设计和操作</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-内存表详解-d9713e98374" class="topicref" data-id="dolphindb-内存表详解" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/in_memory_table.html" id="dolphindb-内存表详解-d9713e98374-link">DolphinDB 内存表详解</a></div></div></li><li role="treeitem"><div data-tocid="内存数据表-d9713e98420" class="topicref" data-id="内存数据表" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/partitioned_in_memory_table.html" id="内存数据表-d9713e98420-link">内存数据表</a></div></div></li><li role="treeitem" class="active"><div data-tocid="oltp-内存存储引擎非嵌入式版使用教程-d9713e98466" class="topicref" data-id="oltp-内存存储引擎非嵌入式版使用教程" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.html" id="oltp-内存存储引擎非嵌入式版使用教程-d9713e98466-link">OLTP 内存存储引擎（非嵌入式版）使用教程</a></div></div></li><li role="treeitem"><div data-tocid="利用缓存表快速实现-mysql-库间信息同步-d9713e98512" class="topicref" data-id="利用缓存表快速实现-mysql-库间信息同步" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/cachedtable.html" id="利用缓存表快速实现-mysql-库间信息同步-d9713e98512-link">利用缓存表快速实现 MySQL 库间信息同步</a></div></div></li><li role="treeitem"><div data-tocid="建库建表最容易忽略的十个细节-d9713e98558" class="topicref" data-id="建库建表最容易忽略的十个细节" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database_and_table_creation_details.html" id="建库建表最容易忽略的十个细节-d9713e98558-link">建库建表最容易忽略的十个细节</a></div></div></li><li role="treeitem"><div data-tocid="redo-log-和-cache-engine-d9713e98604" class="topicref" data-id="redo-log-和-cache-engine" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/redoLog_cacheEngine.html" id="redo-log-和-cache-engine-d9713e98604-link">redo log 和 cache engine</a></div></div></li><li role="treeitem"><div data-tocid="tsdb-存储引擎简介-d9713e98650" class="topicref" data-id="tsdb-存储引擎简介" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tsdb_engine.html" id="tsdb-存储引擎简介-d9713e98650-link">TSDB 存储引擎简介</a></div></div></li><li role="treeitem"><div data-tocid="tsdb-存储引擎详解-d9713e98696" class="topicref" data-id="tsdb-存储引擎详解" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tsdb_explained.html" id="tsdb-存储引擎详解-d9713e98696-link">TSDB 存储引擎详解</a></div></div></li><li role="treeitem"><div data-tocid="分布式表数据更新原理和性能-d9713e98742" class="topicref" data-id="分布式表数据更新原理和性能" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_update.html" id="分布式表数据更新原理和性能-d9713e98742-link">分布式表数据更新原理和性能</a></div></div></li><li role="treeitem"><div data-tocid="软删除-d9713e98788" class="topicref" data-id="软删除" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/soft_delete.html" id="软删除-d9713e98788-link">软删除</a></div></div></li><li role="treeitem"><div data-tocid="基于-datax-的-dolphindb-数据导入工具-d9713e98835" class="topicref" data-id="基于-datax-的-dolphindb-数据导入工具" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/datax_writer.html" id="基于-datax-的-dolphindb-数据导入工具-d9713e98835-link">基于 DataX 的 DolphinDB 数据导入工具</a></div></div></li><li role="treeitem"><div data-tocid="debezium--kafka-实时同步-mysql-数据到-dolphindb-d9713e98881" class="topicref" data-id="debezium--kafka-实时同步-mysql-数据到-dolphindb" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Debezium_and_Kafka_data_sync.html" id="debezium--kafka-实时同步-mysql-数据到-dolphindb-d9713e98881-link">Debezium + Kafka 实时同步 MySQL 数据到 DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="debeziumkafka-实时同步-oracle-11g-数据到-dolphindb-d9713e98927" class="topicref" data-id="debeziumkafka-实时同步-oracle-11g-数据到-dolphindb" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Debezium_Kafka_Oracle_sync.html" id="debeziumkafka-实时同步-oracle-11g-数据到-dolphindb-d9713e98927-link">Debezium+Kafka 实时同步 Oracle 11g 数据到 DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="clear_cache-d9713e98973" class="topicref" data-id="clear_cache" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/clear_cache.html" id="clear_cache-d9713e98973-link">数据库缓存清理机制 </a></div></div></li><li role="treeitem"><div data-tocid="best_practice_for_storage_compute_separation-d9713e99019" class="topicref" data-id="best_practice_for_storage_compute_separation" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practice_for_storage_compute_separation.html" id="best_practice_for_storage_compute_separation-d9713e99019-link">存算分离最佳实践教程</a></div></div></li><li role="treeitem"><div data-tocid="database_and_table_creation_wizard-d9713e99065" class="topicref" data-id="database_and_table_creation_wizard" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database_and_table_creation_wizard.html" id="database_and_table_creation_wizard-d9713e99065-link">DolphinDB Web 界面库表创建指南</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">OLTP 内存存储引擎（非嵌入式版）使用教程</h1><div class="- topic/body body"></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-背景"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. 背景</h2><div class="- topic/body body"><p class="- topic/p p">在一些数据库应用场景中，例如金融行业的交易系统，其主要工作负载来源于对关系表的高频度、高并发的更新和查询操作。这样的应用场景要求数据的读写和计算能够具有低延迟、高并发的特征，同时保证极高的数据一致性，并提供 ACID 事务的支持，是典型的在线事务处理（OLTP）场景。传统的存储引擎由于其架构的设计出发点是将数据存储在磁盘上，在面对上述场景要求时，软硬件层面面临巨大挑战，无法很好地满足上述苛刻的性能要求。而在这些场景中，往往需要维护的数据量实际上没有那么大，那么，能否把所有的数据都维护在内存里呢？这样就可以减少读写磁盘的带宽，能够大大降低数据库的延迟和提升数据库的并发度。</p><p class="- topic/p p">基于这个想法，DolphinDB 设计并实现了一款纯自研的内存 OLTP 数据库，它有以下特点：</p><ul class="- topic/ul ul"><li class="- topic/li li">将所有数据都存储在内存中，省去磁盘 I/O 的开销；</li><li class="- topic/li li">以行存的形式来组织数据，主要适用于 OLTP 的场景；</li><li class="- topic/li li">支持创建 B+ 树索引 (主键索引和二级索引) 来应对高频度、高并发的更新和查询操作；</li><li class="- topic/li li">支持事务，默认为 snapshot isolation；</li><li class="- topic/li li">实现 Write-Ahead-Logging 和 checkpoint 机制以保证数据的持久化和恢复；</li><li class="- topic/li li">为加速重启时的恢复过程，实现了并行恢复机制。</li></ul><p class="- topic/p p">下文将介绍 OLTP 的使用方式。</p><div class="- topic/p p"><div class="- topic/note note note note_note"><span class="note__title">注：</span> 需要在配置文件里加上 <code class="+ topic/ph pr-d/codeph ph codeph">enableIMOLTPEngine=true</code> 来开启 OLTP 引擎。</div></div></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="2-ddl"><h2 class="- topic/title title topictitle2" id="ariaid-title3">2. DDL</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="21-建库"><h3 class="- topic/title title topictitle3" id="ariaid-title4">2.1 建库</h3><div class="- topic/body body"><p class="- topic/p p">使用 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/d/database.html" target="_blank" rel="external noopener">database</a> 函数来创建 OLTP 数据库，语法与创建 OLAP/TSDB 数据库一样，但是有以下注意事项：</p><ul class="- topic/ul ul"><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">directory</em> 必须以 <code class="+ topic/ph pr-d/codeph ph codeph">oltp://</code> 开头。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">engine</em> 必须为 <code class="+ topic/ph pr-d/codeph ph codeph">IMOLTP</code>。</li><li class="- topic/li li">OLTP 目前只支持单机版本，分区方式可以任意填写。</li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbName = "oltp://test_imoltp"
db = database(dbName, VALUE, 1..100, , "IMOLTP")</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="22-建表"><h3 class="- topic/title title topictitle3" id="ariaid-title5">2.2 建表</h3><div class="- topic/body body"><p class="- topic/p p">使用 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/c/createIMOLTPTable.html" target="_blank" rel="external noopener">createIMOLTPTable</a> 函数来创建 OLTP 表，语法如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>createIMOLTPTable(dbHandle, table, tableName, primaryKey, [secondaryKey], [uniqueFlag])</code></pre><p class="- topic/p p"><em class="+ topic/ph hi-d/i ph i">primaryKey</em> 用来指定主键索引的键。主键索引有且只有一个，每个 OLTP 表都必须指定。主键索引是 unique 的，插入数据时会检查是否满足唯一性约束（即不能插入重复元素），若违反则报错。主键可以包含多个字段（字段即为列名）。</p><p class="- topic/p p"><em class="+ topic/ph hi-d/i ph i">secondaryKey</em> 用来指定二级索引的键。二级索引可选，并且每个 OLTP 表可以创建多个二级索引。二级索引有 unique 和 non-unique 两种，两者的区别在于 unique 索引需要满足唯一性约束，而 non-unique 索引没有这个限制。由 <em class="+ topic/ph hi-d/i ph i">uniqueFlag</em> 来指定二级索引是否是 unique 的。二级索引的键同样可以包含多个字段。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>// pt1 以 id 为主键，没有二级索引
pt1 = db.createIMOLTPTable(
    table(1:0, ["id", "val1", "val2", "sym"], [LONG, INT, LONG, STRING]),
    "test_table_1",
    primaryKey=`id
)

// pt2 以 id,sym 为主键，有一个 unique 二级索引：以 val2,sym 为键
pt2 = db.createIMOLTPTable(
    table(1:0, ["id", "val1", "val2", "sym"], [LONG, INT, LONG, STRING]),
    "test_table_2",
    primaryKey=`id`sym,
    secondaryKey=`val2`sym,
    uniqueFlag=true
)

// pt3 以 id 为主键，有一个非 unique 二级索引：以 val1 为键；一个 unique 二级索引：以 sym 为键
pt3 = db.createIMOLTPTable(
    table(1:0, ["id", "val1", "val2", "sym"], [LONG, INT, LONG, STRING]),
    "test_table_3",
    primaryKey=`id,
    secondaryKey=[`val1, `sym],
    uniqueFlag=[false, true]
)</code></pre><p class="- topic/p p">通常来说，对于查询效率：主键索引优于二级索引优于非索引，如果查询时不能利用任何索引，则只能进行全表扫描。合理地创建二级索引可以提升查询的效率，但是相应地会降低写入的效率，因为写入时 (insert/delete/update) 需要修改相应的索引。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title6" id="23-删库删表"><h3 class="- topic/title title topictitle3" id="ariaid-title6">2.3 删库/删表</h3><div class="- topic/body body"><p class="- topic/p p">使用 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/d/dropTable.html" target="_blank" rel="external noopener">dropTable</a> 和 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/d/dropDatabase.html" target="_blank" rel="external noopener">dropDatabase</a> 来删表删库，使用方式与 OLAP/TSDB 没有区别。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>db.dropTable("test_table_1")

if (existsDatabase(dbName)) {
    dropDatabase(dbName)
}</code></pre></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title7" id="3-dml"><h2 class="- topic/title title topictitle2" id="ariaid-title7">3. DML</h2><div class="- topic/body body"><p class="- topic/p p">后文的例子假设已经执行过下面的脚本来建库建表：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>dbName = "oltp://test_imoltp"
tableName = "test_table"

if (existsDatabase(dbName)) {
    dropDatabase(dbName)
}

db = database(dbName, VALUE, 1..100, , "IMOLTP")

// pt 以 id 为主键，没有二级索引
pt = db.createIMOLTPTable(
    table(1:0, ["id", "val1", "val2", "sym"], [LONG, INT, LONG, STRING]),
    tableName,
    primaryKey=`id
)</code></pre></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title8" id="31-写入数据"><h3 class="- topic/title title topictitle3" id="ariaid-title8">3.1 写入数据</h3><div class="- topic/body body"><p class="- topic/p p">写入数据可以用 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/funcs/a/append!.html" target="_blank" rel="external noopener">append!</a> 和 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/progr/sql/insertInto.html" target="_blank" rel="external noopener">insert into</a>，使用方式与 OLAP/TSDB 一样。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>pt = loadTable("oltp://test_imoltp", "test_table")

id = 1..100
val1 = id * 10
val2 = rand(10000, size(id))
sym = take(`aaa`bbb`ccc`ddd`eee, size(id))
pt.append!(table(id, val1, val2, sym))

insert into pt values(200, 2000, 1111, `xxx)
insert into pt values(201, 2010, 2222, `yyy)
insert into pt values(211..220, (211..220)*10, take(9527, 10), take(`xxx`yyy`zzz, 10))

insert into pt(id, sym) values(1000, `aaa)
insert into pt(id, sym, val1) values(1001, `bbb, 10010)</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title9" id="32-查询数据"><h3 class="- topic/title title topictitle3" id="ariaid-title9">3.2 查询数据</h3><div class="- topic/body body"><p class="- topic/p p">使用 SQL 来查询数据。where 条件非常重要，如果一次查询无法利用索引，那么性能会大幅降低。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>pt = loadTable("oltp://test_imoltp", "test_table")

select * from pt where id = 10  // 点查，用主键索引
select * from pt where id &gt; 100, id &lt; 200  // 范围查询，用主键索引

select * from pt where val1 = 1000  // 全表扫描，无法利用索引</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title10" id="33-更新数据"><h3 class="- topic/title title topictitle3" id="ariaid-title10">3.3 更新数据</h3><div class="- topic/body body"><p class="- topic/p p">使用 SQL 来更新数据。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>pt = loadTable("oltp://test_imoltp", "test_table")

update pt set val1 = 100 where id = 1
update pt set val1 = id + val1 where id &lt; 10</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title11" id="34-删除数据"><h3 class="- topic/title title topictitle3" id="ariaid-title11">3.4 删除数据</h3><div class="- topic/body body"><p class="- topic/p p">使用 SQL 来删除数据。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>pt = loadTable("oltp://test_imoltp", "test_table")

delete from pt where id = 1
delete from pt where id &gt;= 100, id &lt;= 110</code></pre></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title12" id="4-事务"><h2 class="- topic/title title topictitle2" id="ariaid-title12">4. 事务</h2><div class="- topic/body body"><p class="- topic/p p">使用 <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/progr/statements/transaction.html" target="_blank" rel="external noopener">transaction</a> 语句块可以在一个事务内执行多条 DML 语句，在一个事务范围内，所有的 DML 操作都会一起成功或一起失败。若一个事务执行的时候有异常抛出，会自动撤销本次事务的所有更改。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>pt = loadTable("oltp://test_imoltp", "test_table")

delete from pt

transaction {
    insert into pt values(0, 0, 0, `aaa)
    insert into pt values(1, 1, 1, `bbb)
    insert into pt values(2, 2, 2, `ccc)
    commit  // 提交事务（可以省略）
}
assert (exec id from pt order by id) == [0,1,2]

transaction {
    insert into pt values(3, 3, 3, `ddd)
    insert into pt values(4, 4, 4, `eee)
    delete from pt where id = 1
    update pt set id = 10 where id = 0
    
    assert (exec id from pt order by id) == [2,3,4,10]
    rollback  // 强制回滚事务，撤销所有修改
}
assert (exec id from pt order by id) == [0,1,2]</code></pre><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">commit</code> 表示提交本次事务的所有更改，<code class="+ topic/ph pr-d/codeph ph codeph">rollback</code> 表示撤销本次事务的所有更改。不需要显式地写 <code class="+ topic/ph pr-d/codeph ph codeph">commit</code>，出了 transaction 语句块的作用域时会自动 commit。</p><div class="- topic/note note note note_note"><span class="note__title">注：</span> 
若不显式地使用 `transaction` 语句块，则每一句 SQL 都是一个事务。
</div><div class="- topic/note note important note_important"><span class="note__title">重要：</span> 
DDL 语句（即建表，删表等）不能放在 `transaction` 语句块里面，因为 DDL 目前不支持事务。
</div></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title13" id="5-配置参数"><h2 class="- topic/title title topictitle2" id="ariaid-title13">5. 配置参数</h2><div class="- topic/body body"><p class="- topic/p p">目前 OLTP 有以下配置参数可以设置：</p><ul class="- topic/ul ul"><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">enableIMOLTPEngine</em>，bool 类型。表示是否开启 OLTP 引擎。默认为 false。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">enableIMOLTPRedo</em>，bool 类型。表示是否开启 WAL（Write-Ahead-Log），开启之后才能保证数据不会丢失。默认为 true。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">IMOLTPRedoFilePath</em>，string 类型。表示 redo 文件（即 WAL 文件）的路径（注意不是目录），可以为绝对路径或者相对路径。当为相对路径时，相对于 home 目录下的 <code class="+ topic/ph pr-d/codeph ph codeph">IMOLTP</code> 目录。默认为 home 目录下的 <code class="+ topic/ph pr-d/codeph ph codeph">IMOLTP/im_oltp.redo</code>。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">IMOLTPSyncOnTxnCommit</em>，bool 类型。只在 <em class="+ topic/ph hi-d/i ph i">enableIMOLTPRedo</em> 为 true 时（即开启了 WAL）有意义。默认为 false。详细解释见下文。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">enableIMOLTPCheckpoint</em>，bool 类型。表示是否开启 checkpoint。默认为 true。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">IMOLTPCheckpointFilePath</em>，string 类型。表示 checkpoint 文件的路径（注意不是目录），可以为绝对路径或者相对路径。当为相对路径时，相对于 home 目录下的 <code class="+ topic/ph pr-d/codeph ph codeph">IMOLTP</code> 目录。默认为 home 目录下的 <code class="+ topic/ph pr-d/codeph ph codeph">IMOLTP/im_oltp.ckp</code>。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">IMOLTPCheckpointThreshold</em>，long 类型，单位为 MiB。 表示：如果 redo 文件里面的 log 大小达到该阈值后，会触发一次 checkpoint。默认为 100 MiB。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">IMOLTPCheckpointInterval</em>，long 类型，单位为秒。表示每隔 # 秒之后强制做一次 checkpoint。默认为 60 秒。</li></ul><div class="- topic/note note note note_note"><span class="note__title">注：</span> 
<p class="- topic/p p">关于 <em class="+ topic/ph hi-d/i ph i">IMOLTPSyncOnTxnCommit</em> 的含义：</p>
<p class="- topic/p p">在开启 WAL 后，事务对数据进行修改之前，会先写日志到持久化存储。系统重启时会回放 redo 文件里的日志，恢复到重启之前的状态。</p>
<p class="- topic/p p">如果 <em class="+ topic/ph hi-d/i ph i">IMOLTPSyncOnTxnCommit</em> 为 false，事务 commit 成功之后，保证日志写到了操作系统的缓存里，但是不保证日志已经写到了持久化存储上。因此，如果进程崩溃, 数据不会丢失, 但是当操作系统崩溃（机器掉电）, 可能会有数据丢失。</p>
<p class="- topic/p p">如果 <em class="+ topic/ph hi-d/i ph i">IMOLTPSyncOnTxnCommit</em> 为 true，在事务 commit 成功之后，保证日志已经写到了持久化存储上，即使操作系统崩溃，数据也不会丢失。(但是如果存储设备故障, 还是可能有数据丢失)。</p>
<p class="- topic/p p">如果需要持久化数据，并且对数据的一致性要求较高，绝对无法忍受数据丢失，推荐把 <em class="+ topic/ph hi-d/i ph i">enableIMOLTPRedo</em> 和 <em class="+ topic/ph hi-d/i ph i">IMOLTPSyncOnTxnCommit</em> 都设置为 true。这种模式下，（写入）性能较差。</p>
<p class="- topic/p p">如果需要持久化数据，并且可以容忍操作系统崩溃（比如机器掉电等小概率事件）导致的数据丢失，推荐把 <em class="+ topic/ph hi-d/i ph i">enableIMOLTPRedo</em> 设置为 true， 把 <em class="+ topic/ph hi-d/i ph i">IMOLTPSyncOnTxnCommit</em> 设置为 false。这种模式下，（写入）性能较好。默认为这种配置。</p>
</div></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title14" id="6-内置函数-triggercheckpointforimoltp"><h2 class="- topic/title title topictitle2" id="ariaid-title14">6. 内置函数 <code class="+ topic/ph pr-d/codeph ph codeph">triggerCheckpointForIMOLTP</code></h2><div class="- topic/body body"><p class="- topic/p p">当开启了 checkpoint 时（即 <em class="+ topic/ph hi-d/i ph i">enableIMOLTPCheckpoint</em> 配置为 true ），系统会在达到以下两个条件之一时自动触发 checkpoint：</p><ul class="- topic/ul ul"><li class="- topic/li li">redo 文件里面的 log 大小达到阈值（<em class="+ topic/ph hi-d/i ph i">IMOLTPCheckpointThreshold</em> MiB）；</li><li class="- topic/li li">或者，距离上一次 checkpoint 过去了 <em class="+ topic/ph hi-d/i ph i">IMOLTPCheckpointInterval</em> 秒。</li></ul><p class="- topic/p p">用户也可以手动调用 <code class="+ topic/ph pr-d/codeph ph codeph">triggerCheckpointForIMOLTP</code> 函数来触发 checkpoint。函数语法如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>triggerCheckpointForIMOLTP([force=false], [sync=false])</code></pre><p class="- topic/p p">参数：</p><ul class="- topic/ul ul"><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">force</em>，bool 类型，可选。表示是否强制做 checkpoint。如果为 false，并且当前并没有达到做 checkpoint 的条件（即 redo 文件里的 log 大小没有达到 <code class="+ topic/ph pr-d/codeph ph codeph">IMOLTPCheckpointThreshold</code>），则忽略这次请求。默认为 false。</li><li class="- topic/li li"><em class="+ topic/ph hi-d/i ph i">sync</em>，bool 类型，可选。表示是否异步。如果为 false，则该函数请求一次异步的 checkpoint，并不会等到请求完成再返回；否则该函数会等到请求完成（注意不一定做了 checkpoint）再返回。默认为 false。</li></ul></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title15" id="7-总结"><h2 class="- topic/title title topictitle2" id="ariaid-title15">7. 总结</h2><div class="- topic/body body"><p class="- topic/p p">DolphinDB 推出的OLTP 内存数据库适用于高并发、低延迟的在线事务处理场景。该数据库将数据存储在内存中，支持 B+ 树索引、事务、Write-Ahead-Logging 和 checkpoint 机制。事务通过 transaction 语句块实现，保证了操作的原子性。</p><p class="- topic/p p">用户还可以通过配置参数的配置以及内置函数 <code class="+ topic/ph pr-d/codeph ph codeph">triggerCheckpointForIMOLTP</code> 的使用，手动触发 checkpoint。</p><p class="- topic/p p">总体而言，DolphinDB 的 OLTP 引擎适用于对数据一致性和性能要求较高的场景。</p></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E8%83%8C%E6%99%AF" data-tocid="1-背景">1. 背景</a></li><li class="topic-item"><a href="#2-ddl" data-tocid="2-ddl">2. DDL</a><ul><li class="topic-item"><a href="#21-%E5%BB%BA%E5%BA%93" data-tocid="21-建库">2.1 建库</a></li><li class="topic-item"><a href="#22-%E5%BB%BA%E8%A1%A8" data-tocid="22-建表">2.2 建表</a></li><li class="topic-item"><a href="#23-%E5%88%A0%E5%BA%93%E5%88%A0%E8%A1%A8" data-tocid="23-删库删表">2.3 删库/删表</a></li></ul></li><li class="topic-item"><a href="#3-dml" data-tocid="3-dml">3. DML</a><ul><li class="topic-item"><a href="#31-%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE" data-tocid="31-写入数据">3.1 写入数据</a></li><li class="topic-item"><a href="#32-%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE" data-tocid="32-查询数据">3.2 查询数据</a></li><li class="topic-item"><a href="#33-%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE" data-tocid="33-更新数据">3.3 更新数据</a></li><li class="topic-item"><a href="#34-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE" data-tocid="34-删除数据">3.4 删除数据</a></li></ul></li><li class="topic-item"><a href="#4-%E4%BA%8B%E5%8A%A1" data-tocid="4-事务">4. 事务</a></li><li class="topic-item"><a href="#5-%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0" data-tocid="5-配置参数">5. 配置参数</a></li><li class="topic-item"><a href="#6-%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0-triggercheckpointforimoltp" data-tocid="6-内置函数-triggercheckpointforimoltp">6. 内置函数 <code class="+ topic/ph pr-d/codeph ph codeph">triggerCheckpointForIMOLTP</code></a></li><li class="topic-item"><a href="#7-%E6%80%BB%E7%BB%93" data-tocid="7-总结">7. 总结</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>