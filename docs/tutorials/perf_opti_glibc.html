<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="在高并发查询、查询需要涉及很多个分区的情况下，低版本的 glibc（低于 2.23）会严重影响查询性能。需要升级 glibc 解决该问题优化性能。我们撰写了本文，通过 patchelf 工具修改可执行文件和动态库的 rpath，达到无需升级系统便可以使用高版本 glibc 的目的。 在高并发查询、查询需要涉及很多个分区的情况下，需要频繁读取磁盘文件，而旧版 glibc（低于 2.23）的 ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="基于-glibc-升级的性能优化案例"/><title>基于 Glibc 升级的性能优化案例</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;基于-glibc-升级的性能优化案例&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;基于 Glibc 升级的性能优化案例&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;在高并发查询、查询需要涉及很多个分区的情况下，低版本的 glibc（低于 2.23）会严重影响查询性能。需要升级 glibc 解决该问题优化性能。我们撰写了本文，通过 patchelf 工具修改可执行文件和动态库的 rpath，达到无需升级系统便可以使用高版本 glibc 的目的。&lt;/p&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:161;204:78&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-概述&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;1. 概述&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;在高并发查询、查询需要涉及很多个分区的情况下，需要频繁读取磁盘文件，而旧版 glibc（低于 2.23）的&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;7:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;fseek&lt;/codeph&gt;函数性能低下，导致查询任务堆积，CPU 利用率却不高。需要升级 glibc 解决该问题。由于系统 glibc 通常和系统版本绑定，所以升级系统 glibc 需要升级系统。但是升级系统步骤繁琐，故我们撰写了本文通过 patchelf 工具修改可执行文件和动态库的 rpath，在动态链接时优先链接的高版本 glibc。从而无需升级系统便可以使用高版本 glibc。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-环境配置与数据模拟&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;2. 环境配置与数据模拟&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;21-硬件配置&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;11:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;11:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;2.1. 硬件配置&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;11:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;测试总共使用四台配置相同的服务器，分别命名为 P1、P2、P3、P4，具体硬件配置如表所示。&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:1;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;6&#34; xtrc=&#34;tgroup:1;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:1;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:2;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:4;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col5&#34; colnum=&#34;5&#34; xtrc=&#34;colspec:5;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col6&#34; colnum=&#34;6&#34; xtrc=&#34;colspec:6;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:1;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:1;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:1;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;处理器&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:2;15:42&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;核数&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:3;15:47&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;内存&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:4;15:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;操作系统&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:5;15:77&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;硬盘&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:6;15:82&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;网络&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:1;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:2;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:7;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;Intel(R) Xeon(R) Gold 5320 CPU @ 2.20GHz&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:8;17:45&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;128&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:9;17:52&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;754 GB&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:10;17:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;CentOS Linux release 7.9&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:11;17:88&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;SSD&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:12;17:95&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;万兆局域网&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;22-集群配置&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;2.2. 集群配置&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;以下测试中使用的 DolphinDB Server 版本为 2.00.9.3。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;基于四台服务器搭建双副本高可用集群，假设四台服务器名称分别为 P1、P2、P3、P4，P1、P2、P3 各部署一个控制节点、一个代理节点、一个数据节点，P4 部署一个代理节点、一个数据节点。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;25:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;主要配置如下表：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:2;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:2;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:7;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:8;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:2;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:3;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:13;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;27:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;配置项&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:14;27:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;27:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;值&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:2;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:4;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:15;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;maxMemSize&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:16;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;480GB&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:5;30:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:17;30:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;workerNum&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:18;30:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;128 个&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:6;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:19;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;TSDBCacheEngineSize&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:20;31:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;100GB&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;23-模拟数据&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;2.3. 模拟数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;231-生成模拟数据&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;2.3.1. 生成模拟数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;模拟数据为物联网测点数据，有 4 个字段，分别是 id、time、v、q，一天 28.8 亿条数据。数据库按照日期（按天）、id（HASH 128）分区。每个分区约 2250 万条记录。具体脚本见附件。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;232-模拟数据查询&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;2.3.2. 模拟数据查询&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;我们模拟单个、20、40、60、100 个并发查询，查询内容为 4 天 1000 个随机 id 的点查询，理论上将包含 128x4 个分区。具体脚本见附件。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-升级-glibc&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3. 升级 glibc&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;31-查看本机-dolphindb-使用的-glibc-版本&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.1. 查看本机 DolphinDB 使用的 glibc 版本&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;执行以下命令&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;49:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;ldd dolphindb&lt;/codeblock&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/performance_optimization_based_on_glibc/01.png&#34; xtrc=&#34;image:1;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34; dita-ot:image-width=&#34;801&#34; dita-ot:image-height=&#34;273&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;55:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;找到 libc.so.6 的位置，在终端执行&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;/lib64/libc.so.6&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;得到版本为如图（2.17，低于 2.23）&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/performance_optimization_based_on_glibc/02.png&#34; xtrc=&#34;image:2;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34; dita-ot:image-width=&#34;733&#34; dita-ot:image-height=&#34;343&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;32-下载或者编译高版本-glibc&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.2. 下载或者编译高版本 glibc&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;321-下载&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.2.1. 下载&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;可自行下载对应系统高版本的 glibc 库和 libgcc 库后手工提取。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;70:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;或下载 DolphinDB 提供的压缩包（glibc 版本 2.23，Centos 7）。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;注意：可能存在兼容性问题。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;gz&#34; href=&#34;script/performance_optimization_based_on_glibc/glibc-2.23.tar.gz&#34; xtrc=&#34;xref:1;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;?ditaot usertext?&gt;glibc-2.23.tar.gz&lt;/xref&gt;&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;322-编译&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.2.2. 编译&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;77:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;可以通过自行编译的方式解决高版本 glibc 的兼容性问题。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;79:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;#下载 glibc 源代码 git clone https://sourceware.org/git/glibc.git cd glibc git checkout glibc-2.23 mkdir build cd build #具体路径需要自己选择，不要不添加路径或者选择系统库的路径，避免系统 glibc 被覆盖 ../configure --prefix=/home/thchen/glibc-2.23 # -j 后面的数字要低于或者等于自己 cpu 的核数 make -j12 make install #编译运行需要把系统的 /lib64/libgcc_s.so.1 复制到 /home/thchen/glibc-2.23/lib 里 cp /lib64/libgcc_s.so.1 /home/thchen/glibc-2.23/lib&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;33-解压高版本-glibc-到自定义位置&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:14;95:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:14;95:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.3. 解压高版本 glibc 到自定义位置&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:14;95:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;97:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;97:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;注意事项&lt;/b&gt;：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:1;99:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;99:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;不要解压到系统 lib64、根目录等路径覆盖系统 glibc。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;100:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;不要添加自定义 glibc 文件夹到&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;100:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;LD_LIBRARY_PATH&lt;/codeph&gt;环境变量。&lt;/li&gt;&lt;/ol&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;#当前位置为 /home/thchen tar -zxvf glibc-2.23.tar.gz&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;34-下载-patchelf&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:15;107:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:15;107:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.4. 下载 patchelf&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:15;107:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;109:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;sudo yum install patchelf&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;35-文件备份&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:16;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:16;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.5. 文件备份&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:16;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;115:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;备份相关文件（&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;115:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;dolphindb &lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;115:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libDolphinDB.so&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;115:39&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libgfortran.so.3&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;115:58&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libopenblas.so.0&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;115:77&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libquadmath.so.0&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;115:96&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libstdc++.so.6&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;115:113&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libtcmalloc_minimal.so.4&lt;/codeph&gt;）&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;117:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;#备份文件，需要到 dolphindb 可执行文件下的目录 cp dolphindb dolphindb.bak cp libDolphinDB.so libDolphinDB.so.bak cp libgfortran.so.3 libgfortran.so.3.bak cp libopenblas.so.0 libopenblas.so.0.bak cp libquadmath.so.0 libquadmath.so.0.bak cp libstdc++.so.6 libstdc++.so.6.bak cp libtcmalloc_minimal.so.4 libtcmalloc_minimal.so.4.bak&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;36-修改文件的-rpath-和-interpreter&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:17;128:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:17;128:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.6. 修改文件的 rpath 和 interpreter&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:17;128:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:2;130:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;130:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;关闭 DolphinDB&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;131:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;根据高版本 glibc 的路径，修改以下文件的 rpath：&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;131:34&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;dolphindb &lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;131:47&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libDolphinDB.so&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;131:65&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libgfortran.so.3&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;131:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libopenblas.so.0&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;131:103&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libquadmath.so.0&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;131:122&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libstdc++.so.6&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;131:139&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;libtcmalloc_minimal.so.4&lt;/codeph&gt;&lt;/li&gt;&lt;/ol&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;133:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;#修改 rpath，具体路径要看高版本 glibc 的路径 patchelf --set-interpreter /home/thchen/glibc-2.23/lib/ld-linux-x86-64.so.2 \ --set-rpath ./:/home/thchen/glibc-2.23/lib dolphindb patchelf --set-rpath ./:/home/thchen/glibc-2.23/lib libDolphinDB.so patchelf --set-rpath ./:/home/thchen/glibc-2.23/lib libgfortran.so.3 patchelf --set-rpath ./:/home/thchen/glibc-2.23/lib libopenblas.so.0 patchelf --set-rpath ./:/home/thchen/glibc-2.23/lib libquadmath.so.0 patchelf --set-rpath ./:/home/thchen/glibc-2.23/lib libstdc++.so.6 patchelf --set-rpath ./:/home/thchen/glibc-2.23/lib libtcmalloc_minimal.so.4&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;37-验证-glibc-库路径&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:18;145:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:18;145:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.7. 验证 glibc 库路径&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:18;145:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;147:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;使用 ldd dolphindb 命令验证当前 glibc 库的路径。当运行结果显示其路径为高版本 glibc 路径时，说明前述修改成功。&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/performance_optimization_based_on_glibc/03.png&#34; xtrc=&#34;image:3;149:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34; dita-ot:image-width=&#34;1015&#34; dita-ot:image-height=&#34;250&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;4-性能测试与对比&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:19;151:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:19;151:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;4. 性能测试与对比&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:19;151:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;153:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;通过在升级前和升级后运行 2.3.2 节的模拟查询，我们得到了以下数据：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:3;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;4&#34; xtrc=&#34;tgroup:3;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:9;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:10;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:11;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:12;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:3;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:7;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:21;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;155:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;查询方法&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:22;155:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;155:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;查询用时 (glibc 2.17)&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:23;155:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;155:38&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;查询用时 (glibc 2.34)&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:24;155:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:7;155:62&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;加速比&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:3;157:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:8;157:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:25;157:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;单查询&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:26;157:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3,241 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:27;157:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;2,007 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:28;157:68&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;1.61&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:9;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:29;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;20 并发查询&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:30;158:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;33,346 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:31;158:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;15,313 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:32;158:68&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;2.18&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:10;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:33;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;40 并发查询&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:34;159:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;85,144 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:35;159:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;24,672 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:36;159:68&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;3.45&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:11;160:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:37;160:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;60 并发查询&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:38;160:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;134,065 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:39;160:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;28,793 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:40;160:68&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;4.66&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:12;161:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:41;161:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;100 并发查询&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:42;161:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;224,902ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:43;161:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;46,938 ms&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:44;161:68&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;4.79&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;163:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;通过升级 glibc，DolphinDB 前后查询加速比为 1.61 到 4.79 倍。在并发情况下性能提升更加明显。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;5-小结&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:20;165:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:20;165:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;5. 小结&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:20;165:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;167:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;针对高并发查询，当查询需要涉及多个分区时，如果查询任务积压但 CPU 利用率不高，可以先确定 glibc 的版本。如果 glibc 版本低于 2.23，则可以按照本方案进行升级，这可能会带来明显的性能提升。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;6-附件&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:21;169:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:21;169:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;6. 附件&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:21;169:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;171:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;171:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;zip&#34; href=&#34;script/performance_optimization_based_on_glibc/testScript.zip&#34; xtrc=&#34;xref:2;171:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;?ditaot usertext?&gt;testScript.zip&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;172:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;gz&#34; href=&#34;script/performance_optimization_based_on_glibc/config.tar.gz&#34; xtrc=&#34;xref:3;172:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;?ditaot usertext?&gt;config.tar.gz&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;173:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;gz&#34; href=&#34;script/performance_optimization_based_on_glibc/glibc-2.23.tar.gz&#34; xtrc=&#34;xref:4;173:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/perf_opti_glibc.md&#34;&gt;&lt;?ditaot usertext?&gt;glibc-2.23.tar.gz&lt;/xref&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/perf_opti_glibc.md"/><meta name="wh-out-relpath" content="tutorials/perf_opti_glibc.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="基于-glibc-升级的性能优化案例" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html">物联网场景案例</a></div></div></li><li class="active"><div class="topicref" data-id="基于-glibc-升级的性能优化案例"><div class="title"><a href="../tutorials/perf_opti_glibc.html">基于 Glibc 升级的性能优化案例</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="引擎级联监测门禁异常状态-d9713e104828" class="topicref" data-id="引擎级联监测门禁异常状态" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="引擎级联监测门禁异常状态-d9713e104828-link">引擎级联监测门禁异常状态</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-历史数据回放功能应用物联网设备故障分析-d9713e104874" class="topicref" data-id="dolphindb-历史数据回放功能应用物联网设备故障分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/faultAnalysis.html" id="dolphindb-历史数据回放功能应用物联网设备故障分析-d9713e104874-link">DolphinDB 历史数据回放功能应用：物联网设备故障分析</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-在工业物联网的应用-d9713e104920" class="topicref" data-id="dolphindb-在工业物联网的应用" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_demo_2.html" id="dolphindb-在工业物联网的应用-d9713e104920-link">DolphinDB 在工业物联网的应用</a></div></div></li><li role="treeitem"><div data-tocid="出租车行程时间预测-d9713e104966" class="topicref" data-id="出租车行程时间预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/forecast_taxi_trip_dura_2.html" id="出租车行程时间预测-d9713e104966-link">出租车行程时间预测</a></div></div></li><li role="treeitem"><div data-tocid="传感器数据异常检测-d9713e105012" class="topicref" data-id="传感器数据异常检测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_anomaly_detection_2.html" id="传感器数据异常检测-d9713e105012-link">传感器数据异常检测</a></div></div></li><li role="treeitem"><div data-tocid="地震波形数据存储解决方案-d9713e105058" class="topicref" data-id="地震波形数据存储解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/waveform_data_storage_2.html" id="地震波形数据存储解决方案-d9713e105058-link">地震波形数据存储解决方案</a></div></div></li><li role="treeitem"><div data-tocid="工业试验平台高频数据的存储和处理分析-d9713e105104" class="topicref" data-id="工业试验平台高频数据的存储和处理分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/high_freq_data_storage_and_analysis.html" id="工业试验平台高频数据的存储和处理分析-d9713e105104-link">工业试验平台高频数据的存储和处理分析</a></div></div></li><li role="treeitem"><div data-tocid="基于波形数据的地震预测-d9713e105150" class="topicref" data-id="基于波形数据的地震预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/earthquake_prediction_ddb_ml_2.html" id="基于波形数据的地震预测-d9713e105150-link">基于波形数据的地震预测</a></div></div></li><li role="treeitem"><div data-tocid="实时检测传感器状态变化-d9713e105196" class="topicref" data-id="实时检测传感器状态变化" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_str_app_iot_2.html" id="实时检测传感器状态变化-d9713e105196-link">实时检测传感器状态变化</a></div></div></li><li role="treeitem"><div data-tocid="实现设备指标的采集监控和展示-d9713e105242" class="topicref" data-id="实现设备指标的采集监控和展示" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_telegraf_grafana.html" id="实现设备指标的采集监控和展示-d9713e105242-link">实现设备指标的采集监控和展示</a></div></div></li><li role="treeitem"><div data-tocid="随机振动信号分析解决方案-d9713e105288" class="topicref" data-id="随机振动信号分析解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/random_vibr_sig_analysis_2.html" id="随机振动信号分析解决方案-d9713e105288-link">随机振动信号分析解决方案</a></div></div></li><li role="treeitem"><div data-tocid="物联网时序数据查询案例-d9713e105335" class="topicref" data-id="物联网时序数据查询案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_query_case.html" id="物联网时序数据查询案例-d9713e105335-link">物联网时序数据查询案例</a></div></div></li><li role="treeitem"><div data-tocid="物联网实时数据异常率预警-d9713e105381" class="topicref" data-id="物联网实时数据异常率预警" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/knn_iot_2.html" id="物联网实时数据异常率预警-d9713e105381-link">物联网实时数据异常率预警</a></div></div></li><li role="treeitem"><div data-tocid="物联网应用范例-d9713e105427" class="topicref" data-id="物联网应用范例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_examples.html" id="物联网应用范例-d9713e105427-link">物联网应用范例</a></div></div></li><li role="treeitem"><div data-tocid="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案-d9713e105473" class="topicref" data-id="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Virbration_Monitor_Fault_Diagnose.html" id="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案-d9713e105473-link">云边协同：DolphinDB 构建一体化振动监控与故障诊断解决方案</a></div></div></li><li role="treeitem"><div data-tocid="助力工业物联网实现智能运维-d9713e105519" class="topicref" data-id="助力工业物联网实现智能运维" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Iot_intelligent_O&amp;M.html" id="助力工业物联网实现智能运维-d9713e105519-link">助力工业物联网实现智能运维</a></div></div></li><li role="treeitem"><div data-tocid="使用-node-red-构建-dolphindb-低代码平台-d9713e105565" class="topicref" data-id="使用-node-red-构建-dolphindb-低代码平台" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/node_red_tutorial_iot.html" id="使用-node-red-构建-dolphindb-低代码平台-d9713e105565-link">使用 Node-RED 构建 DolphinDB 低代码平台</a></div></div></li><li role="treeitem" class="active"><div data-tocid="基于-glibc-升级的性能优化案例-d9713e105611" class="topicref" data-id="基于-glibc-升级的性能优化案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/perf_opti_glibc.html" id="基于-glibc-升级的性能优化案例-d9713e105611-link">基于 Glibc 升级的性能优化案例</a></div></div></li><li role="treeitem"><div data-tocid="当电力市场碰上量化技术如何构建高效电力交易解决方案-d9713e105657" class="topicref" data-id="当电力市场碰上量化技术如何构建高效电力交易解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/efficient_power_trading_solutions.html" id="当电力市场碰上量化技术如何构建高效电力交易解决方案-d9713e105657-link">当电力市场碰上量化技术，如何构建高效电力交易解决方案？</a></div></div></li><li role="treeitem"><div data-tocid="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析-d9713e105703" class="topicref" data-id="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/behavioral_profiling_of_driving_habits.html" id="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析-d9713e105703-link">使用 DolphinDB 进行汽车用户驾驶习惯行为画像分析</a></div></div></li><li role="treeitem"><div data-tocid="edge_to_cloud-d9713e105749" class="topicref" data-id="edge_to_cloud" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/edge_to_cloud.html" id="edge_to_cloud-d9713e105749-link">DolphinDB 实现边到云的实时数据汇聚</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">基于 Glibc 升级的性能优化案例</h1><div class="- topic/body body"><p class="- topic/p p">在高并发查询、查询需要涉及很多个分区的情况下，低版本的 glibc（低于 2.23）会严重影响查询性能。需要升级 glibc 解决该问题优化性能。我们撰写了本文，通过 patchelf 工具修改可执行文件和动态库的 rpath，达到无需升级系统便可以使用高版本 glibc 的目的。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-概述"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. 概述</h2><div class="- topic/body body"><p class="- topic/p p">在高并发查询、查询需要涉及很多个分区的情况下，需要频繁读取磁盘文件，而旧版 glibc（低于 2.23）的<code class="+ topic/ph pr-d/codeph ph codeph">fseek</code>函数性能低下，导致查询任务堆积，CPU 利用率却不高。需要升级 glibc 解决该问题。由于系统 glibc 通常和系统版本绑定，所以升级系统 glibc 需要升级系统。但是升级系统步骤繁琐，故我们撰写了本文通过 patchelf 工具修改可执行文件和动态库的 rpath，在动态链接时优先链接的高版本 glibc。从而无需升级系统便可以使用高版本 glibc。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="2-环境配置与数据模拟"><h2 class="- topic/title title topictitle2" id="ariaid-title3">2. 环境配置与数据模拟</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="21-硬件配置"><h3 class="- topic/title title topictitle3" id="ariaid-title4">2.1. 硬件配置</h3><div class="- topic/body body"><p class="- topic/p p">测试总共使用四台配置相同的服务器，分别命名为 P1、P2、P3、P4，具体硬件配置如表所示。</p><div class="table-container"><table class="- topic/table table" data-cols="6"><caption></caption><colgroup><col/><col/><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="21-硬件配置__entry__1">处理器</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="21-硬件配置__entry__2">核数</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="21-硬件配置__entry__3">内存</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="21-硬件配置__entry__4">操作系统</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="21-硬件配置__entry__5">硬盘</th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="21-硬件配置__entry__6">网络</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="21-硬件配置__entry__1">Intel(R) Xeon(R) Gold 5320 CPU @ 2.20GHz</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="21-硬件配置__entry__2">128</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="21-硬件配置__entry__3">754 GB</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="21-硬件配置__entry__4">CentOS Linux release 7.9</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="21-硬件配置__entry__5">SSD</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="21-硬件配置__entry__6">万兆局域网</td></tr></tbody></table></div></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="22-集群配置"><h3 class="- topic/title title topictitle3" id="ariaid-title5">2.2. 集群配置</h3><div class="- topic/body body"><p class="- topic/p p">以下测试中使用的 DolphinDB Server 版本为 2.00.9.3。</p><p class="- topic/p p">基于四台服务器搭建双副本高可用集群，假设四台服务器名称分别为 P1、P2、P3、P4，P1、P2、P3 各部署一个控制节点、一个代理节点、一个数据节点，P4 部署一个代理节点、一个数据节点。</p><p class="- topic/p p">主要配置如下表：</p><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="22-集群配置__entry__1"><strong class="+ topic/ph hi-d/b ph b">配置项</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="22-集群配置__entry__2"><strong class="+ topic/ph hi-d/b ph b">值</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-集群配置__entry__1">maxMemSize</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-集群配置__entry__2">480GB</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-集群配置__entry__1">workerNum</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-集群配置__entry__2">128 个</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-集群配置__entry__1">TSDBCacheEngineSize</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-集群配置__entry__2">100GB</td></tr></tbody></table></div></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title6" id="23-模拟数据"><h3 class="- topic/title title topictitle3" id="ariaid-title6">2.3. 模拟数据</h3><div class="- topic/body body"></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title7" id="231-生成模拟数据"><h4 class="- topic/title title topictitle4" id="ariaid-title7">2.3.1. 生成模拟数据</h4><div class="- topic/body body"><p class="- topic/p p">模拟数据为物联网测点数据，有 4 个字段，分别是 id、time、v、q，一天 28.8 亿条数据。数据库按照日期（按天）、id（HASH 128）分区。每个分区约 2250 万条记录。具体脚本见附件。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title8" id="232-模拟数据查询"><h4 class="- topic/title title topictitle4" id="ariaid-title8">2.3.2. 模拟数据查询</h4><div class="- topic/body body"><p class="- topic/p p">我们模拟单个、20、40、60、100 个并发查询，查询内容为 4 天 1000 个随机 id 的点查询，理论上将包含 128x4 个分区。具体脚本见附件。</p></div></article></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title9" id="3-升级-glibc"><h2 class="- topic/title title topictitle2" id="ariaid-title9">3. 升级 glibc</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title10" id="31-查看本机-dolphindb-使用的-glibc-版本"><h3 class="- topic/title title topictitle3" id="ariaid-title10">3.1. 查看本机 DolphinDB 使用的 glibc 版本</h3><div class="- topic/body body"><p class="- topic/p p">执行以下命令</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>ldd dolphindb</code></pre><img class="- topic/image image" src="images/performance_optimization_based_on_glibc/01.png"/><br/><p class="- topic/p p">找到 libc.so.6 的位置，在终端执行</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>/lib64/libc.so.6</code></pre><p class="- topic/p p">得到版本为如图（2.17，低于 2.23）</p><img class="- topic/image image" src="images/performance_optimization_based_on_glibc/02.png"/><br/></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title11" id="32-下载或者编译高版本-glibc"><h3 class="- topic/title title topictitle3" id="ariaid-title11">3.2. 下载或者编译高版本 glibc</h3><div class="- topic/body body"></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title12" id="321-下载"><h4 class="- topic/title title topictitle4" id="ariaid-title12">3.2.1. 下载</h4><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">可自行下载对应系统高版本的 glibc 库和 libgcc 库后手工提取。</li><li class="- topic/li li">或下载 DolphinDB 提供的压缩包（glibc 版本 2.23，Centos 7）。</li><li class="- topic/li li">注意：可能存在兼容性问题。</li></ul><p class="- topic/p p"><a class="- topic/xref xref" href="script/performance_optimization_based_on_glibc/glibc-2.23.tar.gz">glibc-2.23.tar.gz</a></p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title13" id="322-编译"><h4 class="- topic/title title topictitle4" id="ariaid-title13">3.2.2. 编译</h4><div class="- topic/body body"><p class="- topic/p p">可以通过自行编译的方式解决高版本 glibc 的兼容性问题。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>#下载 glibc 源代码
git clone https://sourceware.org/git/glibc.git
cd glibc
git checkout glibc-2.23
mkdir build
cd build
#具体路径需要自己选择，不要不添加路径或者选择系统库的路径，避免系统 glibc 被覆盖
../configure --prefix=/home/thchen/glibc-2.23
# -j 后面的数字要低于或者等于自己 cpu 的核数
make -j12
make install
#编译运行需要把系统的 /lib64/libgcc_s.so.1 复制到 /home/thchen/glibc-2.23/lib 里
cp /lib64/libgcc_s.so.1 /home/thchen/glibc-2.23/lib</code></pre></div></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title14" id="33-解压高版本-glibc-到自定义位置"><h3 class="- topic/title title topictitle3" id="ariaid-title14">3.3. 解压高版本 glibc 到自定义位置</h3><div class="- topic/body body"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意事项</strong>：</p><ol class="- topic/ol ol"><li class="- topic/li li">不要解压到系统 lib64、根目录等路径覆盖系统 glibc。</li><li class="- topic/li li">不要添加自定义 glibc 文件夹到<code class="+ topic/ph pr-d/codeph ph codeph">LD_LIBRARY_PATH</code>环境变量。</li></ol><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>#当前位置为 /home/thchen
tar -zxvf glibc-2.23.tar.gz</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title15" id="34-下载-patchelf"><h3 class="- topic/title title topictitle3" id="ariaid-title15">3.4. 下载 patchelf</h3><div class="- topic/body body"><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>sudo yum install patchelf</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title16" id="35-文件备份"><h3 class="- topic/title title topictitle3" id="ariaid-title16">3.5. 文件备份</h3><div class="- topic/body body"><p class="- topic/p p">备份相关文件（<code class="+ topic/ph pr-d/codeph ph codeph">dolphindb </code>，<code class="+ topic/ph pr-d/codeph ph codeph">libDolphinDB.so</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libgfortran.so.3</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libopenblas.so.0</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libquadmath.so.0</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libstdc++.so.6</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libtcmalloc_minimal.so.4</code>）</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>#备份文件，需要到 dolphindb 可执行文件下的目录
cp dolphindb dolphindb.bak
cp libDolphinDB.so libDolphinDB.so.bak
cp libgfortran.so.3 libgfortran.so.3.bak
cp libopenblas.so.0 libopenblas.so.0.bak
cp libquadmath.so.0 libquadmath.so.0.bak
cp libstdc++.so.6 libstdc++.so.6.bak
cp libtcmalloc_minimal.so.4 libtcmalloc_minimal.so.4.bak</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title17" id="36-修改文件的-rpath-和-interpreter"><h3 class="- topic/title title topictitle3" id="ariaid-title17">3.6. 修改文件的 rpath 和 interpreter</h3><div class="- topic/body body"><ol class="- topic/ol ol"><li class="- topic/li li">关闭 DolphinDB</li><li class="- topic/li li">根据高版本 glibc 的路径，修改以下文件的 rpath：<code class="+ topic/ph pr-d/codeph ph codeph">dolphindb </code>，<code class="+ topic/ph pr-d/codeph ph codeph">libDolphinDB.so</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libgfortran.so.3</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libopenblas.so.0</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libquadmath.so.0</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libstdc++.so.6</code>，<code class="+ topic/ph pr-d/codeph ph codeph">libtcmalloc_minimal.so.4</code></li></ol><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>#修改 rpath，具体路径要看高版本 glibc 的路径
patchelf --set-interpreter /home/thchen/glibc-2.23/lib/ld-linux-x86-64.so.2 \
--set-rpath ./:/home/thchen/glibc-2.23/lib dolphindb
patchelf  --set-rpath ./:/home/thchen/glibc-2.23/lib libDolphinDB.so 
patchelf  --set-rpath ./:/home/thchen/glibc-2.23/lib libgfortran.so.3
patchelf  --set-rpath ./:/home/thchen/glibc-2.23/lib libopenblas.so.0
patchelf  --set-rpath ./:/home/thchen/glibc-2.23/lib libquadmath.so.0
patchelf  --set-rpath ./:/home/thchen/glibc-2.23/lib libstdc++.so.6
patchelf  --set-rpath ./:/home/thchen/glibc-2.23/lib libtcmalloc_minimal.so.4</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title18" id="37-验证-glibc-库路径"><h3 class="- topic/title title topictitle3" id="ariaid-title18">3.7. 验证 glibc 库路径</h3><div class="- topic/body body"><p class="- topic/p p">使用 ldd dolphindb 命令验证当前 glibc 库的路径。当运行结果显示其路径为高版本 glibc 路径时，说明前述修改成功。</p><img class="- topic/image image" src="images/performance_optimization_based_on_glibc/03.png"/><br/></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title19" id="4-性能测试与对比"><h2 class="- topic/title title topictitle2" id="ariaid-title19">4. 性能测试与对比</h2><div class="- topic/body body"><p class="- topic/p p">通过在升级前和升级后运行 2.3.2 节的模拟查询，我们得到了以下数据：</p><div class="table-container"><table class="- topic/table table" data-cols="4"><caption></caption><colgroup><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="4-性能测试与对比__entry__1"><strong class="+ topic/ph hi-d/b ph b">查询方法</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="4-性能测试与对比__entry__2"><strong class="+ topic/ph hi-d/b ph b">查询用时 (glibc 2.17)</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="4-性能测试与对比__entry__3"><strong class="+ topic/ph hi-d/b ph b">查询用时 (glibc 2.34)</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="4-性能测试与对比__entry__4"><strong class="+ topic/ph hi-d/b ph b">加速比</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__1">单查询</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__2">3,241 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__3">2,007 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__4">1.61</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__1">20 并发查询</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__2">33,346 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__3">15,313 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__4">2.18</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__1">40 并发查询</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__2">85,144 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__3">24,672 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__4">3.45</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__1">60 并发查询</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__2">134,065 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__3">28,793 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__4">4.66</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__1">100 并发查询</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__2">224,902ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__3">46,938 ms</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="4-性能测试与对比__entry__4">4.79</td></tr></tbody></table></div><p class="- topic/p p">通过升级 glibc，DolphinDB 前后查询加速比为 1.61 到 4.79 倍。在并发情况下性能提升更加明显。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title20" id="5-小结"><h2 class="- topic/title title topictitle2" id="ariaid-title20">5. 小结</h2><div class="- topic/body body"><p class="- topic/p p">针对高并发查询，当查询需要涉及多个分区时，如果查询任务积压但 CPU 利用率不高，可以先确定 glibc 的版本。如果 glibc 版本低于 2.23，则可以按照本方案进行升级，这可能会带来明显的性能提升。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title21" id="6-附件"><h2 class="- topic/title title topictitle2" id="ariaid-title21">6. 附件</h2><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><a class="- topic/xref xref" href="script/performance_optimization_based_on_glibc/testScript.zip">testScript.zip</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/performance_optimization_based_on_glibc/config.tar.gz">config.tar.gz</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/performance_optimization_based_on_glibc/glibc-2.23.tar.gz">glibc-2.23.tar.gz</a></li></ul></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E6%A6%82%E8%BF%B0" data-tocid="1-概述">1. 概述</a></li><li class="topic-item"><a href="#2-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%A8%A1%E6%8B%9F" data-tocid="2-环境配置与数据模拟">2. 环境配置与数据模拟</a><ul><li class="topic-item"><a href="#21-%E7%A1%AC%E4%BB%B6%E9%85%8D%E7%BD%AE" data-tocid="21-硬件配置">2.1. 硬件配置</a></li><li class="topic-item"><a href="#22-%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE" data-tocid="22-集群配置">2.2. 集群配置</a></li><li class="topic-item"><a href="#23-%E6%A8%A1%E6%8B%9F%E6%95%B0%E6%8D%AE" data-tocid="23-模拟数据">2.3. 模拟数据</a><ul><li class="topic-item"><a href="#231-%E7%94%9F%E6%88%90%E6%A8%A1%E6%8B%9F%E6%95%B0%E6%8D%AE" data-tocid="231-生成模拟数据">2.3.1. 生成模拟数据</a></li><li class="topic-item"><a href="#232-%E6%A8%A1%E6%8B%9F%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2" data-tocid="232-模拟数据查询">2.3.2. 模拟数据查询</a></li></ul></li></ul></li><li class="topic-item"><a href="#3-%E5%8D%87%E7%BA%A7-glibc" data-tocid="3-升级-glibc">3. 升级 glibc</a><ul><li class="topic-item"><a href="#31-%E6%9F%A5%E7%9C%8B%E6%9C%AC%E6%9C%BA-dolphindb-%E4%BD%BF%E7%94%A8%E7%9A%84-glibc-%E7%89%88%E6%9C%AC" data-tocid="31-查看本机-dolphindb-使用的-glibc-版本">3.1. 查看本机 DolphinDB 使用的 glibc 版本</a></li><li class="topic-item"><a href="#32-%E4%B8%8B%E8%BD%BD%E6%88%96%E8%80%85%E7%BC%96%E8%AF%91%E9%AB%98%E7%89%88%E6%9C%AC-glibc" data-tocid="32-下载或者编译高版本-glibc">3.2. 下载或者编译高版本 glibc</a><ul><li class="topic-item"><a href="#321-%E4%B8%8B%E8%BD%BD" data-tocid="321-下载">3.2.1. 下载</a></li><li class="topic-item"><a href="#322-%E7%BC%96%E8%AF%91" data-tocid="322-编译">3.2.2. 编译</a></li></ul></li><li class="topic-item"><a href="#33-%E8%A7%A3%E5%8E%8B%E9%AB%98%E7%89%88%E6%9C%AC-glibc-%E5%88%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BD%8D%E7%BD%AE" data-tocid="33-解压高版本-glibc-到自定义位置">3.3. 解压高版本 glibc 到自定义位置</a></li><li class="topic-item"><a href="#34-%E4%B8%8B%E8%BD%BD-patchelf" data-tocid="34-下载-patchelf">3.4. 下载 patchelf</a></li><li class="topic-item"><a href="#35-%E6%96%87%E4%BB%B6%E5%A4%87%E4%BB%BD" data-tocid="35-文件备份">3.5. 文件备份</a></li><li class="topic-item"><a href="#36-%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E7%9A%84-rpath-%E5%92%8C-interpreter" data-tocid="36-修改文件的-rpath-和-interpreter">3.6. 修改文件的 rpath 和 interpreter</a></li><li class="topic-item"><a href="#37-%E9%AA%8C%E8%AF%81-glibc-%E5%BA%93%E8%B7%AF%E5%BE%84" data-tocid="37-验证-glibc-库路径">3.7. 验证 glibc 库路径</a></li></ul></li><li class="topic-item"><a href="#4-%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%AF%B9%E6%AF%94" data-tocid="4-性能测试与对比">4. 性能测试与对比</a></li><li class="topic-item"><a href="#5-%E5%B0%8F%E7%BB%93" data-tocid="5-小结">5. 小结</a></li><li class="topic-item"><a href="#6-%E9%99%84%E4%BB%B6" data-tocid="6-附件">6. 附件</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>