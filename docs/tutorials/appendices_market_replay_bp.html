<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="一个量化策略在生产（交易）环境中运行时，实时数据的处理通常是由事件驱动的。为确保研发和生产使用同一套代码，通常在研发阶段需将历史数据，严格按照事件发生的时间顺序进行回放，以此模拟交易环境。在 DolphinDB 中，用户通过 replay ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="搭建行情回放服务的最佳实践"/><title>搭建行情回放服务的最佳实践</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;搭建行情回放服务的最佳实践&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;搭建行情回放服务的最佳实践&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;一个量化策略在生产（交易）环境中运行时，实时数据的处理通常是由事件驱动的。为确保研发和生产使用同一套代码，通常在研发阶段需将历史数据，严格按照事件发生的时间顺序进行回放，以此模拟交易环境。在 DolphinDB 中，用户通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;3:114&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replay&lt;/codeph&gt; 函数可以实现对静态数据的回放，即将历史数据按照时间顺序以“实时数据”的方式注入流数据表中。对相同时间戳的数据还可以指定额外排序列，使数据回放顺序更接近实时交易场景。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;在&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;data_replay.md&#34; xtrc=&#34;xref:1;5:2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;历史数据回放&lt;/xref&gt;、&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;stock_market_replay.md&#34; xtrc=&#34;xref:2;5:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;股票行情回放&lt;/xref&gt;两篇教程中已经介绍了 DolphinDB 的回放功能，本教程更加侧重于回放功能的工程化实践。本教程将介绍如何基于 DolphinDB 分布式数据库、回放功能以及 DolphinDB API 搭建一个行情数据回放服务，该服务支持多个用户同时通过 C++ 、 Python 等客户端提交数据回放请求。&lt;/p&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:104;139:90&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-基于-dolphindb-的行情回放服务&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;1. 基于 DolphinDB 的行情回放服务&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;本教程实现的行情回放服务基于 3 类国内 A 股行情数据源：逐笔委托数据、逐笔成交数据、Level 2 快照数据，支持以下功能与特性：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;C++、Python 客户端提交回放请求（指定回放股票列表 、回放日期、回放速率、回放数据源）&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;13:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;多个用户同时回放&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;14:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;多个数据源同时有序回放&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;在时间有序的基础上支持排序列有序（如：针对逐笔数据中的交易所原始消息记录号排序）&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;16:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;发布回放结束信号&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;对回放结果订阅消费&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;11-行情回放服务架构&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;1.1. 行情回放服务架构&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;本教程示例 DolphinDB 搭建的行情回放服务架构如下图所示：&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:1;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;行情回放服务架构&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;../stream/images/stock_market_replay_2.png&#34; xtrc=&#34;image:1;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; dita-ot:image-width=&#34;1487&#34; dita-ot:image-height=&#34;1410&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt; &lt;/fig&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;行情数据接入：实时行情数据和历史行情数据可以通过 DolphinDB API 或插件存储到 DolphinDB 分布式时序数据库中。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数模块封装：数据查询和回放过程可以通过 DolphinDB 函数视图封装内置，仅暴露股票列表 、回放日期、回放速率、回放数据源等关键参数给行情服务用户。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;30:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;行情用户请求：需要进行行情回放的用户可以通过 DolphinDB 客户端软件（如 DolphinDB GUI 工具、DolphinDB VS Code 插件、DolphinDB API 等）调用封装好的回放函数对存储在数据库中的行情数据进行回放，同时，用户还可以在客户端对回放结果进行实时订阅消费。此外，支持多用户并发回放。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;12-回放服务搭建步骤&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;1.2. 回放服务搭建步骤&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;34:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;本教程示例 DolphinDB 搭建行情回放服务的具体操作步骤如下图所示：&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:2;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;搭建步骤&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;../stream/images/stock_market_replay_3.png&#34; xtrc=&#34;image:2;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; dita-ot:image-width=&#34;1487&#34; dita-ot:image-height=&#34;542&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt; &lt;/fig&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:3;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Step 1：服务提供者设计合理分区的数据库表，在 DolphinDB 集成开发环境中执行对应的建库建表、数据导入等脚本，以将历史行情数据存储到 DolphinDB 分布式数据库中作为回放服务的数据源。在第二章将给出本教程涉及的 3 类行情数据的分区存储方案及建库建表脚本。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Step 2：服务提供者在 DolphinDB 集成开发环境中将回放过程中的操作封装成函数视图，通过封装使得行情服务用户不需要关心 DolphinDB 回放功能的细节，只需要指定简单的回放参数（股票、日期、回放速率、数据源）即可提交回放请求。在第三章将给全部函数视图的定义脚本。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Step 3：服务提供者在外部程序中通过 DolphinDB API 调用上述函数视图实现提交回放的功能。在第四章将给出 API 端提交回放任务的 C++ 实现和 Python 实现。此外，在第四章提交回放的基础上，在第五章将介绍对回放结果的 API 端订阅与消费的代码实现。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;在第六章将给出多用户多表回放、多天回放的性能测试结果。最后两章为开发环境配置与总结。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-行情数据分区存储方案&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;2. 行情数据分区存储方案&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;49:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;本教程的回放服务基于 3 类国内 A 股行情数据源：逐笔成交数据、逐笔委托数据、快照数据，均使用 TSDB 存储引擎存储在 DolphinDB 分布式数据库中。&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:1;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;6&#34; xtrc=&#34;tgroup:1;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:1;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:2;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:3;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:4;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col5&#34; colnum=&#34;5&#34; xtrc=&#34;colspec:5;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col6&#34; colnum=&#34;6&#34; xtrc=&#34;colspec:6;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:1;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:1;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:1;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;51:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;数据源&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:2;51:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;51:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;代码样例中的分区数据库路径&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:3;51:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;51:33&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;代码样例中的表名&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:4;51:47&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;51:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;分区机制&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:5;51:79&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;51:80&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;排序列&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:6;51:95&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;51:96&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;建库建表脚本&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:1;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:2;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:7;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;逐笔委托&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:8;53:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;dfs://Test_order&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:9;53:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;order&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:10;53:67&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;VALUE: 交易日, HASH: [SYMBOL, 25]&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:11;53:101&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;股票ID，交易时间&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:12;53:113&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;附录 &lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/order_create.txt&#34; xtrc=&#34;xref:3;53:117&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;逐笔委托建库建表脚本&lt;/xref&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:3;54:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:13;54:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;逐笔成交&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:14;54:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;dfs://Test_transaction&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:15;54:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;transaction&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:16;54:67&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;VALUE: 交易日, HASH: [SYMBOL, 25]&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:17;54:101&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;股票ID，交易时间&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:18;54:113&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;附录 &lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/transac_create.txt&#34; xtrc=&#34;xref:4;54:117&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;逐笔成交建库建表脚本&lt;/xref&gt;&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:4;55:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:19;55:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;快照&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:20;55:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;dfs://Test_snapshot&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:21;55:46&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshot&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:22;55:69&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;VALUE: 交易日, HASH: [SYMBOL, 20]&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:23;55:103&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;股票ID，交易时间&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:24;55:115&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;附录 &lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/snap_create.txt&#34; xtrc=&#34;xref:5;55:119&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;快照建库建表脚本&lt;/xref&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放的原理是从数据库中读取需要的行情数据，并根据时间列排序后写入到相应的流数据表。因此，读数据库并排序的性能对回放速度有很大的影响，合理的分区机制将有助于提高数据加载速度。基于用户通常按照日期和股票提交回放请求的特点，设计了上表的分区方案。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;此外，本教程的历史数据存储在三节点双副本的 DolphinDB 集群中，集群和副本同样可以提升读取性能，同时可以增加系统的可用性，分区的副本通常是存放在不同的物理节点的，所以一旦某个分区不可用，系统依然可以调用其它副本分区来保证回放服务的正常运转。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;附录将提供部分原始数据的 csv 文件（原始行情数据文件）以及对应的示例导入脚本（逐笔委托示例导入脚本、逐笔成交示例导入脚本、快照示例导入脚本），以便读者快速体验搭建本教程所示的行情回放服务。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-行情回放自定义函数&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;3. 行情回放自定义函数&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;本章介绍回放过程中的主要函数功能及其实现，最后将函数封装成视图以便通过 API 等方式调用。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;本章的开发工具采用 DolphinDB GUI，完整脚本见附录：&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/replay.txt&#34; xtrc=&#34;xref:6;67:33&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;行情回放函数&lt;/xref&gt;。&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:2;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrc=&#34;tgroup:2;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:7;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:8;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:9;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:2;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:5;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:25;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数名&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:26;69:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数入参&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:27;69:70&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数功能&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:2;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:6;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:28;71:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;stkReplay&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:29;71:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;stkList：回放股票列表startDate：回放开始日期endDate：回放结束日期replayRate：回放速率replayUuid：回放用户标识replayName：回放数据源名称&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:30;71:131&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;行情回放服务主函数&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:7;72:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:31;72:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;dsTb&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:32;72:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;timeRS：数据源时间划分startDate：回放开始日期endDate：回放结束日期stkList：回放股票列表replayName：回放数据源名称&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:33;72:109&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;构造回放数据源&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:8;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:34;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;createEnd&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:35;73:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;tabName：回放输出表名称sortColumn：相同时间戳时额外排序列名&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:36;73:59&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;构造回放结束信号&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:9;74:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:37;74:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replayJob&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:38;74:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;inputDict：回放输入数据源tabName：回放输出表名称dateDict：回放排序时间列timeDict：回放排序时间列replayRate：回放速率sortColumn：相同时间戳时额外排序列名&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:39;74:139&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;定义回放任务内容&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;31-stkreplay-函数行情回放服务主函数&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;76:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;76:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;3.1. stkReplay 函数：行情回放服务主函数&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;76:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;78:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数定义代码：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;80:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;def stkReplay(stkList, mutable startDate, mutable endDate, replayRate, replayUuid, replayName) { maxCnt = 50 returnBody = dict(STRING, STRING) startDate = datetimeParse(startDate, &#34;yyyyMMdd&#34;) endDate = datetimeParse(endDate, &#34;yyyyMMdd&#34;) + 1 sortColumn = &#34;ApplSeqNum&#34; if(stkList.size() &amp;gt; maxCnt) { returnBody[&#34;errorCode&#34;] = &#34;0&#34; returnBody[&#34;errorMsg&#34;] = &#34;超过单次回放股票上限，最大回放上限：&#34; + string(maxCnt) return returnBody } if(size(replayName) != 0) { for(name in replayName) { if(not name in [&#34;snapshot&#34;, &#34;order&#34;, &#34;transaction&#34;]) { returnBody[&#34;errorCode&#34;] = &#34;0&#34; returnBody[&#34;errorMsg&#34;] = &#34;请输入正确的数据源名称，不能识别的数据源名称：&#34; + name return returnBody } } } else { returnBody[&#34;errorCode&#34;] = &#34;0&#34; returnBody[&#34;errorMsg&#34;] = &#34;缺少回放数据源，请输入正确的数据源名称&#34; return returnBody } try { if(size(replayName) == 1 &amp;amp;&amp;amp; replayName[0] == &#34;snapshot&#34;) { colName = [&#34;timestamp&#34;, &#34;biz_type&#34;, &#34;biz_data&#34;] colType = [TIMESTAMP, SYMBOL, BLOB] sortColumn = &#34;NULL&#34; } else { colName = [&#34;timestamp&#34;, &#34;biz_type&#34;, &#34;biz_data&#34;, sortColumn] colType = [TIMESTAMP, SYMBOL, BLOB, LONG] } msgTmp = streamTable(10000000:0, colName, colType) tabName = &#34;replay_&#34; + replayUuid enableTableShareAndPersistence(table=msgTmp, tableName=tabName, asynWrite=true, compress=true, cacheSize=10000000, retentionMinutes=60, flushMode=0, preCache=1000000) timeRS = cutPoints(09:30:00.000..15:00:00.000, 23) inputDict = dict(replayName, each(dsTb{timeRS, startDate, endDate, stkList}, replayName)) dateDict = dict(replayName, take(`MDDate, replayName.size())) timeDict = dict(replayName, take(`MDTime, replayName.size())) jobId = &#34;replay_&#34; + replayUuid jobDesc = &#34;replay stock data&#34; submitJob(jobId, jobDesc, replayJob{inputDict, tabName, dateDict, timeDict, replayRate, sortColumn}) returnBody[&#34;errorCode&#34;] = &#34;1&#34; returnBody[&#34;errorMsg&#34;] = &#34;后台回放成功&#34; return returnBody } catch(ex) { returnBody[&#34;errorCode&#34;] = &#34;0&#34; returnBody[&#34;errorMsg&#34;] = &#34;回放行情数据异常，异常信息：&#34; + ex return returnBody } }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;151:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数功能：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;153:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;自定义函数 stkReplay 是整个回放的主体函数，用户传入的参数在 stkReplay 里会进行有效性判断及格式处理，可以根据实际需求更改。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;155:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;首先，用 maxCnt 来控制用户一次回放股票数量的最大上限，本例中设置的是 50 。returnBody 构造了信息字典，返回给用户以提示执行错误或执行成功。回放开始日期 startDate 和回放结束日期 endDate 利用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;155:116&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;datetimeParse&lt;/codeph&gt;函数进行格式处理 。replayRate 是回放速率，replayUuid 是回放表名名称，replayName 是回放数据源列表，sortColumn 是数据源同回放时间戳排序列列名。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;157:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;当输入参数无误后，便初始化回放结果流数据表，结果流数据表为异构流数据表，字段类型为 BLOB 的字段包含了一条原始记录的全部信息，同时结果流数据表为持久化流数据表，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;157:83&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;enableTableShareAndPersistence&lt;/codeph&gt;函数把流数据表共享并把它持久化到磁盘上，使用持久化流数据表可以避免内存占用过大。当回放数据源包含逐笔成交（transaction ）或逐笔委托（order）时，本例实现了对相同时间戳的逐笔数据按交易所原始消息记录号（ApplSeqNum）进行排序（具体实现见 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#replayjob-函数定义回放任务内容&#34; xtrc=&#34;xref:7;157:245&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;replayJob 函数&lt;/xref&gt;），所以结果流数据表中必须冗余一列来存放排序列。若回放数据源仅包含快照（snapshot）时，则不需要冗余一列排序列。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;定义回放需要的其他参数。inputDict 构造了回放数据源列表字典，利用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;159:39&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;each&lt;/codeph&gt;函数可以对多个数据源进行简洁的定义。dateDict 和 timeDict 构造了回放数据源时间戳字典。最后通过&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;159:101&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;submitJob&lt;/codeph&gt;提交后台回放任务。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;32-dstb-函数构造回放数据源&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;161:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;161:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;3.2. dsTb 函数：构造回放数据源&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;161:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;163:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数定义代码：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;165:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;def dsTb(timeRS, startDate, endDate, stkList, replayName) { if(replayName == &#34;snapshot&#34;){ tab = loadTable(&#34;dfs://Test_snapshot&#34;, &#34;snapshot&#34;) } else if(replayName == &#34;order&#34;) { tab = loadTable(&#34;dfs://Test_order&#34;, &#34;order&#34;) } else if(replayName == &#34;transaction&#34;) { tab = loadTable(&#34;dfs://Test_transaction&#34;, &#34;transaction&#34;) } else { return NULL } ds = replayDS(sqlObj=&amp;lt;select * from tab where MDDate&amp;gt;=startDate and MDDate&amp;lt;endDate and HTSCSecurityID in stkList&amp;gt;, dateColumn='MDDate', timeColumn='MDTime', timeRepartitionSchema=timeRS) return ds }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;185:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数功能：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;187:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;自定义函数 dsTb 返回符合用户回放需求的数据源划分结果。主要是对内置 replayDS 函数进行了进一步的封装，函数首先对用户端输入的 replayName 进行判断，选择从数据库加载对应的表对象。利用 replayDS 对交易日期在 startDate 至 endDate 之间、股票代号在 stkList 内的数据按照 timeRS 进行数据源划分，返回某一个数据源的列表。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;189:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;timeRS 参数对应 replayDS 函数中的 timeRepartitionSchema 参数，是时间类型的向量，可用于将数据源划分为更小粒度的多个数据源，以保证查询 DFS 表中数据的效率以及控制内存大小。本例在 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;markdown&#34; format=&#34;dita&#34; href=&#34;#stkreplay-函数行情回放服务主函数&#34; xtrc=&#34;xref:8;189:112&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;stkReplay 函数&lt;/xref&gt; 中构造了 timeRS 变量，其意为对于一天的数据在有效时间段内平均分为 23 份。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;191:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;执行如下代码查看 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;191:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;dsTb&lt;/codeph&gt; 函数返回的结果：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;193:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;timeRS = cutPoints(09:30:00.000..15:00:00.000, 3) startDate = 2021.12.01 endDate = 2021.12.02 stkList = ['000616.SZ'] replayName = [&#34;order&#34;] ds = dsTb(timeRS, startDate, endDate, stkList, replayName)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;202:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;ds 为一个向量，其中每一个元素如下，数据源被划分为多个小的 SQL 查询语句，具体原理参考&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;202:47&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replayDS&lt;/codeph&gt;函数。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;204:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;DataSource&amp;lt; select [4] * from tab where time(MDTime) &amp;lt; 09:30:00.000,nanotime(MDTime) &amp;gt;= 00:00:00.000000000,date(MDDate) == 2021.12.01,MDDate &amp;gt;= 2021.12.01 and MDDate &amp;lt; 2021.12.02 and SecurityID in [&#34;000616.SZ&#34;] order by MDDate asc,MDTime asc &amp;gt; DataSource&amp;lt; select [4] * from tab where time(MDTime) &amp;lt; 11:20:00.001,time(MDTime) &amp;gt;= 09:30:00.000,date(MDDate) == 2021.12.01,MDDate &amp;gt;= 2021.12.01 and MDDate &amp;lt; 2021.12.02 and SecurityID in [&#34;000616.SZ&#34;] order by MDDate asc,MDTime asc &amp;gt; DataSource&amp;lt; select [4] * from tab where time(MDTime) &amp;lt; 13:10:00.001,time(MDTime) &amp;gt;= 11:20:00.001,date(MDDate) == 2021.12.01,MDDate &amp;gt;= 2021.12.01 and MDDate &amp;lt; 2021.12.02 and SecurityID in [&#34;000616.SZ&#34;] order by MDDate asc,MDTime asc &amp;gt; DataSource&amp;lt; select [4] * from tab where time(MDTime) &amp;lt; 15:00:00.001,time(MDTime) &amp;gt;= 13:10:00.001,date(MDDate) == 2021.12.01,MDDate &amp;gt;= 2021.12.01 and MDDate &amp;lt; 2021.12.02 and SecurityID in [&#34;000616.SZ&#34;] order by MDDate asc,MDTime asc &amp;gt; DataSource&amp;lt; select [4] * from tab where nanotime(MDTime) &amp;lt;= 23:59:59.999999999,time(MDTime) &amp;gt;= 15:00:00.001,date(MDDate) == 2021.12.01,MDDate &amp;gt;= 2021.12.01 and MDDate &amp;lt; 2021.12.02 and SecurityID in [&#34;000616.SZ&#34;] order by MDDate asc,MDTime asc &amp;gt;&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;33-replayjob-函数定义回放任务内容&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;212:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;212:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;3.3. replayJob 函数：定义回放任务内容&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;212:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;214:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数定义代码：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;216:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;def replayJob(inputDict, tabName, dateDict, timeDict, replayRate, sortColumn) { if(sortColumn == &#34;NULL&#34;) { replay(inputTables=inputDict, outputTables=objByName(tabName), dateColumn=dateDict, timeColumn=timeDict, replayRate=int(replayRate), absoluteRate=false, parallelLevel=23) } else { replay(inputTables=inputDict, outputTables=objByName(tabName), dateColumn=dateDict, timeColumn=timeDict, replayRate=int(replayRate), absoluteRate=false, parallelLevel=23, sortColumns=sortColumn) } createEnd(tabName, sortColumn) }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;231:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数功能：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;233:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;自定义函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;233:7&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replayJob&lt;/codeph&gt; 提交用户数据回放并调用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;233:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;createEnd&lt;/codeph&gt; 函数，这里首先通过内置 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;233:55&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replay&lt;/codeph&gt; 函数回放用户需求数据，此处回放模式为 N 对 1 异构回放。&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;233:94&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replay&lt;/codeph&gt; 函数返回后即表示需要的数据已经全部回放结束，再执行自定义 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;233:132&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;createEnd&lt;/codeph&gt; 函数以构造结束信号写入回放结果里。调用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;233:164&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;createEnd&lt;/codeph&gt; 函数是可选的，其功能是在回放结束时再发布一条特殊的记录，以标识回放结束。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;参数 sortColumn 用于指定额外的排序列，如果用户回放的数据源为仅仅包含快照（snapshot），对于这种特殊情况需要指定 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;235:67&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replayJob&lt;/codeph&gt; 函数的回放时间戳排序列参数 sortColumn 为 NULL ，则调用内置的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;235:119&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replay&lt;/codeph&gt; 函数时不加入 sortColumn 参数。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;34-createend-函数构造回放结束信号&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;237:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;237:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;3.4. createEnd 函数：构造回放结束信号&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;237:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;239:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数定义代码：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;241:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;def createEnd(tabName, sortColumn) { dbName = &#34;dfs://End&#34; tbName = &#34;endline&#34; if(not existsDatabase(dbName)) { db = database(directory=dbName, partitionType=VALUE, partitionScheme=2023.04.03..2023.04.04) endTb = table(2200.01.01T23:59:59.000 as DateTime, `END as point, long(0) as ApplSeqNum) endLine = db.createPartitionedTable(table=endTb, tableName=tbName, partitionColumns=`DateTime) endLine.append!(endTb) } ds = replayDS(sqlObj=&amp;lt;select * from loadTable(dbName, tbName)&amp;gt;, dateColumn='DateTime', timeColumn='DateTime') inputEnd = dict([&#34;end&#34;], [ds]) dateEnd = dict([&#34;end&#34;], [`DateTime]) timeEnd = dict([&#34;end&#34;], [`DateTime]) if(sortColumn == &#34;NULL&#34;) { replay(inputTables=inputEnd, outputTables=objByName(tabName), dateColumn=dateEnd, timeColumn=timeEnd, replayRate=-1, absoluteRate=false, parallelLevel=1) } else { replay(inputTables=inputEnd, outputTables=objByName(tabName), dateColumn=dateEnd, timeColumn=timeEnd, replayRate=-1, absoluteRate=false, parallelLevel=1, sortColumns=sortColumn) } }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;270:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;函数功能：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;272:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;自定义函数 createEnd 是在回放结束时给用户提供一条回放结束信号，利用了 replay 回放模式中的 N 对 1 异构回放构造回放信号，会往参数 tabName 指定的异构流数据表中写入一条消息类型列为 end 的记录。为方便后期异构消费解析以及复用，此处为结束信号独立建一个数据库并创建分区表，表内必须有时间列，其他字段可选。并向该表写入一条模拟数据，其数据内容没有任何强制要求。DolphinDB 建库建表相关知识可参考&lt;xref class=&#34;- topic/xref &#34; href=&#34;../db_distr_comp/db/db_partitioning.dita&#34; xtrc=&#34;xref:9;272:217&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;数据分区&lt;/xref&gt; 。inputEnd、dateEnd、timeEnd 字典的 key 按需设置为字符串 end，将对应 replay 函数指定的输出表中的第二个字典，即消息类型。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;274:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;参数 sortColumn 用于指定额外的排序列，如果用户回放的数据源为仅仅包含快照（snapshot），则调用内置的 replay 函数时不加入 sortColumn 参数，结果流数据表中的结束信号记录如下。&lt;/p&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/appendices_market_replay_bp/3_1.png&#34; xtrc=&#34;image:3;276:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; dita-ot:image-width=&#34;278&#34; dita-ot:image-height=&#34;51&#34;/&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;35-封装函数视图&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;278:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;278:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;3.5. 封装函数视图&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;278:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;280:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;将以上函数利用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;280:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;addFunctionView&lt;/codeph&gt;封装成函数视图，具体代码如下。 API 端仅需要调用主函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:17;280:55&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;stkReplay&lt;/codeph&gt;，第四章回放全部基于该函数视图。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;282:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;addFunctionView(dsTb) addFunctionView(createEnd) addFunctionView(replayJob) addFunctionView(stkReplay)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;4-api-提交回放&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;289:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:14;289:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;4. API 提交回放&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;289:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;41-c-api&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;291:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:15;291:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;4.1. C++ API&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;291:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;293:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;本例程序运行在 Linux 系统 DolphinDB C++ API 环境下，编译成可执行文件以命令行输入参数执行。完整脚本见附录 &lt;xref class=&#34;- topic/xref &#34; format=&#34;cpp&#34; href=&#34;script/appendices_market_replay_bp/cpp_replay.cpp&#34; xtrc=&#34;xref:10;293:67&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;C++ 源码&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;411-c-api-调用回放服务&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:14;295:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:16;295:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;4.1.1. C++ API 调用回放服务&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:14;295:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;297:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;C++ API 调用回放服务代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;299:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;DictionarySP result = conn.run(&#34;stkReplay&#34;, args); string errorCode = result-&amp;gt;get(Util::createString(&#34;errorCode&#34;))-&amp;gt;getString(); if (errorCode != &#34;1&#34;) { std::cout &amp;lt;&amp;lt; result-&amp;gt;getString() &amp;lt;&amp;lt; endl; return -1; }&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;309:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;conn 是 DolphinDB C++ API DBConnection 对象， C++ 应用可以通过它在 DolphinDB 服务器上执行脚本和函数并在两者之间双向传递数据。conn 通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:18;309:98&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;run&lt;/codeph&gt; 方法调用 stkReplay 自定义函数，args 容器内包含了 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:19;309:137&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;stkReplay&lt;/codeph&gt; 函数所需的参数。执行结果返回到字典 result 中，可以通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:20;309:181&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;get&lt;/codeph&gt; 方法来获得 key 为 errorCode 对应的值，如果错误代号不为 1 ，则代表回放执行错误，返回错误信息并结束程序。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;311:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;多用户进行回放时，需要对用户回放的流数据表进行命名，为了不重复命名以避免冲突，对每个回放用户生成唯一识别号，会生成形如 “Eq8Jk8Dd0Tw5Ej8D” 的识别字符串，代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;313:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;string uuid(int len) { char* str = (char*)malloc(len + 1); srand(getpid()); for (int i = 0; i &amp;lt; len; ++i) { switch (i % 3) { case 0: str[i] = 'A' + std::rand() % 26; break; case 1: str[i] = 'a' + std::rand() % 26; break; default: str[i] = '0' + std::rand() % 10; break; } } str[len] = '\0'; std::string rst = str; free(str); return rst; }&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;42-python-api&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:15;340:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:17;340:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;4.2. Python API&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:15;340:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;342:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;本例程序运行在 Windows 系统 DolphinDB Python API 环境下，可以在任何具备该环境的客户端执行。完整脚本见附录 &lt;xref class=&#34;- topic/xref &#34; format=&#34;py&#34; href=&#34;script/appendices_market_replay_bp/python_replay.py&#34; xtrc=&#34;xref:11;342:70&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;Python 源码&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;421-python-api-调用回放服务&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:16;344:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:18;344:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;4.2.1. Python API 调用回放服务&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:16;344:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;346:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Python API 调用回放服务代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;348:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;stk_list = ['000616.SZ','000681.SZ'] start_date = '20211201' end_date = '20211201' replay_rate = -1 replay_name = ['snapshot'] s.upload({'stk_list':stk_list, 'start_date':start_date, 'end_date':end_date, 'replay_rate':replay_rate, 'replay_uuid':uuidStr, 'replay_name':replay_name}) s.run(&#34;stkReplay(stk_list, start_date, end_date, replay_rate, replay_uuid, replay_name)&#34;)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;358:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;stk_list 是回放股票列表，start_date 是回放开始日期，end_date 是回放结束日期，replay_rate 是回放速率，replay_uuid 是回放流数据表名称，replay_name 是回放数据源列表。s 是 DolphinDB 会话，Python 应用通过会话在 DolphinDB 服务器上执行脚本和函数以及在两者之间双向传递数据。使用 s 的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:21;358:189&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;upload&lt;/codeph&gt; 方法上传 Python 对象，使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:22;358:216&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;run&lt;/codeph&gt; 方法执行 stkReplay 函数。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;360:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;多用户进行回放时，需要对用户回放的流数据表进行命名，为了不重复命名以避免冲突，对每个回放用户生成唯一识别号，会生成形如“Eq8Jk8Dd0Tw5Ej8D”的识别字符串，代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;362:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;def uuid(length): str=&#34;&#34; for i in range(length): if(i % 3 == 0): str += chr(ord('A') + random.randint(0, os.getpid() + 1) % 26) elif(i % 3 == 1): str += chr(ord('a') + random.randint(0, os.getpid() + 1) % 26) else: str += chr(ord('0') + random.randint(0, os.getpid() + 1) % 10) return str uuidStr = uuid(16)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;5-api-订阅消费&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:17;377:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:19;377:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5. API 订阅消费&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:17;377:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;51-c-api&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:18;379:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:20;379:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.1. C++ API&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:18;379:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;511-反序列化器构造&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:19;381:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:21;381:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.1.1. 反序列化器构造&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:19;381:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;383:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;为使异构流数据表反序列化输出，构造输出表结构，代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:12;385:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;DictionarySP snap_full_schema = conn.run(&#34;loadTable(\&#34;dfs://Test_snapshot\&#34;, \&#34;snapshot\&#34;).schema()&#34;); DictionarySP order_full_schema = conn.run(&#34;loadTable(\&#34;dfs://Test_order\&#34;, \&#34;order\&#34;).schema()&#34;); DictionarySP transac_full_schema = conn.run(&#34;loadTable(\&#34;dfs://Test_transaction\&#34;, \&#34;transaction\&#34;).schema()&#34;); DictionarySP end_full_schema = conn.run(&#34;loadTable(\&#34;dfs://End\&#34;, \&#34;endline\&#34;).schema()&#34;); unordered_map&amp;lt;string, DictionarySP&amp;gt; sym2schema; sym2schema[&#34;snapshot&#34;] = snap_full_schema; sym2schema[&#34;order&#34;] = order_full_schema; sym2schema[&#34;transaction&#34;] = transac_full_schema; sym2schema[&#34;end&#34;] = end_full_schema; StreamDeserializerSP sdsp = new StreamDeserializer(sym2schema);&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:43;399:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;上述前四行分别是快照、逐笔委托、逐笔成交、结束信号的表结构构造，回放根据需要选择对应的表结构，结束信号表必须有。unordered_map 创建了 key-&amp;gt;schema 的映射表，可以将回放数据源和结束信号按照 schema 进行结构解析。通过 StreamDeserializer 对象来构造异构流数据表反序列化器。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;512-订阅回放服务&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:20;401:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:22;401:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.1.2. 订阅回放服务&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:20;401:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:44;403:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;在 DolphinDB C++ API 中订阅异构流数据表，代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:13;405:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;int listenport = 10260; ThreadedClient threadedClient(listenport); string tableNameUuid = &#34;replay_&#34; + uuidStr; auto thread = threadedClient.subscribe(hostName, port, myHandler, tableNameUuid, &#34;stkReplay&#34;, 0, true, nullptr, true, 500000, 0.001, false, &#34;admin&#34;, &#34;123456&#34;, sdsp); std::cout &amp;lt;&amp;lt; &#34;Successed to subscribe &#34; + tableNameUuid &amp;lt;&amp;lt; endl; thread-&amp;gt;join();&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:45;414:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;listenport 是单线程客户端的订阅端口号，tableNameUuid 是用户回放的流数据表名称，通过 threadedClient.subscribe 可以订阅回放的流数据表，详情用法参考 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/cppdoc/cpp_api.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:12;414:101&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;C++ API&lt;/xref&gt;。thread 指向循环调用 myHandler 的线程的指针，线程在 topic 被取消订阅后会退出。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;513-消费函数构造&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:21;416:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:23;416:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.1.3. 消费函数构造&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:21;416:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:46;418:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;调用订阅函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:23;418:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;threadedClient.subscribe&lt;/codeph&gt; 订阅异构流数据表时，在最后一个参数指定相应的流数据反序列化实例 StreamDeserializerSP ，在订阅时会对收到的数据进行反序列化再传递给用户自定义的回调函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:24;418:121&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;myHandler&lt;/codeph&gt;，用户可以在回调函数内自定义消费，本文仅实现了简单的输出消费，当消息 msg 的标识为 end 时，通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:25;418:185&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;threadedClient.unsubscribe&lt;/codeph&gt; 取消订阅，代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:14;420:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;long sumcount = 0; long long starttime = Util::getNanoEpochTime(); auto myHandler = [&amp;amp;](vector&amp;lt;Message&amp;gt; msgs) { for (auto&amp;amp; msg : msgs) { std::cout &amp;lt;&amp;lt; msg.getSymbol() &amp;lt;&amp;lt; &#34; : &#34; &amp;lt;&amp;lt; msg-&amp;gt;getString() &amp;lt;&amp;lt; endl; if(msg.getSymbol() == &#34;end&#34;) { threadedClient.unsubscribe(hostName, port, tableNameUuid,&#34;stkReplay&#34;); } sumcount += msg-&amp;gt;get(0)-&amp;gt;size(); } long long speed = (Util::getNanoEpochTime() - starttime) / sumcount; std::cout &amp;lt;&amp;lt; &#34;callback speed: &#34; &amp;lt;&amp;lt; speed &amp;lt;&amp;lt; &#34;ns&#34; &amp;lt;&amp;lt; endl; };&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;514-程序执行&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:22;439:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:24;439:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.1.4. 程序执行&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:22;439:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:47;441:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;将如上 C++ 程序代码写入 main.cpp 中，在 DolphinDB C++ API 环境下编译成可执行文件 main ，按照如下命令格式输入，回车，即可开始“回放-订阅-消费”过程。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:48;443:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;单支股票最大速度回放 “order“ 表一天数据命令：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:15;445:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;$ ./main 000616.SZ 20211201 20211201 -1 order&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:49;449:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;两支(多支)股票最大速度回放三张表一天数据命令：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:16;450:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;$ ./main 000616.SZ,000681.SZ 20211201 20211201 -1 snapshot,order,transaction&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;515-消费输出&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:23;453:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:25;453:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.1.5. 消费输出&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:23;453:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:50;455:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;根据前文构造的消费函数，两支股票（“000616.SZ” &amp;amp;“000681.SZ”）最大速度回放三张表一天数据输出如下图所示：&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:3;457:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:26;457:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;消费输出结果&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/appendices_market_replay_bp/5_1.png&#34; width=&#34;70%&#34; xtrc=&#34;image:4;457:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; dita-ot:image-width=&#34;1606&#34; dita-ot:image-height=&#34;916&#34;/&gt; &lt;/fig&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;52-python-api&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:24;464:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:27;464:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.2. Python API&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:24;464:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;521-反序列化器构造&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:25;466:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:28;466:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.2.1. 反序列化器构造&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:25;466:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:51;468:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;为使异构流数据表反序列化输出，Python API 通过 streamDeserializer 类来构造异构流数据表反序列化器，同时定义输出表结构，代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:17;470:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;sd = ddb.streamDeserializer({ 'snapshot': [&#34;dfs://Test_snapshot&#34;, &#34;snapshot&#34;], 'order': [&#34;dfs://Test_order&#34;, &#34;order&#34;], 'transaction': [&#34;dfs://Test_transaction&#34;, &#34;transaction&#34;], 'end': [&#34;dfs://End&#34;, &#34;endline&#34;], }, s)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:52;479:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;上述主体部分分别是快照、逐笔委托、逐笔成交、结束信号的表结构构造，回放根据需要选择对应的表结构，结束信号表必须有。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;522-python-api-订阅回放服务&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:26;481:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:29;481:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.2.2. Python API 订阅回放服务&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:26;481:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:53;483:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;在 DolphinDB Python API 中订阅异构流数据表，代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:18;485:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;s.enableStreaming(0) s.subscribe(host=hostname, port=portname, handler=myHandler, tableName=&#34;replay_&#34;+uuidStr, actionName=&#34;replay_stock_data&#34;, offset=0, resub=False, msgAsTable=False, streamDeserializer=sd, userName=&#34;admin&#34;, password=&#34;123456&#34;) event.wait()&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:54;491:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:26;491:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;enableStreaming&lt;/codeph&gt; 函数启用流数据功能，函数参数指定开启数据订阅的端口。s 使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:27;491:50&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;subscribe&lt;/codeph&gt; 函数来订阅 DolphinDB 中的流数据表。订阅是异步执行的，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:28;491:94&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;event.wait()&lt;/codeph&gt; 保持主线程不退出。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;523-消费函数构造&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:27;493:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:30;493:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.2.3. 消费函数构造&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:27;493:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:55;495:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;调用订阅函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:29;495:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;s.subscribe&lt;/codeph&gt; 订阅异构流数据表时，在参数指定相应的流数据反序列化实例 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:30;495:50&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;streamDeserializer&lt;/codeph&gt;,在订阅时会对收到的数据进行反序列化再传递给用户自定义的回调函数 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:31;495:103&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;myHandler&lt;/codeph&gt;，用户可以在回调函数内自定义消费，仅输出消费代码如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:19;497:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;def myHandler(lst): if lst[-1] == &#34;snapshot&#34;: print(&#34;SNAPSHOT: &#34;, lst) elif lst[-1] == 'order': print(&#34;ORDER: &#34;, lst) elif lst[-1] == 'transaction': print(&#34;TRANSACTION: &#34;, lst) else: print(&#34;END: &#34;, lst) event.set()&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;524-消费输出&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:28;510:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:31;510:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;5.2.4. 消费输出&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:28;510:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:56;512:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;根据前文构造的消费函数，两支股票（“000616.SZ” &amp;amp;“000681.SZ”）最大速度回放三张表一天数据输出如下图所示：&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:4;514:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:32;514:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;消费输出结果&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/appendices_market_replay_bp/5_2.png&#34; width=&#34;70%&#34; xtrc=&#34;image:5;514:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; dita-ot:image-width=&#34;1849&#34; dita-ot:image-height=&#34;647&#34;/&gt; &lt;/fig&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;6-性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:29;521:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:33;521:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;6. 性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:29;521:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:57;523:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;测试的交易日范围从 2021 年 12 月 1 日至 12 月 9 日共 7 个连续交易日。测试脚本见附录：&lt;xref class=&#34;- topic/xref &#34; format=&#34;cpp&#34; href=&#34;script/appendices_market_replay_bp/cpp_replay_test.cpp&#34; xtrc=&#34;xref:13;523:55&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;C++ 测试源码&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;7-测试服务器配置&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:30;525:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:34;525:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;7. 测试服务器配置&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:30;525:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:3;527:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;2&#34; xtrc=&#34;tgroup:3;527:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:10;527:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:11;527:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:3;527:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:10;527:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:40;527:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;CPU 类型&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:41;527:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Intel(R) Xeon(R) Silver 4216 CPU @ 2.10GHz&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:3;529:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:11;529:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:42;529:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;逻辑 CPU 总数&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:43;529:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;64&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:12;530:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:44;530:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;内存&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:45;530:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;503 GB&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:13;531:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:46;531:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;硬盘&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:47;531:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;SSD&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:14;532:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:48;532:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;OS&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:49;532:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;CentOS Linux release 7.9.2009 (Core)&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:15;533:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:50;533:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;DolphinDB Server 版本&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:51;533:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;2.00.9.3 2023.03.29&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;71-50-支深交所股票一天全速并发回放性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:31;535:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:35;535:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;7.1. 50 支深交所股票一天全速并发回放性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:31;535:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:58;537:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;测试方法：选取深交所 2021 年 12 月 1 日 50 支交易股票数据，linux 后台同时启动多个第四章 C++ API 提交回放程序，提交多个并发回放任务。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:4;539:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;539:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放耗时=所有回放任务最晚结束时间-所有回放任务最早收到时间&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;540:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放速率=所有用户回放数据量总和/回放耗时&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;541:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;平均单个用户回放耗时=（所有回放任务结束时间和-所有回放任务开始时间和）/并发数量&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;542:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;平均单个用户回放速率=单个用户回放数据量/平均单个用户回放耗时&lt;/li&gt;&lt;/ul&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:4;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;7&#34; xtrc=&#34;tgroup:4;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:12;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:13;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:14;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:15;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col5&#34; colnum=&#34;5&#34; xtrc=&#34;colspec:16;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col6&#34; colnum=&#34;6&#34; xtrc=&#34;colspec:17;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col7&#34; colnum=&#34;7&#34; xtrc=&#34;colspec:18;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:4;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:16;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:52;544:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;并发数量&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:53;544:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;数据源&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:54;544:41&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;数据量&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:55;544:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放耗时&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:56;544:62&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放速率&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:57;544:69&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;单个用户回放耗时（平均）&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:58;544:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;单个用户回放速率（平均）&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:4;546:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:17;546:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:59;546:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:60;546:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransactionorder&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:61;546:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;2,775,129行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:62;546:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约2.669s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:63;546:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约104w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:64;546:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约2.669s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:65;546:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约104w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:18;547:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:66;547:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;10&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:67;547:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransactionorder&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:68;547:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;27,751,290行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:69;547:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约10.161s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:70;547:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约273w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:71;547:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约8.482s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:72;547:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约32w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:19;548:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:73;548:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;20&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:74;548:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransactionorder&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:75;548:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;55,502,580行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:76;548:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约18.761s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:77;548:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约296w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:78;548:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约16.728s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:79;548:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约16w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:20;549:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:80;549:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;40&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:81;549:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransactionorder&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:82;549:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;111,005,160行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:83;549:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约35.537s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:84;549:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约312w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:85;549:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约19.091s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:86;549:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约14w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:21;550:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:87;550:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:88;550:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransaction&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:89;550:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;1,416,548行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:90;550:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约2.003s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:91;550:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约70w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:92;550:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约2.003s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:93;550:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约70w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:22;551:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:94;551:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;10&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:95;551:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransaction&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:96;551:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;14,165,480行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:97;551:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约7.155s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:98;551:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约198w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:99;551:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约6.382s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:100;551:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约22w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:23;552:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:101;552:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;20&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:102;552:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransaction&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:103;552:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;28,330,960行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:104;552:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约13.115s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:105;552:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约216w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:106;552:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约11.436s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:107;552:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约12w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:24;553:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:108;553:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;40&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:109;553:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransaction&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:110;553:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;56,661,920行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:111;553:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约27.003s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:112;553:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约210w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:113;553:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约13.740s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:114;553:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约10w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:25;554:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:115;554:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;1&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:116;554:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshot&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:117;554:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;194,045行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:118;554:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约1.387s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:119;554:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约14w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:120;554:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约1.387s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:121;554:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约14w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:26;555:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:122;555:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;10&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:123;555:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshot&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:124;555:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;1,940,450行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:125;555:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约6.428s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:126;555:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约30w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:127;555:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约5.128s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:128;555:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约4w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:27;556:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:129;556:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;20&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:130;556:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshot&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:131;556:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;3,880,900行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:132;556:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约11.782s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:133;556:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约33w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:134;556:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约10.539s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:135;556:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约2w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:28;557:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;13&#34; xtrc=&#34;entry:136;557:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;40&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;13&#34; xtrc=&#34;entry:137;557:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshot&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;13&#34; xtrc=&#34;entry:138;557:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;7,761,800行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;13&#34; xtrc=&#34;entry:139;557:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约23.274s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col5&#34; dita-ot:x=&#34;5&#34; dita-ot:y=&#34;13&#34; xtrc=&#34;entry:140;557:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约33w/s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col6&#34; dita-ot:x=&#34;6&#34; dita-ot:y=&#34;13&#34; xtrc=&#34;entry:141;557:84&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约12.393s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col7&#34; dita-ot:x=&#34;7&#34; dita-ot:y=&#34;13&#34; xtrc=&#34;entry:142;557:110&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约1w/s&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;72-50-支深交所股票跨天全速回放性能测试&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:32;559:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:36;559:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;7.2. 50 支深交所股票跨天全速回放性能测试&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:32;559:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:59;561:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;测试方法：选取深交所 50 支交易股票数据，linux 后台启动第四章 C++ API 提交回放程序，提交多天回放任务。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:5;563:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;563:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放耗时=回放任务结束时间-回放任务收到时间&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;564:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放速率=回放数据量/回放耗时&lt;/li&gt;&lt;/ul&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:5;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;4&#34; xtrc=&#34;tgroup:5;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:19;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:20;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:21;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:22;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:5;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:29;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:143;566:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;数据源&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:144;566:34&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;数据量&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:145;566:52&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放耗时&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:146;566:60&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;回放速率&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:5;568:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:30;568:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:147;568:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransactionorder&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:148;568:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;一天：2,775,129行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:149;568:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约2.925s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:150;568:65&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约95w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:31;569:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:151;569:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransactionorder&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:152;569:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;一周：17,366,642行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:153;569:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约16.393s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:154;569:65&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约106w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:32;570:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:155;570:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransaction&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:156;570:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;一天：1,416,548行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:157;570:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约1.912s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:158;570:65&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约74w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:33;571:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:159;571:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshottransaction&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:160;571:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;一周：8,899,562行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:161;571:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约9.142s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:162;571:65&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约97w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:34;572:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:163;572:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshot&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:164;572:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;一天：194,045行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:165;572:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约1.267s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:166;572:65&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约15w/s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:35;573:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:167;573:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;snapshot&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:168;573:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;一周：1,279,869行&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:169;573:54&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约6.659s&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:170;573:65&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;约19w/s&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;8-开发环境配置&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:33;575:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:37;575:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;8. 开发环境配置&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:33;575:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;81-部署-dolphindb-server&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:34;577:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:38;577:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;8.1. 部署 DolphinDB Server&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:34;577:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:6;579:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;579:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Server 版本：2.00.9.3 2023.03.29&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;580:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Server 部署模式：单服务器集群&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;581:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;配置文件：&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:1;581:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;cluster.cfg&lt;/i&gt;&lt;/li&gt;&lt;/ul&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:20;583:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;maxMemSize=128 maxConnections=5000 workerNum=24 webWorkerNum=2 chunkCacheEngineMemSize=16 newValuePartitionPolicy=add logLevel=INFO maxLogSize=512 node1.volumes=/ssd/ssd3/pocTSDB/volumes/node1,/ssd/ssd4/pocTSDB/volumes/node1 node2.volumes=/ssd/ssd5/pocTSDB/volumes/node2,/ssd/ssd6/pocTSDB/volumes/node2 node3.volumes=/ssd/ssd7/pocTSDB/volumes/node3,/ssd/ssd8/pocTSDB/volumes/node3 diskIOConcurrencyLevel=0 node1.redoLogDir=/ssd/ssd3/pocTSDB/redoLog/node1 node2.redoLogDir=/ssd/ssd4/pocTSDB/redoLog/node2 node3.redoLogDir=/ssd/ssd5/pocTSDB/redoLog/node3 node1.chunkMetaDir=/ssd/ssd3/pocTSDB/metaDir/chunkMeta/node1 node2.chunkMetaDir=/ssd/ssd4/pocTSDB/metaDir/chunkMeta/node2 node3.chunkMetaDir=/ssd/ssd5/pocTSDB/metaDir/chunkMeta/node3 node1.persistenceDir=/ssd/ssd6/pocTSDB/persistenceDir/node1 node2.persistenceDir=/ssd/ssd7/pocTSDB/persistenceDir/node2 node3.persistenceDir=/ssd/ssd8/pocTSDB/persistenceDir/node3 maxPubConnections=128 subExecutors=24 subThrottle=1 persistenceWorkerNum=1 node1.subPort=8825 node2.subPort=8826 node3.subPort=8827 maxPartitionNumPerQuery=200000 streamingHAMode=raft streamingRaftGroups=2:node1:node2:node3 node1.streamingHADir=/ssd/ssd6/pocTSDB/streamingHADir/node1 node2.streamingHADir=/ssd/ssd7/pocTSDB/streamingHADir/node2 node3.streamingHADir=/ssd/ssd8/pocTSDB/streamingHADir/node3 TSDBCacheEngineSize=16 TSDBCacheEngineCompression=false node1.TSDBRedoLogDir=/ssd/ssd3/pocTSDB/TSDBRedoLogDir/node1 node2.TSDBRedoLogDir=/ssd/ssd4/pocTSDB/TSDBRedoLogDir/node2 node3.TSDBRedoLogDir=/ssd/ssd5/pocTSDB/TSDBRedoLogDir/node3 TSDBLevelFileIndexCacheSize=20 TSDBLevelFileIndexCacheInvalidPercent=0.6 lanCluster=0 enableChunkGranularityConfig=true&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:60;629:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:7;629:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;注意&lt;/b&gt;： 路径配置参数需要开发人员根据实际环境配置。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:61;631:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;有关单服务器集群部署教程，请参考：&lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;single_machine_cluster_deploy.md&#34; xtrc=&#34;xref:14;631:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;单服务器集群部署&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;82-dolphindb-client-开发环境&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:35;633:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:39;633:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;8.2. DolphinDB client 开发环境&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:35;633:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:7;635:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:22;635:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;CPU 类型：Intel(R) Core(TM) i5-11500 @ 2.70GHz 2.71 GHz&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:23;636:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;逻辑 CPU 总数：12&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:24;637:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;内存：16GB&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:25;638:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;OS：Windows 11 专业版&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:26;639:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;DolphinDB GUI 版本：1.30.20.1&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;83-dolphindb-c-api-安装&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:36;642:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:40;642:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;8.3. DolphinDB C++ API 安装&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:36;642:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:8;644:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:27;644:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;C++ API 版本：release200.9&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:62;646:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:8;646:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;注意&lt;/b&gt;： C++ API 版本建议按 DolphinDB server 版本选择，如 2.00.9 版本的 server 安装 release200.9 分支的 API&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;84-dolphindb-python-api-安装&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:37;649:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:41;649:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;8.4. DolphinDB Python API 安装&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:37;649:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:9;651:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:28;651:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Python API 版本：1.30.21.1&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:29;652:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;Python API 教程：&lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://docs.dolphindb.cn/zh/pydoc/py.html&#34; scope=&#34;external&#34; xtrc=&#34;xref:15;652:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;Python API 教程&lt;/xref&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;9-路线图-roadmap&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:38;656:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:42;656:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;9. 路线图 (Roadmap)&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:38;656:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:10;658:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:30;658:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;在后续版本中，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:32;658:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replay&lt;/codeph&gt; 函数将支持原速回放，即严格以两条记录的时间戳之差为输出间隔向下游注入数据；&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:31;659:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;在后续版本中，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:33;659:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;replay&lt;/codeph&gt; 函数将支持原速倍速回放，即严格以两条记录的时间戳之差为输出间隔进行倍速再向下游注入数据。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;10-附录&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:39;661:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:43;661:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;10. 附录&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:39;661:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:63;663:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;附录中的压缩包包含以下文件：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:11;665:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:32;665:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;zip&#34; href=&#34;https://www.dolphindb.cn/downloads/docs/appendices_market_replay_bp_data.zip&#34; scope=&#34;external&#34; xtrc=&#34;xref:16;665:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;原始行情数据文件&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:33;666:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/order_create.txt&#34; xtrc=&#34;xref:17;666:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;逐笔委托建库建表脚本&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:34;667:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/transac_create.txt&#34; xtrc=&#34;xref:18;667:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;逐笔成交建库建表脚本&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:35;668:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/snap_create.txt&#34; xtrc=&#34;xref:19;668:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;快照建库建表脚本&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:36;669:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/order_upload.txt&#34; xtrc=&#34;xref:20;669:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;逐笔委托示例导入脚本&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:37;670:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/transac_upload.txt&#34; xtrc=&#34;xref:21;670:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;逐笔成交示例导入脚本&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:38;671:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/snap_upload.txt&#34; xtrc=&#34;xref:22;671:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;快照示例导入脚本&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:39;672:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;txt&#34; href=&#34;script/appendices_market_replay_bp/replay.txt&#34; xtrc=&#34;xref:23;672:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;行情回放函数&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:40;673:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;cpp&#34; href=&#34;script/appendices_market_replay_bp/cpp_replay.cpp&#34; xtrc=&#34;xref:24;673:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;C++ 源码&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:41;674:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;py&#34; href=&#34;script/appendices_market_replay_bp/python_replay.py&#34; xtrc=&#34;xref:25;674:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;Python 源码&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:42;675:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;xref class=&#34;- topic/xref &#34; format=&#34;cpp&#34; href=&#34;script/appendices_market_replay_bp/cpp_replay_test.cpp&#34; xtrc=&#34;xref:26;675:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/appendices_market_replay_bp.md&#34;&gt;&lt;?ditaot usertext?&gt;C++ 测试源码&lt;/xref&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/appendices_market_replay_bp.md"/><meta name="wh-out-relpath" content="tutorials/appendices_market_replay_bp.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="搭建行情回放服务的最佳实践" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/OHLC_2.html">金融场景案例</a></div></div></li><li class="active"><div class="topicref" data-id="搭建行情回放服务的最佳实践"><div class="title"><a href="../tutorials/appendices_market_replay_bp.html">搭建行情回放服务的最佳实践</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="k-线计算-d9713e102569" class="topicref" data-id="k-线计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="k-线计算-d9713e102569-link">K 线计算</a></div></div></li><li role="treeitem"><div data-tocid="使用-klinechart-展示-dolphindb-k-线-d9713e102615" class="topicref" data-id="使用-klinechart-展示-dolphindb-k-线" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/displaying_the_dolphindb_k-line_with_klinechart.html" id="使用-klinechart-展示-dolphindb-k-线-d9713e102615-link">使用 KLineChart 展示 DolphinDB K 线</a></div></div></li><li role="treeitem"><div data-tocid="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比-d9713e102661" class="topicref" data-id="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Python_HDF5_vs_DolphinDB.html" id="python--hdf5-因子计算与-dolphindb-一体化因子计算方案对比-d9713e102661-link">Python + HDF5 因子计算与 DolphinDB 一体化因子计算方案对比</a></div></div></li><li role="treeitem"><div data-tocid="python--文件存储与-dolphindb-因子计算性能比较-d9713e102707" class="topicref" data-id="python--文件存储与-dolphindb-因子计算性能比较" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/DolphinDB_VS_PythonFile_Storage.html" id="python--文件存储与-dolphindb-因子计算性能比较-d9713e102707-link">Python + 文件存储与 DolphinDB 因子计算性能比较</a></div></div></li><li role="treeitem"><div data-tocid="python-parser-在金融量化分析场景的应用入门-d9713e102753" class="topicref" data-id="python-parser-在金融量化分析场景的应用入门" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/py_parser__quant_fin.html" id="python-parser-在金融量化分析场景的应用入门-d9713e102753-link">Python Parser 在金融量化分析场景的应用入门</a></div></div></li><li role="treeitem"><div data-tocid="处理-level-2-行情数据实例-d9713e102799" class="topicref" data-id="处理-level-2-行情数据实例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/l2_stk_data_proc_2.html" id="处理-level-2-行情数据实例-d9713e102799-link">处理 Level-2 行情数据实例</a></div></div></li><li role="treeitem"><div data-tocid="存储金融数据的分区方案最佳实践-d9713e102845" class="topicref" data-id="存储金融数据的分区方案最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practices_for_partitioned_storage.html" id="存储金融数据的分区方案最佳实践-d9713e102845-link">存储金融数据的分区方案最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="公募基金历史数据基础分析教程-d9713e102891" class="topicref" data-id="公募基金历史数据基础分析教程" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/public_fund_basic_analysis.html" id="公募基金历史数据基础分析教程-d9713e102891-link">公募基金历史数据基础分析教程</a></div></div></li><li role="treeitem"><div data-tocid="股票行情回放-d9713e102937" class="topicref" data-id="股票行情回放" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stock_market_replay_2.html" id="股票行情回放-d9713e102937-link">股票行情回放</a></div></div></li><li role="treeitem" class="active"><div data-tocid="搭建行情回放服务的最佳实践-d9713e102983" class="topicref" data-id="搭建行情回放服务的最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/appendices_market_replay_bp.html" id="搭建行情回放服务的最佳实践-d9713e102983-link">搭建行情回放服务的最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="国内股票行情数据导入实例-d9713e103029" class="topicref" data-id="国内股票行情数据导入实例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stockdata_csv_import_demo.html" id="国内股票行情数据导入实例-d9713e103029-link">国内股票行情数据导入实例</a></div></div></li><li role="treeitem"><div data-tocid="基金份额参考价值-iopv-计算-d9713e103076" class="topicref" data-id="基金份额参考价值-iopv-计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_IOPV_2.html" id="基金份额参考价值-iopv-计算-d9713e103076-link">基金份额参考价值 IOPV 计算</a></div></div></li><li role="treeitem"><div data-tocid="基于快照行情的股票和基金-k-线合成-d9713e103122" class="topicref" data-id="基于快照行情的股票和基金-k-线合成" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/k.html" id="基于快照行情的股票和基金-k-线合成-d9713e103122-link">基于快照行情的股票和基金 K 线合成</a></div></div></li><li role="treeitem"><div data-tocid="计算基金日频因子-d9713e103168" class="topicref" data-id="计算基金日频因子" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/fund_factor_contrasted_by_py.html" id="计算基金日频因子-d9713e103168-link">计算基金日频因子</a></div></div></li><li role="treeitem"><div data-tocid="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎-d9713e103214" class="topicref" data-id="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/orderBookSnapshotEngine.html" id="基于逐笔数据合成高频-orderbookdolphindb-orderbook-引擎-d9713e103214-link">基于逐笔数据合成高频 Orderbook：DolphinDB Orderbook 引擎</a></div></div></li><li role="treeitem"><div data-tocid="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇-d9713e103260" class="topicref" data-id="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/LoadDataForPoc.html" id="金融-poc-用户历史数据导入指导手册之股票-level-2-逐笔篇-d9713e103260-link">金融 PoC 用户历史数据导入指导手册之股票 Level-2 逐笔篇</a></div></div></li><li role="treeitem"><div data-tocid="金融实时实际波动率预测-d9713e103306" class="topicref" data-id="金融实时实际波动率预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ml_volatility_2.html" id="金融实时实际波动率预测-d9713e103306-link">金融实时实际波动率预测</a></div></div></li><li role="treeitem"><div data-tocid="金融因子流式实现-d9713e103352" class="topicref" data-id="金融因子流式实现" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/str_comp_fin_quant_2.html" id="金融因子流式实现-d9713e103352-link">金融因子流式实现</a></div></div></li><li role="treeitem"><div data-tocid="开发股票波动率预测模型的-676-个输入特征-d9713e103398" class="topicref" data-id="开发股票波动率预测模型的-676-个输入特征" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/metacode_derived_features_2.html" id="开发股票波动率预测模型的-676-个输入特征-d9713e103398-link">开发股票波动率预测模型的 676 个输入特征</a></div></div></li><li role="treeitem"><div data-tocid="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践-d9713e103444" class="topicref" data-id="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/l2_snapshot_factor_calc_2.html" id="快速搭建-level-2-快照数据流批一体因子计算平台最佳实践-d9713e103444-link">快速搭建 Level-2 快照数据流批一体因子计算平台最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="量化金融范例-d9713e103490" class="topicref" data-id="量化金融范例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/quant_finance_examples.html" id="量化金融范例-d9713e103490-link">量化金融范例</a></div></div></li><li role="treeitem"><div data-tocid="流式计算中证-1000-指数主买主卖交易量-d9713e103536" class="topicref" data-id="流式计算中证-1000-指数主买主卖交易量" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/CSI_1000_2.html" id="流式计算中证-1000-指数主买主卖交易量-d9713e103536-link">流式计算中证 1000 指数主买/主卖交易量</a></div></div></li><li role="treeitem"><div data-tocid="深度不平衡买卖压力指标波动率计算-d9713e103583" class="topicref" data-id="深度不平衡买卖压力指标波动率计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/sql_performance_optimization_wap_di_rv.html" id="深度不平衡买卖压力指标波动率计算-d9713e103583-link">深度不平衡、买卖压力指标、波动率计算</a></div></div></li><li role="treeitem"><div data-tocid="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用-d9713e103629" class="topicref" data-id="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/insight_plugin_orderbook_engine_application.html" id="实时合成自定义频订单簿快照dolphindb-insight-行情插件与订单簿引擎应用-d9713e103629-link">实时合成自定义频订单簿快照：DolphinDB INSIGHT 行情插件与订单簿引擎应用</a></div></div></li><li role="treeitem"><div data-tocid="实时计算分钟资金流-d9713e103675" class="topicref" data-id="实时计算分钟资金流" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_capital_flow_order_by_order_2.html" id="实时计算分钟资金流-d9713e103675-link">实时计算分钟资金流</a></div></div></li><li role="treeitem"><div data-tocid="实时计算高频因子-d9713e103721" class="topicref" data-id="实时计算高频因子" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/hf_factor_streaming_2.html" id="实时计算高频因子-d9713e103721-link">实时计算高频因子</a></div></div></li><li role="treeitem"><div data-tocid="实时计算日累计逐单资金流-d9713e103767" class="topicref" data-id="实时计算日累计逐单资金流" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_capital_flow_daily_2.html" id="实时计算日累计逐单资金流-d9713e103767-link">实时计算日累计逐单资金流</a></div></div></li><li role="treeitem"><div data-tocid="实时计算涨幅榜-d9713e103813" class="topicref" data-id="实时计算涨幅榜" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/rt_stk_price_inc_calc_2.html" id="实时计算涨幅榜-d9713e103813-link">实时计算涨幅榜</a></div></div></li><li role="treeitem"><div data-tocid="实时选取外汇行情多价源最优价-d9713e103859" class="topicref" data-id="实时选取外汇行情多价源最优价" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_price_selection.html" id="实时选取外汇行情多价源最优价-d9713e103859-link">实时选取外汇行情多价源最优价</a></div></div></li><li role="treeitem"><div data-tocid="外汇掉期估值计算-d9713e103905" class="topicref" data-id="外汇掉期估值计算" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/FxSwapValuation.html" id="外汇掉期估值计算-d9713e103905-link">外汇掉期估值计算</a></div></div></li><li role="treeitem"><div data-tocid="因子计算平台构建-d9713e103951" class="topicref" data-id="因子计算平台构建" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Python_Celery.html" id="因子计算平台构建-d9713e103951-link">因子计算平台构建</a></div></div></li><li role="treeitem"><div data-tocid="因子计算最佳实践-d9713e103997" class="topicref" data-id="因子计算最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practice_for_factor_calculation.html" id="因子计算最佳实践-d9713e103997-link">因子计算最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="mvo_tutorial-d9713e104043" class="topicref" data-id="mvo_tutorial" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/MVO.html" id="mvo_tutorial-d9713e104043-link">优化投资组合：DolphinDB 最优化求解系列函数应用指南</a></div></div></li><li role="treeitem"><div data-tocid="中高频多因子库存储最佳实践-d9713e104090" class="topicref" data-id="中高频多因子库存储最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practices_for_multi_factor.html" id="中高频多因子库存储最佳实践-d9713e104090-link">中高频多因子库存储最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="alphalens-在-dolphindb-中的应用因子分析建模实践-d9713e104136" class="topicref" data-id="alphalens-在-dolphindb-中的应用因子分析建模实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Practical_Factor_Analysis_Modeling.html" id="alphalens-在-dolphindb-中的应用因子分析建模实践-d9713e104136-link">Alphalens 在 DolphinDB 中的应用：因子分析建模实践</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-与-dolphinscheduler-的集成-d9713e104182" class="topicref" data-id="dolphindb-与-dolphinscheduler-的集成" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphinscheduler_integration.html" id="dolphindb-与-dolphinscheduler-的集成-d9713e104182-link">DolphinDB 与 DolphinScheduler 的集成</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-与-python-airflow-最佳实践-d9713e104228" class="topicref" data-id="dolphindb-与-python-airflow-最佳实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_airflow.html" id="dolphindb-与-python-airflow-最佳实践-d9713e104228-link">DolphinDB 与 Python AirFlow 最佳实践</a></div></div></li><li role="treeitem"><div data-tocid="gplearn-d9713e104274" class="topicref" data-id="gplearn" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/gplearn.html" id="gplearn-d9713e104274-link">Shark GPLearn 快速上手</a></div></div></li><li role="treeitem"><div data-tocid="利用jit加速计算-etf-期权隐含波动率和希腊值-d9713e104320" class="topicref" data-id="利用jit加速计算-etf-期权隐含波动率和希腊值" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/IV_Greeks_Calculation_for_ETF_Options_Using_JIT.html" id="利用jit加速计算-etf-期权隐含波动率和希腊值-d9713e104320-link">利用JIT加速计算 ETF 期权隐含波动率和希腊值</a></div></div></li><li role="treeitem"><div data-tocid="基于-dolphindb-的-brinson-绩效归因模型实践-d9713e104366" class="topicref" data-id="基于-dolphindb-的-brinson-绩效归因模型实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/brinson.html" id="基于-dolphindb-的-brinson-绩效归因模型实践-d9713e104366-link">基于 DolphinDB 的 Brinson 绩效归因模型实践</a></div></div></li><li role="treeitem"><div data-tocid="基于-dolphindb-的-campisi-绩效归因模型实践-d9713e104412" class="topicref" data-id="基于-dolphindb-的-campisi-绩效归因模型实践" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/campisi.html" id="基于-dolphindb-的-campisi-绩效归因模型实践-d9713e104412-link">基于 DolphinDB 的 Campisi 绩效归因模型实践</a></div></div></li><li role="treeitem"><div data-tocid="期货分钟频cta策略回测案例-d9713e104458" class="topicref" data-id="期货分钟频cta策略回测案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/futures_minute_frequency_cta_strategy_backtest_example.html" id="期货分钟频cta策略回测案例-d9713e104458-link">期货分钟频CTA策略回测案例</a></div></div></li><li role="treeitem"><div data-tocid="exchdata-交易所历史股票数据自动化导入功能模块使用教程-d9713e104504" class="topicref" data-id="exchdata-交易所历史股票数据自动化导入功能模块使用教程" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/exchdata_exchange_historical_stock_data_auto_import_module_tutorial.html" id="exchdata-交易所历史股票数据自动化导入功能模块使用教程-d9713e104504-link">ExchData 交易所历史股票数据自动化导入功能模块使用教程</a></div></div></li><li role="treeitem"><div data-tocid="ficc_func_uasge_and_performance-d9713e104550" class="topicref" data-id="ficc_func_uasge_and_performance" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ficc_func_uasge_and_performance.html" id="ficc_func_uasge_and_performance-d9713e104550-link">FICC 固收系列函数使用示例及性能</a></div></div></li><li role="treeitem"><div data-tocid="title1-d9713e104597" class="topicref" data-id="title1" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ficc_funcs_application.html" id="title1-d9713e104597-link">FICC 固收系列函数应用场景</a></div></div></li><li role="treeitem"><div data-tocid="最优化函数_socp_的使用及转化案例-d9713e104643" class="topicref" data-id="最优化函数_socp_的使用及转化案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/socp_usage_case.html" id="最优化函数_socp_的使用及转化案例-d9713e104643-link">最优化函数 socp 的使用及转化案例</a></div></div></li><li role="treeitem"><div data-tocid="k_line_calculation-d9713e104689" class="topicref" data-id="k_line_calculation" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/k_line_calculation%20.html" id="k_line_calculation-d9713e104689-link">基于期货快照行情数据计算合约 K 线以及主连行情</a></div></div></li><li role="treeitem"><div data-tocid="backtest_introduction_usage-d9713e104735" class="topicref" data-id="backtest_introduction_usage" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/backtest_introduction_usage.html" id="backtest_introduction_usage-d9713e104735-link">融资融券策略回测使用说明及回测案例</a></div></div></li><li role="treeitem"><div data-tocid="stock_backtest-d9713e104781" class="topicref" data-id="stock_backtest" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/stock_backtest.html" id="stock_backtest-d9713e104781-link">股票中低频投资组合回测案例实现</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">搭建行情回放服务的最佳实践</h1><div class="- topic/body body"><p class="- topic/p p">一个量化策略在生产（交易）环境中运行时，实时数据的处理通常是由事件驱动的。为确保研发和生产使用同一套代码，通常在研发阶段需将历史数据，严格按照事件发生的时间顺序进行回放，以此模拟交易环境。在 DolphinDB 中，用户通过 <code class="+ topic/ph pr-d/codeph ph codeph">replay</code> 函数可以实现对静态数据的回放，即将历史数据按照时间顺序以“实时数据”的方式注入流数据表中。对相同时间戳的数据还可以指定额外排序列，使数据回放顺序更接近实时交易场景。</p><p class="- topic/p p">在<a class="- topic/xref xref" href="data_replay.html">历史数据回放</a>、<a class="- topic/xref xref" href="stock_market_replay.html">股票行情回放</a>两篇教程中已经介绍了 DolphinDB 的回放功能，本教程更加侧重于回放功能的工程化实践。本教程将介绍如何基于 DolphinDB 分布式数据库、回放功能以及 DolphinDB API 搭建一个行情数据回放服务，该服务支持多个用户同时通过 C++ 、 Python 等客户端提交数据回放请求。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-基于-dolphindb-的行情回放服务"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. 基于 DolphinDB 的行情回放服务</h2><div class="- topic/body body"><p class="- topic/p p">本教程实现的行情回放服务基于 3 类国内 A 股行情数据源：逐笔委托数据、逐笔成交数据、Level 2 快照数据，支持以下功能与特性：</p><ul class="- topic/ul ul"><li class="- topic/li li">C++、Python 客户端提交回放请求（指定回放股票列表 、回放日期、回放速率、回放数据源）</li><li class="- topic/li li">多个用户同时回放</li><li class="- topic/li li">多个数据源同时有序回放</li><li class="- topic/li li">在时间有序的基础上支持排序列有序（如：针对逐笔数据中的交易所原始消息记录号排序）</li><li class="- topic/li li">发布回放结束信号</li><li class="- topic/li li">对回放结果订阅消费</li></ul></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title3" id="11-行情回放服务架构"><h3 class="- topic/title title topictitle3" id="ariaid-title3">1.1. 行情回放服务架构</h3><div class="- topic/body body"><p class="- topic/p p">本教程示例 DolphinDB 搭建的行情回放服务架构如下图所示：</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 1</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">行情回放服务架构</span></figcaption>
<img class="- topic/image image" src="../stream/images/stock_market_replay_2.png"/><br/>
    
</figure><ul class="- topic/ul ul"><li class="- topic/li li">行情数据接入：实时行情数据和历史行情数据可以通过 DolphinDB API 或插件存储到 DolphinDB 分布式时序数据库中。</li><li class="- topic/li li">函数模块封装：数据查询和回放过程可以通过 DolphinDB 函数视图封装内置，仅暴露股票列表 、回放日期、回放速率、回放数据源等关键参数给行情服务用户。</li><li class="- topic/li li">行情用户请求：需要进行行情回放的用户可以通过 DolphinDB 客户端软件（如 DolphinDB GUI 工具、DolphinDB VS Code 插件、DolphinDB API 等）调用封装好的回放函数对存储在数据库中的行情数据进行回放，同时，用户还可以在客户端对回放结果进行实时订阅消费。此外，支持多用户并发回放。</li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="12-回放服务搭建步骤"><h3 class="- topic/title title topictitle3" id="ariaid-title4">1.2. 回放服务搭建步骤</h3><div class="- topic/body body"><p class="- topic/p p">本教程示例 DolphinDB 搭建行情回放服务的具体操作步骤如下图所示：</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 2</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">搭建步骤</span></figcaption>
<img class="- topic/image image" src="../stream/images/stock_market_replay_3.png"/><br/>
    
</figure><ul class="- topic/ul ul"><li class="- topic/li li">Step 1：服务提供者设计合理分区的数据库表，在 DolphinDB 集成开发环境中执行对应的建库建表、数据导入等脚本，以将历史行情数据存储到 DolphinDB 分布式数据库中作为回放服务的数据源。在第二章将给出本教程涉及的 3 类行情数据的分区存储方案及建库建表脚本。</li><li class="- topic/li li">Step 2：服务提供者在 DolphinDB 集成开发环境中将回放过程中的操作封装成函数视图，通过封装使得行情服务用户不需要关心 DolphinDB 回放功能的细节，只需要指定简单的回放参数（股票、日期、回放速率、数据源）即可提交回放请求。在第三章将给全部函数视图的定义脚本。</li><li class="- topic/li li">Step 3：服务提供者在外部程序中通过 DolphinDB API 调用上述函数视图实现提交回放的功能。在第四章将给出 API 端提交回放任务的 C++ 实现和 Python 实现。此外，在第四章提交回放的基础上，在第五章将介绍对回放结果的 API 端订阅与消费的代码实现。</li></ul><p class="- topic/p p">在第六章将给出多用户多表回放、多天回放的性能测试结果。最后两章为开发环境配置与总结。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title5" id="2-行情数据分区存储方案"><h2 class="- topic/title title topictitle2" id="ariaid-title5">2. 行情数据分区存储方案</h2><div class="- topic/body body"><p class="- topic/p p">本教程的回放服务基于 3 类国内 A 股行情数据源：逐笔成交数据、逐笔委托数据、快照数据，均使用 TSDB 存储引擎存储在 DolphinDB 分布式数据库中。</p><div class="table-container"><table class="- topic/table table" data-cols="6"><caption></caption><colgroup><col/><col/><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="2-行情数据分区存储方案__entry__1"><strong class="+ topic/ph hi-d/b ph b">数据源</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="2-行情数据分区存储方案__entry__2"><strong class="+ topic/ph hi-d/b ph b">代码样例中的分区数据库路径</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="2-行情数据分区存储方案__entry__3"><strong class="+ topic/ph hi-d/b ph b">代码样例中的表名</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="2-行情数据分区存储方案__entry__4"><strong class="+ topic/ph hi-d/b ph b">分区机制</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="2-行情数据分区存储方案__entry__5"><strong class="+ topic/ph hi-d/b ph b">排序列</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="2-行情数据分区存储方案__entry__6"><strong class="+ topic/ph hi-d/b ph b">建库建表脚本</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__1">逐笔委托</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__2">dfs://Test_order</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__3">order</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__4">VALUE: 交易日, HASH: [SYMBOL, 25]</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__5">股票ID，交易时间</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__6">附录 <a class="- topic/xref xref" href="script/appendices_market_replay_bp/order_create.txt">逐笔委托建库建表脚本</a></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__1">逐笔成交</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__2">dfs://Test_transaction</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__3">transaction</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__4">VALUE: 交易日, HASH: [SYMBOL, 25]</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__5">股票ID，交易时间</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__6">附录 <a class="- topic/xref xref" href="script/appendices_market_replay_bp/transac_create.txt">逐笔成交建库建表脚本</a></td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__1">快照</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__2">dfs://Test_snapshot</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__3">snapshot</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__4">VALUE: 交易日, HASH: [SYMBOL, 20]</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__5">股票ID，交易时间</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="2-行情数据分区存储方案__entry__6">附录 <a class="- topic/xref xref" href="script/appendices_market_replay_bp/snap_create.txt">快照建库建表脚本</a></td></tr></tbody></table></div><p class="- topic/p p">回放的原理是从数据库中读取需要的行情数据，并根据时间列排序后写入到相应的流数据表。因此，读数据库并排序的性能对回放速度有很大的影响，合理的分区机制将有助于提高数据加载速度。基于用户通常按照日期和股票提交回放请求的特点，设计了上表的分区方案。</p><p class="- topic/p p">此外，本教程的历史数据存储在三节点双副本的 DolphinDB 集群中，集群和副本同样可以提升读取性能，同时可以增加系统的可用性，分区的副本通常是存放在不同的物理节点的，所以一旦某个分区不可用，系统依然可以调用其它副本分区来保证回放服务的正常运转。</p><p class="- topic/p p">附录将提供部分原始数据的 csv 文件（原始行情数据文件）以及对应的示例导入脚本（逐笔委托示例导入脚本、逐笔成交示例导入脚本、快照示例导入脚本），以便读者快速体验搭建本教程所示的行情回放服务。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title6" id="3-行情回放自定义函数"><h2 class="- topic/title title topictitle2" id="ariaid-title6">3. 行情回放自定义函数</h2><div class="- topic/body body"><p class="- topic/p p">本章介绍回放过程中的主要函数功能及其实现，最后将函数封装成视图以便通过 API 等方式调用。</p><p class="- topic/p p">本章的开发工具采用 DolphinDB GUI，完整脚本见附录：<a class="- topic/xref xref" href="script/appendices_market_replay_bp/replay.txt">行情回放函数</a>。</p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="3-行情回放自定义函数__entry__1">函数名</th><th class="- topic/entry entry colsep-0 rowsep-0" id="3-行情回放自定义函数__entry__2">函数入参</th><th class="- topic/entry entry colsep-0 rowsep-0" id="3-行情回放自定义函数__entry__3">函数功能</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__1">stkReplay</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__2">stkList：回放股票列表startDate：回放开始日期endDate：回放结束日期replayRate：回放速率replayUuid：回放用户标识replayName：回放数据源名称</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__3">行情回放服务主函数</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__1">dsTb</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__2">timeRS：数据源时间划分startDate：回放开始日期endDate：回放结束日期stkList：回放股票列表replayName：回放数据源名称</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__3">构造回放数据源</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__1">createEnd</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__2">tabName：回放输出表名称sortColumn：相同时间戳时额外排序列名</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__3">构造回放结束信号</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__1">replayJob</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__2">inputDict：回放输入数据源tabName：回放输出表名称dateDict：回放排序时间列timeDict：回放排序时间列replayRate：回放速率sortColumn：相同时间戳时额外排序列名</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="3-行情回放自定义函数__entry__3">定义回放任务内容</td></tr></tbody></table></div></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title7" id="31-stkreplay-函数行情回放服务主函数"><h3 class="- topic/title title topictitle3" id="ariaid-title7">3.1. stkReplay 函数：行情回放服务主函数</h3><div class="- topic/body body"><p class="- topic/p p">函数定义代码：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def stkReplay(stkList, mutable startDate, mutable endDate, replayRate, replayUuid, replayName)
{
    maxCnt = 50
    returnBody = dict(STRING, STRING)
    startDate = datetimeParse(startDate, "yyyyMMdd")
    endDate = datetimeParse(endDate, "yyyyMMdd") + 1
    sortColumn = "ApplSeqNum"
    if(stkList.size() &gt; maxCnt)
    {
        returnBody["errorCode"] = "0"
        returnBody["errorMsg"] = "超过单次回放股票上限，最大回放上限：" + string(maxCnt)
        return returnBody
    }
    if(size(replayName) != 0)
    { 
        for(name in replayName)
        {
            if(not name in ["snapshot", "order", "transaction"])
            {
                returnBody["errorCode"] = "0"
                returnBody["errorMsg"] = "请输入正确的数据源名称，不能识别的数据源名称：" + name
                return returnBody
            }
        }
    }
    else
    {
        returnBody["errorCode"] = "0"
        returnBody["errorMsg"] = "缺少回放数据源，请输入正确的数据源名称"
        return returnBody
    }
    try 
    {
        if(size(replayName) == 1 &amp;&amp; replayName[0] == "snapshot")
        {
            colName = ["timestamp", "biz_type", "biz_data"]
            colType = [TIMESTAMP, SYMBOL, BLOB]
            sortColumn = "NULL"
        }
        else
        {
            colName = ["timestamp", "biz_type", "biz_data", sortColumn]
            colType = [TIMESTAMP, SYMBOL, BLOB, LONG]
        }
        msgTmp = streamTable(10000000:0, colName, colType)
        tabName = "replay_" + replayUuid
        enableTableShareAndPersistence(table=msgTmp, tableName=tabName, asynWrite=true, compress=true, cacheSize=10000000, retentionMinutes=60, flushMode=0, preCache=1000000)
        
        timeRS = cutPoints(09:30:00.000..15:00:00.000, 23)
        
        inputDict = dict(replayName, each(dsTb{timeRS, startDate, endDate, stkList}, replayName))
        dateDict = dict(replayName, take(`MDDate, replayName.size()))
        timeDict = dict(replayName, take(`MDTime, replayName.size()))
        
        jobId = "replay_" + replayUuid
        jobDesc = "replay stock data"
        submitJob(jobId, jobDesc, replayJob{inputDict, tabName, dateDict, timeDict, replayRate, sortColumn})
        returnBody["errorCode"] = "1"
        returnBody["errorMsg"] = "后台回放成功"
        return returnBody
    }
    catch(ex)
    {
        returnBody["errorCode"] = "0"
        returnBody["errorMsg"] = "回放行情数据异常，异常信息：" + ex
        return returnBody
    }
}</code></pre><p class="- topic/p p">函数功能：</p><p class="- topic/p p">自定义函数 stkReplay 是整个回放的主体函数，用户传入的参数在 stkReplay 里会进行有效性判断及格式处理，可以根据实际需求更改。</p><p class="- topic/p p">首先，用 maxCnt 来控制用户一次回放股票数量的最大上限，本例中设置的是 50 。returnBody 构造了信息字典，返回给用户以提示执行错误或执行成功。回放开始日期 startDate 和回放结束日期 endDate 利用<code class="+ topic/ph pr-d/codeph ph codeph">datetimeParse</code>函数进行格式处理 。replayRate 是回放速率，replayUuid 是回放表名名称，replayName 是回放数据源列表，sortColumn 是数据源同回放时间戳排序列列名。</p><p class="- topic/p p">当输入参数无误后，便初始化回放结果流数据表，结果流数据表为异构流数据表，字段类型为 BLOB 的字段包含了一条原始记录的全部信息，同时结果流数据表为持久化流数据表，<code class="+ topic/ph pr-d/codeph ph codeph">enableTableShareAndPersistence</code>函数把流数据表共享并把它持久化到磁盘上，使用持久化流数据表可以避免内存占用过大。当回放数据源包含逐笔成交（transaction ）或逐笔委托（order）时，本例实现了对相同时间戳的逐笔数据按交易所原始消息记录号（ApplSeqNum）进行排序（具体实现见 <a class="- topic/xref xref" href="#replayjob-%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89%E5%9B%9E%E6%94%BE%E4%BB%BB%E5%8A%A1%E5%86%85%E5%AE%B9">replayJob 函数</a>），所以结果流数据表中必须冗余一列来存放排序列。若回放数据源仅包含快照（snapshot）时，则不需要冗余一列排序列。</p><p class="- topic/p p">定义回放需要的其他参数。inputDict 构造了回放数据源列表字典，利用 <code class="+ topic/ph pr-d/codeph ph codeph">each</code>函数可以对多个数据源进行简洁的定义。dateDict 和 timeDict 构造了回放数据源时间戳字典。最后通过<code class="+ topic/ph pr-d/codeph ph codeph">submitJob</code>提交后台回放任务。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title8" id="32-dstb-函数构造回放数据源"><h3 class="- topic/title title topictitle3" id="ariaid-title8">3.2. dsTb 函数：构造回放数据源</h3><div class="- topic/body body"><p class="- topic/p p">函数定义代码：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def dsTb(timeRS, startDate, endDate, stkList, replayName)
{
    if(replayName == "snapshot"){
        tab = loadTable("dfs://Test_snapshot", "snapshot")
	}
	else if(replayName == "order") {
		tab = loadTable("dfs://Test_order", "order")
	}
	else if(replayName == "transaction") {
		tab = loadTable("dfs://Test_transaction", "transaction")
	}
	else {
		return NULL
	}
    ds = replayDS(sqlObj=&lt;select * from tab where MDDate&gt;=startDate and MDDate&lt;endDate and HTSCSecurityID in stkList&gt;, dateColumn='MDDate', timeColumn='MDTime', timeRepartitionSchema=timeRS)
    return ds
}</code></pre><p class="- topic/p p">函数功能：</p><p class="- topic/p p">自定义函数 dsTb 返回符合用户回放需求的数据源划分结果。主要是对内置 replayDS 函数进行了进一步的封装，函数首先对用户端输入的 replayName 进行判断，选择从数据库加载对应的表对象。利用 replayDS 对交易日期在 startDate 至 endDate 之间、股票代号在 stkList 内的数据按照 timeRS 进行数据源划分，返回某一个数据源的列表。</p><p class="- topic/p p">timeRS 参数对应 replayDS 函数中的 timeRepartitionSchema 参数，是时间类型的向量，可用于将数据源划分为更小粒度的多个数据源，以保证查询 DFS 表中数据的效率以及控制内存大小。本例在 <a class="- topic/xref xref" href="#stkreplay-%E5%87%BD%E6%95%B0%E8%A1%8C%E6%83%85%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1%E4%B8%BB%E5%87%BD%E6%95%B0">stkReplay 函数</a> 中构造了 timeRS 变量，其意为对于一天的数据在有效时间段内平均分为 23 份。</p><p class="- topic/p p">执行如下代码查看 <code class="+ topic/ph pr-d/codeph ph codeph">dsTb</code> 函数返回的结果：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>timeRS = cutPoints(09:30:00.000..15:00:00.000, 3)
startDate = 2021.12.01
endDate = 2021.12.02
stkList = ['000616.SZ']
replayName = ["order"]
ds = dsTb(timeRS, startDate, endDate, stkList, replayName)</code></pre><p class="- topic/p p">ds 为一个向量，其中每一个元素如下，数据源被划分为多个小的 SQL 查询语句，具体原理参考<code class="+ topic/ph pr-d/codeph ph codeph">replayDS</code>函数。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>DataSource&lt; select [4] * from tab where time(MDTime) &lt; 09:30:00.000,nanotime(MDTime) &gt;= 00:00:00.000000000,date(MDDate) == 2021.12.01,MDDate &gt;= 2021.12.01 and MDDate &lt; 2021.12.02 and SecurityID in ["000616.SZ"] order by MDDate asc,MDTime asc &gt;
DataSource&lt; select [4] * from tab where time(MDTime) &lt; 11:20:00.001,time(MDTime) &gt;= 09:30:00.000,date(MDDate) == 2021.12.01,MDDate &gt;= 2021.12.01 and MDDate &lt; 2021.12.02 and SecurityID in ["000616.SZ"] order by MDDate asc,MDTime asc &gt;
DataSource&lt; select [4] * from tab where time(MDTime) &lt; 13:10:00.001,time(MDTime) &gt;= 11:20:00.001,date(MDDate) == 2021.12.01,MDDate &gt;= 2021.12.01 and MDDate &lt; 2021.12.02 and SecurityID in ["000616.SZ"] order by MDDate asc,MDTime asc &gt;
DataSource&lt; select [4] * from tab where time(MDTime) &lt; 15:00:00.001,time(MDTime) &gt;= 13:10:00.001,date(MDDate) == 2021.12.01,MDDate &gt;= 2021.12.01 and MDDate &lt; 2021.12.02 and SecurityID in ["000616.SZ"] order by MDDate asc,MDTime asc &gt;
DataSource&lt; select [4] * from tab where nanotime(MDTime) &lt;= 23:59:59.999999999,time(MDTime) &gt;= 15:00:00.001,date(MDDate) == 2021.12.01,MDDate &gt;= 2021.12.01 and MDDate &lt; 2021.12.02 and SecurityID in ["000616.SZ"] order by MDDate asc,MDTime asc &gt;</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title9" id="33-replayjob-函数定义回放任务内容"><h3 class="- topic/title title topictitle3" id="ariaid-title9">3.3. replayJob 函数：定义回放任务内容</h3><div class="- topic/body body"><p class="- topic/p p">函数定义代码：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def replayJob(inputDict, tabName, dateDict, timeDict, replayRate, sortColumn)
{
    if(sortColumn == "NULL")
    {
        replay(inputTables=inputDict, outputTables=objByName(tabName), dateColumn=dateDict, timeColumn=timeDict, replayRate=int(replayRate), absoluteRate=false, parallelLevel=23)
    }
    else
    {
        replay(inputTables=inputDict, outputTables=objByName(tabName), dateColumn=dateDict, timeColumn=timeDict, replayRate=int(replayRate), absoluteRate=false, parallelLevel=23, sortColumns=sortColumn)    
    }
    createEnd(tabName, sortColumn)
}</code></pre><p class="- topic/p p">函数功能：</p><p class="- topic/p p">自定义函数 <code class="+ topic/ph pr-d/codeph ph codeph">replayJob</code> 提交用户数据回放并调用 <code class="+ topic/ph pr-d/codeph ph codeph">createEnd</code> 函数，这里首先通过内置 <code class="+ topic/ph pr-d/codeph ph codeph">replay</code> 函数回放用户需求数据，此处回放模式为 N 对 1 异构回放。<code class="+ topic/ph pr-d/codeph ph codeph">replay</code> 函数返回后即表示需要的数据已经全部回放结束，再执行自定义 <code class="+ topic/ph pr-d/codeph ph codeph">createEnd</code> 函数以构造结束信号写入回放结果里。调用 <code class="+ topic/ph pr-d/codeph ph codeph">createEnd</code> 函数是可选的，其功能是在回放结束时再发布一条特殊的记录，以标识回放结束。</p><p class="- topic/p p">参数 sortColumn 用于指定额外的排序列，如果用户回放的数据源为仅仅包含快照（snapshot），对于这种特殊情况需要指定 <code class="+ topic/ph pr-d/codeph ph codeph">replayJob</code> 函数的回放时间戳排序列参数 sortColumn 为 NULL ，则调用内置的 <code class="+ topic/ph pr-d/codeph ph codeph">replay</code> 函数时不加入 sortColumn 参数。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title10" id="34-createend-函数构造回放结束信号"><h3 class="- topic/title title topictitle3" id="ariaid-title10">3.4. createEnd 函数：构造回放结束信号</h3><div class="- topic/body body"><p class="- topic/p p">函数定义代码：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def createEnd(tabName, sortColumn)
{
    dbName = "dfs://End"
    tbName = "endline"
    if(not existsDatabase(dbName))
    {
        db = database(directory=dbName, partitionType=VALUE, partitionScheme=2023.04.03..2023.04.04)
        endTb = table(2200.01.01T23:59:59.000 as DateTime, `END as point, long(0) as ApplSeqNum)
        endLine = db.createPartitionedTable(table=endTb, tableName=tbName, partitionColumns=`DateTime)
        endLine.append!(endTb)
    }
     
    ds = replayDS(sqlObj=&lt;select * from loadTable(dbName, tbName)&gt;, dateColumn='DateTime', timeColumn='DateTime')
    
    inputEnd = dict(["end"], [ds])
    dateEnd = dict(["end"], [`DateTime])
    timeEnd = dict(["end"], [`DateTime])
    if(sortColumn == "NULL")
    {
        replay(inputTables=inputEnd, outputTables=objByName(tabName), dateColumn=dateEnd, timeColumn=timeEnd, replayRate=-1, absoluteRate=false, parallelLevel=1)
    }
    else
    {
        replay(inputTables=inputEnd, outputTables=objByName(tabName), dateColumn=dateEnd, timeColumn=timeEnd, replayRate=-1, absoluteRate=false, parallelLevel=1, sortColumns=sortColumn)
    }
}</code></pre><p class="- topic/p p">函数功能：</p><p class="- topic/p p">自定义函数 createEnd 是在回放结束时给用户提供一条回放结束信号，利用了 replay 回放模式中的 N 对 1 异构回放构造回放信号，会往参数 tabName 指定的异构流数据表中写入一条消息类型列为 end 的记录。为方便后期异构消费解析以及复用，此处为结束信号独立建一个数据库并创建分区表，表内必须有时间列，其他字段可选。并向该表写入一条模拟数据，其数据内容没有任何强制要求。DolphinDB 建库建表相关知识可参考<a class="- topic/xref xref" href="../db_distr_comp/db/db_partitioning.html">数据分区</a> 。inputEnd、dateEnd、timeEnd 字典的 key 按需设置为字符串 end，将对应 replay 函数指定的输出表中的第二个字典，即消息类型。</p><p class="- topic/p p">参数 sortColumn 用于指定额外的排序列，如果用户回放的数据源为仅仅包含快照（snapshot），则调用内置的 replay 函数时不加入 sortColumn 参数，结果流数据表中的结束信号记录如下。</p><img class="- topic/image image" src="images/appendices_market_replay_bp/3_1.png"/><br/></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title11" id="35-封装函数视图"><h3 class="- topic/title title topictitle3" id="ariaid-title11">3.5. 封装函数视图</h3><div class="- topic/body body"><p class="- topic/p p">将以上函数利用<code class="+ topic/ph pr-d/codeph ph codeph">addFunctionView</code>封装成函数视图，具体代码如下。 API 端仅需要调用主函数 <code class="+ topic/ph pr-d/codeph ph codeph">stkReplay</code>，第四章回放全部基于该函数视图。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>addFunctionView(dsTb)
addFunctionView(createEnd)
addFunctionView(replayJob)
addFunctionView(stkReplay)</code></pre></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title12" id="4-api-提交回放"><h2 class="- topic/title title topictitle2" id="ariaid-title12">4. API 提交回放</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title13" id="41-c-api"><h3 class="- topic/title title topictitle3" id="ariaid-title13">4.1. C++ API</h3><div class="- topic/body body"><p class="- topic/p p">本例程序运行在 Linux 系统 DolphinDB C++ API 环境下，编译成可执行文件以命令行输入参数执行。完整脚本见附录 <a class="- topic/xref xref" href="script/appendices_market_replay_bp/cpp_replay.cpp">C++ 源码</a>。</p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title14" id="411-c-api-调用回放服务"><h4 class="- topic/title title topictitle4" id="ariaid-title14">4.1.1. C++ API 调用回放服务</h4><div class="- topic/body body"><p class="- topic/p p">C++ API 调用回放服务代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>DictionarySP result = conn.run("stkReplay", args);
string errorCode = result-&gt;get(Util::createString("errorCode"))-&gt;getString();
if (errorCode != "1") 
{
    std::cout &lt;&lt; result-&gt;getString() &lt;&lt; endl;
    return -1;
}</code></pre><p class="- topic/p p">conn 是 DolphinDB C++ API DBConnection 对象， C++ 应用可以通过它在 DolphinDB 服务器上执行脚本和函数并在两者之间双向传递数据。conn 通过 <code class="+ topic/ph pr-d/codeph ph codeph">run</code> 方法调用 stkReplay 自定义函数，args 容器内包含了 <code class="+ topic/ph pr-d/codeph ph codeph">stkReplay</code> 函数所需的参数。执行结果返回到字典 result 中，可以通过 <code class="+ topic/ph pr-d/codeph ph codeph">get</code> 方法来获得 key 为 errorCode 对应的值，如果错误代号不为 1 ，则代表回放执行错误，返回错误信息并结束程序。</p><p class="- topic/p p">多用户进行回放时，需要对用户回放的流数据表进行命名，为了不重复命名以避免冲突，对每个回放用户生成唯一识别号，会生成形如 “Eq8Jk8Dd0Tw5Ej8D” 的识别字符串，代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>string uuid(int len)
{
    char* str = (char*)malloc(len + 1);
    srand(getpid());
    for (int i = 0; i &lt; len; ++i)
    {
        switch (i % 3)
        {
        case 0:
            str[i] = 'A' + std::rand() % 26;
            break;
        case 1:
            str[i] = 'a' + std::rand() % 26;
            break;
        default:
            str[i] = '0' + std::rand() % 10;
            break;
        }
    }
    str[len] = '\0';
    std::string rst = str;
    free(str);
    return rst;
}</code></pre></div></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title15" id="42-python-api"><h3 class="- topic/title title topictitle3" id="ariaid-title15">4.2. Python API</h3><div class="- topic/body body"><p class="- topic/p p">本例程序运行在 Windows 系统 DolphinDB Python API 环境下，可以在任何具备该环境的客户端执行。完整脚本见附录 <a class="- topic/xref xref" href="script/appendices_market_replay_bp/python_replay.py">Python 源码</a>。</p></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title16" id="421-python-api-调用回放服务"><h4 class="- topic/title title topictitle4" id="ariaid-title16">4.2.1. Python API 调用回放服务</h4><div class="- topic/body body"><p class="- topic/p p">Python API 调用回放服务代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>stk_list = ['000616.SZ','000681.SZ']
start_date = '20211201'
end_date = '20211201'
replay_rate = -1
replay_name = ['snapshot']
s.upload({'stk_list':stk_list, 'start_date':start_date, 'end_date':end_date, 'replay_rate':replay_rate, 'replay_uuid':uuidStr, 'replay_name':replay_name})
s.run("stkReplay(stk_list, start_date, end_date, replay_rate, replay_uuid, replay_name)")</code></pre><p class="- topic/p p">stk_list 是回放股票列表，start_date 是回放开始日期，end_date 是回放结束日期，replay_rate 是回放速率，replay_uuid 是回放流数据表名称，replay_name 是回放数据源列表。s 是 DolphinDB 会话，Python 应用通过会话在 DolphinDB 服务器上执行脚本和函数以及在两者之间双向传递数据。使用 s 的 <code class="+ topic/ph pr-d/codeph ph codeph">upload</code> 方法上传 Python 对象，使用 <code class="+ topic/ph pr-d/codeph ph codeph">run</code> 方法执行 stkReplay 函数。</p><p class="- topic/p p">多用户进行回放时，需要对用户回放的流数据表进行命名，为了不重复命名以避免冲突，对每个回放用户生成唯一识别号，会生成形如“Eq8Jk8Dd0Tw5Ej8D”的识别字符串，代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def uuid(length):
    str=""
    for i in range(length):
        if(i % 3 == 0):
            str += chr(ord('A') + random.randint(0, os.getpid() + 1) % 26)
        elif(i % 3 == 1):
            str += chr(ord('a') + random.randint(0, os.getpid() + 1) % 26)
        else:
            str += chr(ord('0') + random.randint(0, os.getpid() + 1) % 10)
    return str

uuidStr = uuid(16)</code></pre></div></article></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title17" id="5-api-订阅消费"><h2 class="- topic/title title topictitle2" id="ariaid-title17">5. API 订阅消费</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title18" id="51-c-api"><h3 class="- topic/title title topictitle3" id="ariaid-title18">5.1. C++ API</h3><div class="- topic/body body"></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title19" id="511-反序列化器构造"><h4 class="- topic/title title topictitle4" id="ariaid-title19">5.1.1. 反序列化器构造</h4><div class="- topic/body body"><p class="- topic/p p">为使异构流数据表反序列化输出，构造输出表结构，代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>DictionarySP snap_full_schema = conn.run("loadTable(\"dfs://Test_snapshot\", \"snapshot\").schema()");
DictionarySP order_full_schema = conn.run("loadTable(\"dfs://Test_order\", \"order\").schema()");
DictionarySP transac_full_schema = conn.run("loadTable(\"dfs://Test_transaction\", \"transaction\").schema()");
DictionarySP end_full_schema = conn.run("loadTable(\"dfs://End\", \"endline\").schema()");

unordered_map&lt;string, DictionarySP&gt; sym2schema;
sym2schema["snapshot"] = snap_full_schema;
sym2schema["order"] = order_full_schema;
sym2schema["transaction"] = transac_full_schema;
sym2schema["end"] = end_full_schema;
StreamDeserializerSP sdsp = new StreamDeserializer(sym2schema);</code></pre><p class="- topic/p p">上述前四行分别是快照、逐笔委托、逐笔成交、结束信号的表结构构造，回放根据需要选择对应的表结构，结束信号表必须有。unordered_map 创建了 key-&gt;schema 的映射表，可以将回放数据源和结束信号按照 schema 进行结构解析。通过 StreamDeserializer 对象来构造异构流数据表反序列化器。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title20" id="512-订阅回放服务"><h4 class="- topic/title title topictitle4" id="ariaid-title20">5.1.2. 订阅回放服务</h4><div class="- topic/body body"><p class="- topic/p p">在 DolphinDB C++ API 中订阅异构流数据表，代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>int listenport = 10260;
ThreadedClient threadedClient(listenport);
string tableNameUuid = "replay_" + uuidStr;
auto thread = threadedClient.subscribe(hostName, port, myHandler, tableNameUuid, "stkReplay", 0, true, nullptr, true, 500000, 0.001, false, "admin", "123456", sdsp);
std::cout &lt;&lt; "Successed to subscribe " + tableNameUuid &lt;&lt; endl;
thread-&gt;join();</code></pre><p class="- topic/p p">listenport 是单线程客户端的订阅端口号，tableNameUuid 是用户回放的流数据表名称，通过 threadedClient.subscribe 可以订阅回放的流数据表，详情用法参考  <a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/cppdoc/cpp_api.html" target="_blank" rel="external noopener">C++ API</a>。thread 指向循环调用 myHandler 的线程的指针，线程在 topic 被取消订阅后会退出。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title21" id="513-消费函数构造"><h4 class="- topic/title title topictitle4" id="ariaid-title21">5.1.3. 消费函数构造</h4><div class="- topic/body body"><p class="- topic/p p">调用订阅函数 <code class="+ topic/ph pr-d/codeph ph codeph">threadedClient.subscribe</code> 订阅异构流数据表时，在最后一个参数指定相应的流数据反序列化实例 StreamDeserializerSP ，在订阅时会对收到的数据进行反序列化再传递给用户自定义的回调函数 <code class="+ topic/ph pr-d/codeph ph codeph">myHandler</code>，用户可以在回调函数内自定义消费，本文仅实现了简单的输出消费，当消息 msg 的标识为 end 时，通过 <code class="+ topic/ph pr-d/codeph ph codeph">threadedClient.unsubscribe</code> 取消订阅，代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>long sumcount = 0;
long long starttime = Util::getNanoEpochTime();
auto myHandler = [&amp;](vector&lt;Message&gt; msgs) 
{
    for (auto&amp; msg : msgs) 
    {
        std::cout &lt;&lt; msg.getSymbol() &lt;&lt; " : " &lt;&lt; msg-&gt;getString() &lt;&lt; endl;
        if(msg.getSymbol() == "end")
        {
            threadedClient.unsubscribe(hostName, port, tableNameUuid,"stkReplay");
        }
        sumcount += msg-&gt;get(0)-&gt;size();
    }
    long long speed = (Util::getNanoEpochTime() - starttime) / sumcount;
    std::cout &lt;&lt; "callback speed: " &lt;&lt; speed &lt;&lt; "ns" &lt;&lt; endl;
};</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title22" id="514-程序执行"><h4 class="- topic/title title topictitle4" id="ariaid-title22">5.1.4. 程序执行</h4><div class="- topic/body body"><p class="- topic/p p">将如上 C++ 程序代码写入 main.cpp 中，在 DolphinDB C++ API 环境下编译成可执行文件 main ，按照如下命令格式输入，回车，即可开始“回放-订阅-消费”过程。</p><p class="- topic/p p">单支股票最大速度回放 “order“ 表一天数据命令：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>$  ./main 000616.SZ 20211201 20211201 -1 order</code></pre><p class="- topic/p p">两支(多支)股票最大速度回放三张表一天数据命令：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>$  ./main 000616.SZ,000681.SZ 20211201 20211201 -1 snapshot,order,transaction</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title23" id="515-消费输出"><h4 class="- topic/title title topictitle4" id="ariaid-title23">5.1.5. 消费输出</h4><div class="- topic/body body"><p class="- topic/p p">根据前文构造的消费函数，两支股票（“000616.SZ” &amp;“000681.SZ”）最大速度回放三张表一天数据输出如下图所示：</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 3</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">消费输出结果</span></figcaption>
<img class="- topic/image image" src="images/appendices_market_replay_bp/5_1.png"/><br/>
    
</figure></div></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title24" id="52-python-api"><h3 class="- topic/title title topictitle3" id="ariaid-title24">5.2. Python API</h3><div class="- topic/body body"></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title25" id="521-反序列化器构造"><h4 class="- topic/title title topictitle4" id="ariaid-title25">5.2.1. 反序列化器构造</h4><div class="- topic/body body"><p class="- topic/p p">为使异构流数据表反序列化输出，Python API 通过 streamDeserializer 类来构造异构流数据表反序列化器，同时定义输出表结构，代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>sd = ddb.streamDeserializer({
    'snapshot':  ["dfs://Test_snapshot", "snapshot"],
    'order': ["dfs://Test_order", "order"],
    'transaction': ["dfs://Test_transaction", "transaction"],
    'end': ["dfs://End", "endline"],
}, s)</code></pre><p class="- topic/p p">上述主体部分分别是快照、逐笔委托、逐笔成交、结束信号的表结构构造，回放根据需要选择对应的表结构，结束信号表必须有。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title26" id="522-python-api-订阅回放服务"><h4 class="- topic/title title topictitle4" id="ariaid-title26">5.2.2. Python API 订阅回放服务</h4><div class="- topic/body body"><p class="- topic/p p">在 DolphinDB Python API 中订阅异构流数据表，代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>s.enableStreaming(0)
s.subscribe(host=hostname, port=portname, handler=myHandler, tableName="replay_"+uuidStr, actionName="replay_stock_data", offset=0, resub=False, msgAsTable=False, streamDeserializer=sd, userName="admin", password="123456")
event.wait()</code></pre><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">enableStreaming</code> 函数启用流数据功能，函数参数指定开启数据订阅的端口。s 使用 <code class="+ topic/ph pr-d/codeph ph codeph">subscribe</code> 函数来订阅 DolphinDB 中的流数据表。订阅是异步执行的，<code class="+ topic/ph pr-d/codeph ph codeph">event.wait()</code> 保持主线程不退出。</p></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title27" id="523-消费函数构造"><h4 class="- topic/title title topictitle4" id="ariaid-title27">5.2.3. 消费函数构造</h4><div class="- topic/body body"><p class="- topic/p p">调用订阅函数 <code class="+ topic/ph pr-d/codeph ph codeph">s.subscribe</code> 订阅异构流数据表时，在参数指定相应的流数据反序列化实例 <code class="+ topic/ph pr-d/codeph ph codeph">streamDeserializer</code>,在订阅时会对收到的数据进行反序列化再传递给用户自定义的回调函数 <code class="+ topic/ph pr-d/codeph ph codeph">myHandler</code>，用户可以在回调函数内自定义消费，仅输出消费代码如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>def myHandler(lst):
    if lst[-1] == "snapshot":
        print("SNAPSHOT: ", lst)
    elif lst[-1] == 'order':
        print("ORDER: ", lst)
    elif lst[-1] == 'transaction':
        print("TRANSACTION: ", lst)
    else:
        print("END: ", lst)
        event.set()</code></pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title28" id="524-消费输出"><h4 class="- topic/title title topictitle4" id="ariaid-title28">5.2.4. 消费输出</h4><div class="- topic/body body"><p class="- topic/p p">根据前文构造的消费函数，两支股票（“000616.SZ” &amp;“000681.SZ”）最大速度回放三张表一天数据输出如下图所示：</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 4</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">消费输出结果</span></figcaption>
<img class="- topic/image image" src="images/appendices_market_replay_bp/5_2.png"/><br/>
    
</figure></div></article></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title29" id="6-性能测试"><h2 class="- topic/title title topictitle2" id="ariaid-title29">6. 性能测试</h2><div class="- topic/body body"><p class="- topic/p p">测试的交易日范围从 2021 年 12 月 1 日至 12 月 9 日共 7 个连续交易日。测试脚本见附录：<a class="- topic/xref xref" href="script/appendices_market_replay_bp/cpp_replay_test.cpp">C++ 测试源码</a>。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title30" id="7-测试服务器配置"><h2 class="- topic/title title topictitle2" id="ariaid-title30">7. 测试服务器配置</h2><div class="- topic/body body"><div class="table-container"><table class="- topic/table table" data-cols="2"><caption></caption><colgroup><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="7-测试服务器配置__entry__1">CPU 类型</th><th class="- topic/entry entry colsep-0 rowsep-0" id="7-测试服务器配置__entry__2">Intel(R) Xeon(R) Silver 4216 CPU @ 2.10GHz</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__1">逻辑 CPU 总数</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__2">64</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__1">内存</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__2">503 GB</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__1">硬盘</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__2">SSD</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__1">OS</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__2">CentOS Linux release 7.9.2009 (Core)</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__1">DolphinDB Server 版本</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="7-测试服务器配置__entry__2">2.00.9.3 2023.03.29</td></tr></tbody></table></div></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title31" id="71-50-支深交所股票一天全速并发回放性能测试"><h3 class="- topic/title title topictitle3" id="ariaid-title31">7.1. 50 支深交所股票一天全速并发回放性能测试</h3><div class="- topic/body body"><p class="- topic/p p">测试方法：选取深交所 2021 年 12 月 1 日 50 支交易股票数据，linux 后台同时启动多个第四章 C++ API 提交回放程序，提交多个并发回放任务。</p><ul class="- topic/ul ul"><li class="- topic/li li">回放耗时=所有回放任务最晚结束时间-所有回放任务最早收到时间</li><li class="- topic/li li">回放速率=所有用户回放数据量总和/回放耗时</li><li class="- topic/li li">平均单个用户回放耗时=（所有回放任务结束时间和-所有回放任务开始时间和）/并发数量</li><li class="- topic/li li">平均单个用户回放速率=单个用户回放数据量/平均单个用户回放耗时</li></ul><div class="table-container"><table class="- topic/table table" data-cols="7"><caption></caption><colgroup><col/><col/><col/><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="71-50-支深交所股票一天全速并发回放性能测试__entry__1">并发数量</th><th class="- topic/entry entry colsep-0 rowsep-0" id="71-50-支深交所股票一天全速并发回放性能测试__entry__2">数据源</th><th class="- topic/entry entry colsep-0 rowsep-0" id="71-50-支深交所股票一天全速并发回放性能测试__entry__3">数据量</th><th class="- topic/entry entry colsep-0 rowsep-0" id="71-50-支深交所股票一天全速并发回放性能测试__entry__4">回放耗时</th><th class="- topic/entry entry colsep-0 rowsep-0" id="71-50-支深交所股票一天全速并发回放性能测试__entry__5">回放速率</th><th class="- topic/entry entry colsep-0 rowsep-0" id="71-50-支深交所股票一天全速并发回放性能测试__entry__6">单个用户回放耗时（平均）</th><th class="- topic/entry entry colsep-0 rowsep-0" id="71-50-支深交所股票一天全速并发回放性能测试__entry__7">单个用户回放速率（平均）</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">1</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshottransactionorder</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">2,775,129行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约2.669s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约104w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约2.669s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约104w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">10</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshottransactionorder</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">27,751,290行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约10.161s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约273w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约8.482s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约32w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">20</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshottransactionorder</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">55,502,580行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约18.761s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约296w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约16.728s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约16w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">40</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshottransactionorder</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">111,005,160行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约35.537s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约312w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约19.091s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约14w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">1</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshottransaction</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">1,416,548行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约2.003s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约70w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约2.003s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约70w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">10</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshottransaction</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">14,165,480行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约7.155s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约198w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约6.382s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约22w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">20</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshottransaction</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">28,330,960行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约13.115s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约216w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约11.436s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约12w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">40</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshottransaction</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">56,661,920行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约27.003s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约210w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约13.740s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约10w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">1</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshot</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">194,045行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约1.387s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约14w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约1.387s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约14w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">10</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshot</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">1,940,450行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约6.428s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约30w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约5.128s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约4w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">20</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshot</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">3,880,900行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约11.782s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约33w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约10.539s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约2w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__1">40</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__2">snapshot</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__3">7,761,800行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__4">约23.274s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__5">约33w/s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__6">约12.393s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="71-50-支深交所股票一天全速并发回放性能测试__entry__7">约1w/s</td></tr></tbody></table></div></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title32" id="72-50-支深交所股票跨天全速回放性能测试"><h3 class="- topic/title title topictitle3" id="ariaid-title32">7.2. 50 支深交所股票跨天全速回放性能测试</h3><div class="- topic/body body"><p class="- topic/p p">测试方法：选取深交所 50 支交易股票数据，linux 后台启动第四章 C++ API 提交回放程序，提交多天回放任务。</p><ul class="- topic/ul ul"><li class="- topic/li li">回放耗时=回放任务结束时间-回放任务收到时间</li><li class="- topic/li li">回放速率=回放数据量/回放耗时</li></ul><div class="table-container"><table class="- topic/table table" data-cols="4"><caption></caption><colgroup><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="72-50-支深交所股票跨天全速回放性能测试__entry__1">数据源</th><th class="- topic/entry entry colsep-0 rowsep-0" id="72-50-支深交所股票跨天全速回放性能测试__entry__2">数据量</th><th class="- topic/entry entry colsep-0 rowsep-0" id="72-50-支深交所股票跨天全速回放性能测试__entry__3">回放耗时</th><th class="- topic/entry entry colsep-0 rowsep-0" id="72-50-支深交所股票跨天全速回放性能测试__entry__4">回放速率</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__1">snapshottransactionorder</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__2">一天：2,775,129行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__3">约2.925s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__4">约95w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__1">snapshottransactionorder</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__2">一周：17,366,642行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__3">约16.393s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__4">约106w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__1">snapshottransaction</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__2">一天：1,416,548行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__3">约1.912s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__4">约74w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__1">snapshottransaction</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__2">一周：8,899,562行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__3">约9.142s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__4">约97w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__1">snapshot</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__2">一天：194,045行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__3">约1.267s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__4">约15w/s</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__1">snapshot</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__2">一周：1,279,869行</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__3">约6.659s</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="72-50-支深交所股票跨天全速回放性能测试__entry__4">约19w/s</td></tr></tbody></table></div></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title33" id="8-开发环境配置"><h2 class="- topic/title title topictitle2" id="ariaid-title33">8. 开发环境配置</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title34" id="81-部署-dolphindb-server"><h3 class="- topic/title title topictitle3" id="ariaid-title34">8.1. 部署 DolphinDB Server</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">Server 版本：2.00.9.3 2023.03.29</li><li class="- topic/li li">Server 部署模式：单服务器集群</li><li class="- topic/li li">配置文件：<em class="+ topic/ph hi-d/i ph i">cluster.cfg</em></li></ul><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>maxMemSize=128
maxConnections=5000
workerNum=24
webWorkerNum=2
chunkCacheEngineMemSize=16
newValuePartitionPolicy=add
logLevel=INFO
maxLogSize=512
node1.volumes=/ssd/ssd3/pocTSDB/volumes/node1,/ssd/ssd4/pocTSDB/volumes/node1
node2.volumes=/ssd/ssd5/pocTSDB/volumes/node2,/ssd/ssd6/pocTSDB/volumes/node2
node3.volumes=/ssd/ssd7/pocTSDB/volumes/node3,/ssd/ssd8/pocTSDB/volumes/node3
diskIOConcurrencyLevel=0
node1.redoLogDir=/ssd/ssd3/pocTSDB/redoLog/node1
node2.redoLogDir=/ssd/ssd4/pocTSDB/redoLog/node2
node3.redoLogDir=/ssd/ssd5/pocTSDB/redoLog/node3
node1.chunkMetaDir=/ssd/ssd3/pocTSDB/metaDir/chunkMeta/node1
node2.chunkMetaDir=/ssd/ssd4/pocTSDB/metaDir/chunkMeta/node2
node3.chunkMetaDir=/ssd/ssd5/pocTSDB/metaDir/chunkMeta/node3
node1.persistenceDir=/ssd/ssd6/pocTSDB/persistenceDir/node1
node2.persistenceDir=/ssd/ssd7/pocTSDB/persistenceDir/node2
node3.persistenceDir=/ssd/ssd8/pocTSDB/persistenceDir/node3
maxPubConnections=128
subExecutors=24
subThrottle=1
persistenceWorkerNum=1
node1.subPort=8825
node2.subPort=8826
node3.subPort=8827
maxPartitionNumPerQuery=200000
streamingHAMode=raft
streamingRaftGroups=2:node1:node2:node3
node1.streamingHADir=/ssd/ssd6/pocTSDB/streamingHADir/node1
node2.streamingHADir=/ssd/ssd7/pocTSDB/streamingHADir/node2
node3.streamingHADir=/ssd/ssd8/pocTSDB/streamingHADir/node3
TSDBCacheEngineSize=16
TSDBCacheEngineCompression=false
node1.TSDBRedoLogDir=/ssd/ssd3/pocTSDB/TSDBRedoLogDir/node1
node2.TSDBRedoLogDir=/ssd/ssd4/pocTSDB/TSDBRedoLogDir/node2
node3.TSDBRedoLogDir=/ssd/ssd5/pocTSDB/TSDBRedoLogDir/node3
TSDBLevelFileIndexCacheSize=20
TSDBLevelFileIndexCacheInvalidPercent=0.6
lanCluster=0
enableChunkGranularityConfig=true</code></pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>： 路径配置参数需要开发人员根据实际环境配置。</p><p class="- topic/p p">有关单服务器集群部署教程，请参考：<a class="- topic/xref xref" href="single_machine_cluster_deploy.html">单服务器集群部署</a>。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title35" id="82-dolphindb-client-开发环境"><h3 class="- topic/title title topictitle3" id="ariaid-title35">8.2. DolphinDB client 开发环境</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">CPU 类型：Intel(R) Core(TM) i5-11500 @ 2.70GHz   2.71 GHz</li><li class="- topic/li li">逻辑 CPU 总数：12</li><li class="- topic/li li">内存：16GB</li><li class="- topic/li li">OS：Windows 11 专业版</li><li class="- topic/li li">DolphinDB GUI 版本：1.30.20.1</li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title36" id="83-dolphindb-c-api-安装"><h3 class="- topic/title title topictitle3" id="ariaid-title36">8.3. DolphinDB C++ API 安装</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">C++ API 版本：release200.9</li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>： C++ API 版本建议按 DolphinDB server 版本选择，如 2.00.9 版本的 server 安装 release200.9 分支的 API</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title37" id="84-dolphindb-python-api-安装"><h3 class="- topic/title title topictitle3" id="ariaid-title37">8.4. DolphinDB Python API 安装</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">Python API 版本：1.30.21.1</li><li class="- topic/li li">Python API 教程：<a class="- topic/xref xref" href="https://docs.dolphindb.cn/zh/pydoc/py.html" target="_blank" rel="external noopener">Python API 教程</a></li></ul></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title38" id="9-路线图-roadmap"><h2 class="- topic/title title topictitle2" id="ariaid-title38">9. 路线图 (Roadmap)</h2><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">在后续版本中，<code class="+ topic/ph pr-d/codeph ph codeph">replay</code> 函数将支持原速回放，即严格以两条记录的时间戳之差为输出间隔向下游注入数据；</li><li class="- topic/li li">在后续版本中，<code class="+ topic/ph pr-d/codeph ph codeph">replay</code> 函数将支持原速倍速回放，即严格以两条记录的时间戳之差为输出间隔进行倍速再向下游注入数据。</li></ul></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title39" id="10-附录"><h2 class="- topic/title title topictitle2" id="ariaid-title39">10. 附录</h2><div class="- topic/body body"><p class="- topic/p p">附录中的压缩包包含以下文件：</p><ul class="- topic/ul ul"><li class="- topic/li li"><a class="- topic/xref xref" href="https://www.dolphindb.cn/downloads/docs/appendices_market_replay_bp_data.zip" target="_blank" rel="external noopener">原始行情数据文件</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/order_create.txt">逐笔委托建库建表脚本</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/transac_create.txt">逐笔成交建库建表脚本</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/snap_create.txt">快照建库建表脚本</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/order_upload.txt">逐笔委托示例导入脚本</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/transac_upload.txt">逐笔成交示例导入脚本</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/snap_upload.txt">快照示例导入脚本</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/replay.txt">行情回放函数</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/cpp_replay.cpp">C++ 源码</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/python_replay.py">Python 源码</a></li><li class="- topic/li li"><a class="- topic/xref xref" href="script/appendices_market_replay_bp/cpp_replay_test.cpp">C++ 测试源码</a></li></ul></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E5%9F%BA%E4%BA%8E-dolphindb-%E7%9A%84%E8%A1%8C%E6%83%85%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1" data-tocid="1-基于-dolphindb-的行情回放服务">1. 基于 DolphinDB 的行情回放服务</a><ul><li class="topic-item"><a href="#11-%E8%A1%8C%E6%83%85%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84" data-tocid="11-行情回放服务架构">1.1. 行情回放服务架构</a></li><li class="topic-item"><a href="#12-%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E6%AD%A5%E9%AA%A4" data-tocid="12-回放服务搭建步骤">1.2. 回放服务搭建步骤</a></li></ul></li><li class="topic-item"><a href="#2-%E8%A1%8C%E6%83%85%E6%95%B0%E6%8D%AE%E5%88%86%E5%8C%BA%E5%AD%98%E5%82%A8%E6%96%B9%E6%A1%88" data-tocid="2-行情数据分区存储方案">2. 行情数据分区存储方案</a></li><li class="topic-item"><a href="#3-%E8%A1%8C%E6%83%85%E5%9B%9E%E6%94%BE%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0" data-tocid="3-行情回放自定义函数">3. 行情回放自定义函数</a><ul><li class="topic-item"><a href="#31-stkreplay-%E5%87%BD%E6%95%B0%E8%A1%8C%E6%83%85%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1%E4%B8%BB%E5%87%BD%E6%95%B0" data-tocid="31-stkreplay-函数行情回放服务主函数">3.1. stkReplay 函数：行情回放服务主函数</a></li><li class="topic-item"><a href="#32-dstb-%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A0%E5%9B%9E%E6%94%BE%E6%95%B0%E6%8D%AE%E6%BA%90" data-tocid="32-dstb-函数构造回放数据源">3.2. dsTb 函数：构造回放数据源</a></li><li class="topic-item"><a href="#33-replayjob-%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89%E5%9B%9E%E6%94%BE%E4%BB%BB%E5%8A%A1%E5%86%85%E5%AE%B9" data-tocid="33-replayjob-函数定义回放任务内容">3.3. replayJob 函数：定义回放任务内容</a></li><li class="topic-item"><a href="#34-createend-%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A0%E5%9B%9E%E6%94%BE%E7%BB%93%E6%9D%9F%E4%BF%A1%E5%8F%B7" data-tocid="34-createend-函数构造回放结束信号">3.4. createEnd 函数：构造回放结束信号</a></li><li class="topic-item"><a href="#35-%E5%B0%81%E8%A3%85%E5%87%BD%E6%95%B0%E8%A7%86%E5%9B%BE" data-tocid="35-封装函数视图">3.5. 封装函数视图</a></li></ul></li><li class="topic-item"><a href="#4-api-%E6%8F%90%E4%BA%A4%E5%9B%9E%E6%94%BE" data-tocid="4-api-提交回放">4. API 提交回放</a><ul><li class="topic-item"><a href="#41-c-api" data-tocid="41-c-api">4.1. C++ API</a><ul><li class="topic-item"><a href="#411-c-api-%E8%B0%83%E7%94%A8%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1" data-tocid="411-c-api-调用回放服务">4.1.1. C++ API 调用回放服务</a></li></ul></li><li class="topic-item"><a href="#42-python-api" data-tocid="42-python-api">4.2. Python API</a><ul><li class="topic-item"><a href="#421-python-api-%E8%B0%83%E7%94%A8%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1" data-tocid="421-python-api-调用回放服务">4.2.1. Python API 调用回放服务</a></li></ul></li></ul></li><li class="topic-item"><a href="#5-api-%E8%AE%A2%E9%98%85%E6%B6%88%E8%B4%B9" data-tocid="5-api-订阅消费">5. API 订阅消费</a><ul><li class="topic-item"><a href="#51-c-api" data-tocid="51-c-api">5.1. C++ API</a><ul><li class="topic-item"><a href="#511-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E6%9E%84%E9%80%A0" data-tocid="511-反序列化器构造">5.1.1. 反序列化器构造</a></li><li class="topic-item"><a href="#512-%E8%AE%A2%E9%98%85%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1" data-tocid="512-订阅回放服务">5.1.2. 订阅回放服务</a></li><li class="topic-item"><a href="#513-%E6%B6%88%E8%B4%B9%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A0" data-tocid="513-消费函数构造">5.1.3. 消费函数构造</a></li><li class="topic-item"><a href="#514-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C" data-tocid="514-程序执行">5.1.4. 程序执行</a></li><li class="topic-item"><a href="#515-%E6%B6%88%E8%B4%B9%E8%BE%93%E5%87%BA" data-tocid="515-消费输出">5.1.5. 消费输出</a></li></ul></li><li class="topic-item"><a href="#52-python-api" data-tocid="52-python-api">5.2. Python API</a><ul><li class="topic-item"><a href="#521-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%99%A8%E6%9E%84%E9%80%A0" data-tocid="521-反序列化器构造">5.2.1. 反序列化器构造</a></li><li class="topic-item"><a href="#522-python-api-%E8%AE%A2%E9%98%85%E5%9B%9E%E6%94%BE%E6%9C%8D%E5%8A%A1" data-tocid="522-python-api-订阅回放服务">5.2.2. Python API 订阅回放服务</a></li><li class="topic-item"><a href="#523-%E6%B6%88%E8%B4%B9%E5%87%BD%E6%95%B0%E6%9E%84%E9%80%A0" data-tocid="523-消费函数构造">5.2.3. 消费函数构造</a></li><li class="topic-item"><a href="#524-%E6%B6%88%E8%B4%B9%E8%BE%93%E5%87%BA" data-tocid="524-消费输出">5.2.4. 消费输出</a></li></ul></li></ul></li><li class="topic-item"><a href="#6-%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="6-性能测试">6. 性能测试</a></li><li class="topic-item"><a href="#7-%E6%B5%8B%E8%AF%95%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE" data-tocid="7-测试服务器配置">7. 测试服务器配置</a><ul><li class="topic-item"><a href="#71-50-%E6%94%AF%E6%B7%B1%E4%BA%A4%E6%89%80%E8%82%A1%E7%A5%A8%E4%B8%80%E5%A4%A9%E5%85%A8%E9%80%9F%E5%B9%B6%E5%8F%91%E5%9B%9E%E6%94%BE%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="71-50-支深交所股票一天全速并发回放性能测试">7.1. 50 支深交所股票一天全速并发回放性能测试</a></li><li class="topic-item"><a href="#72-50-%E6%94%AF%E6%B7%B1%E4%BA%A4%E6%89%80%E8%82%A1%E7%A5%A8%E8%B7%A8%E5%A4%A9%E5%85%A8%E9%80%9F%E5%9B%9E%E6%94%BE%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95" data-tocid="72-50-支深交所股票跨天全速回放性能测试">7.2. 50 支深交所股票跨天全速回放性能测试</a></li></ul></li><li class="topic-item"><a href="#8-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE" data-tocid="8-开发环境配置">8. 开发环境配置</a><ul><li class="topic-item"><a href="#81-%E9%83%A8%E7%BD%B2-dolphindb-server" data-tocid="81-部署-dolphindb-server">8.1. 部署 DolphinDB Server</a></li><li class="topic-item"><a href="#82-dolphindb-client-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83" data-tocid="82-dolphindb-client-开发环境">8.2. DolphinDB client 开发环境</a></li><li class="topic-item"><a href="#83-dolphindb-c-api-%E5%AE%89%E8%A3%85" data-tocid="83-dolphindb-c-api-安装">8.3. DolphinDB C++ API 安装</a></li><li class="topic-item"><a href="#84-dolphindb-python-api-%E5%AE%89%E8%A3%85" data-tocid="84-dolphindb-python-api-安装">8.4. DolphinDB Python API 安装</a></li></ul></li><li class="topic-item"><a href="#9-%E8%B7%AF%E7%BA%BF%E5%9B%BE-roadmap" data-tocid="9-路线图-roadmap">9. 路线图 (Roadmap)</a></li><li class="topic-item"><a href="#10-%E9%99%84%E5%BD%95" data-tocid="10-附录">10. 附录</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>