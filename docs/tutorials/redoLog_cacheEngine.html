<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="这篇教程重点介绍了 DolphinDB 中的 redo log 和 cache engine 机制以及其配置对整体性能的影响。 注意 ： 它们只对 DFS 数据库起作用，对流数据表不起作用 TSDB 存储引擎必须开启 cache engine 和 redo log OLAP 存储引擎可以不开启 redo log，但启用了 redo log 之后必须启用 cache engine ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="redo-log-和-cache-engine"/><title>redo log 和 cache engine</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ../?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;redo-log-和-cache-engine&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redo log 和 cache engine&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;这篇教程重点介绍了 DolphinDB 中的 redo log 和 cache engine 机制以及其配置对整体性能的影响。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;5:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;注意&lt;/b&gt;：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;7:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;它们只对 DFS 数据库起作用，对流数据表不起作用&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;TSDB 存储引擎必须开启 cache engine 和 redo log&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;9:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;OLAP 存储引擎可以不开启 redo log，但启用了 redo log 之后必须启用 cache engine&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:9;24:82&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-redo-logcache-engine-相关概念&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;1. redo log/cache engine 相关概念&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;11-什么是-redo-log&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;1.1. 什么是 redo log&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;15:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;17:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;在关系型数据库系统中，预写式日志 (write-ahead logging, WAL) 是用于提供原子性和持久性的一系列技术。DolphinDB 中的 redo log 与 WAL 的概念类似。简而言之，redo log 的核心思想是：只有在描述事务更改的日志记录刷新到持久化存储介质以后，才对数据库的数据文件进行修改。如果遵循这个过程，就不需要在每次提交事务时都将数据页刷新到磁盘上，因为在数据库发生宕机时，可以使用日志来恢复数据库，尚未应用的所有更改可以通过日志记录回放并重做。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;12-什么是-cache-engine&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;20:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;20:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;1.2. 什么是 cache engine&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;20:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;22:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cache engine 是 DolphinDB 中的一种数据写入缓存机制，它是为了解决数据表列数过多的情况下写入性能急剧下降的问题而引入的。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;24:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;对一个文件进行写入时，写入 1 行数据和写入 1000 行数据的时间基本相等，大部分时间都花在打开和关闭文件上。因此，引入 cache engine 以后，写入操作时首先写入缓存中，到达一定阈值以后，异步将缓存中的数据写入磁盘中。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;13-redo-log-和-cache-engine-的写入和回收&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;26:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;26:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;1.3. redo log 和 cache engine 的写入和回收&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;26:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;image class=&#34;- topic/image &#34; href=&#34;images/redoLog_cacheEngine/1_1.png&#34; placement=&#34;break&#34; xtrc=&#34;image:1;28:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34; dita-ot:image-width=&#34;731&#34; dita-ot:image-height=&#34;161&#34;/&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;30:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;由上图可知，数据整体的写入流程可以分成三个部分：&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;32:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;（1）数据写入 redo log，一个事务的数据存成一个文件。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;34:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;（2）数据写入 cache engine，并由 cache engine 异步写入数据到列文件（OLAP）或者 level file（TSDB）。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;（3）事务完成后回收 cache engine 和 redo log。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;38:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;在系统内部，为了保证极端情况下还能够从 redo log 中恢复数据，redo log 在对某个事务的日志进行回收之前，首先要向 cache engine 确认该事务已经不在缓存当中，即已经被 cache engine 回收。因此，对于步骤（3），系统实质上是先完成 cache engine 的回收，才会进一步回收 redo log。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;40:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cache engine 的回收，在写入磁盘后完成。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;定期回收&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:3;43:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;43:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;OLAP 引擎：每 30 秒&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;44:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;TSDB 引擎：每 60 秒&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cache engine 的内存占用大小达到一定阈值时回收&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:4;46:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;46:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;OLAP 引擎：当缓存中的数据量达到 OLAPCacheEngineSize 的 30% 时，cache engine 会将内容写到&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;46:71&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;列文件&lt;/b&gt;，完成回收。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;47:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;TSDB 引擎：将当数据量达到 TSDBCacheEngineSize 大小后，cache engine 将内容写入 &lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;47:64&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;level file&lt;/b&gt; （类似于 leveldb 的 flush memtable 的过程），完成回收。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;48:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;48:6&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;flushOLAPCache&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;48:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;flushTSDBCache&lt;/codeph&gt; 手动清理缓存&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;50:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;系统定期回收已完成且 cache engine 完成落盘的事务的 redo log。DolphinDB 提供了两种回收机制：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:5;52:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;52:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;定期回收（&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;52:8&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redoLogPurgeInterval&lt;/codeph&gt;）&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;53:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;文件大小达到一定阈值时回收（&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;53:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redoLogPurgeLimit&lt;/codeph&gt;）&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;55:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;因此，需要注意不可以将 cahce engine 的大小设置过大，否则事务长期滞留在缓存当中，无法被 redo log 回收，将导致 redo log 占用的空间持续增长。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;14-为什么需要-redo-logcache-engine&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;1.4. 为什么需要 redo log/cache engine&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;57:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;59:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;除了解决断电、数据库系统宕机等极端情况下的数据一致性问题，redo log 同时优化了写入性能。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;61:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;以 OLAP 引擎的写入场景为例，如果一次写入 100 个分区，每个分区有 200 个列文件，那么一次就需要写入 20000 个列文件。如果这些列文件都在 1 块 HDD 上，数据直接同步落盘，那么寻址的开销将非常大。而引入 redo log 机制后，落盘时数据无需按分区和列文件进行写入，大幅减小了寻址的开销，优化写入性能。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;63:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;使用 redo log 的主要优势为：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:6;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;65:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;顺序写入性能更好，在事务提交时只需要将日志文件刷新到磁盘，而不是将事务涉及到的所有文件刷新。这点对于 OLAP 引擎来说优化更加明显。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;67:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cache engine 大大减少了磁盘的写入次数，能够提升写入性能，尤其是在数据表列数过多的情况下。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;69:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;DolphinDB 采用列式存储，一个分区内的每一列数据单独存放在一个文件中。如果表的列数过多（比如物联网场景下同时记录几千个指标），每进行一次数据写入，就要对几千个物理文件进行操作（打开，写入，关闭等）。如果把多次少量的写入缓存起来，一次批量写入，就可以节省许多对文件进行打开和关闭带来的时间开销，从而在整体上提升系统的写入性能。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-配置说明&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;2. 配置说明&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;73:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;21-redo-log-相关配置和函数&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;2.1. redo log 相关配置和函数&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;75:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;77:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;配置参数：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:7;79:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:14;79:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;79:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;dataSync&lt;/codeph&gt;：是否使用 redo log 功能。取值为 1 代表开启 redo log；默认值为 0，表示不启用该功能。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:15;80:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;80:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redoLogDir&lt;/codeph&gt;：redo log 文件的存放位置。一般建议将该位置设置到 SSD 硬盘上以获取最佳的性能。默认在 homeDir（由 home 参数决定）下的 log/redoLog 目录下。如果是集群模式，注意要分别设置不同数据节点的目录，避免使用相同目录，造成写入错误。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:16;81:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;81:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redoLogPurgeLimit&lt;/codeph&gt;：redo log 文件占用的最大空间，单位为 GB，默认值为 4。当 redo log 文件大小超过该值时会自动开始回收。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:17;82:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;82:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redoLogPurgeInterval&lt;/codeph&gt;：redo log 自动回收的周期，单位为秒，默认值为 30，表示每 30 秒自动回收一次。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:18;83:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;83:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;TSDBRedoLogDir&lt;/codeph&gt;：TSDB 存储引擎重做日志的目录。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;需要注意有些参数需要配置在控制节点配置文件，有些参数则需要配置在数据节点的配置文件里，上面链接会有具体说明。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;87:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;运维函数：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:8;89:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:19;89:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;89:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;getRedoLogGCStat&lt;/codeph&gt;：获取 redo log 垃圾回收的状态。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:20;90:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;90:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;imtForceGCRedolog&lt;/codeph&gt;：跳过长时间未回收的事务继续回收后续事务。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;22-cache-engine-相关配置和函数&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;2.2. cache engine 相关配置和函数&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;92:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;94:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;94:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;OLAP 引擎 cache engine 相关参数和函数&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;96:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;配置参数：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:9;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:21;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;98:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;OLAPCacheEngineSize&lt;/codeph&gt;：cache engine 中数据量上限，单位为 GB。默认值为 0，表示不使用 cache engine。若该值大于 0，那么当 cache engine 占用内存大于该值的 30% 时，会主动开始异步回收。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;100:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;函数/命令：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:10;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:22;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;102:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;flushOLAPCache&lt;/codeph&gt;：手动清空缓存。只有已经完成的事务才会被清空，正在进行但是还没有提交的事务不会被清空。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:23;103:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;103:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;getOLAPCacheEngineSize&lt;/codeph&gt;：返回 cache engine 占用的内存量。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:24;104:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;104:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;setOLAPCacheEngineSize&lt;/codeph&gt;：在线修改 OLAP 引擎 cache engine 的容量。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:25;105:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;105:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;getOLAPCacheEngineStat&lt;/codeph&gt;：返回 cache engine 的状态。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;107:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;107:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;TSDB 引擎 cache engine 相关参数和函数&lt;/b&gt;&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;109:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;配置参数：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:11;111:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:26;111:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:17;111:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;TSDBCacheEngineSize&lt;/codeph&gt;：默认为 1G，用于配置 TSDB cache engine 的大小，注意如果写入压力太大，系统的 cache engine 内存占用会达到两倍的 TSDBCacheEngineSize 大小。这是因为写入数据量达到 TSDBCacheEngineSize 时，系统会开始将这部分数据刷盘。若刷盘时有新数据的继续写入，系统会重新申请一个新的内存空间。老的内存空间在后台继续做刷盘操作，如果刷盘不够快，有可能因为写入导致新的内存也达到 TSDB CacheEngineSize 大小，所以内存峰值可能会达到 2 倍的 TSDBCacheEngineSize。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;函数/命令：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:12;115:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:27;115:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:18;115:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;flushTSDBCache&lt;/codeph&gt;：将 TSDB 引擎缓冲区里已经完成的事务强制写入数据库。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:28;116:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:19;116:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;getTSDBCacheEngineSize&lt;/codeph&gt;：查看 TSDB 引擎 CacheEngine 许使用的内存上限。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:29;117:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:20;117:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;setTSDBCacheEngineSize&lt;/codeph&gt;：用于在线修改 TSDB 引擎的 CacheEngine 容量。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-性能的影响与优化建议&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;119:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:10;119:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;3. 性能的影响与优化建议&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;119:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;31-磁盘负载和内存使用&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;121:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;121:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;3.1. 磁盘负载和内存使用&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;121:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:13;123:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:30;123:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redo log 会增加磁盘占用，在数据文件以外额外写 redo log 文件增加了数据的写入量。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:31;124:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cache engine 可以减少磁盘负载，因为写入的次数减少了，少量多次的写入变成了批次写入。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:32;125:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cache engine 也会增加内存占用，因为系统对还未写入磁盘的数据进行了缓存。&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;32-对节点启动的影响&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;127:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;127:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;3.2. 对节点启动的影响&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;127:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;129:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redo log 过大可能导致节点启动时间过长，可能有以下原因：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:1;131:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:33;131:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redo log 配置的磁盘空间太大，导致 redo log 文件一直没有回收。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:34;132:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redo log 配置的回收周期太长，导致一直没有触发回收。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:35;133:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cache engine 配置的内存太大，导致 cache engine 一直没有回收，从而阻塞了 redo log 的回收。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:36;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redo log 文件存储在机械硬盘（HDD）上，致使集群启动的时候读取这些文件耗费的时间较多。&lt;/li&gt;&lt;/ol&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;136:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;启动时 redo log 可能需要回放很长时间，用户可以通过在日志里搜索 &#34;transactions to be replayed have been completed&#34; 字符串来查看回放的进度。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;33-相关性能优化的建议&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;138:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;138:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;3.3. 相关性能优化的建议&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;138:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;根据以上叙述，为了提升数据库的整体写入性能，有以下几点建议：&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:2;142:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:37;142:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;将所有元数据的存放目录以及 redo log 存放目录配置到 SSD 磁盘，有条件的情况下使用工业级 SSD 磁盘。具体建议的配置如下：&lt;/li&gt;&lt;/ol&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;144:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;dfsMetaDir: 控制节点元数据存储目录，设置到 SSD 磁盘，在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:1;144:40&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;controller.cfg&lt;/i&gt; 中设置。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;146:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;chunkMetaDir: 数据节点元数据存储目录，设置到 SSD 磁盘，在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:2;146:42&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cluster.cfg&lt;/i&gt; 中设置。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;148:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;redoLogDir: 设置到 SSD 磁盘，在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:3;148:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cluster.cfg&lt;/i&gt; 中设置。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;150:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;persistenceDir: 流数据的存储路径，建议设置到 SSD 磁盘。在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:4;150:43&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cluter.cfg&lt;/i&gt; 中设置。在集群模式中，需要保证同一机器上的数据节点配置了不同的 persistenceDir&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;152:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;logFile: 各个节点的运行日志，记录节点的运行状态、错误信息等，可以写到 HDD 磁盘。在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:5;152:52&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;controller.cfg&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:6;152:70&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;agent.cfg&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:7;152:83&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cluster.cfg&lt;/i&gt; 中设置。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;154:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;batchJobDir: 批处理任务的日志目录，例如 submiJob 提交的任务日志，可以写到 HDD 磁盘。在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:8;154:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cluster.cfg&lt;/i&gt; 中设置。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;156:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;jobLogFile: 各个节点的 query 日志，记录各个 query 的执行情况，可以写到 HDD 磁盘。在 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:9;156:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;cluster.cfg&lt;/i&gt; 中设置。&lt;/p&gt;&lt;ol class=&#34;- topic/ol &#34; xtrc=&#34;ol:3;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:38;158:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;合理配置 redo log 的磁盘空间上限和垃圾回收周期，一般建议配置磁盘空间不超过 4GB，不低于 1GB，回收周期配置为 60 秒。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:39;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/redoLog_cacheEngine.md&#34;&gt;合理配置 cache engine 的内存大小，不宜过大或过小，最大不超过数据节点内存配置的 1/4，设置为 1~4GB 适合大部分情况。具体结合机器硬件与写入数据的速率来决定。&lt;/li&gt;&lt;/ol&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/redoLog_cacheEngine.md"/><meta name="wh-out-relpath" content="tutorials/redoLog_cacheEngine.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="redo-log-和-cache-engine" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/database.html">数据库</a></div></div></li><li class="active"><div class="topicref" data-id="redo-log-和-cache-engine"><div class="title"><a href="../tutorials/redoLog_cacheEngine.html">redo log 和 cache engine</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="分区数据库设计和操作-d9713e98328" class="topicref" data-id="分区数据库设计和操作" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="分区数据库设计和操作-d9713e98328-link">分区数据库设计和操作</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-内存表详解-d9713e98374" class="topicref" data-id="dolphindb-内存表详解" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/in_memory_table.html" id="dolphindb-内存表详解-d9713e98374-link">DolphinDB 内存表详解</a></div></div></li><li role="treeitem"><div data-tocid="内存数据表-d9713e98420" class="topicref" data-id="内存数据表" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/partitioned_in_memory_table.html" id="内存数据表-d9713e98420-link">内存数据表</a></div></div></li><li role="treeitem"><div data-tocid="oltp-内存存储引擎非嵌入式版使用教程-d9713e98466" class="topicref" data-id="oltp-内存存储引擎非嵌入式版使用教程" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/oltp_in-memory_storage_engine_non-embedded_version_tutorials.html" id="oltp-内存存储引擎非嵌入式版使用教程-d9713e98466-link">OLTP 内存存储引擎（非嵌入式版）使用教程</a></div></div></li><li role="treeitem"><div data-tocid="利用缓存表快速实现-mysql-库间信息同步-d9713e98512" class="topicref" data-id="利用缓存表快速实现-mysql-库间信息同步" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/cachedtable.html" id="利用缓存表快速实现-mysql-库间信息同步-d9713e98512-link">利用缓存表快速实现 MySQL 库间信息同步</a></div></div></li><li role="treeitem"><div data-tocid="建库建表最容易忽略的十个细节-d9713e98558" class="topicref" data-id="建库建表最容易忽略的十个细节" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database_and_table_creation_details.html" id="建库建表最容易忽略的十个细节-d9713e98558-link">建库建表最容易忽略的十个细节</a></div></div></li><li role="treeitem" class="active"><div data-tocid="redo-log-和-cache-engine-d9713e98604" class="topicref" data-id="redo-log-和-cache-engine" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/redoLog_cacheEngine.html" id="redo-log-和-cache-engine-d9713e98604-link">redo log 和 cache engine</a></div></div></li><li role="treeitem"><div data-tocid="tsdb-存储引擎简介-d9713e98650" class="topicref" data-id="tsdb-存储引擎简介" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tsdb_engine.html" id="tsdb-存储引擎简介-d9713e98650-link">TSDB 存储引擎简介</a></div></div></li><li role="treeitem"><div data-tocid="tsdb-存储引擎详解-d9713e98696" class="topicref" data-id="tsdb-存储引擎详解" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tsdb_explained.html" id="tsdb-存储引擎详解-d9713e98696-link">TSDB 存储引擎详解</a></div></div></li><li role="treeitem"><div data-tocid="分布式表数据更新原理和性能-d9713e98742" class="topicref" data-id="分布式表数据更新原理和性能" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_update.html" id="分布式表数据更新原理和性能-d9713e98742-link">分布式表数据更新原理和性能</a></div></div></li><li role="treeitem"><div data-tocid="软删除-d9713e98788" class="topicref" data-id="软删除" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/soft_delete.html" id="软删除-d9713e98788-link">软删除</a></div></div></li><li role="treeitem"><div data-tocid="基于-datax-的-dolphindb-数据导入工具-d9713e98835" class="topicref" data-id="基于-datax-的-dolphindb-数据导入工具" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/datax_writer.html" id="基于-datax-的-dolphindb-数据导入工具-d9713e98835-link">基于 DataX 的 DolphinDB 数据导入工具</a></div></div></li><li role="treeitem"><div data-tocid="debezium--kafka-实时同步-mysql-数据到-dolphindb-d9713e98881" class="topicref" data-id="debezium--kafka-实时同步-mysql-数据到-dolphindb" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Debezium_and_Kafka_data_sync.html" id="debezium--kafka-实时同步-mysql-数据到-dolphindb-d9713e98881-link">Debezium + Kafka 实时同步 MySQL 数据到 DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="debeziumkafka-实时同步-oracle-11g-数据到-dolphindb-d9713e98927" class="topicref" data-id="debeziumkafka-实时同步-oracle-11g-数据到-dolphindb" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Debezium_Kafka_Oracle_sync.html" id="debeziumkafka-实时同步-oracle-11g-数据到-dolphindb-d9713e98927-link">Debezium+Kafka 实时同步 Oracle 11g 数据到 DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="clear_cache-d9713e98973" class="topicref" data-id="clear_cache" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/clear_cache.html" id="clear_cache-d9713e98973-link">数据库缓存清理机制 </a></div></div></li><li role="treeitem"><div data-tocid="best_practice_for_storage_compute_separation-d9713e99019" class="topicref" data-id="best_practice_for_storage_compute_separation" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/best_practice_for_storage_compute_separation.html" id="best_practice_for_storage_compute_separation-d9713e99019-link">存算分离最佳实践教程</a></div></div></li><li role="treeitem"><div data-tocid="database_and_table_creation_wizard-d9713e99065" class="topicref" data-id="database_and_table_creation_wizard" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database_and_table_creation_wizard.html" id="database_and_table_creation_wizard-d9713e99065-link">DolphinDB Web 界面库表创建指南</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">redo log 和 cache engine</h1><div class="- topic/body body"><p class="- topic/p p">这篇教程重点介绍了 DolphinDB 中的 redo log 和 cache engine 机制以及其配置对整体性能的影响。</p><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：</p><ul class="- topic/ul ul"><li class="- topic/li li">它们只对 DFS 数据库起作用，对流数据表不起作用</li><li class="- topic/li li">TSDB 存储引擎必须开启 cache engine 和 redo log</li><li class="- topic/li li">OLAP 存储引擎可以不开启 redo log，但启用了 redo log 之后必须启用 cache engine</li></ul></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-redo-logcache-engine-相关概念"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. redo log/cache engine 相关概念</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title3" id="11-什么是-redo-log"><h3 class="- topic/title title topictitle3" id="ariaid-title3">1.1. 什么是 redo log</h3><div class="- topic/body body"><p class="- topic/p p">在关系型数据库系统中，预写式日志 (write-ahead logging, WAL) 是用于提供原子性和持久性的一系列技术。DolphinDB 中的 redo log 与 WAL 的概念类似。简而言之，redo log 的核心思想是：只有在描述事务更改的日志记录刷新到持久化存储介质以后，才对数据库的数据文件进行修改。如果遵循这个过程，就不需要在每次提交事务时都将数据页刷新到磁盘上，因为在数据库发生宕机时，可以使用日志来恢复数据库，尚未应用的所有更改可以通过日志记录回放并重做。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="12-什么是-cache-engine"><h3 class="- topic/title title topictitle3" id="ariaid-title4">1.2. 什么是 cache engine</h3><div class="- topic/body body"><p class="- topic/p p">cache engine 是 DolphinDB 中的一种数据写入缓存机制，它是为了解决数据表列数过多的情况下写入性能急剧下降的问题而引入的。</p><p class="- topic/p p">对一个文件进行写入时，写入 1 行数据和写入 1000 行数据的时间基本相等，大部分时间都花在打开和关闭文件上。因此，引入 cache engine 以后，写入操作时首先写入缓存中，到达一定阈值以后，异步将缓存中的数据写入磁盘中。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="13-redo-log-和-cache-engine-的写入和回收"><h3 class="- topic/title title topictitle3" id="ariaid-title5">1.3. redo log 和 cache engine 的写入和回收</h3><div class="- topic/body body"><br/><img class="- topic/image image" src="images/redoLog_cacheEngine/1_1.png"/><br/><p class="- topic/p p">由上图可知，数据整体的写入流程可以分成三个部分：</p><p class="- topic/p p">（1）数据写入 redo log，一个事务的数据存成一个文件。</p><p class="- topic/p p">（2）数据写入 cache engine，并由 cache engine 异步写入数据到列文件（OLAP）或者 level file（TSDB）。</p><p class="- topic/p p">（3）事务完成后回收 cache engine 和 redo log。</p><p class="- topic/p p">在系统内部，为了保证极端情况下还能够从 redo log 中恢复数据，redo log 在对某个事务的日志进行回收之前，首先要向 cache engine 确认该事务已经不在缓存当中，即已经被 cache engine 回收。因此，对于步骤（3），系统实质上是先完成 cache engine 的回收，才会进一步回收 redo log。</p><p class="- topic/p p">cache engine 的回收，在写入磁盘后完成。</p><ul class="- topic/ul ul"><li class="- topic/li li">定期回收<ul class="- topic/ul ul"><li class="- topic/li li">OLAP 引擎：每 30 秒</li><li class="- topic/li li">TSDB 引擎：每 60 秒</li></ul></li><li class="- topic/li li">cache engine 的内存占用大小达到一定阈值时回收<ul class="- topic/ul ul"><li class="- topic/li li">OLAP 引擎：当缓存中的数据量达到 OLAPCacheEngineSize 的 30% 时，cache engine 会将内容写到<strong class="+ topic/ph hi-d/b ph b">列文件</strong>，完成回收。</li><li class="- topic/li li">TSDB 引擎：将当数据量达到 TSDBCacheEngineSize 大小后，cache engine 将内容写入 <strong class="+ topic/ph hi-d/b ph b">level file</strong> （类似于 leveldb 的 flush memtable 的过程），完成回收。</li></ul></li><li class="- topic/li li">通过 <code class="+ topic/ph pr-d/codeph ph codeph">flushOLAPCache</code>，<code class="+ topic/ph pr-d/codeph ph codeph">flushTSDBCache</code> 手动清理缓存</li></ul><p class="- topic/p p">系统定期回收已完成且 cache engine 完成落盘的事务的 redo log。DolphinDB 提供了两种回收机制：</p><ul class="- topic/ul ul"><li class="- topic/li li">定期回收（<code class="+ topic/ph pr-d/codeph ph codeph">redoLogPurgeInterval</code>）</li><li class="- topic/li li">文件大小达到一定阈值时回收（<code class="+ topic/ph pr-d/codeph ph codeph">redoLogPurgeLimit</code>）</li></ul><p class="- topic/p p">因此，需要注意不可以将 cahce engine 的大小设置过大，否则事务长期滞留在缓存当中，无法被 redo log 回收，将导致 redo log 占用的空间持续增长。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title6" id="14-为什么需要-redo-logcache-engine"><h3 class="- topic/title title topictitle3" id="ariaid-title6">1.4. 为什么需要 redo log/cache engine</h3><div class="- topic/body body"><p class="- topic/p p">除了解决断电、数据库系统宕机等极端情况下的数据一致性问题，redo log 同时优化了写入性能。</p><p class="- topic/p p">以 OLAP 引擎的写入场景为例，如果一次写入 100 个分区，每个分区有 200 个列文件，那么一次就需要写入 20000 个列文件。如果这些列文件都在 1 块 HDD 上，数据直接同步落盘，那么寻址的开销将非常大。而引入  redo log 机制后，落盘时数据无需按分区和列文件进行写入，大幅减小了寻址的开销，优化写入性能。</p><p class="- topic/p p">使用 redo log 的主要优势为：</p><ul class="- topic/ul ul"><li class="- topic/li li">顺序写入性能更好，在事务提交时只需要将日志文件刷新到磁盘，而不是将事务涉及到的所有文件刷新。这点对于 OLAP 引擎来说优化更加明显。</li></ul><p class="- topic/p p">cache engine 大大减少了磁盘的写入次数，能够提升写入性能，尤其是在数据表列数过多的情况下。</p><p class="- topic/p p">DolphinDB 采用列式存储，一个分区内的每一列数据单独存放在一个文件中。如果表的列数过多（比如物联网场景下同时记录几千个指标），每进行一次数据写入，就要对几千个物理文件进行操作（打开，写入，关闭等）。如果把多次少量的写入缓存起来，一次批量写入，就可以节省许多对文件进行打开和关闭带来的时间开销，从而在整体上提升系统的写入性能。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title7" id="2-配置说明"><h2 class="- topic/title title topictitle2" id="ariaid-title7">2. 配置说明</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title8" id="21-redo-log-相关配置和函数"><h3 class="- topic/title title topictitle3" id="ariaid-title8">2.1. redo log 相关配置和函数</h3><div class="- topic/body body"><p class="- topic/p p">配置参数：</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">dataSync</code>：是否使用 redo log 功能。取值为 1 代表开启 redo log；默认值为 0，表示不启用该功能。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">redoLogDir</code>：redo log 文件的存放位置。一般建议将该位置设置到 SSD 硬盘上以获取最佳的性能。默认在 homeDir（由 home 参数决定）下的 log/redoLog 目录下。如果是集群模式，注意要分别设置不同数据节点的目录，避免使用相同目录，造成写入错误。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">redoLogPurgeLimit</code>：redo log 文件占用的最大空间，单位为 GB，默认值为 4。当 redo log 文件大小超过该值时会自动开始回收。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">redoLogPurgeInterval</code>：redo log 自动回收的周期，单位为秒，默认值为 30，表示每 30 秒自动回收一次。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">TSDBRedoLogDir</code>：TSDB 存储引擎重做日志的目录。</li></ul><p class="- topic/p p">需要注意有些参数需要配置在控制节点配置文件，有些参数则需要配置在数据节点的配置文件里，上面链接会有具体说明。</p><p class="- topic/p p">运维函数：</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">getRedoLogGCStat</code>：获取 redo log 垃圾回收的状态。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">imtForceGCRedolog</code>：跳过长时间未回收的事务继续回收后续事务。</li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title9" id="22-cache-engine-相关配置和函数"><h3 class="- topic/title title topictitle3" id="ariaid-title9">2.2. cache engine 相关配置和函数</h3><div class="- topic/body body"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">OLAP 引擎 cache engine 相关参数和函数</strong></p><p class="- topic/p p">配置参数：</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">OLAPCacheEngineSize</code>：cache engine 中数据量上限，单位为 GB。默认值为 0，表示不使用 cache engine。若该值大于 0，那么当 cache engine 占用内存大于该值的 30% 时，会主动开始异步回收。</li></ul><p class="- topic/p p">函数/命令：</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">flushOLAPCache</code>：手动清空缓存。只有已经完成的事务才会被清空，正在进行但是还没有提交的事务不会被清空。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">getOLAPCacheEngineSize</code>：返回 cache engine 占用的内存量。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">setOLAPCacheEngineSize</code>：在线修改 OLAP 引擎 cache engine 的容量。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">getOLAPCacheEngineStat</code>：返回 cache engine 的状态。</li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">TSDB 引擎 cache engine 相关参数和函数</strong></p><p class="- topic/p p">配置参数：</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">TSDBCacheEngineSize</code>：默认为 1G，用于配置 TSDB cache engine 的大小，注意如果写入压力太大，系统的 cache engine 内存占用会达到两倍的 TSDBCacheEngineSize 大小。这是因为写入数据量达到 TSDBCacheEngineSize 时，系统会开始将这部分数据刷盘。若刷盘时有新数据的继续写入，系统会重新申请一个新的内存空间。老的内存空间在后台继续做刷盘操作，如果刷盘不够快，有可能因为写入导致新的内存也达到 TSDB CacheEngineSize 大小，所以内存峰值可能会达到 2 倍的 TSDBCacheEngineSize。</li></ul><p class="- topic/p p">函数/命令：</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">flushTSDBCache</code>：将 TSDB 引擎缓冲区里已经完成的事务强制写入数据库。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">getTSDBCacheEngineSize</code>：查看 TSDB 引擎 CacheEngine 许使用的内存上限。</li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">setTSDBCacheEngineSize</code>：用于在线修改 TSDB 引擎的 CacheEngine 容量。</li></ul></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title10" id="3-性能的影响与优化建议"><h2 class="- topic/title title topictitle2" id="ariaid-title10">3. 性能的影响与优化建议</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title11" id="31-磁盘负载和内存使用"><h3 class="- topic/title title topictitle3" id="ariaid-title11">3.1. 磁盘负载和内存使用</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">redo log 会增加磁盘占用，在数据文件以外额外写 redo log 文件增加了数据的写入量。</li><li class="- topic/li li">cache engine 可以减少磁盘负载，因为写入的次数减少了，少量多次的写入变成了批次写入。</li><li class="- topic/li li">cache engine 也会增加内存占用，因为系统对还未写入磁盘的数据进行了缓存。</li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title12" id="32-对节点启动的影响"><h3 class="- topic/title title topictitle3" id="ariaid-title12">3.2. 对节点启动的影响</h3><div class="- topic/body body"><p class="- topic/p p">redo log 过大可能导致节点启动时间过长，可能有以下原因：</p><ol class="- topic/ol ol"><li class="- topic/li li">redo log 配置的磁盘空间太大，导致 redo log 文件一直没有回收。</li><li class="- topic/li li">redo log 配置的回收周期太长，导致一直没有触发回收。</li><li class="- topic/li li">cache engine 配置的内存太大，导致 cache engine 一直没有回收，从而阻塞了 redo log 的回收。</li><li class="- topic/li li">redo log 文件存储在机械硬盘（HDD）上，致使集群启动的时候读取这些文件耗费的时间较多。</li></ol><p class="- topic/p p">启动时 redo log 可能需要回放很长时间，用户可以通过在日志里搜索 "transactions to be replayed have been completed" 字符串来查看回放的进度。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title13" id="33-相关性能优化的建议"><h3 class="- topic/title title topictitle3" id="ariaid-title13">3.3. 相关性能优化的建议</h3><div class="- topic/body body"><p class="- topic/p p">根据以上叙述，为了提升数据库的整体写入性能，有以下几点建议：</p><ol class="- topic/ol ol"><li class="- topic/li li">将所有元数据的存放目录以及 redo log 存放目录配置到 SSD 磁盘，有条件的情况下使用工业级 SSD 磁盘。具体建议的配置如下：</li></ol><p class="- topic/p p">dfsMetaDir: 控制节点元数据存储目录，设置到 SSD 磁盘，在 <em class="+ topic/ph hi-d/i ph i">controller.cfg</em> 中设置。</p><p class="- topic/p p">chunkMetaDir: 数据节点元数据存储目录，设置到 SSD 磁盘，在 <em class="+ topic/ph hi-d/i ph i">cluster.cfg</em> 中设置。</p><p class="- topic/p p">redoLogDir: 设置到 SSD 磁盘，在 <em class="+ topic/ph hi-d/i ph i">cluster.cfg</em> 中设置。</p><p class="- topic/p p">persistenceDir: 流数据的存储路径，建议设置到 SSD 磁盘。在 <em class="+ topic/ph hi-d/i ph i">cluter.cfg</em> 中设置。在集群模式中，需要保证同一机器上的数据节点配置了不同的 persistenceDir</p><p class="- topic/p p">logFile: 各个节点的运行日志，记录节点的运行状态、错误信息等，可以写到 HDD 磁盘。在 <em class="+ topic/ph hi-d/i ph i">controller.cfg</em>, <em class="+ topic/ph hi-d/i ph i">agent.cfg</em>, <em class="+ topic/ph hi-d/i ph i">cluster.cfg</em> 中设置。</p><p class="- topic/p p">batchJobDir: 批处理任务的日志目录，例如 submiJob 提交的任务日志，可以写到 HDD 磁盘。在 <em class="+ topic/ph hi-d/i ph i">cluster.cfg</em> 中设置。</p><p class="- topic/p p">jobLogFile: 各个节点的 query 日志，记录各个 query 的执行情况，可以写到 HDD 磁盘。在 <em class="+ topic/ph hi-d/i ph i">cluster.cfg</em> 中设置。</p><ol class="- topic/ol ol"><li class="- topic/li li">合理配置 redo log 的磁盘空间上限和垃圾回收周期，一般建议配置磁盘空间不超过 4GB，不低于 1GB，回收周期配置为 60 秒。</li><li class="- topic/li li">合理配置 cache engine 的内存大小，不宜过大或过小，最大不超过数据节点内存配置的 1/4，设置为 1~4GB 适合大部分情况。具体结合机器硬件与写入数据的速率来决定。</li></ol></div></article></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-redo-logcache-engine-%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5" data-tocid="1-redo-logcache-engine-相关概念">1. redo log/cache engine 相关概念</a><ul><li class="topic-item"><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AF-redo-log" data-tocid="11-什么是-redo-log">1.1. 什么是 redo log</a></li><li class="topic-item"><a href="#12-%E4%BB%80%E4%B9%88%E6%98%AF-cache-engine" data-tocid="12-什么是-cache-engine">1.2. 什么是 cache engine</a></li><li class="topic-item"><a href="#13-redo-log-%E5%92%8C-cache-engine-%E7%9A%84%E5%86%99%E5%85%A5%E5%92%8C%E5%9B%9E%E6%94%B6" data-tocid="13-redo-log-和-cache-engine-的写入和回收">1.3. redo log 和 cache engine 的写入和回收</a></li><li class="topic-item"><a href="#14-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-redo-logcache-engine" data-tocid="14-为什么需要-redo-logcache-engine">1.4. 为什么需要 redo log/cache engine</a></li></ul></li><li class="topic-item"><a href="#2-%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E" data-tocid="2-配置说明">2. 配置说明</a><ul><li class="topic-item"><a href="#21-redo-log-%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE%E5%92%8C%E5%87%BD%E6%95%B0" data-tocid="21-redo-log-相关配置和函数">2.1. redo log 相关配置和函数</a></li><li class="topic-item"><a href="#22-cache-engine-%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE%E5%92%8C%E5%87%BD%E6%95%B0" data-tocid="22-cache-engine-相关配置和函数">2.2. cache engine 相关配置和函数</a></li></ul></li><li class="topic-item"><a href="#3-%E6%80%A7%E8%83%BD%E7%9A%84%E5%BD%B1%E5%93%8D%E4%B8%8E%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE" data-tocid="3-性能的影响与优化建议">3. 性能的影响与优化建议</a><ul><li class="topic-item"><a href="#31-%E7%A3%81%E7%9B%98%E8%B4%9F%E8%BD%BD%E5%92%8C%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8" data-tocid="31-磁盘负载和内存使用">3.1. 磁盘负载和内存使用</a></li><li class="topic-item"><a href="#32-%E5%AF%B9%E8%8A%82%E7%82%B9%E5%90%AF%E5%8A%A8%E7%9A%84%E5%BD%B1%E5%93%8D" data-tocid="32-对节点启动的影响">3.2. 对节点启动的影响</a></li><li class="topic-item"><a href="#33-%E7%9B%B8%E5%85%B3%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E7%9A%84%E5%BB%BA%E8%AE%AE" data-tocid="33-相关性能优化的建议">3.3. 相关性能优化的建议</a></li></ul></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>