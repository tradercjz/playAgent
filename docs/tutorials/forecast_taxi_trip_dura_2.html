<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../favicon.ico"/><link rel="icon" href="../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="DolphinDB 集高性能时序数据库与全面的分析功能为一体，可用于海量结构化数据的存储、查询、分析、实时计算等，在工业物联网场景中应用广泛。本文以纽约出租车行程时间预测为例，介绍如何使用 DolphinDB 训练机器学习模型，并进行实时数据的预测，为基于智能网联汽车的车联网企业提供基于机器学习方法的即时预测方案。 ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.coverage" content=""/><meta name="DC.relation" content="../tutorials/about_tutorials.html"/><meta name="prodname" content="DolphinDB"/><meta name="brand" content="DolphinDB"/><meta name="DC.creator" content="DolphinDB"/><meta name="DC.publisher" content="DDB N/A DDB 200"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="出租车行程时间预测"/><title>出租车行程时间预测</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/tutorials?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/tutorials/?&gt;&lt;?path2project ..?&gt;&lt;?path2project-uri ../?&gt;&lt;?path2rootmap-uri ../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;出租车行程时间预测&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;出租车行程时间预测&lt;/title&gt;&lt;prolog class=&#34;- topic/prolog &#34;&gt;&lt;author class=&#34;- topic/author &#34; xtrc=&#34;author:1;12:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/author&gt;&lt;publisherinformation class=&#34;- topic/publisher bookmap/publisherinformation &#34; xtrc=&#34;publisherinformation:1;14:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:1;15:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;printlocation class=&#34;- topic/data bookmap/printlocation &#34; xtrc=&#34;printlocation:1;16:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;N/A&lt;/printlocation&gt; &lt;published class=&#34;- topic/data bookmap/published &#34; xtrc=&#34;published:1;17:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;person class=&#34;- topic/data bookmap/person &#34; xtrc=&#34;person:2;18:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DDB&lt;/person&gt; &lt;publishtype class=&#34;- topic/data bookmap/publishtype &#34; value=&#34;HTML&#34; xtrc=&#34;publishtype:1;19:44&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;revisionid class=&#34;- topic/ph bookmap/revisionid &#34; xtrc=&#34;revisionid:1;20:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;200&lt;/revisionid&gt; &lt;summary class=&#34;- topic/ph bookmap/summary &#34; xtrc=&#34;summary:1;22:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:1;23:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/published&gt; &lt;data class=&#34;- topic/data &#34; xtrc=&#34;data:2;25:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt; &lt;/publisherinformation&gt;&lt;metadata class=&#34;- topic/metadata &#34;&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:2;39:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;audience class=&#34;- topic/audience &#34; xtrc=&#34;audience:1;28:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;category class=&#34;- topic/category &#34; xtrc=&#34;category:1;29:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;/&gt;&lt;prodinfo class=&#34;- topic/prodinfo &#34; xtrc=&#34;prodinfo:1;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt; &lt;prodname class=&#34;- topic/prodname &#34; xtrc=&#34;prodname:1;35:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/prodname&gt; &lt;brand class=&#34;- topic/brand &#34; xtrc=&#34;brand:1;36:24&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/ddb_doc_centre.ditamap&#34;&gt;DolphinDB&lt;/brand&gt; &lt;/prodinfo&gt;&lt;/metadata&gt;&lt;/prolog&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:1;1:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:1;3:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 集高性能时序数据库与全面的分析功能为一体，可用于海量结构化数据的存储、查询、分析、实时计算等，在工业物联网场景中应用广泛。本文以纽约出租车行程时间预测为例，介绍如何使用 DolphinDB 训练机器学习模型，并进行实时数据的预测，为基于智能网联汽车的车联网企业提供基于机器学习方法的即时预测方案。&lt;/p&gt;&lt;/body&gt;&lt;related-links class=&#34;- topic/related-links &#34;&gt;&lt;linkpool class=&#34;- topic/linkpool &#34; xtrc=&#34;topicref:147;190:86&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;link class=&#34;- topic/link &#34; format=&#34;dita&#34; href=&#34;../tutorials/about_tutorials.dita&#34; mapclass=&#34;- map/topicref bookmap/chapter &#34; role=&#34;parent&#34; scope=&#34;local&#34; type=&#34;topic&#34; xtrc=&#34;topicref:1;5:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/chap_tutorials.ditamap&#34;&gt;&lt;?ditaot usertext?&gt;&lt;linktext class=&#34;- topic/linktext &#34;&gt;&lt;?ditaot usertext?&gt;教程&lt;/linktext&gt;&lt;?ditaot usershortdesc?&gt;&lt;desc class=&#34;- topic/desc &#34;&gt;DolphinDB 产品使用教程&lt;/desc&gt;&lt;/link&gt;&lt;/linkpool&gt;&lt;/related-links&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;1-概要&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:2;6:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:2;6:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;1. 概要&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:2;6:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:2;8:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;随着手机移动应用与网约车平台的迅速发展，网约车出行逐渐成为城市生活中一种重要的出行方式。相较其他出行方式而言，选择网约车的乘客对出行时效性有更高的要求，本文将基于乘客上车时间及上下车地点等静态信息，使用 DolphinDB 机器学习方法训练模型，预测网约车行程时间。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:3;10:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;在此基础上，本文将介绍如何使用 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;streaming_tutorial.md&#34; xtrc=&#34;xref:1;10:17&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;DolphinDB 流数据处理系统&lt;/xref&gt;对业务系统产生的持续增长的网约车订单动态数据进行实时的收集、清洗、统计、入库，并实时展示行程时间预测结果。&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:1;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:3;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;行程时间实时预测流程&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;../stream/images/forecast_taxi_1.png&#34; xtrc=&#34;image:1;12:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;2080&#34; dita-ot:image-height=&#34;720&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt; &lt;/fig&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;2-数据介绍&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:3;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:4;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;2. 数据介绍&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:3;19:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;21-数据来源及训练方法&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:5;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;2.1. 数据来源及训练方法&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:4;21:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:4;23:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;本文训练和预测采用 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://www.kaggle.com/competitions/nyc-taxi-trip-duration/data&#34; scope=&#34;external&#34; xtrc=&#34;xref:2;23:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;?ditaot usertext?&gt;Kaggle&lt;/xref&gt;提供的来自纽约出租车委员会的数据集，训练方法参考了获奖者 &lt;xref class=&#34;- topic/xref &#34; format=&#34;html&#34; href=&#34;https://www.kaggle.com/competitions/nyc-taxi-trip-duration&#34; scope=&#34;external&#34; xtrc=&#34;xref:3;23:114&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;?ditaot usertext?&gt;beluga&lt;/xref&gt; 的模型，使用 DolphinDB 对原始数据进行数据预处理，完成位置信息主成分分析（PCA, Principal Component Analysis）、位置信息聚类（KMeans）、新特征构建等工作，并使用 DolphinDB XGBoost 插件完成模型训练及行程时间预测。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:5;25:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;为对比 DolphinDB 在机器学习上的性能，本文使用 Python Scikit-Learn 库及 XGBoost 在同一环境下进行了模型训练和预测，DolphinDB 在训练耗时、模型精度等方面均有良好表现。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;22-数据特征&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:5;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:6;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;2.2. 数据特征&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:5;27:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:6;29:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;该数据集预先分为训练数据集及测试数据集，训练数据集共包含 1458644 条数据，测试数据集共包括 625134 条数据；训练数据集共包含以下 11 列信息。&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:1;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;4&#34; xtrc=&#34;tgroup:1;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:1;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:2;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:3;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col4&#34; colnum=&#34;4&#34; xtrc=&#34;colspec:4;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:1;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:1;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:1;31:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:1;31:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;列名&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:2;31:21&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:2;31:22&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;列类型&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:3;31:31&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:3;31:32&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;说明&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:4;31:60&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:4;31:61&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;实例&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:1;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:2;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:5;33:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;id&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:6;33:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;SYMBOL&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:7;33:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;行程的唯一标识&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:8;33:60&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;id2875421&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:3;34:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:9;34:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;vendor_id&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:10;34:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;INT&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:11;34:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;行程记录提供商代码&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:12;34:58&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;2&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:4;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:13;35:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;pickup_datetime&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:14;35:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DATETIME&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:15;35:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;出租车计价器开启时间&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:16;35:57&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;2016/3/14 17:24:55&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:5;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:17;36:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;dropoff_datetime&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:18;36:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DATETIME&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:19;36:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;出租车计价器关闭时间&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;5&#34; xtrc=&#34;entry:20;36:57&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;2016/3/14 17:32:30&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:6;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:21;37:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;passenger_count&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:22;37:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;INT&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:23;37:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;乘客数量&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;6&#34; xtrc=&#34;entry:24;37:63&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;1&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:7;38:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:25;38:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;pickup_longitude&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:26;38:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:27;38:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;出租车计价器开启位置经度&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;7&#34; xtrc=&#34;entry:28;38:55&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;-73.98215484619139&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:8;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:29;39:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;pickup_latitude&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:30;39:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:31;39:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;出租车计价器开启位置纬度&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;8&#34; xtrc=&#34;entry:32;39:55&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;40.76793670654297&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:9;40:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:33;40:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;dropoff_longitude&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:34;40:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:35;40:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;出租车计价器关闭位置经度&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;9&#34; xtrc=&#34;entry:36;40:55&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;-73.96463012695312&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:10;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:37;41:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;dropoff_latitude&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:38;41:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DOUBLE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:39;41:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;出租车计价器关闭位置纬度&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;10&#34; xtrc=&#34;entry:40;41:55&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;40.765602111816406&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:11;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:41;42:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;store_and_fwd_flag&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:42;42:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;CHAR&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:43;42:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;标识来源是否为存储的历史数据&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;11&#34; xtrc=&#34;entry:44;42:53&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;N&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:12;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:45;43:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;trip_duration&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:46;43:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;INT&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:47;43:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;行程时间（按秒计）&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col4&#34; dita-ot:x=&#34;4&#34; dita-ot:y=&#34;12&#34; xtrc=&#34;entry:48;43:58&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;455&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:7;45:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;行程时间预测的目标列为上表中 trip_duration 列，即 dropoff_datetime 与 pickup_datetime 之差。测试数据集用于预测，故其列信息不包括 dropoff_datetime 及 trip_duration 列，测试数据集中行程标识、位置等列属性同上表。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:8;47:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;上表的数据类型中，SYMBOL 类型是 DolphinDB 中一种特殊的字符串类型，在系统内部的存储结构为一个编码字典，DATETIME 类型为包含了日期和时刻的时间类型。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:9;49:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 支持 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:1;49:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;loadText&lt;/codeph&gt; 方法读取 csv 等数据存储文件到内存表，用户可以 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:2;49:51&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;schema&lt;/codeph&gt; 函数获取表的特征信息。DolphinDB 也支持使用 SQL 语句完成数据的查询。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:1;51:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;train = loadText(&#34;./taxidata/train.csv&#34;) train.schema().colDefs select count(*) from train select top 5 * from train&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;23-数据存储&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:6;58:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:7;58:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;2.3. 数据存储&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:6;58:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:10;60:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;将数据加载到内存表后，可以将训练数据与测试数据导入 DolphinDB 数据库中，便于后续数据的读取与模型的训练，数据导入分布式数据库的操作详见 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;database.md&#34; xtrc=&#34;xref:4;60:74&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;分区数据库教程&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;3-模型构建&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:7;62:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:8;62:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;3. 模型构建&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:7;62:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:11;64:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;本节介绍行程时间预测模型的构建方法。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:12;66:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;行程时间预测模型的构建分多个过程，一是预处理原始数据，对可能存在的空值进行转换，并将字符等非数值型数据转换为可用于模型训练的数值型数据；二是优化位置信息，原始数据中的纬度经度信息集中在 40.70 °N 至 40.80 °N 及 73.94 °W 至 74.02 °W 之间，数据间位置特征差异不够显著，使用主成分分析、聚类方法处理可以提取到特征更明显的信息；三是新特征的构建，位置信息和时间信息是订单数据的两个关键维度，通过计算可以在位置信息基础上得到方位、距离信息，提取更多空间特征，而组合不同类别的位置信息和时间信息也可以得到更复杂的特征，有利于模型学习深层次的时空规律。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;31-数据预处理&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:8;68:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:9;68:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;3.1. 数据预处理&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:8;68:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:13;70:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;在模型训练过程中，首先需要检查数据集是否包含空值，本训练数据集与测试数据集均不包含空值，若存在缺失值，还需要删除、插补等操作解决缺失数据问题。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:14;72:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;其次，需要检查数据集数据类型，原始数据往往包含文本/字符数据，由“数据特征”小节的表可知，本数据集中 store_and_fwd_flag 列为字符型数据，pickup_datetime 及 dropoff_datetime 列为日期时间类型数据，为充分利用这些信息训练模型，需要将其转化为数值型数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:15;74:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;此外，考虑到该数据测试集评价指标为均方根对数误差（Root Mean Squared Logarithmic Error, RMSLE），同时，最大行程时间接近 1000 小时，离群值会影响模型训练效果，对行程时间取对数作为预测值，在评价时（见“模型评价”）可以直接使用均方根误差（Root Mean Squared Error, RMSE）指标。&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:2;78:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title align=&#34;left&#34; class=&#34;- topic/title &#34; xtrc=&#34;title:10;78:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;RMSE&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/Forecast_of_Taxi_Trip_Duration/3_1.png&#34; xtrc=&#34;image:2;78:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;380&#34; dita-ot:image-height=&#34;93&#34;/&gt; &lt;/fig&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:16;85:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 提供多种计算函数，可以帮助用户快速实现数据处理。DolphinDB 提供 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:3;85:48&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;isNull()&lt;/codeph&gt; 方法用于判断空值，配合 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:4;85:71&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;sum()&lt;/codeph&gt; 等聚合函数使用可以快速完成整表数据的查询；提供类似于条件运算符的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:5;85:112&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;iif()&lt;/codeph&gt; 方法简化 if-else 语句；&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:6;85:136&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;date()&lt;/codeph&gt;、&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:7;85:145&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;weekday()&lt;/codeph&gt;、&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:8;85:157&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;hour()&lt;/codeph&gt; 等方法可以提取时间、日期数据的不同特征，简洁高效；类似于 Python 等编程语言，DolphinDB 支持方括号（[]）索引，简化了表的查找、更新和插入。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:2;88:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;sum(isNull(train)) // 0，不含空值 trainData[`store_and_fwd_flag_int] = iif(trainData[`store_and_fwd_flag] == 'N', int(0), int(1)) // 将字符N/Y转化为0/1值 trainData[`pickup_date] = date(trainData[`pickup_datetime]) // 日期 trainData[`pickup_weekday] = weekday(trainData[`pickup_datetime]) // 星期* trainData[`pickup_hour] = hour(trainData[`pickup_datetime]) // 小时 trainData[`log_trip_duration] = log(double(trainData[`trip_duration]) + 1)// 对行程时间取对数，log(trip_duration+1) select max(trip_duration / 3600) from trainData // 训练集上最大行程时间为979h&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;32-位置信息主成分分析pca&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:9;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:11;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;3.2. 位置信息主成分分析（PCA）&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:9;98:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:17;100:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;原始数据中的纬度经度信息集中在 40.70 °N 至 40.80 °N 及 73.94 °W 至 74.02 °W 之间，数据间位置特征差异不够显著，使用 PCA 来转换经度和纬度坐标，有助于 XGBoost 决策树的拆分，DolphinDB PCA 函数使用详见&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:9;100:133&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;pca&lt;/codeph&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:18;102:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB PCA 返回的结果是一个字典，包含 components、explainedVarianceRatio、singularValues 三个键，分别代表对应大小为 size(colNames)*k 的主成分分析矩阵、前 k 个主成分每个特征的方差贡献率、主成分方差（协方差矩阵特征值）。可通过主成分分析矩阵转换待处理数据，详见 &lt;xref class=&#34;- topic/xref &#34; format=&#34;py&#34; href=&#34;https://github.com/scikit-learn/scikit-learn/blob/9aaed4987/sklearn/decomposition/_base.py#L100&#34; scope=&#34;external&#34; xtrc=&#34;xref:5;102:174&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;?ditaot usertext?&gt;Scikit-Learn PCA.transform()&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:19;104:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;可从中取若干数据绘制经度 - 纬度散点图观察 PCA 结果。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:20;106:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;经处理，位置坐标分散在原点附近。&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:3;108:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:12;108:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;PCA 前上客位置信息&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/Forecast_of_Taxi_Trip_Duration/3_2.png&#34; xtrc=&#34;image:3;108:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;1852&#34; dita-ot:image-height=&#34;934&#34;/&gt; &lt;/fig&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:4;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:13;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;PCA 后上客位置信息&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/Forecast_of_Taxi_Trip_Duration/3_3.png&#34; xtrc=&#34;image:4;113:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;1840&#34; dita-ot:image-height=&#34;932&#34;/&gt; &lt;/fig&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:21;118:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:10;118:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;pca()&lt;/codeph&gt; 接收一个或多个数据源为参数，对指定列中的数据进行主成分分析，用户可通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:11;118:45&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;table()&lt;/codeph&gt; 方法创建内存表，用于 PCA；DolphinDB 也提供了 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:12;118:85&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;dot()&lt;/codeph&gt;、&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:13;118:93&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;repmat()&lt;/codeph&gt; 等矩阵乘法、矩阵堆叠方法，用户可使用内置函数快速完成矩阵运算，处理位置信息。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:3;120:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;PCApara = table(trainData[`pickup_latitude] as latitude, trainData[`pickup_longitude] as longitude) pca_model = pca(sqlDS(&amp;lt;select * from PCApara&amp;gt;)) // 使用PCA计算数据集属性 pca_trainpick = dot((matrix(trainPickPara) - repmat(matrix(avg(trainPickPara)), train_n, 1)), pca_model.components) // transform trainData[`pca_trainpick_0] = flatten(pca_trainpick[:, 0])&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:22;126:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 提供了 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:14;126:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;plot&lt;/codeph&gt; 函数供数据可视化。用户可通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:15;126:37&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;chartType&lt;/codeph&gt; 指定图表类型，详见 &lt;xref class=&#34;- topic/xref &#34; href=&#34;../funcs/p/plot.dita&#34; xtrc=&#34;xref:6;126:59&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;plot&lt;/xref&gt;。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:4;128:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;x = select top 1000 pca_trainpick_1 from trainData y = flatten(matrix(select top 1000 pca_trainpick_0 from trainData)) plot(x, y, chartType=SCATTER)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;33-位置信息聚类kmeans&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:10;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:14;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;3.3. 位置信息聚类（KMeans）&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:10;134:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:23;136:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;原始数据位置数据规模庞大，很难挖掘多条数据间的共同特征。KMeans 可以将经纬度相近的数据点归为同一个簇，有助于更好地归纳组内数据特征。本模型指定要生成的聚类数为 100，质心最大迭代次数为 100，选择 KMeans++ 算法生成模型，DolphinDB kmeans 可选参数及含义详见&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:16;136:147&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;kmeans&lt;/codeph&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:24;138:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;可以使用条形图观察聚类后的数据分布。&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:5;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:15;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;KMeans 聚类结果&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/Forecast_of_Taxi_Trip_Duration/3_4.png&#34; xtrc=&#34;image:5;140:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;1805&#34; dita-ot:image-height=&#34;900&#34;/&gt; &lt;/fig&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:25;145:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:17;145:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;kmeans()&lt;/codeph&gt; 接收一个表作为训练集。对于机器学习函数生成的模型，DolphinDB 提供 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:18;145:50&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;saveModel&lt;/codeph&gt; 方法将模型保存到本地文件中用于后续预测，用户可指定服务器端输出文件的绝对路径或相对路径；DolphinDB 也提供了 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:19;145:121&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;predict&lt;/codeph&gt; 方法，调用已训练的特定模型对相同表结构的测试集数据进行预测。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:5;147:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;kmeans_set = PCApara[rand(size(PCApara)-1, 500000)] // 随机选取500000数据用于聚类 kmeans_model = kmeans(kmeans_set, 100, maxIter=100, init='k-means++') // KMeans++ saveModel(kmeans_model, &#34;./taxidata/KMeans.model&#34;) // 保存模型训练结果 trainData['pickup_cluster'] = kmeans_model.predict(select pickup_latitude, pickup_longitude from trainData)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:26;154:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:20;154:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;saveModel&lt;/codeph&gt; 和 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:21;154:15&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;predict&lt;/codeph&gt; 函数的使用方法可以参考：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:1;156:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:1;156:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:22;156:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;saveModel&lt;/codeph&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:2;157:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:23;157:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;predict&lt;/codeph&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;34-新特征构建&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:11;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:16;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;3.4. 新特征构建&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:11;159:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:27;161:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;原始数据仅提供了经度及纬度位置信息，可在此基础上增加位置特征，如地球表面两经纬度点之间距离、两经纬度点之间的 Manhattan 距离、两个经纬度之间的方位信息等等。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:28;163:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;地球表面两点间的距离可使用 haversine 公式精确得到，而在本数据集中，网约车实际驶过的往往是水平或竖直的街道所组成的路径，Manhattan 距离（也称城市街区距离）标明两个点在标准坐标系上的绝对轴距总和，可能能够更精确地反映实际的行驶距离。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:29;165:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;在此基础上，考虑到训练集包含了完整的时间信息，还可以在训练集上添加速度特征。训练集上的速度特征无法直接用于测试集，但在相同的位置聚类属性或相同的时间日期特征下，行程所需时间及平均速度可能存在某些共性（如郊区或凌晨时分网约车车速偏大而城区及早晚高峰时段网约车车速偏小），可以将这种训练集上发现的经验应用到测试集上。可将数据按聚类属性或时间特征分组，统计组内数据平均速度等特征，组合生成新特征，合并到测试集的相应分组中。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:30;167:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;距离、方位的计算参数不同而方法相同，DolphinDB 支持用户自定义函数，通过独立的代码模块完成特定的计算任务。而对于不同类别（聚类、时间）内的特征，可使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:24;167:81&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;groupby&lt;/codeph&gt; 方法在每个分组中计算需要的特征（如平均值）。&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:25;167:113&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;groupby&lt;/codeph&gt; 接收三个参数，将根据第三个参数指定的列进行分组，取第一个参数为计算函数，计算第二个参数对应列的特征，并返回行数与分组数相等的表。用户可通过表连接操作将该组合特征合并入特征数据，本文使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:26;167:216&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;fj&lt;/codeph&gt;(full join) 将特征表与 groupby 表合并，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:27;167:250&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;fj()&lt;/codeph&gt; 指定第三个参数为连接列，将前两个参数所传入的表合并。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:6;169:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;// 两经纬度点距离、两个经纬度之间的 Manhattan 距离、两个经纬度之间的方位信息 trainData['distance_haversine'] = haversine_array(trainData['pickup_latitude'], trainData['pickup_longitude'], trainData['dropoff_latitude'], trainData['dropoff_longitude']) trainData['distance_dummy_manhattan'] = dummy_manhattan_distance(trainData['pickup_latitude'], trainData['pickup_longitude'], trainData['dropoff_latitude'], trainData['dropoff_longitude']) trainData['direction'] = bearing_array(trainData['pickup_latitude'], trainData['pickup_longitude'], trainData['dropoff_latitude'], trainData['dropoff_longitude']) // 按时间、聚类等信息处理速度、行程时间，产生新特征 for(gby_col in ['pickup_hour', 'pickup_date', 'pickup_week_hour', 'pickup_cluster', 'dropoff_cluster']) {     for(gby_para in ['avg_speed_h', 'avg_speed_m', 'log_trip_duration']) {         gby = groupby(avg, trainData[gby_para], trainData[gby_col])         gby.rename!(`avg_ + gby_para, gby_para + '_gby_' + gby_col)         trainData = fj(trainData, gby, gby_col)         testData = fj(testData, gby, gby_col)     } trainData.dropColumns!(`gby + gby_col) }&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;35-模型训练xgboost&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:12;186:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:17;186:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;3.5. 模型训练（XGBoost）&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:12;186:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:31;188:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;在进行训练之前，需要再一次检查训练集和测试集的数据，需要剔除 ID、日期、字符等非数值型数据，以及平均速度、行驶时间等仅在训练集上存在的数据，保证训练数据与预测数据结构一致。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:32;190:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;完成数据处理及特征构建后，可以使用 XGBoost 等机器学习方法训练模型。为评价模型训练效果，将训练数据集划分为训练集和验证集，随机选取 80% 的数据作为训练集训练模型，使用 20% 的数据作为验证集输出预测结果，使用均方根误差指标计算验证集的预测值与真实值的偏差。最终可以在测试集上输出行程时间的预测结果。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:33;192:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;本模型在验证集上的均方根误差为 0.390，可以绘制预测值 - 真值散点图，定性分析模型预测效果。&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:6;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:18;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;验证集上的预测值与真实值&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/Forecast_of_Taxi_Trip_Duration/3_5.png&#34; xtrc=&#34;image:6;194:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;1856&#34; dita-ot:image-height=&#34;910&#34;/&gt; &lt;/fig&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:34;199:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 提供了 XGBoost 插件实现模型训练及预测，使用前需要下载插件到指定路径并加载 XGBoost 插件。DolphinDB XGBoost 插件使用详见 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;../plugins/xgboost/xgboost.md&#34; xtrc=&#34;xref:7;199:89&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;XGboost 插件使用说明&lt;/xref&gt;。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:7;201:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;xgb_pars = {'min_child_weight': 50, 'eta': 0.3, 'colsample_bytree': 0.3, 'max_depth': 10, 'subsample': 0.8, 'lambda': 1., 'nthread': 4, 'booster' : 'gbtree', 'silent': 1, 'eval_metric': 'rmse', 'objective': 'reg:linear', 'nthread': 48} // xgb 参数设置 xgbModel = xgboost::train(ytrain, train, xgb_pars, 60) // 训练模型 yvalid_ = xgboost::predict(xgbModel, valid) // 使用模型进行预测&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;36-模型评价&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:13;209:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:19;209:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;3.6. 模型评价&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:13;209:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:35;211:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;为实现出租车行程时间的预测，本文使用了三种机器学习方法。首先使用 PCA 对位置信息进行处理，转换数据的经纬度特征；使用 KMeans++ 对出租车上下客位置进行聚类，将纽约市区划分为 100 个区域进行分析；最后使用 XGBoost 对数据集特征进行训练。在验证集上模型均方根误差为 0.390，效果较好。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:36;213:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Python Scikit-Learn 也是主流的机器学习库之一，本文在相同环境下使用 Python 对同一数据集进行训练，PCA、KMeans++、XGBoost 训练耗时如下表所示：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:2;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrc=&#34;tgroup:2;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:5;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:6;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:7;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:2;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:13;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:49;215:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:5;215:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;模型&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:50;215:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:6;215:12&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:51;215:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:7;215:28&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Python&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:2;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:14;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:52;217:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;PCA&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:53;217:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:8;217:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;0.325s&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:54;217:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;0.396s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:15;218:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:55;218:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;KMeans++&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:56;218:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:9;218:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;45.711s&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34; xtrc=&#34;entry:57;218:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;104.568s&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:16;219:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:58;219:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;XGBoost&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:59;219:13&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:10;219:14&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;57.269s&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;4&#34; xtrc=&#34;entry:60;219:29&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;74.289s&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:37;221:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 与 Python 训练模型在验证集上误差如下表所示：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrc=&#34;table:3;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrc=&#34;tgroup:3;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; colnum=&#34;1&#34; xtrc=&#34;colspec:8;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; colnum=&#34;2&#34; xtrc=&#34;colspec:9;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; colnum=&#34;3&#34; xtrc=&#34;colspec:10;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrc=&#34;thead:3;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:17;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:61;223:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt; &lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:62;223:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:11;223:10&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB&lt;/b&gt;&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34; xtrc=&#34;entry:63;223:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrc=&#34;b:12;223:26&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Python&lt;/b&gt;&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrc=&#34;tbody:3;225:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrc=&#34;row:18;225:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:64;225:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;RMSE&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:65;225:9&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;0.390&lt;/entry&gt;&lt;entry align=&#34;left&#34; class=&#34;- topic/entry &#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34; xtrc=&#34;entry:66;225:25&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;0.394&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:38;227:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;在本行程时间预测任务中，在准确率上，DolphinDB 与 Python 相近；而在性能上，DolphinDB 在 PCA、KMeans++、XGBoost 上的性能均优于 Python。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;4-行程时间实时预测&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:14;229:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:20;229:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;4. 行程时间实时预测&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:14;229:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:39;231:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;本节结合现实场景，介绍如何使用 DolphinDB 处理实时的订单流数据，基于预测模型实时估计行程时间。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:40;233:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;现实场景中，网约车乘客对时效性要求高，需要平台提供准确的行程时间估计；而服务商也需要监控出行平台，分析出行需求并完成资源调度，仅仅使用预测模型无法高效处理实时数据，难以完成即时预测任务，无法满足乘客和服务商的实时需求。DolphinDB 流数据模块可以解决生产环境下实时数据的快速分析计算问题，对服务商发送的即时数据，DolphinDB 流数据引擎可高效完成数据预处理、信息提取、特征构建等工作，使用预先训练的模型完成实时订单行程时间的快速准确预测，为用户提供从模型训练、流数据注入到实时预测及在线监控的一站式解决方案。&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:7;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:21;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 流数据处理框架 &lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;../stream/images/forecast_taxi_2.png&#34; xtrc=&#34;image:7;235:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;1693&#34; dita-ot:image-height=&#34;481&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt; &lt;/fig&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;41-场景描述&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:15;242:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:22;242:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;4.1. 场景描述&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:15;242:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:41;244:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 流数据模块采用发布 - 订阅 - 消费的模式，流数据首先注入流数据表中，通过流数据表来发布数据，第三方应用可以通过 DolphinDB 脚本或 API 订阅及消费流数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:42;246:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;为实现出租车行程时间的实时预测，服务商可以创建 DolphinDB 流数据表订阅服务端消息，获取乘客创建的行程信息，使用离线训练完成的模型对行程时间进行实时预测，最后可通过应用程序订阅预测数据并提供给乘客。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;42-实时数据模拟及预测&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:16;248:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:23;248:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;4.2. 实时数据模拟及预测&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:16;248:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:43;250:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;为获取行程数据并使用机器学习模型预测行程时间，用户需要创建三个流数据表实现实时预测，一是创建订单信息表订阅乘客行程信息，二是创建特征表完成对订单信息的特征提取；三是创建预测表预测特征流数据表发送的行程特征信息，输出预测结果。&lt;/p&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:8;252:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:24;252:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt; &lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;../stream/images/forecast_taxi_3.png&#34; xtrc=&#34;image:8;252:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;1693&#34; dita-ot:image-height=&#34;217&#34; dita-ot:horizontal-dpi=&#34;72&#34; dita-ot:vertical-dpi=&#34;72&#34;/&gt; &lt;/fig&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:44;257:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;用户可以使用 subscribeTable 完成流数据的订阅，并通过 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrc=&#34;i:1;257:36&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;handler&lt;/i&gt; 指定处理订阅数据的方法（详见 subscribeTable — DolphinDB 2.0 documentation）。在本例中，特征表需订阅订单表完成原始信息的特征提取，本模型定义 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:28;257:139&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;process&lt;/codeph&gt; 函数实现；预测表需订阅特征表使用特征信息完成行程时间预测，本模型定义 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:29;257:184&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;predictDuration&lt;/codeph&gt; 函数实现。函数实现详见&#34;模型代码&#34;所附代码。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:45;259:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;为模拟实时数据，使用&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:30;259:11&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;replay&lt;/codeph&gt;函数回放历史数据。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:8;261:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;// 订阅订单信息表，数据从订单表流向特征表 subscribeTable(tableName=&#34;orderTable&#34;, actionName=&#34;orderProcess&#34;, offset=0, handler=process{traitTable, hisData}, msgAsTable=true, batchSize=1, throttle=1, hash=0, reconnect=true) // 订阅特征表，数据从特征表流向预测表 subscribeTable(tableName=&#34;traitTable&#34;, actionName=&#34;predict&#34;, offset=0, handler=predictDuration{predictTable}, msgAsTable=true, hash=1, reconnect=true) // 回放历史数据，模拟实时产生的生产数据 submitJob(&#34;replay&#34;, &#34;trade&#34;, replay{inputTables=data, outputTables=orderTable, dateColumn=`pickup_datetime, timeColumn=`pickup_datetime, replayRate=25, absoluteRate=true, parallelLevel=1})&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;43-grafana-实时监控&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:17;270:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:25;270:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;4.3. Grafana 实时监控&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:17;270:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:46;272:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;服务商可通过第三方 API 连接 DolphinDB 数据库监控行程时间预测服务，本文以 Grafana 为例简要介绍如何使用第三方应用程序动态展示实时数据。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:47;274:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Grafana 是一个用于时序数据动态可视化的数据展示工具，DolphinDB 提供了 Grafana 的数据接口，用户可在 Grafana 面板上编写查询脚本与 DolphinDB 进行交互，实现 DolphinDB 时序数据的可视化，并 Web 端进行实时数据分析，详见 &lt;xref class=&#34;- topic/xref &#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; href=&#34;../tools/grafana.md&#34; xtrc=&#34;xref:8;274:139&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;grafana-datasource&lt;/xref&gt;。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:48;276:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;添加 datasource 并新建 dashboard 后，在 Query 中填写以下 DolphinDB 语句进行实时数据可视化：&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:2;278:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:3;278:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:49;278:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Query 1：展示当日出行订单预估到达时间及预估行程时间&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:9;280:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;select id as ID, pickup_datetime as pickup_time, (pickup_datetime+int((exp(duration)-1))) as arrival_time, (exp(duration)-1)/60 as duration from predictTable where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) &lt;/codeblock&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:4;284:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:50;284:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Query 2：统计当日累计订单数及累计乘客数&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:10;286:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;select count(*) from predictTable where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) select sum(passenger_count) from predictTable where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) &lt;/codeblock&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:9;293:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:26;293:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;订单预估到达时间及当日订单数&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/Forecast_of_Taxi_Trip_Duration/4_3.png&#34; xtrc=&#34;image:9;293:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;671&#34; dita-ot:image-height=&#34;532&#34;/&gt; &lt;/fig&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:5;298:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:51;298:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Query 3：统计当日乘客上车位置&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:11;300:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;select pickup_latitude as latitude, pickup_longitude as longitude from predictTable where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) &lt;/codeblock&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:10;305:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:27;305:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;当日乘客上车位置&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/Forecast_of_Taxi_Trip_Duration/4_3.png&#34; xtrc=&#34;image:10;305:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;671&#34; dita-ot:image-height=&#34;532&#34;/&gt; &lt;/fig&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:6;310:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:52;310:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Query 4：统计当日不同时刻订单出行耗时&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:12;312:5&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;select pickup_datetime, (exp(duration)-1)/60 as duration from predictTable where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) &lt;/codeblock&gt;&lt;fig align=&#34;left&#34; class=&#34;- topic/fig &#34; xtrc=&#34;fig:11;317:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:28;317:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;当日不同时刻订单出行耗时&lt;/title&gt; &lt;image class=&#34;- topic/image &#34; href=&#34;images/Forecast_of_Taxi_Trip_Duration/4_3.png&#34; xtrc=&#34;image:11;317:3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34; dita-ot:image-width=&#34;671&#34; dita-ot:image-height=&#34;532&#34;/&gt; &lt;/fig&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;44-数据持久化&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:18;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:29;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;4.4. 数据持久化&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:18;324:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:53;326:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;如果需要将历史数据落盘，可以订阅订单表中数据，指定 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:31;326:27&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;subscribeTable&lt;/codeph&gt; 以 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrc=&#34;codeph:32;326:46&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;loadTable&lt;/codeph&gt; 的方式将数据持久化到磁盘。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrc=&#34;codeblock:13;328:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;db = database(&#34;dfs://taxi&#34;) if(existsTable(&#34;dfs://taxi&#34;, &#34;newData&#34;)) { dropTable(db, &#34;newData&#34;) } db.createPartitionedTable(table=table(1:0, orderTable.schema().colDefs.name, orderTable.schema().colDefs.typeString), tableName=`newData, partitionColumns=`pickup_datetime, sortColumns=`pickup_datetime, compressMethods={datetime:&#34;delta&#34;}) subscribeTable(tableName=&#34;orderTable&#34;, actionName=&#34;saveToDisk&#34;, offset=0, handler=loadTable(&#34;dfs://taxi&#34;, &#34;newData&#34;), msgAsTable=true, batchSize=100000, throttle=1, reconnect=true)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;5-附录&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:19;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:30;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;5. 附录&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:19;335:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;51-测试环境&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:20;337:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:31;337:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;5.1. 测试环境&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:20;337:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:3;339:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:7;339:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;操作系统：Linux version 3.10.0-1160.el7.x86_64&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:8;340:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;CPU：Intel(R) Xeon(R) Silver 4214 CPU @2.20GHz 48 核&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:9;341:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;内存：188G&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:10;342:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;软件版本&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:54;344:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB: 2.00.9&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:55;346:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Python3:3.7.12&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:56;348:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Scikit-Learn: 1.0.2&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrc=&#34;p:57;350:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;XGBoost: 1.6.2&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34; id=&#34;52-模型代码&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; xtrc=&#34;topic:21;352:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrc=&#34;title:32;352:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;5.2. 模型代码&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrc=&#34;body:21;352:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrc=&#34;ul:4;354:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:11;354:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 模型训练代码：&lt;xref class=&#34;- topic/xref &#34; format=&#34;dos&#34; href=&#34;script/Forecast_of_Taxi_Trip_Duration/taxiTrain.dos&#34; xtrc=&#34;xref:9;354:20&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;?ditaot usertext?&gt;taxiTrain.dos&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:12;355:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;DolphinDB 流数据预测代码： &lt;xref class=&#34;- topic/xref &#34; format=&#34;dos&#34; href=&#34;script/Forecast_of_Taxi_Trip_Duration/taxiStream.dos&#34; xtrc=&#34;xref:10;355:23&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;?ditaot usertext?&gt;taxiStream.dos&lt;/xref&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrc=&#34;li:13;356:1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;Python 模型训练代码： &lt;xref class=&#34;- topic/xref &#34; format=&#34;py&#34; href=&#34;script/Forecast_of_Taxi_Trip_Duration/taxiTrain.py&#34; xtrc=&#34;xref:11;356:18&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/tutorials/forecast_taxi_trip_dura.md&#34;&gt;&lt;?ditaot usertext?&gt;taxiTrain.py&lt;/xref&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="tutorials/forecast_taxi_trip_dura.md"/><meta name="wh-out-relpath" content="tutorials/forecast_taxi_trip_dura_2.html"/>

    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="出租车行程时间预测" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="../index.html"><span>主页</span></a></span></li><li><div class="topicref" data-id="about_tutorials"><div class="title"><a href="../tutorials/about_tutorials.html"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div></li><li><div class="topicref"><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html">物联网场景案例</a></div></div></li><li class="active"><div class="topicref" data-id="出租车行程时间预测"><div class="title"><a href="../tutorials/forecast_taxi_trip_dura_2.html">出租车行程时间预测</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="ddb_intro-d9713e87" class="topicref" data-id="ddb_intro" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../about/ddb_intro.html" id="ddb_intro-d9713e87-link">关于DolphinDB</a></div></div></li><li role="treeitem"><div data-tocid="chap1_getstarted-d9713e136" class="topicref" data-id="chap1_getstarted" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../getstarted/chap1_getstarted.html" id="chap1_getstarted-d9713e136-link">快速上手</a><div class="wh-tooltip"><p class="shortdesc">如何快速部署 DolphinDB、建库建表、写入和查询数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="sectionddb_deployment-d9713e189" class="topicref" data-id="sectionddb_deployment" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action sectionddb_deployment-d9713e189-link" class="wh-expand-btn"></span><div class="title"><a href="../deploy/deploy_intro.html" id="sectionddb_deployment-d9713e189-link"><span class="keyword label">部署</span></a><div class="wh-tooltip"><p class="shortdesc">如何在不同的场景中部署 DolphinDB</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259" class="topicref" data-id="new_chap_database_manage_new_chap_dbmanage_landing_page" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/cfg/db_intro.html" id="new_chap_database_manage_new_chap_dbmanage_landing_page-d9713e2259-link"><span class="keyword label">数据库</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 数据库的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_streaming-d9713e3760" class="topicref" data-id="chap7_tutorials_streaming" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_streaming-d9713e3760-link" class="wh-expand-btn"></span><div class="title"><a href="../stream/str_intro.html" id="chap7_tutorials_streaming-d9713e3760-link"><span class="keyword label">流数据</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 流数据引擎及流数据计算的基本概念</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e7513" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e7513-link" class="wh-expand-btn"></span><div class="title"><a href="../db_distr_comp/db_oper/import_data.html" id="tocId-d9713e7513-link">数据迁移</a><div class="wh-tooltip"><p class="shortdesc">如何从不同数据源向 DolphinDB 迁移数据</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap7_tutorials_system_management-d9713e7940" class="topicref" data-id="chap7_tutorials_system_management" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap7_tutorials_system_management-d9713e7940-link" class="wh-expand-btn"></span><div class="title"><a href="../sys_man/om_intro.html" id="chap7_tutorials_system_management-d9713e7940-link"><span class="keyword label">系统运维</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 的系统运维功能及方法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="troubleshooting-d9713e8780" class="topicref" data-id="troubleshooting" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action troubleshooting-d9713e8780-link" class="wh-expand-btn"></span><div class="title"><a href="../error_codes/troubleshooting.html" id="troubleshooting-d9713e8780-link">故障排查</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="about_language_resources-d9713e20911" class="topicref" data-id="about_language_resources" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action about_language_resources-d9713e20911-link" class="wh-expand-btn"></span><div class="title"><a href="../progr/progr_intro.html" id="about_language_resources-d9713e20911-link"><span class="keyword label">编程语言</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 编程基本概念与方法、SQL 在 DolphinDB 的应用</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="functions_references-d9713e30925" class="topicref" data-id="functions_references" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action functions_references-d9713e30925-link" class="wh-expand-btn"></span><div class="title"><a href="../funcs/funcs_intro.html" id="functions_references-d9713e30925-link"><span class="keyword label">函数参考</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 函数分类、语法、详解及示例</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="api_protocol-d9713e94064" class="topicref" data-id="api_protocol" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action api_protocol-d9713e94064-link" class="wh-expand-btn"></span><div class="title"><a href="../api/connapi_intro.html" id="api_protocol-d9713e94064-link"><span class="keyword label">连接器 &amp; API</span></a><div class="wh-tooltip"><p class="shortdesc">面向不同编程语言的 DolphinDB API 及连接器，相关协议和用法</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="chap6_plugin-d9713e94210" class="topicref" data-id="chap6_plugin" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action chap6_plugin-d9713e94210-link" class="wh-expand-btn"></span><div class="title"><a href="../plugins/plg_intro.html" id="chap6_plugin-d9713e94210-link"><span class="keyword label">插件</span></a><div class="wh-tooltip"><p class="shortdesc">多个应用场景的插件使用说明和插件开发指导</p></div></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="third_party-d9713e97904" class="topicref" data-id="third_party" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action third_party-d9713e97904-link" class="wh-expand-btn"></span><div class="title"><a href="../third_party.html" id="third_party-d9713e97904-link">第三方工具</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="about_tutorials-d9713e98227" class="topicref" data-id="about_tutorials" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action about_tutorials-d9713e98227-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/about_tutorials.html" id="about_tutorials-d9713e98227-link"><span class="keyword label">教程</span></a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 产品使用教程</p></div></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98280" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98280-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/new_users_finance.html" id="tocId-d9713e98280-link">新用户入门</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e98327" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e98327-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/database.html" id="tocId-d9713e98327-link">数据库</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e99111" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e99111-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/std_sql_ddb.html" id="tocId-d9713e99111-link">编程</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100448" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100448-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming-real-time-correlation-processing_2.html" id="tocId-d9713e100448-link">流数据</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e100955" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e100955-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/scheduledJob_2.html" id="tocId-d9713e100955-link">系统运维</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="模块概述-d9713e101923" class="topicref" data-id="模块概述" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action 模块概述-d9713e101923-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/tu_modules.html" id="模块概述-d9713e101923-link">模块</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e102568" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e102568-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/OHLC_2.html" id="tocId-d9713e102568-link">金融场景案例</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="tocId-d9713e104827" class="topicref" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action tocId-d9713e104827-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="tocId-d9713e104827-link">物联网场景案例</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="引擎级联监测门禁异常状态-d9713e104828" class="topicref" data-id="引擎级联监测门禁异常状态" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/streaming_engine_anomaly_alerts_2.html" id="引擎级联监测门禁异常状态-d9713e104828-link">引擎级联监测门禁异常状态</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-历史数据回放功能应用物联网设备故障分析-d9713e104874" class="topicref" data-id="dolphindb-历史数据回放功能应用物联网设备故障分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/faultAnalysis.html" id="dolphindb-历史数据回放功能应用物联网设备故障分析-d9713e104874-link">DolphinDB 历史数据回放功能应用：物联网设备故障分析</a></div></div></li><li role="treeitem"><div data-tocid="dolphindb-在工业物联网的应用-d9713e104920" class="topicref" data-id="dolphindb-在工业物联网的应用" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_demo_2.html" id="dolphindb-在工业物联网的应用-d9713e104920-link">DolphinDB 在工业物联网的应用</a></div></div></li><li role="treeitem" class="active"><div data-tocid="出租车行程时间预测-d9713e104966" class="topicref" data-id="出租车行程时间预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/forecast_taxi_trip_dura_2.html" id="出租车行程时间预测-d9713e104966-link">出租车行程时间预测</a></div></div></li><li role="treeitem"><div data-tocid="传感器数据异常检测-d9713e105012" class="topicref" data-id="传感器数据异常检测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_anomaly_detection_2.html" id="传感器数据异常检测-d9713e105012-link">传感器数据异常检测</a></div></div></li><li role="treeitem"><div data-tocid="地震波形数据存储解决方案-d9713e105058" class="topicref" data-id="地震波形数据存储解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/waveform_data_storage_2.html" id="地震波形数据存储解决方案-d9713e105058-link">地震波形数据存储解决方案</a></div></div></li><li role="treeitem"><div data-tocid="工业试验平台高频数据的存储和处理分析-d9713e105104" class="topicref" data-id="工业试验平台高频数据的存储和处理分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/high_freq_data_storage_and_analysis.html" id="工业试验平台高频数据的存储和处理分析-d9713e105104-link">工业试验平台高频数据的存储和处理分析</a></div></div></li><li role="treeitem"><div data-tocid="基于波形数据的地震预测-d9713e105150" class="topicref" data-id="基于波形数据的地震预测" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/earthquake_prediction_ddb_ml_2.html" id="基于波形数据的地震预测-d9713e105150-link">基于波形数据的地震预测</a></div></div></li><li role="treeitem"><div data-tocid="实时检测传感器状态变化-d9713e105196" class="topicref" data-id="实时检测传感器状态变化" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_str_app_iot_2.html" id="实时检测传感器状态变化-d9713e105196-link">实时检测传感器状态变化</a></div></div></li><li role="treeitem"><div data-tocid="实现设备指标的采集监控和展示-d9713e105242" class="topicref" data-id="实现设备指标的采集监控和展示" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/ddb_telegraf_grafana.html" id="实现设备指标的采集监控和展示-d9713e105242-link">实现设备指标的采集监控和展示</a></div></div></li><li role="treeitem"><div data-tocid="随机振动信号分析解决方案-d9713e105288" class="topicref" data-id="随机振动信号分析解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/random_vibr_sig_analysis_2.html" id="随机振动信号分析解决方案-d9713e105288-link">随机振动信号分析解决方案</a></div></div></li><li role="treeitem"><div data-tocid="物联网时序数据查询案例-d9713e105335" class="topicref" data-id="物联网时序数据查询案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_query_case.html" id="物联网时序数据查询案例-d9713e105335-link">物联网时序数据查询案例</a></div></div></li><li role="treeitem"><div data-tocid="物联网实时数据异常率预警-d9713e105381" class="topicref" data-id="物联网实时数据异常率预警" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/knn_iot_2.html" id="物联网实时数据异常率预警-d9713e105381-link">物联网实时数据异常率预警</a></div></div></li><li role="treeitem"><div data-tocid="物联网应用范例-d9713e105427" class="topicref" data-id="物联网应用范例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/iot_examples.html" id="物联网应用范例-d9713e105427-link">物联网应用范例</a></div></div></li><li role="treeitem"><div data-tocid="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案-d9713e105473" class="topicref" data-id="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Virbration_Monitor_Fault_Diagnose.html" id="云边协同dolphindb-构建一体化振动监控与故障诊断解决方案-d9713e105473-link">云边协同：DolphinDB 构建一体化振动监控与故障诊断解决方案</a></div></div></li><li role="treeitem"><div data-tocid="助力工业物联网实现智能运维-d9713e105519" class="topicref" data-id="助力工业物联网实现智能运维" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/Iot_intelligent_O&amp;M.html" id="助力工业物联网实现智能运维-d9713e105519-link">助力工业物联网实现智能运维</a></div></div></li><li role="treeitem"><div data-tocid="使用-node-red-构建-dolphindb-低代码平台-d9713e105565" class="topicref" data-id="使用-node-red-构建-dolphindb-低代码平台" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/node_red_tutorial_iot.html" id="使用-node-red-构建-dolphindb-低代码平台-d9713e105565-link">使用 Node-RED 构建 DolphinDB 低代码平台</a></div></div></li><li role="treeitem"><div data-tocid="基于-glibc-升级的性能优化案例-d9713e105611" class="topicref" data-id="基于-glibc-升级的性能优化案例" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/perf_opti_glibc.html" id="基于-glibc-升级的性能优化案例-d9713e105611-link">基于 Glibc 升级的性能优化案例</a></div></div></li><li role="treeitem"><div data-tocid="当电力市场碰上量化技术如何构建高效电力交易解决方案-d9713e105657" class="topicref" data-id="当电力市场碰上量化技术如何构建高效电力交易解决方案" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/efficient_power_trading_solutions.html" id="当电力市场碰上量化技术如何构建高效电力交易解决方案-d9713e105657-link">当电力市场碰上量化技术，如何构建高效电力交易解决方案？</a></div></div></li><li role="treeitem"><div data-tocid="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析-d9713e105703" class="topicref" data-id="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/behavioral_profiling_of_driving_habits.html" id="使用-dolphindb-进行汽车用户驾驶习惯行为画像分析-d9713e105703-link">使用 DolphinDB 进行汽车用户驾驶习惯行为画像分析</a></div></div></li><li role="treeitem"><div data-tocid="edge_to_cloud-d9713e105749" class="topicref" data-id="edge_to_cloud" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/edge_to_cloud.html" id="edge_to_cloud-d9713e105749-link">DolphinDB 实现边到云的实时数据汇聚</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105795" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105795-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/dolphindb_tensor_libtorch_tutorial.html" id="tocId-d9713e105795-link">机器学习</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105842" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105842-link" class="wh-expand-btn"></span><div class="title"><a href="../tutorials/api_performance.html" id="tocId-d9713e105842-link">测试报告</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="tocId-d9713e105982" class="topicref" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action tocId-d9713e105982-link" class="wh-expand-btn"></span><div class="title"><a href="../rn/server/3_00_2.html" id="tocId-d9713e105982-link">版本说明</a><div class="wh-tooltip"><p class="shortdesc">DolphinDB 版本发布历史</p></div></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">出租车行程时间预测</h1><div class="- topic/body body"><p class="- topic/p p">DolphinDB 集高性能时序数据库与全面的分析功能为一体，可用于海量结构化数据的存储、查询、分析、实时计算等，在工业物联网场景中应用广泛。本文以纽约出租车行程时间预测为例，介绍如何使用 DolphinDB 训练机器学习模型，并进行实时数据的预测，为基于智能网联汽车的车联网企业提供基于机器学习方法的即时预测方案。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="1-概要"><h2 class="- topic/title title topictitle2" id="ariaid-title2">1. 概要</h2><div class="- topic/body body"><p class="- topic/p p">随着手机移动应用与网约车平台的迅速发展，网约车出行逐渐成为城市生活中一种重要的出行方式。相较其他出行方式而言，选择网约车的乘客对出行时效性有更高的要求，本文将基于乘客上车时间及上下车地点等静态信息，使用 DolphinDB 机器学习方法训练模型，预测网约车行程时间。</p><p class="- topic/p p">在此基础上，本文将介绍如何使用 <a class="- topic/xref xref" href="streaming_tutorial.html">DolphinDB 流数据处理系统</a>对业务系统产生的持续增长的网约车订单动态数据进行实时的收集、清洗、统计、入库，并实时展示行程时间预测结果。</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 1</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">行程时间实时预测流程</span></figcaption>
<img class="- topic/image image" src="../stream/images/forecast_taxi_1.png"/><br/>  
  
</figure></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="2-数据介绍"><h2 class="- topic/title title topictitle2" id="ariaid-title3">2. 数据介绍</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="21-数据来源及训练方法"><h3 class="- topic/title title topictitle3" id="ariaid-title4">2.1. 数据来源及训练方法</h3><div class="- topic/body body"><p class="- topic/p p">本文训练和预测采用 <a class="- topic/xref xref" href="https://www.kaggle.com/competitions/nyc-taxi-trip-duration/data" target="_blank" rel="external noopener">Kaggle</a>提供的来自纽约出租车委员会的数据集，训练方法参考了获奖者 <a class="- topic/xref xref" href="https://www.kaggle.com/competitions/nyc-taxi-trip-duration" target="_blank" rel="external noopener">beluga</a> 的模型，使用 DolphinDB 对原始数据进行数据预处理，完成位置信息主成分分析（PCA, Principal Component Analysis）、位置信息聚类（KMeans）、新特征构建等工作，并使用 DolphinDB XGBoost 插件完成模型训练及行程时间预测。</p><p class="- topic/p p">为对比 DolphinDB 在机器学习上的性能，本文使用 Python Scikit-Learn 库及 XGBoost 在同一环境下进行了模型训练和预测，DolphinDB 在训练耗时、模型精度等方面均有良好表现。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title5" id="22-数据特征"><h3 class="- topic/title title topictitle3" id="ariaid-title5">2.2. 数据特征</h3><div class="- topic/body body"><p class="- topic/p p">该数据集预先分为训练数据集及测试数据集，训练数据集共包含 1458644 条数据，测试数据集共包括 625134 条数据；训练数据集共包含以下 11 列信息。</p><div class="table-container"><table class="- topic/table table" data-cols="4"><caption></caption><colgroup><col/><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="22-数据特征__entry__1"><strong class="+ topic/ph hi-d/b ph b">列名</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="22-数据特征__entry__2"><strong class="+ topic/ph hi-d/b ph b">列类型</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="22-数据特征__entry__3"><strong class="+ topic/ph hi-d/b ph b">说明</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="22-数据特征__entry__4"><strong class="+ topic/ph hi-d/b ph b">实例</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">id</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">SYMBOL</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">行程的唯一标识</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">id2875421</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">vendor_id</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">INT</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">行程记录提供商代码</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">2</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">pickup_datetime</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">DATETIME</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">出租车计价器开启时间</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">2016/3/14 17:24:55</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">dropoff_datetime</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">DATETIME</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">出租车计价器关闭时间</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">2016/3/14 17:32:30</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">passenger_count</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">INT</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">乘客数量</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">1</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">pickup_longitude</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">出租车计价器开启位置经度</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">-73.98215484619139</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">pickup_latitude</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">出租车计价器开启位置纬度</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">40.76793670654297</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">dropoff_longitude</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">出租车计价器关闭位置经度</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">-73.96463012695312</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">dropoff_latitude</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">DOUBLE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">出租车计价器关闭位置纬度</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">40.765602111816406</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">store_and_fwd_flag</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">CHAR</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">标识来源是否为存储的历史数据</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">N</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__1">trip_duration</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__2">INT</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__3">行程时间（按秒计）</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="22-数据特征__entry__4">455</td></tr></tbody></table></div><p class="- topic/p p">行程时间预测的目标列为上表中 trip_duration 列，即 dropoff_datetime 与 pickup_datetime 之差。测试数据集用于预测，故其列信息不包括 dropoff_datetime 及 trip_duration 列，测试数据集中行程标识、位置等列属性同上表。</p><p class="- topic/p p">上表的数据类型中，SYMBOL 类型是 DolphinDB 中一种特殊的字符串类型，在系统内部的存储结构为一个编码字典，DATETIME 类型为包含了日期和时刻的时间类型。</p><p class="- topic/p p">DolphinDB 支持 <code class="+ topic/ph pr-d/codeph ph codeph">loadText</code> 方法读取 csv 等数据存储文件到内存表，用户可以 <code class="+ topic/ph pr-d/codeph ph codeph">schema</code> 函数获取表的特征信息。DolphinDB 也支持使用 SQL 语句完成数据的查询。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>train = loadText("./taxidata/train.csv") 
train.schema().colDefs
select count(*) from train
select top 5 * from train</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title6" id="23-数据存储"><h3 class="- topic/title title topictitle3" id="ariaid-title6">2.3. 数据存储</h3><div class="- topic/body body"><p class="- topic/p p">将数据加载到内存表后，可以将训练数据与测试数据导入 DolphinDB 数据库中，便于后续数据的读取与模型的训练，数据导入分布式数据库的操作详见 <a class="- topic/xref xref" href="database.html">分区数据库教程</a>。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title7" id="3-模型构建"><h2 class="- topic/title title topictitle2" id="ariaid-title7">3. 模型构建</h2><div class="- topic/body body"><p class="- topic/p p">本节介绍行程时间预测模型的构建方法。</p><p class="- topic/p p">行程时间预测模型的构建分多个过程，一是预处理原始数据，对可能存在的空值进行转换，并将字符等非数值型数据转换为可用于模型训练的数值型数据；二是优化位置信息，原始数据中的纬度经度信息集中在 40.70 °N 至 40.80 °N 及 73.94 °W 至 74.02 °W 之间，数据间位置特征差异不够显著，使用主成分分析、聚类方法处理可以提取到特征更明显的信息；三是新特征的构建，位置信息和时间信息是订单数据的两个关键维度，通过计算可以在位置信息基础上得到方位、距离信息，提取更多空间特征，而组合不同类别的位置信息和时间信息也可以得到更复杂的特征，有利于模型学习深层次的时空规律。</p></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title8" id="31-数据预处理"><h3 class="- topic/title title topictitle3" id="ariaid-title8">3.1. 数据预处理</h3><div class="- topic/body body"><p class="- topic/p p">在模型训练过程中，首先需要检查数据集是否包含空值，本训练数据集与测试数据集均不包含空值，若存在缺失值，还需要删除、插补等操作解决缺失数据问题。</p><p class="- topic/p p">其次，需要检查数据集数据类型，原始数据往往包含文本/字符数据，由“数据特征”小节的表可知，本数据集中 store_and_fwd_flag 列为字符型数据，pickup_datetime 及 dropoff_datetime 列为日期时间类型数据，为充分利用这些信息训练模型，需要将其转化为数值型数据。</p><p class="- topic/p p">此外，考虑到该数据测试集评价指标为均方根对数误差（Root Mean Squared Logarithmic Error, RMSLE），同时，最大行程时间接近 1000 小时，离群值会影响模型训练效果，对行程时间取对数作为预测值，在评价时（见“模型评价”）可以直接使用均方根误差（Root Mean Squared Error, RMSE）指标。</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 2</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">RMSE</span></figcaption>
<img class="- topic/image image" src="images/Forecast_of_Taxi_Trip_Duration/3_1.png"/><br/>  
  
</figure><p class="- topic/p p">DolphinDB 提供多种计算函数，可以帮助用户快速实现数据处理。DolphinDB 提供 <code class="+ topic/ph pr-d/codeph ph codeph">isNull()</code> 方法用于判断空值，配合 <code class="+ topic/ph pr-d/codeph ph codeph">sum()</code> 等聚合函数使用可以快速完成整表数据的查询；提供类似于条件运算符的 <code class="+ topic/ph pr-d/codeph ph codeph">iif()</code> 方法简化 if-else 语句；<code class="+ topic/ph pr-d/codeph ph codeph">date()</code>、<code class="+ topic/ph pr-d/codeph ph codeph">weekday()</code>、<code class="+ topic/ph pr-d/codeph ph codeph">hour()</code> 等方法可以提取时间、日期数据的不同特征，简洁高效；类似于 Python 等编程语言，DolphinDB 支持方括号（[]）索引，简化了表的查找、更新和插入。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>sum(isNull(train))  // 0，不含空值
trainData[`store_and_fwd_flag_int] = iif(trainData[`store_and_fwd_flag] == 'N', int(0), int(1)) // 将字符N/Y转化为0/1值
trainData[`pickup_date] = date(trainData[`pickup_datetime]) // 日期
trainData[`pickup_weekday] = weekday(trainData[`pickup_datetime]) // 星期*
trainData[`pickup_hour] = hour(trainData[`pickup_datetime]) // 小时
trainData[`log_trip_duration] = log(double(trainData[`trip_duration]) + 1)// 对行程时间取对数，log(trip_duration+1)
select max(trip_duration / 3600) from trainData // 训练集上最大行程时间为979h</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title9" id="32-位置信息主成分分析pca"><h3 class="- topic/title title topictitle3" id="ariaid-title9">3.2. 位置信息主成分分析（PCA）</h3><div class="- topic/body body"><p class="- topic/p p">原始数据中的纬度经度信息集中在 40.70 °N 至 40.80 °N 及 73.94 °W 至 74.02 °W 之间，数据间位置特征差异不够显著，使用 PCA 来转换经度和纬度坐标，有助于 XGBoost 决策树的拆分，DolphinDB PCA 函数使用详见<code class="+ topic/ph pr-d/codeph ph codeph">pca</code>。</p><p class="- topic/p p">DolphinDB PCA 返回的结果是一个字典，包含 components、explainedVarianceRatio、singularValues 三个键，分别代表对应大小为 size(colNames)*k 的主成分分析矩阵、前 k 个主成分每个特征的方差贡献率、主成分方差（协方差矩阵特征值）。可通过主成分分析矩阵转换待处理数据，详见 <a class="- topic/xref xref" href="https://github.com/scikit-learn/scikit-learn/blob/9aaed4987/sklearn/decomposition/_base.py#L100" target="_blank" rel="external noopener">Scikit-Learn PCA.transform()</a>。</p><p class="- topic/p p">可从中取若干数据绘制经度 - 纬度散点图观察 PCA 结果。</p><p class="- topic/p p">经处理，位置坐标分散在原点附近。</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 3</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">PCA 前上客位置信息</span></figcaption>
<img class="- topic/image image" src="images/Forecast_of_Taxi_Trip_Duration/3_2.png"/><br/>  
  
</figure><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 4</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">PCA 后上客位置信息</span></figcaption>
<img class="- topic/image image" src="images/Forecast_of_Taxi_Trip_Duration/3_3.png"/><br/>  
  
</figure><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">pca()</code> 接收一个或多个数据源为参数，对指定列中的数据进行主成分分析，用户可通过 <code class="+ topic/ph pr-d/codeph ph codeph">table()</code> 方法创建内存表，用于 PCA；DolphinDB 也提供了 <code class="+ topic/ph pr-d/codeph ph codeph">dot()</code>、<code class="+ topic/ph pr-d/codeph ph codeph">repmat()</code> 等矩阵乘法、矩阵堆叠方法，用户可使用内置函数快速完成矩阵运算，处理位置信息。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>PCApara = table(trainData[`pickup_latitude] as latitude, trainData[`pickup_longitude] as longitude)
pca_model = pca(sqlDS(&lt;select * from PCApara&gt;)) // 使用PCA计算数据集属性
pca_trainpick = dot((matrix(trainPickPara) - repmat(matrix(avg(trainPickPara)), train_n, 1)), pca_model.components) // transform
trainData[`pca_trainpick_0] = flatten(pca_trainpick[:, 0])</code></pre><p class="- topic/p p">DolphinDB 提供了 <code class="+ topic/ph pr-d/codeph ph codeph">plot</code> 函数供数据可视化。用户可通过 <code class="+ topic/ph pr-d/codeph ph codeph">chartType</code> 指定图表类型，详见 <a class="- topic/xref xref" href="../funcs/p/plot.html">plot</a>。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>x = select top 1000 pca_trainpick_1 from trainData
y = flatten(matrix(select top 1000 pca_trainpick_0 from trainData))
plot(x, y, chartType=SCATTER)</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title10" id="33-位置信息聚类kmeans"><h3 class="- topic/title title topictitle3" id="ariaid-title10">3.3. 位置信息聚类（KMeans）</h3><div class="- topic/body body"><p class="- topic/p p">原始数据位置数据规模庞大，很难挖掘多条数据间的共同特征。KMeans 可以将经纬度相近的数据点归为同一个簇，有助于更好地归纳组内数据特征。本模型指定要生成的聚类数为 100，质心最大迭代次数为 100，选择 KMeans++ 算法生成模型，DolphinDB kmeans 可选参数及含义详见<code class="+ topic/ph pr-d/codeph ph codeph">kmeans</code>。</p><p class="- topic/p p">可以使用条形图观察聚类后的数据分布。</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 5</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">KMeans 聚类结果</span></figcaption>
<img class="- topic/image image" src="images/Forecast_of_Taxi_Trip_Duration/3_4.png"/><br/>  
  
</figure><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">kmeans()</code> 接收一个表作为训练集。对于机器学习函数生成的模型，DolphinDB 提供 <code class="+ topic/ph pr-d/codeph ph codeph">saveModel</code> 方法将模型保存到本地文件中用于后续预测，用户可指定服务器端输出文件的绝对路径或相对路径；DolphinDB 也提供了 <code class="+ topic/ph pr-d/codeph ph codeph">predict</code> 方法，调用已训练的特定模型对相同表结构的测试集数据进行预测。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>kmeans_set = PCApara[rand(size(PCApara)-1, 500000)] // 随机选取500000数据用于聚类
kmeans_model = kmeans(kmeans_set, 100, maxIter=100, init='k-means++') // KMeans++
saveModel(kmeans_model, "./taxidata/KMeans.model") // 保存模型训练结果
trainData['pickup_cluster'] = kmeans_model.predict(select pickup_latitude, pickup_longitude from trainData)</code></pre><p class="- topic/p p"><code class="+ topic/ph pr-d/codeph ph codeph">saveModel</code> 和 <code class="+ topic/ph pr-d/codeph ph codeph">predict</code> 函数的使用方法可以参考：</p><ul class="- topic/ul ul"><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">saveModel</code></li><li class="- topic/li li"><code class="+ topic/ph pr-d/codeph ph codeph">predict</code></li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title11" id="34-新特征构建"><h3 class="- topic/title title topictitle3" id="ariaid-title11">3.4. 新特征构建</h3><div class="- topic/body body"><p class="- topic/p p">原始数据仅提供了经度及纬度位置信息，可在此基础上增加位置特征，如地球表面两经纬度点之间距离、两经纬度点之间的 Manhattan 距离、两个经纬度之间的方位信息等等。</p><p class="- topic/p p">地球表面两点间的距离可使用 haversine 公式精确得到，而在本数据集中，网约车实际驶过的往往是水平或竖直的街道所组成的路径，Manhattan 距离（也称城市街区距离）标明两个点在标准坐标系上的绝对轴距总和，可能能够更精确地反映实际的行驶距离。</p><p class="- topic/p p">在此基础上，考虑到训练集包含了完整的时间信息，还可以在训练集上添加速度特征。训练集上的速度特征无法直接用于测试集，但在相同的位置聚类属性或相同的时间日期特征下，行程所需时间及平均速度可能存在某些共性（如郊区或凌晨时分网约车车速偏大而城区及早晚高峰时段网约车车速偏小），可以将这种训练集上发现的经验应用到测试集上。可将数据按聚类属性或时间特征分组，统计组内数据平均速度等特征，组合生成新特征，合并到测试集的相应分组中。</p><p class="- topic/p p">距离、方位的计算参数不同而方法相同，DolphinDB 支持用户自定义函数，通过独立的代码模块完成特定的计算任务。而对于不同类别（聚类、时间）内的特征，可使用 <code class="+ topic/ph pr-d/codeph ph codeph">groupby</code> 方法在每个分组中计算需要的特征（如平均值）。<code class="+ topic/ph pr-d/codeph ph codeph">groupby</code> 接收三个参数，将根据第三个参数指定的列进行分组，取第一个参数为计算函数，计算第二个参数对应列的特征，并返回行数与分组数相等的表。用户可通过表连接操作将该组合特征合并入特征数据，本文使用 <code class="+ topic/ph pr-d/codeph ph codeph">fj</code>(full join) 将特征表与 groupby 表合并，<code class="+ topic/ph pr-d/codeph ph codeph">fj()</code> 指定第三个参数为连接列，将前两个参数所传入的表合并。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>// 两经纬度点距离、两个经纬度之间的 Manhattan 距离、两个经纬度之间的方位信息
trainData['distance_haversine'] = haversine_array(trainData['pickup_latitude'], trainData['pickup_longitude'], trainData['dropoff_latitude'], trainData['dropoff_longitude'])
trainData['distance_dummy_manhattan'] = dummy_manhattan_distance(trainData['pickup_latitude'], trainData['pickup_longitude'], trainData['dropoff_latitude'], trainData['dropoff_longitude'])
trainData['direction'] = bearing_array(trainData['pickup_latitude'], trainData['pickup_longitude'], trainData['dropoff_latitude'], trainData['dropoff_longitude'])
// 按时间、聚类等信息处理速度、行程时间，产生新特征
for(gby_col in ['pickup_hour', 'pickup_date', 'pickup_week_hour', 'pickup_cluster', 'dropoff_cluster']) {
    for(gby_para in ['avg_speed_h', 'avg_speed_m', 'log_trip_duration']) {
        gby = groupby(avg, trainData[gby_para], trainData[gby_col])
        gby.rename!(`avg_ + gby_para, gby_para + '_gby_' + gby_col)
        trainData = fj(trainData, gby, gby_col)
        testData = fj(testData, gby, gby_col)
    }
      trainData.dropColumns!(`gby + gby_col)
}</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title12" id="35-模型训练xgboost"><h3 class="- topic/title title topictitle3" id="ariaid-title12">3.5. 模型训练（XGBoost）</h3><div class="- topic/body body"><p class="- topic/p p">在进行训练之前，需要再一次检查训练集和测试集的数据，需要剔除 ID、日期、字符等非数值型数据，以及平均速度、行驶时间等仅在训练集上存在的数据，保证训练数据与预测数据结构一致。</p><p class="- topic/p p">完成数据处理及特征构建后，可以使用 XGBoost 等机器学习方法训练模型。为评价模型训练效果，将训练数据集划分为训练集和验证集，随机选取 80% 的数据作为训练集训练模型，使用 20% 的数据作为验证集输出预测结果，使用均方根误差指标计算验证集的预测值与真实值的偏差。最终可以在测试集上输出行程时间的预测结果。</p><p class="- topic/p p">本模型在验证集上的均方根误差为 0.390，可以绘制预测值 - 真值散点图，定性分析模型预测效果。</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 6</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">验证集上的预测值与真实值</span></figcaption>
<img class="- topic/image image" src="images/Forecast_of_Taxi_Trip_Duration/3_5.png"/><br/>  
  
</figure><p class="- topic/p p">DolphinDB 提供了 XGBoost 插件实现模型训练及预测，使用前需要下载插件到指定路径并加载 XGBoost 插件。DolphinDB XGBoost 插件使用详见 <a class="- topic/xref xref" href="../plugins/xgboost/xgboost.html">XGboost 插件使用说明</a>。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>xgb_pars = {'min_child_weight': 50, 'eta': 0.3, 'colsample_bytree': 0.3, 'max_depth': 10,
            'subsample': 0.8, 'lambda': 1., 'nthread': 4, 'booster' : 'gbtree', 'silent': 1,
            'eval_metric': 'rmse', 'objective': 'reg:linear', 'nthread': 48} // xgb 参数设置
xgbModel = xgboost::train(ytrain, train, xgb_pars, 60) // 训练模型
yvalid_ = xgboost::predict(xgbModel, valid) // 使用模型进行预测</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title13" id="36-模型评价"><h3 class="- topic/title title topictitle3" id="ariaid-title13">3.6. 模型评价</h3><div class="- topic/body body"><p class="- topic/p p">为实现出租车行程时间的预测，本文使用了三种机器学习方法。首先使用 PCA 对位置信息进行处理，转换数据的经纬度特征；使用 KMeans++ 对出租车上下客位置进行聚类，将纽约市区划分为 100 个区域进行分析；最后使用 XGBoost 对数据集特征进行训练。在验证集上模型均方根误差为 0.390，效果较好。</p><p class="- topic/p p">Python Scikit-Learn 也是主流的机器学习库之一，本文在相同环境下使用 Python 对同一数据集进行训练，PCA、KMeans++、XGBoost 训练耗时如下表所示：</p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="36-模型评价__entry__1"><strong class="+ topic/ph hi-d/b ph b">模型</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="36-模型评价__entry__2"><strong class="+ topic/ph hi-d/b ph b">DolphinDB</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="36-模型评价__entry__3"><strong class="+ topic/ph hi-d/b ph b">Python</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__1">PCA</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__2"><strong class="+ topic/ph hi-d/b ph b">0.325s</strong></td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__3">0.396s</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__1">KMeans++</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__2"><strong class="+ topic/ph hi-d/b ph b">45.711s</strong></td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__3">104.568s</td></tr><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__1">XGBoost</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__2"><strong class="+ topic/ph hi-d/b ph b">57.269s</strong></td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__3">74.289s</td></tr></tbody></table></div><p class="- topic/p p">DolphinDB 与 Python 训练模型在验证集上误差如下表所示：</p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="36-模型评价__entry__13"> </th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="36-模型评价__entry__14"><strong class="+ topic/ph hi-d/b ph b">DolphinDB</strong></th><th class="- topic/entry entry align-left colsep-0 rowsep-0" id="36-模型评价__entry__15"><strong class="+ topic/ph hi-d/b ph b">Python</strong></th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__13">RMSE</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__14">0.390</td><td class="- topic/entry entry align-left colsep-0 rowsep-0" headers="36-模型评价__entry__15">0.394</td></tr></tbody></table></div><p class="- topic/p p">在本行程时间预测任务中，在准确率上，DolphinDB 与 Python 相近；而在性能上，DolphinDB 在 PCA、KMeans++、XGBoost 上的性能均优于 Python。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title14" id="4-行程时间实时预测"><h2 class="- topic/title title topictitle2" id="ariaid-title14">4. 行程时间实时预测</h2><div class="- topic/body body"><p class="- topic/p p">本节结合现实场景，介绍如何使用 DolphinDB 处理实时的订单流数据，基于预测模型实时估计行程时间。</p><p class="- topic/p p">现实场景中，网约车乘客对时效性要求高，需要平台提供准确的行程时间估计；而服务商也需要监控出行平台，分析出行需求并完成资源调度，仅仅使用预测模型无法高效处理实时数据，难以完成即时预测任务，无法满足乘客和服务商的实时需求。DolphinDB 流数据模块可以解决生产环境下实时数据的快速分析计算问题，对服务商发送的即时数据，DolphinDB 流数据引擎可高效完成数据预处理、信息提取、特征构建等工作，使用预先训练的模型完成实时订单行程时间的快速准确预测，为用户提供从模型训练、流数据注入到实时预测及在线监控的一站式解决方案。</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 7</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">DolphinDB 流数据处理框架 </span></figcaption>
<img class="- topic/image image" src="../stream/images/forecast_taxi_2.png"/><br/>  
  
</figure></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title15" id="41-场景描述"><h3 class="- topic/title title topictitle3" id="ariaid-title15">4.1. 场景描述</h3><div class="- topic/body body"><p class="- topic/p p">DolphinDB 流数据模块采用发布 - 订阅 - 消费的模式，流数据首先注入流数据表中，通过流数据表来发布数据，第三方应用可以通过 DolphinDB 脚本或 API 订阅及消费流数据。</p><p class="- topic/p p">为实现出租车行程时间的实时预测，服务商可以创建 DolphinDB 流数据表订阅服务端消息，获取乘客创建的行程信息，使用离线训练完成的模型对行程时间进行实时预测，最后可通过应用程序订阅预测数据并提供给乘客。</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title16" id="42-实时数据模拟及预测"><h3 class="- topic/title title topictitle3" id="ariaid-title16">4.2. 实时数据模拟及预测</h3><div class="- topic/body body"><p class="- topic/p p">为获取行程数据并使用机器学习模型预测行程时间，用户需要创建三个流数据表实现实时预测，一是创建订单信息表订阅乘客行程信息，二是创建特征表完成对订单信息的特征提取；三是创建预测表预测特征流数据表发送的行程特征信息，输出预测结果。</p><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 8</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title"> </span></figcaption>
<img class="- topic/image image" src="../stream/images/forecast_taxi_3.png"/><br/>  
  
</figure><p class="- topic/p p">用户可以使用 subscribeTable 完成流数据的订阅，并通过 <em class="+ topic/ph hi-d/i ph i">handler</em> 指定处理订阅数据的方法（详见 subscribeTable — DolphinDB 2.0 documentation）。在本例中，特征表需订阅订单表完成原始信息的特征提取，本模型定义 <code class="+ topic/ph pr-d/codeph ph codeph">process</code> 函数实现；预测表需订阅特征表使用特征信息完成行程时间预测，本模型定义 <code class="+ topic/ph pr-d/codeph ph codeph">predictDuration</code> 函数实现。函数实现详见"模型代码"所附代码。</p><p class="- topic/p p">为模拟实时数据，使用<code class="+ topic/ph pr-d/codeph ph codeph">replay</code>函数回放历史数据。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>// 订阅订单信息表，数据从订单表流向特征表
subscribeTable(tableName="orderTable", actionName="orderProcess", offset=0, handler=process{traitTable, hisData}, msgAsTable=true, batchSize=1, throttle=1, hash=0, reconnect=true)
// 订阅特征表，数据从特征表流向预测表
subscribeTable(tableName="traitTable", actionName="predict", offset=0, handler=predictDuration{predictTable}, msgAsTable=true, hash=1, reconnect=true)
// 回放历史数据，模拟实时产生的生产数据
submitJob("replay", "trade",  replay{inputTables=data, outputTables=orderTable, dateColumn=`pickup_datetime, timeColumn=`pickup_datetime, replayRate=25, absoluteRate=true, parallelLevel=1})</code></pre></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title17" id="43-grafana-实时监控"><h3 class="- topic/title title topictitle3" id="ariaid-title17">4.3. Grafana 实时监控</h3><div class="- topic/body body"><p class="- topic/p p">服务商可通过第三方 API 连接 DolphinDB 数据库监控行程时间预测服务，本文以 Grafana 为例简要介绍如何使用第三方应用程序动态展示实时数据。</p><p class="- topic/p p">Grafana 是一个用于时序数据动态可视化的数据展示工具，DolphinDB 提供了 Grafana 的数据接口，用户可在 Grafana 面板上编写查询脚本与 DolphinDB 进行交互，实现 DolphinDB 时序数据的可视化，并 Web 端进行实时数据分析，详见 <a class="- topic/xref xref" href="../tools/grafana.html">grafana-datasource</a>。</p><p class="- topic/p p">添加 datasource 并新建 dashboard 后，在 Query 中填写以下 DolphinDB 语句进行实时数据可视化：</p><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p">Query 1：展示当日出行订单预估到达时间及预估行程时间</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select id as ID, pickup_datetime as pickup_time, (pickup_datetime+int((exp(duration)-1))) as arrival_time,  (exp(duration)-1)/60 as duration from predictTable 
where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) </code></pre></li><li class="- topic/li li"><p class="- topic/p p">Query 2：统计当日累计订单数及累计乘客数</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select count(*) from predictTable 
where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable)
select sum(passenger_count) from predictTable 
where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) </code></pre><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 9</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">订单预估到达时间及当日订单数</span></figcaption>
    <img class="- topic/image image" src="images/Forecast_of_Taxi_Trip_Duration/4_3.png"/><br/>  
      
    </figure></li><li class="- topic/li li"><p class="- topic/p p">Query 3：统计当日乘客上车位置</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select pickup_latitude as latitude, pickup_longitude as longitude from predictTable 
where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) </code></pre><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 10</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">当日乘客上车位置</span></figcaption>
    <img class="- topic/image image" src="images/Forecast_of_Taxi_Trip_Duration/4_3.png"/><br/>  
      
    </figure></li><li class="- topic/li li"><p class="- topic/p p">Query 4：统计当日不同时刻订单出行耗时</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>select pickup_datetime, (exp(duration)-1)/60 as duration from predictTable 
where date(predictTable.pickup_datetime) == date(select max(pickup_datetime) from predictTable) </code></pre><figure class="- topic/fig fig fignone"><figcaption data-caption-side="top" class="- topic/title title figcap"><span class="figtitleprefix fig--title-label">图<span class="fig--title-label-number"> 11</span><span class="fig--title-label-punctuation">. </span></span><span class="fig--title">当日不同时刻订单出行耗时</span></figcaption>
    <img class="- topic/image image" src="images/Forecast_of_Taxi_Trip_Duration/4_3.png"/><br/>  
      
    </figure></li></ul></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title18" id="44-数据持久化"><h3 class="- topic/title title topictitle3" id="ariaid-title18">4.4. 数据持久化</h3><div class="- topic/body body"><p class="- topic/p p">如果需要将历史数据落盘，可以订阅订单表中数据，指定 <code class="+ topic/ph pr-d/codeph ph codeph">subscribeTable</code> 以 <code class="+ topic/ph pr-d/codeph ph codeph">loadTable</code> 的方式将数据持久化到磁盘。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>db = database("dfs://taxi")
if(existsTable("dfs://taxi", "newData")) { dropTable(db, "newData") }
db.createPartitionedTable(table=table(1:0, orderTable.schema().colDefs.name, orderTable.schema().colDefs.typeString), tableName=`newData, partitionColumns=`pickup_datetime, sortColumns=`pickup_datetime, compressMethods={datetime:"delta"})
subscribeTable(tableName="orderTable", actionName="saveToDisk", offset=0, handler=loadTable("dfs://taxi", "newData"), msgAsTable=true, batchSize=100000, throttle=1, reconnect=true)</code></pre></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title19" id="5-附录"><h2 class="- topic/title title topictitle2" id="ariaid-title19">5. 附录</h2><div class="- topic/body body"></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title20" id="51-测试环境"><h3 class="- topic/title title topictitle3" id="ariaid-title20">5.1. 测试环境</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">操作系统：Linux version 3.10.0-1160.el7.x86_64</li><li class="- topic/li li">CPU：Intel(R) Xeon(R) Silver 4214 CPU @2.20GHz 48 核</li><li class="- topic/li li">内存：188G</li><li class="- topic/li li">软件版本</li></ul><p class="- topic/p p">DolphinDB: 2.00.9</p><p class="- topic/p p">Python3:3.7.12</p><p class="- topic/p p">Scikit-Learn: 1.0.2</p><p class="- topic/p p">XGBoost: 1.6.2</p></div></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title21" id="52-模型代码"><h3 class="- topic/title title topictitle3" id="ariaid-title21">5.2. 模型代码</h3><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li">DolphinDB 模型训练代码：<a class="- topic/xref xref" href="script/Forecast_of_Taxi_Trip_Duration/taxiTrain.dos">taxiTrain.dos</a></li><li class="- topic/li li">DolphinDB 流数据预测代码：  <a class="- topic/xref xref" href="script/Forecast_of_Taxi_Trip_Duration/taxiStream.dos">taxiStream.dos</a></li><li class="- topic/li li">Python 模型训练代码： <a class="- topic/xref xref" href="script/Forecast_of_Taxi_Trip_Duration/taxiTrain.py">taxiTrain.py</a></li></ul></div></article></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#1-%E6%A6%82%E8%A6%81" data-tocid="1-概要">1. 概要</a></li><li class="topic-item"><a href="#2-%E6%95%B0%E6%8D%AE%E4%BB%8B%E7%BB%8D" data-tocid="2-数据介绍">2. 数据介绍</a><ul><li class="topic-item"><a href="#21-%E6%95%B0%E6%8D%AE%E6%9D%A5%E6%BA%90%E5%8F%8A%E8%AE%AD%E7%BB%83%E6%96%B9%E6%B3%95" data-tocid="21-数据来源及训练方法">2.1. 数据来源及训练方法</a></li><li class="topic-item"><a href="#22-%E6%95%B0%E6%8D%AE%E7%89%B9%E5%BE%81" data-tocid="22-数据特征">2.2. 数据特征</a></li><li class="topic-item"><a href="#23-%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8" data-tocid="23-数据存储">2.3. 数据存储</a></li></ul></li><li class="topic-item"><a href="#3-%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA" data-tocid="3-模型构建">3. 模型构建</a><ul><li class="topic-item"><a href="#31-%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86" data-tocid="31-数据预处理">3.1. 数据预处理</a></li><li class="topic-item"><a href="#32-%E4%BD%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90pca" data-tocid="32-位置信息主成分分析pca">3.2. 位置信息主成分分析（PCA）</a></li><li class="topic-item"><a href="#33-%E4%BD%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E8%81%9A%E7%B1%BBkmeans" data-tocid="33-位置信息聚类kmeans">3.3. 位置信息聚类（KMeans）</a></li><li class="topic-item"><a href="#34-%E6%96%B0%E7%89%B9%E5%BE%81%E6%9E%84%E5%BB%BA" data-tocid="34-新特征构建">3.4. 新特征构建</a></li><li class="topic-item"><a href="#35-%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83xgboost" data-tocid="35-模型训练xgboost">3.5. 模型训练（XGBoost）</a></li><li class="topic-item"><a href="#36-%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BB%B7" data-tocid="36-模型评价">3.6. 模型评价</a></li></ul></li><li class="topic-item"><a href="#4-%E8%A1%8C%E7%A8%8B%E6%97%B6%E9%97%B4%E5%AE%9E%E6%97%B6%E9%A2%84%E6%B5%8B" data-tocid="4-行程时间实时预测">4. 行程时间实时预测</a><ul><li class="topic-item"><a href="#41-%E5%9C%BA%E6%99%AF%E6%8F%8F%E8%BF%B0" data-tocid="41-场景描述">4.1. 场景描述</a></li><li class="topic-item"><a href="#42-%E5%AE%9E%E6%97%B6%E6%95%B0%E6%8D%AE%E6%A8%A1%E6%8B%9F%E5%8F%8A%E9%A2%84%E6%B5%8B" data-tocid="42-实时数据模拟及预测">4.2. 实时数据模拟及预测</a></li><li class="topic-item"><a href="#43-grafana-%E5%AE%9E%E6%97%B6%E7%9B%91%E6%8E%A7" data-tocid="43-grafana-实时监控">4.3. Grafana 实时监控</a></li><li class="topic-item"><a href="#44-%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96" data-tocid="44-数据持久化">4.4. 数据持久化</a></li></ul></li><li class="topic-item"><a href="#5-%E9%99%84%E5%BD%95" data-tocid="5-附录">5. 附录</a><ul><li class="topic-item"><a href="#51-%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83" data-tocid="51-测试环境">5.1. 测试环境</a></li><li class="topic-item"><a href="#52-%E6%A8%A1%E5%9E%8B%E4%BB%A3%E7%A0%81" data-tocid="52-模型代码">5.2. 模型代码</a></li></ul></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>