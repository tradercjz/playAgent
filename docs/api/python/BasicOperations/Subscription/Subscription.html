<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh" lang="zh" data-whc_version="26.0">
    <head><link rel="shortcut icon" href="../../../../favicon.ico"/><link rel="icon" href="../../../../favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Python API 支持流数据订阅的功能，以下介绍如何启用流数据，订阅流数据，获取订阅主题和取消订阅流数据。 使用 session 提供的 enableStreaming 方法启用流数据功能，使用示例如下： enableStreaming(port= 0 ) port ：指定开启数据订阅的端口，用于订阅服务器端发送的数据。（2.00.9 及之后版本的 DolphinDB 无需指定该参数） ..."/><meta name="DC.rights.owner" content="(C) 版权 2025"/><meta name="copyright" content="(C) 版权 2025"/><meta name="generator" content="DITA-OT"/><meta name="DC.type" content="topic"/><meta name="DC.format" content="HTML5"/><meta name="DC.identifier" content="流数据订阅"/><title>流数据订阅</title><!--  Generated with Oxygen version 26.0, build number 2024012323.  --><meta name="wh-path2root" content="../../../../"/><meta name="wh-toc-id" content="&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;&lt;?workdir /tmp/temp20250305183303418/api/python/BasicOperations/Subscription?&gt;&lt;?workdir-uri file:/tmp/temp20250305183303418/api/python/BasicOperations/Subscription/?&gt;&lt;?path2project ../../../../?&gt;&lt;?path2project-uri ../../../../?&gt;&lt;?path2rootmap-uri ../../../../?&gt;&lt;topic xmlns:dita-ot=&#34;http://dita-ot.sourceforge.net/ns/201007/dita-ot&#34; xmlns:ditaarch=&#34;http://dita.oasis-open.org/architecture/2005/&#34; class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;流数据订阅&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:1;1:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:1;1:1&#34;&gt;流数据订阅&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:1;1:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:1;3:1&#34;&gt;Python API 支持流数据订阅的功能，以下介绍如何启用流数据，订阅流数据，获取订阅主题和取消订阅流数据。&lt;/p&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;启用流数据&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:2;5:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:2;5:1&#34;&gt;启用流数据&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:2;5:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:2;7:1&#34;&gt;使用 session 提供的 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:1;7:16&#34;&gt;enableStreaming&lt;/codeph&gt; 方法启用流数据功能，使用示例如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;python&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:1;9:1&#34;&gt;enableStreaming(port=0)&lt;/codeblock&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:1;13:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:1;13:1&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:1;13:3&#34;&gt;port&lt;/b&gt;：指定开启数据订阅的端口，用于订阅服务器端发送的数据。（2.00.9 及之后版本的 DolphinDB 无需指定该参数）&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:3;15:1&#34;&gt;使用时须注意，API 进行订阅时，其订阅行为根据 DolphinDB 的版本有所不同，详细说明如下：&lt;/p&gt;&lt;table class=&#34;- topic/table &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;table:1;17:1&#34;&gt;&lt;tgroup class=&#34;- topic/tgroup &#34; cols=&#34;3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;tgroup:1;17:1&#34;&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col1&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;colspec:1;17:1&#34; colnum=&#34;1&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col2&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;colspec:2;17:1&#34; colnum=&#34;2&#34;/&gt;&lt;colspec class=&#34;- topic/colspec &#34; colname=&#34;col3&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;colspec:3;17:1&#34; colnum=&#34;3&#34;/&gt;&lt;thead class=&#34;- topic/thead &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;thead:1;17:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;row:1;17:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:1;17:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;1&#34;&gt;DolphinDB Server 版本&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:2;17:22&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;1&#34;&gt;Python API 版本&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:3;17:36&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;1&#34;&gt;是否需要指定端口&lt;/entry&gt;&lt;/row&gt;&lt;/thead&gt;&lt;tbody class=&#34;- topic/tbody &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;tbody:1;19:1&#34;&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;row:2;19:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:4;19:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;2&#34;&gt;1.30.x, 2.00.9 之前的版本&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:5;19:23&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;2&#34;&gt;与 DolphinDB Server 版本对应的版本&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:6;19:50&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;2&#34;&gt;是&lt;/entry&gt;&lt;/row&gt;&lt;row class=&#34;- topic/row &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;row:3;20:1&#34;&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:7;20:1&#34; colname=&#34;col1&#34; dita-ot:x=&#34;1&#34; dita-ot:y=&#34;3&#34;&gt;2.00.9 及之后的版本&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:8;20:16&#34; colname=&#34;col2&#34; dita-ot:x=&#34;2&#34; dita-ot:y=&#34;3&#34;&gt;与 DolphinDB Server 版本对应的版本&lt;/entry&gt;&lt;entry class=&#34;- topic/entry &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;entry:9;20:43&#34; colname=&#34;col3&#34; dita-ot:x=&#34;3&#34; dita-ot:y=&#34;3&#34;&gt;否&lt;/entry&gt;&lt;/row&gt;&lt;/tbody&gt;&lt;/tgroup&gt;&lt;/table&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:2;22:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:2;22:1&#34;&gt;1.30.x, 2.00.9 之前的版本在订阅端提交订阅请求后，发布端需要向 API 端指定端口重新发起一个 TCP 连接用于传输数据。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:3;23:1&#34;&gt;2.00.9 及之后的版本支持发布端通过订阅端的请求连接推送数据。因此，订阅端无需指定端口（默认值为 0）；如果指定，该参数无效，会被 API 忽略。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:4;25:1&#34;&gt;使用不同版本 API 启用流数据功能的脚本示例如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;python&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:2;27:1&#34;&gt;import dolphindb as ddb s = ddb.session() # 1.30.x，2.00.9 之前的版本，开启订阅，指定端口8000 s.enableStreaming(8000) # 2.00.9 及之后的版本，开启订阅，无需指定端口 s.enableStreaming() &lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:5;36:1&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:2;36:1&#34;&gt;注意&lt;/b&gt;：若同时升级 API 和 Server 至 2.00.9 及之后的版本，须在升级前先取消订阅，完成升级后再重新订阅。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;订阅&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:3;38:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:3;38:1&#34;&gt;订阅&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:3;38:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:6;40:1&#34;&gt;使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:2;40:4&#34;&gt;subscribe&lt;/codeph&gt; 方法订阅 DolphinDB 中的流数据表，接口示例如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;python&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:3;42:1&#34;&gt;subscribe(host, port, handler, tableName, actionName=None, offset=-1, resub=False, filter=None, msgAsTable=False, batchSize=0, throttle=1.0, userName=None, password=None, streamDeserializer=None, backupSites=None, resubTimeout=100, subOnce=False)&lt;/codeblock&gt;&lt;/body&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;参数介绍&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:4;49:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:4;49:1&#34;&gt;参数介绍&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:4;49:1&#34;/&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;连接参数-host-port-username-password-backupsites&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:5;51:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:5;51:1&#34;&gt;连接参数： &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:1;51:12&#34;&gt;host&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:2;51:20&#34;&gt;port&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:3;51:28&#34;&gt;userName&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:4;51:40&#34;&gt;password&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:5;51:52&#34;&gt;backupSites&lt;/i&gt;&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:5;51:1&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:3;53:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:4;53:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:7;53:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:3;53:3&#34;&gt;host&lt;/b&gt; ：字符串，必填，表示发布端节点的 IP 地址。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:5;54:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:8;54:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:4;54:3&#34;&gt;port&lt;/b&gt; ：字符串，必填，表示发布端节点的端口号。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:6;55:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:9;55:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:5;55:3&#34;&gt;userName&lt;/b&gt; ：字符串，可选，表示所连接 DolphinDB 的登录用户名。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:7;56:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:10;56:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:6;56:3&#34;&gt;password&lt;/b&gt; ：字符串，可选，表示所连接 DolphinDB 的登录用户名对应的密码。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:8;57:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:11;57:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:7;57:3&#34;&gt;backupSites&lt;/b&gt; ：字符串，可选，字符串列表，表示备用的发布端节点列表，由节点 ip 和端口号组成，例如 [&#34;192.168.0.1:8848&#34;, &#34;192.168.0.2:8849&#34;]。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:4;59:5&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:9;59:5&#34;&gt;指定 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:6;59:10&#34;&gt;backupSites&lt;/i&gt;，表示启动主备节点切换。如果发生节点切换（例如连接断开），会在可用节点列表中不断轮询订阅，直至订阅成功。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:10;60:5&#34;&gt;若配置该参数，用户需保证主节点（由 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:7;60:25&#34;&gt;host&lt;/i&gt; 和 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:8;60:34&#34;&gt;port&lt;/i&gt; 参数指定）和备用节点上存在相同结构、相同数据的同名流数据表。否则，可能出现订阅的数据不符合预期。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:11;61:5&#34;&gt;若订阅的是高可用流表，重连时将从 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:9;61:24&#34;&gt;backupSites&lt;/i&gt; 指定的节点列表中选择节点。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:12;62:5&#34;&gt;取消订阅需使用主节点 IP 和端口号进行取消。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;回调参数-handler&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:6;64:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:6;64:1&#34;&gt;回调参数： &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:10;64:12&#34;&gt;handler&lt;/i&gt;&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:6;64:1&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:5;66:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:13;66:1&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:8;66:3&#34;&gt;handler&lt;/b&gt; ：用户自定义的回调函数，用于处理每次流入的数据。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:12;68:1&#34;&gt;下例定义了一个简单的回调函数：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;python&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:4;70:1&#34;&gt;def handler(msg): print(msg)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;订阅参数tablename-actionname-offset-resub-filter-resubtimeout-subonce&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:7;75:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:7;75:1&#34;&gt;订阅参数：&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:11;75:11&#34;&gt;tableName&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:12;75:24&#34;&gt;actionName&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:13;75:38&#34;&gt;offset&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:14;75:48&#34;&gt;resub&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:15;75:57&#34;&gt;filter&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:16;75:67&#34;&gt;resubTimeout&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:17;75:83&#34;&gt;subOnce&lt;/i&gt;&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:7;75:1&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:6;77:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:14;77:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:13;77:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:9;77:3&#34;&gt;tableName&lt;/b&gt; ：表示发布表的名称。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:15;78:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:14;78:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:10;78:3&#34;&gt;actionName&lt;/b&gt; ：表示订阅任务的名称。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:7;79:3&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:16;79:3&#34;&gt;订阅时，订阅主题由订阅表所在节点的别名、流数据表名称和订阅任务名称组合而成，使用“/”分隔。注意，如果订阅主题已经存在，将会订阅失败。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:17;80:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:15;80:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:11;80:3&#34;&gt;offset&lt;/b&gt; ：整数，表示订阅任务开始后的第一条消息所在的位置。消息即为流数据表中的行。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:8;81:3&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:18;81:3&#34;&gt;若该参数未指定，或设为 -1，订阅将会从流数据表的当前行开始。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:19;82:3&#34;&gt;若该参数设为 -2，系统会获取持久化到磁盘上的 offset，并从该位置开始订阅。其中，offset 与流数据表创建时的第一行对应。如果某些行因为内存限制被删除，在决定订阅开始的位置时，这些行仍然考虑在内。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:20;84:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:16;84:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:12;84:3&#34;&gt;resub&lt;/b&gt; ：布尔值，表示订阅中断后，API 是否进行自动重订阅。默认值为 False，表示不会自动重订阅。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:21;85:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:17;85:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:13;85:3&#34;&gt;filter&lt;/b&gt; ：一个数组，表示过滤条件。在流数据表过滤列中，只有符合 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:18;85:42&#34;&gt;filter&lt;/i&gt; 过滤条件的数据才会发布到订阅端。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:22;86:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:18;86:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:14;86:3&#34;&gt;resubTimeout&lt;/b&gt; ：一个非负整数，表示在检测到连接断开后，经过多长时间开始尝试重新连接（单位毫秒），默认值为 100。&lt;/p&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:23;87:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:19;87:3&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:15;87:3&#34;&gt;subOnce&lt;/b&gt; ：布尔值，表示节点在切换重连时，同一个节点是否只能被订阅一次。&lt;/p&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:9;88:5&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:24;88:5&#34;&gt;默认为 False：节点被订阅后，再次进行重连时，该节点仍可参与后续的切换重连。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:25;89:5&#34;&gt;若设置为 True：节点被订阅后，若发生了节点切换，该节点将不再参与后续的切换重连。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:20;91:6&#34;&gt;当订阅单个节点，且 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:19;91:16&#34;&gt;resub&lt;/i&gt;=true 时，该参数不生效。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;模式参数msgastable-batchsize-throttle-streamdeserializer&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:8;93:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:8;93:1&#34;&gt;模式参数：&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:20;93:11&#34;&gt;msgAsTable&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:21;93:25&#34;&gt;batchSize&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:22;93:38&#34;&gt;throttle&lt;/i&gt;, &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:23;93:50&#34;&gt;streamDeserializer&lt;/i&gt;&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:8;93:1&#34;&gt;&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:10;95:1&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:26;95:1&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:16;95:3&#34;&gt;msgAsTable&lt;/b&gt; ：布尔值。若该参数设置为 True，表示订阅的数据将会转换为 DataFrame 格式。须注意，只有设置了参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:24;95:74&#34;&gt;batchSize&lt;/i&gt;，参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:25;95:89&#34;&gt;msgAsTable&lt;/i&gt; 才会生效。&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:17;95:107&#34;&gt;注意&lt;/b&gt;：若设置了 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:26;95:119&#34;&gt;streamDeserializer&lt;/i&gt;，则参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:27;95:144&#34;&gt;msgAsTable&lt;/i&gt; 必须设置为 False。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:27;96:1&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:18;96:3&#34;&gt;batchSize&lt;/b&gt; ：整数，表示批处理的消息的数量。&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:11;97:3&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:28;97:3&#34;&gt;如果该参数是正数：&lt;ul class=&#34;- topic/ul &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;ul:12;98:5&#34;&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:29;98:5&#34;&gt;设置 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:3;98:10&#34;&gt;msgAsTable = False&lt;/codeph&gt; 时，直到消息的数量达到 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:28;98:43&#34;&gt;batchSize&lt;/i&gt; 时，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:29;98:57&#34;&gt;handler&lt;/i&gt; 才会处理进来的 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:30;98:75&#34;&gt;batchSize&lt;/i&gt; 条消息，并返回一个 list，其中每一项都是单条数据。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:30;99:5&#34;&gt;设置 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:4;99:10&#34;&gt;msgAsTable = True&lt;/codeph&gt; 时，回调参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:31;99:37&#34;&gt;handler&lt;/i&gt; 将基于消息块（由 DolphinDB 中的参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:32;99:71&#34;&gt;maxMsgNumPerBlock&lt;/i&gt; 进行配置）处理消息。当收到的记录总数大于等于 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:33;99:114&#34;&gt;batchSize&lt;/i&gt; 时，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:34;99:128&#34;&gt;handler&lt;/i&gt; 将处理所有达到条件的消息块。举例说明：若设置 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:5;99:161&#34;&gt;batchSize = 1500&lt;/codeph&gt;，API 收到 DolphinDB 发送的第一个消息块（包含 1024 条记录），1024&amp;lt;1500，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:35;99:230&#34;&gt;handler&lt;/i&gt; 将不处理消息；API 收到第 2 个消息块（包含 500 条记录），此时，1024+500&amp;gt;1500，即两个消息块中包含的记录数大于 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:36;99:307&#34;&gt;batchSize&lt;/i&gt;，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:37;99:319&#34;&gt;handler&lt;/i&gt; 将开始处理这两个消息块中的 1524 条记录。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:31;100:3&#34;&gt;如果该参数是非正数或者未被指定，消息到达之后，&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:38;100:28&#34;&gt;handler&lt;/i&gt; 将立刻逐条处理消息，返回的数据将为单条数据组成的 list。&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:32;101:1&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:19;101:3&#34;&gt;throttle&lt;/b&gt; ：浮点数，表示 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:39;101:24&#34;&gt;handler&lt;/i&gt; 处理到达的消息之前等待的时间。单位为秒，默认值为 1.0。如果未指定 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:40;101:69&#34;&gt;batchSize&lt;/i&gt;，参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:41;101:84&#34;&gt;throttle&lt;/i&gt; 将无法产生作用。&lt;/li&gt;&lt;li class=&#34;- topic/li &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;li:33;102:1&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:20;102:3&#34;&gt;streamDeserializer&lt;/b&gt; ：表示订阅的异构流表对应的反序列化器。&lt;/li&gt;&lt;/ul&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:21;104:1&#34;&gt;&lt;b class=&#34;+ topic/ph hi-d/b &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;b:21;104:1&#34;&gt;注意：&lt;/b&gt; 订阅流表时，参数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:42;104:18&#34;&gt;batchsize&lt;/i&gt;、&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:43;104:30&#34;&gt;msgAsTable&lt;/i&gt;、&lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:44;104:43&#34;&gt;streamDeserializer&lt;/i&gt; 的值都将影响传入回调函数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:45;104:77&#34;&gt;handler&lt;/i&gt; 中变量的格式，各种参数的订阅示例请参考章节&lt;xref class=&#34;- topic/xref &#34; href=&#34;../../AdvancedOperations/SubscriptionOptions/SubscriptionOptions.md&#34; dita-ot:orig-format=&#34;md&#34; format=&#34;dita&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;xref:1;104:108&#34; type=&#34;topic&#34;&gt;&lt;?ditaot usertext?&gt;流订阅&lt;/xref&gt;。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;订阅示例&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:9;106:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:9;106:1&#34;&gt;订阅示例&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:9;106:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:22;108:1&#34;&gt;先在 DolphinDB 中创建共享的流数据表，指定进行过滤的列为 sym，并向 5 个 symbol 各插入 2 条记录，共 10 条记录：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:5;110:1&#34;&gt;share streamTable(10000:0,`time`sym`price`id, [TIMESTAMP,SYMBOL,DOUBLE,INT]) as trades setStreamTableFilterColumn(trades, `sym) insert into trades values(take(now(), 10), take(`000905`600001`300201`000908`600002, 10), rand(1000,10)/10.0, 1..10)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:23;116:1&#34;&gt;在 Python API 中，首先指定订阅端口号并启用流订阅（ 本例中使用 1.30.x 和 2.00.9 之前版本的 DolphinDB，故需要指定订阅端口号），然后定义回调函数 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:46;116:92&#34;&gt;handler&lt;/i&gt; 。再调用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:6;116:107&#34;&gt;subscribe&lt;/codeph&gt; 方法开启流订阅，其中设置 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:7;116:132&#34;&gt;offset=-1&lt;/codeph&gt;，&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:8;116:144&#34;&gt;filter=np.array([&#34;000905&#34;])&lt;/codeph&gt;。最后通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:9;116:180&#34;&gt;Event().wait()&lt;/codeph&gt; 的方式阻塞主线程，保持进程不退出。&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;python&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:6;118:1&#34;&gt;import dolphindb as ddb import numpy as np s = ddb.session() s.enableStreaming(0) # DolphinDB 的版本为 1.30.x 或小于 2.00.9 时，需指定端口 def handler(lst): print(lst) s.subscribe(&#34;192.168.1.113&#34;, 8848, handler, &#34;trades&#34;, &#34;action&#34;, offset=-1, filter=np.array([&#34;000905&#34;])) from threading import Event Event().wait() # 阻塞主线程，保持进程不退出&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:24;133:1&#34;&gt;执行脚本，发现此时没有流数据被打印出来。该情况是由于 offset 设置为 -1，表示订阅将会从流数据表的当前行开始，因此 DolphinDB &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:10;133:74&#34;&gt;insert into&lt;/codeph&gt; 命令中包含的数据将不会发送到流订阅客户端。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:25;135:1&#34;&gt;在 DolphinDB 中再次执行同一脚本：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:7;137:1&#34;&gt;insert into trades values(take(now(), 10), take(`000905`600001`300201`000908`600002, 10), rand(1000,10)/10.0, 1..10)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:26;141:1&#34;&gt;此时 Python 进程开始打印收到的流数据，输出内容如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:8;143:1&#34;&gt;[numpy.datetime64('2023-03-17T10:11:19.684'), '000905', 69.3, 1] [numpy.datetime64('2023-03-17T10:11:19.684'), '000905', 96.5, 6]&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:27;148:1&#34;&gt;在 API 收到的数据中，由于 &lt;i class=&#34;+ topic/ph hi-d/i &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;i:47;148:17&#34;&gt;filter&lt;/i&gt; 参数生效，故打印结果中仅保留了 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:11;148:42&#34;&gt;sym=&#34;000905&#34;&lt;/codeph&gt;的数据，其余数据都被过滤掉。&lt;/p&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;获取订阅主题&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:10;150:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:10;150:1&#34;&gt;获取订阅主题&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:10;150:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:28;152:1&#34;&gt;通过 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:12;152:4&#34;&gt;getSubscriptionTopics&lt;/codeph&gt; 方法可以获取当前 session 中的所有订阅主题。主题的构成方式是：&lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:13;152:63&#34;&gt;host/port/tableName/actionName&lt;/codeph&gt;，每个 session 的主题互不相同。&lt;/p&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:29;154:1&#34;&gt;使用示例如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;python&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:9;156:1&#34;&gt;s.getSubscriptionTopics()&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:30;160:1&#34;&gt;示例的输出结果如下所示：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:10;162:1&#34;&gt;['192.168.1.113/8848/trades/action']&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;topic class=&#34;- topic/topic &#34; ditaarch:DITAArchVersion=&#34;2.0&#34; specializations=&#34;@props/audience @props/deliveryTarget @props/otherprops @props/platform @props/product&#34; id=&#34;取消订阅&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;topic:11;166:1&#34; domains=&#34;a(props audience) a(props deliveryTarget) a(props otherprops) a(props platform) a(props product)&#34;&gt;&lt;title class=&#34;- topic/title &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;title:11;166:1&#34;&gt;取消订阅&lt;/title&gt;&lt;body class=&#34;- topic/body &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;body:11;166:1&#34;&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:31;168:1&#34;&gt;使用 &lt;codeph class=&#34;+ topic/ph pr-d/codeph &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeph:14;168:4&#34;&gt;unsubscribe&lt;/codeph&gt; 方法可以取消订阅，接口如下：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;python&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:11;170:1&#34;&gt;unsubscribe(host, port, tableName, actionName=None)&lt;/codeblock&gt;&lt;p class=&#34;- topic/p &#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;p:32;174:1&#34;&gt;取消示例中的订阅：&lt;/p&gt;&lt;codeblock class=&#34;+ topic/pre pr-d/codeblock &#34; xml:space=&#34;preserve&#34; outputclass=&#34;python&#34; xtrf=&#34;file:/var/lib/jenkins/workspace/packDocCN/documentation/zh/api/python/BasicOperations/Subscription/Subscription.md&#34; xtrc=&#34;codeblock:12;176:1&#34;&gt;s.unsubscribe(&#34;192.168.1.113&#34;, 8848, &#34;trades&#34;, &#34;action&#34;)&lt;/codeblock&gt;&lt;/body&gt;&lt;/topic&gt;&lt;/topic&gt;"/><meta name="wh-source-relpath" content="api/python/BasicOperations/Subscription/Subscription.md"/><meta name="wh-out-relpath" content="api/python/BasicOperations/Subscription/Subscription.html"/>

    <link rel="stylesheet" type="text/css" href="../../../../oxygen-webhelp/app/commons.css?buildId=2024012323"/>
    <link rel="stylesheet" type="text/css" href="../../../../oxygen-webhelp/app/topic.css?buildId=2024012323"/>

    <script src="../../../../oxygen-webhelp/app/options/properties.js?buildId=20250305183303"></script>
    <script src="../../../../oxygen-webhelp/app/localization/strings.js?buildId=2024012323"></script>
    <script src="../../../../oxygen-webhelp/app/search/index/keywords.js?buildId=20250305183303"></script>
    <script defer="defer" src="../../../../oxygen-webhelp/app/commons.js?buildId=2024012323"></script>
    <script defer="defer" src="../../../../oxygen-webhelp/app/topic.js?buildId=2024012323"></script>
<link rel="stylesheet" type="text/css" href="../../../../oxygen-webhelp/template/styles.css?buildId=2024012323"/><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script></head>

    <body id="流数据订阅" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            跳转到主要内容
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div xmlns:whc="http://www.oxygenxml.com/webhelp/components" class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="https://docs.dolphindb.cn/zh/index.html" class=" wh_logo d-none d-sm-block "><img src="../../../../logo.png" alt="  DolphinDB 文档中心  "/></a>
                    <div class=" wh_publication_title "><a href="../../../../index.html"><span class="booktitle">  <span class="ph mainbooktitle">DolphinDB 文档中心</span>  </span></a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="../../../../search.html"><div><input type="search" placeholder="搜索 " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="搜索查询" required="required"/><button type="submit" class="wh_search_button" aria-label="搜索"><span class="search_input_text">搜索</span></button></div></form>
            
            <script src="/vendors/react/umd/react.production.min.js" defer="defer"></script>
<script src="/vendors/react-dom/umd/react-dom.production.min.js" defer="defer"></script>
<script src="/vendors/dayjs/dayjs.min.js" defer="defer"></script>
<script src="/vendors/antd/dist/antd.min.js" defer="defer"></script>
<script src="/vendors/@ant-design/icons/dist/index.umd.min.js" defer="defer"></script>
<script src="/zh/index.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" defer="defer"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer="defer"><!--


--></script>
<script defer="defer"><!--

// 从主页重定向
const currentUrl = window.location.href;

// 判断当前URL是否包含index.html并且路径最后部分是index.html
if (currentUrl.endsWith('index.html')) {
    // 处理根目录下的index.html跳转
    const baseUrl = currentUrl.split('/index.html')[0]; // 获取index.html之前的部分
    const redirectUrl = `${baseUrl}/about/ddb_intro.html`; // 构建跳转路径
    window.location.href = redirectUrl; // 执行跳转
}

--></script>
            
        </div></div>
    </div>
</header>
        
        
         
        
        
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="切换搜索突出显示" title="切换搜索突出显示"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="折叠截面" title="折叠截面"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="打印此页" aria-label="打印此页"></button></div>
                        
                        
                    </div>
                    
                </nav>
            </div>
            
            
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                    
                    <div class="col-lg-10 col-md-10 col-sm-10 col-xs-12" id="wh_topic_body">
                        
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article class="- topic/topic topic" role="article" aria-labelledby="ariaid-title1"><h1 class="- topic/title title topictitle1" id="ariaid-title1">流数据订阅</h1><div class="- topic/body body"><p class="- topic/p p">Python API 支持流数据订阅的功能，以下介绍如何启用流数据，订阅流数据，获取订阅主题和取消订阅流数据。</p></div><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title2" id="启用流数据"><h2 class="- topic/title title topictitle2" id="ariaid-title2">启用流数据</h2><div class="- topic/body body"><p class="- topic/p p">使用 session 提供的 <code class="+ topic/ph pr-d/codeph ph codeph">enableStreaming</code> 方法启用流数据功能，使用示例如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python">enableStreaming(port=<span class="hl-number">0</span>)</pre><ul class="- topic/ul ul"><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">port</strong>：指定开启数据订阅的端口，用于订阅服务器端发送的数据。（2.00.9 及之后版本的 DolphinDB 无需指定该参数）</li></ul><p class="- topic/p p">使用时须注意，API 进行订阅时，其订阅行为根据 DolphinDB 的版本有所不同，详细说明如下：</p><div class="table-container"><table class="- topic/table table" data-cols="3"><caption></caption><colgroup><col/><col/><col/></colgroup><thead class="- topic/thead thead"><tr class="- topic/row"><th class="- topic/entry entry colsep-0 rowsep-0" id="启用流数据__entry__1">DolphinDB Server 版本</th><th class="- topic/entry entry colsep-0 rowsep-0" id="启用流数据__entry__2">Python API 版本</th><th class="- topic/entry entry colsep-0 rowsep-0" id="启用流数据__entry__3">是否需要指定端口</th></tr></thead><tbody class="- topic/tbody tbody"><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="启用流数据__entry__1">1.30.x, 2.00.9 之前的版本</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="启用流数据__entry__2">与 DolphinDB Server 版本对应的版本</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="启用流数据__entry__3">是</td></tr><tr class="- topic/row"><td class="- topic/entry entry colsep-0 rowsep-0" headers="启用流数据__entry__1">2.00.9 及之后的版本</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="启用流数据__entry__2">与 DolphinDB Server 版本对应的版本</td><td class="- topic/entry entry colsep-0 rowsep-0" headers="启用流数据__entry__3">否</td></tr></tbody></table></div><ul class="- topic/ul ul"><li class="- topic/li li">1.30.x, 2.00.9 之前的版本在订阅端提交订阅请求后，发布端需要向 API 端指定端口重新发起一个 TCP 连接用于传输数据。</li><li class="- topic/li li">2.00.9 及之后的版本支持发布端通过订阅端的请求连接推送数据。因此，订阅端无需指定端口（默认值为 0）；如果指定，该参数无效，会被 API 忽略。</li></ul><p class="- topic/p p">使用不同版本 API 启用流数据功能的脚本示例如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python"><strong class="hl-keyword">import</strong> dolphindb <strong class="hl-keyword">as</strong> ddb
s = ddb.session()
<em class="hl-comment"># 1.30.x，2.00.9 之前的版本，开启订阅，指定端口8000</em>
s.enableStreaming(<span class="hl-number">8000</span>)   
<em class="hl-comment"># 2.00.9 及之后的版本，开启订阅，无需指定端口</em>
s.enableStreaming() </pre><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意</strong>：若同时升级 API 和 Server 至 2.00.9 及之后的版本，须在升级前先取消订阅，完成升级后再重新订阅。</p></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title3" id="订阅"><h2 class="- topic/title title topictitle2" id="ariaid-title3">订阅</h2><div class="- topic/body body"><p class="- topic/p p">使用 <code class="+ topic/ph pr-d/codeph ph codeph">subscribe</code> 方法订阅 DolphinDB 中的流数据表，接口示例如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python">subscribe(host, port, handler, tableName, actionName=None, offset=-<span class="hl-number">1</span>, resub=False, 
          filter=None, msgAsTable=False, batchSize=<span class="hl-number">0</span>, throttle=<span class="hl-number">1.0</span>,
          userName=None, password=None, streamDeserializer=None, backupSites=None,
          resubTimeout=<span class="hl-number">100</span>, subOnce=False)</pre></div><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title4" id="参数介绍"><h3 class="- topic/title title topictitle3" id="ariaid-title4">参数介绍</h3><div class="- topic/body body"></div><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title5" id="连接参数-host-port-username-password-backupsites"><h4 class="- topic/title title topictitle4" id="ariaid-title5">连接参数： <em class="+ topic/ph hi-d/i ph i">host</em>, <em class="+ topic/ph hi-d/i ph i">port</em>, <em class="+ topic/ph hi-d/i ph i">userName</em>, <em class="+ topic/ph hi-d/i ph i">password</em>, <em class="+ topic/ph hi-d/i ph i">backupSites</em></h4><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">host</strong> ：字符串，必填，表示发布端节点的 IP 地址。</p></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">port</strong> ：字符串，必填，表示发布端节点的端口号。</p></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">userName</strong> ：字符串，可选，表示所连接 DolphinDB 的登录用户名。</p></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">password</strong> ：字符串，可选，表示所连接 DolphinDB 的登录用户名对应的密码。</p></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">backupSites</strong> ：字符串，可选，字符串列表，表示备用的发布端节点列表，由节点 ip 和端口号组成，例如 ["192.168.0.1:8848", "192.168.0.2:8849"]。</p><ul class="- topic/ul ul"><li class="- topic/li li">指定 <em class="+ topic/ph hi-d/i ph i">backupSites</em>，表示启动主备节点切换。如果发生节点切换（例如连接断开），会在可用节点列表中不断轮询订阅，直至订阅成功。</li><li class="- topic/li li">若配置该参数，用户需保证主节点（由 <em class="+ topic/ph hi-d/i ph i">host</em> 和 <em class="+ topic/ph hi-d/i ph i">port</em> 参数指定）和备用节点上存在相同结构、相同数据的同名流数据表。否则，可能出现订阅的数据不符合预期。</li><li class="- topic/li li">若订阅的是高可用流表，重连时将从 <em class="+ topic/ph hi-d/i ph i">backupSites</em> 指定的节点列表中选择节点。</li><li class="- topic/li li">取消订阅需使用主节点 IP 和端口号进行取消。</li></ul></li></ul></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title6" id="回调参数-handler"><h4 class="- topic/title title topictitle4" id="ariaid-title6">回调参数： <em class="+ topic/ph hi-d/i ph i">handler</em></h4><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">handler</strong> ：用户自定义的回调函数，用于处理每次流入的数据。</li></ul><p class="- topic/p p">下例定义了一个简单的回调函数：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python"><strong class="hl-keyword">def</strong> handler(msg):
    <strong class="hl-keyword">print</strong>(msg)</pre></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title7" id="订阅参数tablename-actionname-offset-resub-filter-resubtimeout-subonce"><h4 class="- topic/title title topictitle4" id="ariaid-title7">订阅参数：<em class="+ topic/ph hi-d/i ph i">tableName</em>, <em class="+ topic/ph hi-d/i ph i">actionName</em>, <em class="+ topic/ph hi-d/i ph i">offset</em>, <em class="+ topic/ph hi-d/i ph i">resub</em>, <em class="+ topic/ph hi-d/i ph i">filter</em>, <em class="+ topic/ph hi-d/i ph i">resubTimeout</em>, <em class="+ topic/ph hi-d/i ph i">subOnce</em></h4><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">tableName</strong> ：表示发布表的名称。</p></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">actionName</strong> ：表示订阅任务的名称。</p><ul class="- topic/ul ul"><li class="- topic/li li">订阅时，订阅主题由订阅表所在节点的别名、流数据表名称和订阅任务名称组合而成，使用“/”分隔。注意，如果订阅主题已经存在，将会订阅失败。</li></ul></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">offset</strong> ：整数，表示订阅任务开始后的第一条消息所在的位置。消息即为流数据表中的行。</p><ul class="- topic/ul ul"><li class="- topic/li li">若该参数未指定，或设为 -1，订阅将会从流数据表的当前行开始。</li><li class="- topic/li li">若该参数设为 -2，系统会获取持久化到磁盘上的 offset，并从该位置开始订阅。其中，offset 与流数据表创建时的第一行对应。如果某些行因为内存限制被删除，在决定订阅开始的位置时，这些行仍然考虑在内。</li></ul></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">resub</strong> ：布尔值，表示订阅中断后，API 是否进行自动重订阅。默认值为 False，表示不会自动重订阅。</p></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">filter</strong> ：一个数组，表示过滤条件。在流数据表过滤列中，只有符合 <em class="+ topic/ph hi-d/i ph i">filter</em> 过滤条件的数据才会发布到订阅端。</p></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">resubTimeout</strong> ：一个非负整数，表示在检测到连接断开后，经过多长时间开始尝试重新连接（单位毫秒），默认值为 100。</p></li><li class="- topic/li li"><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">subOnce</strong> ：布尔值，表示节点在切换重连时，同一个节点是否只能被订阅一次。</p><ul class="- topic/ul ul"><li class="- topic/li li">默认为 False：节点被订阅后，再次进行重连时，该节点仍可参与后续的切换重连。</li><li class="- topic/li li">若设置为 True：节点被订阅后，若发生了节点切换，该节点将不再参与后续的切换重连。</li></ul><p class="- topic/p p">当订阅单个节点，且 <em class="+ topic/ph hi-d/i ph i">resub</em>=true 时，该参数不生效。</p></li></ul></div></article><article class="- topic/topic topic nested3" aria-labelledby="ariaid-title8" id="模式参数msgastable-batchsize-throttle-streamdeserializer"><h4 class="- topic/title title topictitle4" id="ariaid-title8">模式参数：<em class="+ topic/ph hi-d/i ph i">msgAsTable</em>, <em class="+ topic/ph hi-d/i ph i">batchSize</em>, <em class="+ topic/ph hi-d/i ph i">throttle</em>, <em class="+ topic/ph hi-d/i ph i">streamDeserializer</em></h4><div class="- topic/body body"><ul class="- topic/ul ul"><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">msgAsTable</strong> ：布尔值。若该参数设置为 True，表示订阅的数据将会转换为 DataFrame 格式。须注意，只有设置了参数 <em class="+ topic/ph hi-d/i ph i">batchSize</em>，参数 <em class="+ topic/ph hi-d/i ph i">msgAsTable</em> 才会生效。<strong class="+ topic/ph hi-d/b ph b">注意</strong>：若设置了 <em class="+ topic/ph hi-d/i ph i">streamDeserializer</em>，则参数 <em class="+ topic/ph hi-d/i ph i">msgAsTable</em> 必须设置为 False。</li><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">batchSize</strong> ：整数，表示批处理的消息的数量。<ul class="- topic/ul ul"><li class="- topic/li li">如果该参数是正数：<ul class="- topic/ul ul"><li class="- topic/li li">设置 <code class="+ topic/ph pr-d/codeph ph codeph">msgAsTable = False</code> 时，直到消息的数量达到 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 时，<em class="+ topic/ph hi-d/i ph i">handler</em> 才会处理进来的 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 条消息，并返回一个 list，其中每一项都是单条数据。</li><li class="- topic/li li">设置 <code class="+ topic/ph pr-d/codeph ph codeph">msgAsTable = True</code> 时，回调参数 <em class="+ topic/ph hi-d/i ph i">handler</em> 将基于消息块（由 DolphinDB 中的参数 <em class="+ topic/ph hi-d/i ph i">maxMsgNumPerBlock</em> 进行配置）处理消息。当收到的记录总数大于等于 <em class="+ topic/ph hi-d/i ph i">batchSize</em> 时，<em class="+ topic/ph hi-d/i ph i">handler</em> 将处理所有达到条件的消息块。举例说明：若设置 <code class="+ topic/ph pr-d/codeph ph codeph">batchSize = 1500</code>，API 收到 DolphinDB 发送的第一个消息块（包含 1024 条记录），1024&lt;1500，<em class="+ topic/ph hi-d/i ph i">handler</em> 将不处理消息；API 收到第 2 个消息块（包含 500 条记录），此时，1024+500&gt;1500，即两个消息块中包含的记录数大于 <em class="+ topic/ph hi-d/i ph i">batchSize</em>，<em class="+ topic/ph hi-d/i ph i">handler</em> 将开始处理这两个消息块中的 1524 条记录。</li></ul></li><li class="- topic/li li">如果该参数是非正数或者未被指定，消息到达之后，<em class="+ topic/ph hi-d/i ph i">handler</em> 将立刻逐条处理消息，返回的数据将为单条数据组成的 list。</li></ul></li><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">throttle</strong> ：浮点数，表示 <em class="+ topic/ph hi-d/i ph i">handler</em> 处理到达的消息之前等待的时间。单位为秒，默认值为 1.0。如果未指定 <em class="+ topic/ph hi-d/i ph i">batchSize</em>，参数 <em class="+ topic/ph hi-d/i ph i">throttle</em> 将无法产生作用。</li><li class="- topic/li li"><strong class="+ topic/ph hi-d/b ph b">streamDeserializer</strong> ：表示订阅的异构流表对应的反序列化器。</li></ul><p class="- topic/p p"><strong class="+ topic/ph hi-d/b ph b">注意：</strong> 订阅流表时，参数 <em class="+ topic/ph hi-d/i ph i">batchsize</em>、<em class="+ topic/ph hi-d/i ph i">msgAsTable</em>、<em class="+ topic/ph hi-d/i ph i">streamDeserializer</em> 的值都将影响传入回调函数 <em class="+ topic/ph hi-d/i ph i">handler</em> 中变量的格式，各种参数的订阅示例请参考章节<a class="- topic/xref xref" href="../../AdvancedOperations/SubscriptionOptions/SubscriptionOptions.html">流订阅</a>。</p></div></article></article><article class="- topic/topic topic nested2" aria-labelledby="ariaid-title9" id="订阅示例"><h3 class="- topic/title title topictitle3" id="ariaid-title9">订阅示例</h3><div class="- topic/body body"><p class="- topic/p p">先在 DolphinDB 中创建共享的流数据表，指定进行过滤的列为 sym，并向 5 个 symbol 各插入 2 条记录，共 10 条记录：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>share streamTable(10000:0,`time`sym`price`id, [TIMESTAMP,SYMBOL,DOUBLE,INT]) as trades
setStreamTableFilterColumn(trades, `sym)
insert into trades values(take(now(), 10), take(`000905`600001`300201`000908`600002, 10), rand(1000,10)/10.0, 1..10)</code></pre><p class="- topic/p p">在 Python API 中，首先指定订阅端口号并启用流订阅（ 本例中使用 1.30.x 和 2.00.9 之前版本的 DolphinDB，故需要指定订阅端口号），然后定义回调函数 <em class="+ topic/ph hi-d/i ph i">handler</em> 。再调用 <code class="+ topic/ph pr-d/codeph ph codeph">subscribe</code> 方法开启流订阅，其中设置 <code class="+ topic/ph pr-d/codeph ph codeph">offset=-1</code>，<code class="+ topic/ph pr-d/codeph ph codeph">filter=np.array(["000905"])</code>。最后通过  <code class="+ topic/ph pr-d/codeph ph codeph">Event().wait()</code> 的方式阻塞主线程，保持进程不退出。</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python"><strong class="hl-keyword">import</strong> dolphindb <strong class="hl-keyword">as</strong> ddb
<strong class="hl-keyword">import</strong> numpy <strong class="hl-keyword">as</strong> np
s = ddb.session()
s.enableStreaming(<span class="hl-number">0</span>) <em class="hl-comment"># DolphinDB 的版本为 1.30.x 或小于 2.00.9 时，需指定端口</em>

<strong class="hl-keyword">def</strong> handler(lst):
    <strong class="hl-keyword">print</strong>(lst)

s.subscribe(<span class="hl-string">"192.168.1.113"</span>, <span class="hl-number">8848</span>, handler, <span class="hl-string">"trades"</span>, <span class="hl-string">"action"</span>, offset=-<span class="hl-number">1</span>, filter=np.array([<span class="hl-string">"000905"</span>]))

<strong class="hl-keyword">from</strong> threading <strong class="hl-keyword">import</strong> Event
Event().wait()          <em class="hl-comment"># 阻塞主线程，保持进程不退出</em></pre><p class="- topic/p p">执行脚本，发现此时没有流数据被打印出来。该情况是由于 offset 设置为 -1，表示订阅将会从流数据表的当前行开始，因此 DolphinDB  <code class="+ topic/ph pr-d/codeph ph codeph">insert into</code> 命令中包含的数据将不会发送到流订阅客户端。</p><p class="- topic/p p">在 DolphinDB 中再次执行同一脚本：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>insert into trades values(take(now(), 10), take(`000905`600001`300201`000908`600002, 10), rand(1000,10)/10.0, 1..10)</code></pre><p class="- topic/p p">此时 Python 进程开始打印收到的流数据，输出内容如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>[numpy.datetime64('2023-03-17T10:11:19.684'), '000905', 69.3, 1]
[numpy.datetime64('2023-03-17T10:11:19.684'), '000905', 96.5, 6]</code></pre><p class="- topic/p p">在 API 收到的数据中，由于 <em class="+ topic/ph hi-d/i ph i">filter</em> 参数生效，故打印结果中仅保留了 <code class="+ topic/ph pr-d/codeph ph codeph">sym="000905"</code>的数据，其余数据都被过滤掉。</p></div></article></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title10" id="获取订阅主题"><h2 class="- topic/title title topictitle2" id="ariaid-title10">获取订阅主题</h2><div class="- topic/body body"><p class="- topic/p p">通过 <code class="+ topic/ph pr-d/codeph ph codeph">getSubscriptionTopics</code> 方法可以获取当前 session 中的所有订阅主题。主题的构成方式是：<code class="+ topic/ph pr-d/codeph ph codeph">host/port/tableName/actionName</code>，每个 session 的主题互不相同。</p><p class="- topic/p p">使用示例如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python">s.getSubscriptionTopics()</pre><p class="- topic/p p">示例的输出结果如下所示：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock"><code>['192.168.1.113/8848/trades/action']</code></pre></div></article><article class="- topic/topic topic nested1" aria-labelledby="ariaid-title11" id="取消订阅"><h2 class="- topic/title title topictitle2" id="ariaid-title11">取消订阅</h2><div class="- topic/body body"><p class="- topic/p p">使用 <code class="+ topic/ph pr-d/codeph ph codeph">unsubscribe</code> 方法可以取消订阅，接口如下：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python">unsubscribe(host, port, tableName, actionName=None)</pre><p class="- topic/p p">取消示例中的订阅：</p><pre class="+ topic/pre pr-d/codeblock pre codeblock python">s.unsubscribe(<span class="hl-string">"192.168.1.113"</span>, <span class="hl-number">8848</span>, <span class="hl-string">"trades"</span>, <span class="hl-string">"action"</span>)</pre></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">在本页上</div><ul><li class="topic-item"><a href="#%E5%90%AF%E7%94%A8%E6%B5%81%E6%95%B0%E6%8D%AE" data-tocid="启用流数据">启用流数据</a></li><li class="topic-item"><a href="#%E8%AE%A2%E9%98%85" data-tocid="订阅">订阅</a><ul><li class="topic-item"><a href="#%E5%8F%82%E6%95%B0%E4%BB%8B%E7%BB%8D" data-tocid="参数介绍">参数介绍</a><ul><li class="topic-item"><a href="#%E8%BF%9E%E6%8E%A5%E5%8F%82%E6%95%B0-host-port-username-password-backupsites" data-tocid="连接参数-host-port-username-password-backupsites">连接参数： <em class="+ topic/ph hi-d/i ph i">host</em>, <em class="+ topic/ph hi-d/i ph i">port</em>, <em class="+ topic/ph hi-d/i ph i">userName</em>, <em class="+ topic/ph hi-d/i ph i">password</em>, <em class="+ topic/ph hi-d/i ph i">backupSites</em></a></li><li class="topic-item"><a href="#%E5%9B%9E%E8%B0%83%E5%8F%82%E6%95%B0-handler" data-tocid="回调参数-handler">回调参数： <em class="+ topic/ph hi-d/i ph i">handler</em></a></li><li class="topic-item"><a href="#%E8%AE%A2%E9%98%85%E5%8F%82%E6%95%B0tablename-actionname-offset-resub-filter-resubtimeout-subonce" data-tocid="订阅参数tablename-actionname-offset-resub-filter-resubtimeout-subonce">订阅参数：<em class="+ topic/ph hi-d/i ph i">tableName</em>, <em class="+ topic/ph hi-d/i ph i">actionName</em>, <em class="+ topic/ph hi-d/i ph i">offset</em>, <em class="+ topic/ph hi-d/i ph i">resub</em>, <em class="+ topic/ph hi-d/i ph i">filter</em>, <em class="+ topic/ph hi-d/i ph i">resubTimeout</em>, <em class="+ topic/ph hi-d/i ph i">subOnce</em></a></li><li class="topic-item"><a href="#%E6%A8%A1%E5%BC%8F%E5%8F%82%E6%95%B0msgastable-batchsize-throttle-streamdeserializer" data-tocid="模式参数msgastable-batchsize-throttle-streamdeserializer">模式参数：<em class="+ topic/ph hi-d/i ph i">msgAsTable</em>, <em class="+ topic/ph hi-d/i ph i">batchSize</em>, <em class="+ topic/ph hi-d/i ph i">throttle</em>, <em class="+ topic/ph hi-d/i ph i">streamDeserializer</em></a></li></ul></li><li class="topic-item"><a href="#%E8%AE%A2%E9%98%85%E7%A4%BA%E4%BE%8B" data-tocid="订阅示例">订阅示例</a></li></ul></li><li class="topic-item"><a href="#%E8%8E%B7%E5%8F%96%E8%AE%A2%E9%98%85%E4%B8%BB%E9%A2%98" data-tocid="获取订阅主题">获取订阅主题</a></li><li class="topic-item"><a href="#%E5%8F%96%E6%B6%88%E8%AE%A2%E9%98%85" data-tocid="取消订阅">取消订阅</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
<title>Copyright</title><p><b> ©2025 浙江智臾科技有限公司 浙ICP备18048711号-3</b></p>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
    </body>
</html>